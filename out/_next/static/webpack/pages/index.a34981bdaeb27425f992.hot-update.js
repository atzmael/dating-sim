webpackHotUpdate_N_E("pages/index",{

/***/ "./node_modules/inkjs/dist/ink-es2015.js":
/*!***********************************************!*\
  !*** ./node_modules/inkjs/dist/ink-es2015.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

!function(t,e){ true?e(exports):undefined}(this,(function(t){"use strict";class e{constructor(){if(this._components=[],this._componentsString=null,this._isRelative=!1,"string"==typeof arguments[0]){let t=arguments[0];this.componentsString=t}else if(arguments[0]instanceof e.Component&&arguments[1]instanceof e){let t=arguments[0],e=arguments[1];this._components.push(t),this._components=this._components.concat(e._components)}else if(arguments[0]instanceof Array){let t=arguments[0],e=!!arguments[1];this._components=this._components.concat(t),this._isRelative=e}}get isRelative(){return this._isRelative}get componentCount(){return this._components.length}get head(){return this._components.length>0?this._components[0]:null}get tail(){if(this._components.length>=2){let t=this._components.slice(1,this._components.length);return new e(t)}return e.self}get length(){return this._components.length}get lastComponent(){let t=this._components.length-1;return t>=0?this._components[t]:null}get containsNamedComponent(){for(let t=0,e=this._components.length;t<e;t++)if(!this._components[t].isIndex)return!0;return!1}static get self(){let t=new e;return t._isRelative=!0,t}GetComponent(t){return this._components[t]}PathByAppendingPath(t){let n=new e,i=0;for(let e=0;e<t._components.length&&t._components[e].isParent;++e)i++;for(let t=0;t<this._components.length-i;++t)n._components.push(this._components[t]);for(let e=i;e<t._components.length;++e)n._components.push(t._components[e]);return n}get componentsString(){return null==this._componentsString&&(this._componentsString=this._components.join("."),this.isRelative&&(this._componentsString="."+this._componentsString)),this._componentsString}set componentsString(t){if(this._components.length=0,this._componentsString=t,null==this._componentsString||""==this._componentsString)return;"."==this._componentsString[0]&&(this._isRelative=!0,this._componentsString=this._componentsString.substring(1));let n=this._componentsString.split(".");for(let t of n)/^(\-|\+)?([0-9]+|Infinity)$/.test(t)?this._components.push(new e.Component(parseInt(t))):this._components.push(new e.Component(t))}toString(){return this.componentsString}Equals(t){if(null==t)return!1;if(t._components.length!=this._components.length)return!1;if(t.isRelative!=this.isRelative)return!1;for(let e=0,n=t._components.length;e<n;e++)if(!t._components[e].Equals(this._components[e]))return!1;return!0}PathByAppendingComponent(t){let n=new e;return n._components.push.apply(n._components,this._components),n._components.push(t),n}}var n,i,r;function a(t,e){return t instanceof e?h(t):null}function s(t,e){if(t instanceof e)return h(t);throw new Error(`${t} is not of type ${e}`)}function l(t){return t.hasValidName&&t.name?t:null}function o(t){return void 0===t?null:t}function u(t){return"object"==typeof t&&"function"==typeof t.Equals}function h(t,e){return t}e.parentId="^",function(t){class e{constructor(t){this.index=-1,this.name=null,"string"==typeof t?this.name=t:this.index=t}get isIndex(){return this.index>=0}get isParent(){return this.name==t.parentId}static ToParent(){return new e(t.parentId)}toString(){return this.isIndex?this.index.toString():this.name}Equals(t){return null!=t&&t.isIndex==this.isIndex&&(this.isIndex?this.index==t.index:this.name==t.name)}}t.Component=e}(e||(e={})),function(t){function e(t,e){if(!t)throw void 0!==e&&console.warn(e),console.trace&&console.trace(),new Error("")}t.AssertType=function(t,n,i){e(t instanceof n,i)},t.Assert=e}(n||(n={}));class c extends Error{}function d(t){throw new c(t+" is null or undefined")}class p{constructor(){this.parent=null,this._debugMetadata=null,this._path=null}get debugMetadata(){return null===this._debugMetadata&&this.parent?this.parent.debugMetadata:this._debugMetadata}set debugMetadata(t){this._debugMetadata=t}get ownDebugMetadata(){return this._debugMetadata}DebugLineNumberOfPath(t){if(null===t)return null;let e=this.rootContentContainer;if(e){let n=e.ContentAtPath(t).obj;if(n){let t=n.debugMetadata;if(null!==t)return t.startLineNumber}}return null}get path(){if(null==this._path)if(null==this.parent)this._path=new e;else{let t=[],n=this,i=a(n.parent,N);for(;null!==i;){let r=l(n);null!=r&&r.hasValidName?t.unshift(new e.Component(r.name)):t.unshift(new e.Component(i.content.indexOf(n))),n=i,i=a(i.parent,N)}this._path=new e(t)}return this._path}ResolvePath(t){if(null===t)return d("path");if(t.isRelative){let e=a(this,N);return null===e&&(n.Assert(null!==this.parent,"Can't resolve relative path because we don't have a parent"),e=a(this.parent,N),n.Assert(null!==e,"Expected parent to be a container"),n.Assert(t.GetComponent(0).isParent),t=t.tail),null===e?d("nearestContainer"):e.ContentAtPath(t)}{let e=this.rootContentContainer;return null===e?d("contentContainer"):e.ContentAtPath(t)}}ConvertPathToRelative(t){let n=this.path,i=Math.min(t.length,n.length),r=-1;for(let e=0;e<i;++e){let i=n.GetComponent(e),a=t.GetComponent(e);if(!i.Equals(a))break;r=e}if(-1==r)return t;let a=n.componentCount-1-r,s=[];for(let t=0;t<a;++t)s.push(e.Component.ToParent());for(let e=r+1;e<t.componentCount;++e)s.push(t.GetComponent(e));return new e(s,!0)}CompactPathString(t){let e=null,n=null;if(t.isRelative)n=t.componentsString,e=this.path.PathByAppendingPath(t).componentsString;else{n=this.ConvertPathToRelative(t).componentsString,e=t.componentsString}return n.length<e.length?n:e}get rootContentContainer(){let t=this;for(;t.parent;)t=t.parent;return a(t,N)}Copy(){throw Error("Not Implemented: Doesn't support copying")}SetChild(t,e,n){t[e]&&(t[e]=null),t[e]=n,t[e]&&(t[e].parent=this)}}class m{constructor(t){t=void 0!==t?t.toString():"",this.string=t}get Length(){return this.string.length}Append(t){null!==t&&(this.string+=t)}AppendLine(t){void 0!==t&&this.Append(t),this.string+="\n"}AppendFormat(t,...e){this.string+=t.replace(/{(\d+)}/g,(t,n)=>void 0!==e[n]?e[n]:t)}toString(){return this.string}}class f{constructor(){if(this.originName=null,this.itemName=null,void 0!==arguments[1]){let t=arguments[0],e=arguments[1];this.originName=t,this.itemName=e}else if(arguments[0]){let t=arguments[0].toString().split(".");this.originName=t[0],this.itemName=t[1]}}static get Null(){return new f(null,null)}get isNull(){return null==this.originName&&null==this.itemName}get fullName(){return(null!==this.originName?this.originName:"?")+"."+this.itemName}toString(){return this.fullName}Equals(t){if(t instanceof f){let e=t;return e.itemName==this.itemName&&e.originName==this.originName}return!1}copy(){return new f(this.originName,this.itemName)}serialized(){return JSON.stringify({originName:this.originName,itemName:this.itemName})}static fromSerializedKey(t){let e=JSON.parse(t);if(!f.isLikeInkListItem(e))return f.Null;let n=e;return new f(n.originName,n.itemName)}static isLikeInkListItem(t){return"object"==typeof t&&(!(!t.hasOwnProperty("originName")||!t.hasOwnProperty("itemName"))&&(("string"==typeof t.originName||null===typeof t.originName)&&("string"==typeof t.itemName||null===typeof t.itemName)))}}class g extends Map{constructor(){if(super(arguments[0]instanceof g?arguments[0]:[]),this.origins=null,this._originNames=[],arguments[0]instanceof g){let t=arguments[0];t._originNames&&(this._originNames=t._originNames.slice())}else if("string"==typeof arguments[0]){let t=arguments[0],e=arguments[1];this.SetInitialOriginName(t);let n=e.listDefinitions.TryListGetDefinition(t,null);if(!n.exists)throw new Error("InkList origin could not be found in story when constructing new list: "+t);this.origins=[n.result]}else if("object"==typeof arguments[0]&&arguments[0].hasOwnProperty("Key")&&arguments[0].hasOwnProperty("Value")){let t=arguments[0];this.Add(t.Key,t.Value)}}AddItem(t){if(t instanceof f){let e=t;if(null==e.originName)return void this.AddItem(e.itemName);if(null===this.origins)return d("this.origins");for(let t of this.origins)if(t.name==e.originName){let n=t.TryGetValueForItem(e,0);if(n.exists)return void this.Add(e,n.result);throw new Error("Could not add the item "+e+" to this list because it doesn't exist in the original list definition in ink.")}throw new Error("Failed to add item to list because the item was from a new list definition that wasn't previously known to this list. Only items from previously known lists can be used, so that the int value can be found.")}{let e=t,n=null;if(null===this.origins)return d("this.origins");for(let t of this.origins){if(null===e)return d("itemName");if(t.ContainsItemWithName(e)){if(null!=n)throw new Error("Could not add the item "+e+" to this list because it could come from either "+t.name+" or "+n.name);n=t}}if(null==n)throw new Error("Could not add the item "+e+" to this list because it isn't known to any list definitions previously associated with this list.");let i=new f(n.name,e),r=n.ValueForItem(i);this.Add(i,r)}}ContainsItemNamed(t){for(let[e]of this){if(f.fromSerializedKey(e).itemName==t)return!0}return!1}ContainsKey(t){return this.has(t.serialized())}Add(t,e){let n=t.serialized();if(this.has(n))throw new Error("The Map already contains an entry for "+t);this.set(n,e)}Remove(t){return this.delete(t.serialized())}get Count(){return this.size}get originOfMaxItem(){if(null==this.origins)return null;let t=this.maxItem.Key.originName,e=null;return this.origins.every(n=>n.name!=t||(e=n,!1)),e}get originNames(){if(this.Count>0){null==this._originNames&&this.Count>0?this._originNames=[]:(this._originNames||(this._originNames=[]),this._originNames.length=0);for(let[t]of this){let e=f.fromSerializedKey(t);if(null===e.originName)return d("item.originName");this._originNames.push(e.originName)}}return this._originNames}SetInitialOriginName(t){this._originNames=[t]}SetInitialOriginNames(t){this._originNames=null==t?null:t.slice()}get maxItem(){let t={Key:f.Null,Value:0};for(let[e,n]of this){let i=f.fromSerializedKey(e);(t.Key.isNull||n>t.Value)&&(t={Key:i,Value:n})}return t}get minItem(){let t={Key:f.Null,Value:0};for(let[e,n]of this){let i=f.fromSerializedKey(e);(t.Key.isNull||n<t.Value)&&(t={Key:i,Value:n})}return t}get inverse(){let t=new g;if(null!=this.origins)for(let e of this.origins)for(let[n,i]of e.items){let e=f.fromSerializedKey(n);this.ContainsKey(e)||t.Add(e,i)}return t}get all(){let t=new g;if(null!=this.origins)for(let e of this.origins)for(let[n,i]of e.items){let e=f.fromSerializedKey(n);t.set(e.serialized(),i)}return t}Union(t){let e=new g(this);for(let[n,i]of t)e.set(n,i);return e}Intersect(t){let e=new g;for(let[n,i]of this)t.has(n)&&e.set(n,i);return e}Without(t){let e=new g(this);for(let[n]of t)e.delete(n);return e}Contains(t){for(let[e]of t)if(!this.has(e))return!1;return!0}GreaterThan(t){return 0!=this.Count&&(0==t.Count||this.minItem.Value>t.maxItem.Value)}GreaterThanOrEquals(t){return 0!=this.Count&&(0==t.Count||this.minItem.Value>=t.minItem.Value&&this.maxItem.Value>=t.maxItem.Value)}LessThan(t){return 0!=t.Count&&(0==this.Count||this.maxItem.Value<t.minItem.Value)}LessThanOrEquals(t){return 0!=t.Count&&(0==this.Count||this.maxItem.Value<=t.maxItem.Value&&this.minItem.Value<=t.minItem.Value)}MaxAsList(){return this.Count>0?new g(this.maxItem):new g}MinAsList(){return this.Count>0?new g(this.minItem):new g}ListWithSubRange(t,e){if(0==this.Count)return new g;let n=this.orderedItems,i=0,r=Number.MAX_SAFE_INTEGER;Number.isInteger(t)?i=t:t instanceof g&&t.Count>0&&(i=t.minItem.Value),Number.isInteger(e)?r=e:t instanceof g&&t.Count>0&&(r=e.maxItem.Value);let a=new g;a.SetInitialOriginNames(this.originNames);for(let t of n)t.Value>=i&&t.Value<=r&&a.Add(t.Key,t.Value);return a}Equals(t){if(t instanceof g==!1)return!1;if(t.Count!=this.Count)return!1;for(let[e]of this)if(!t.has(e))return!1;return!0}get orderedItems(){let t=new Array;for(let[e,n]of this){let i=f.fromSerializedKey(e);t.push({Key:i,Value:n})}return t.sort((t,e)=>null===t.Key.originName?d("x.Key.originName"):null===e.Key.originName?d("y.Key.originName"):t.Value==e.Value?t.Key.originName.localeCompare(e.Key.originName):t.Value<e.Value?-1:t.Value>e.Value?1:0),t}toString(){let t=this.orderedItems,e=new m;for(let n=0;n<t.length;n++){n>0&&e.Append(", ");let i=t[n].Key;if(null===i.itemName)return d("item.itemName");e.Append(i.itemName)}return e.toString()}valueOf(){return NaN}}class S extends Error{constructor(t){super(t),this.useEndLineNumber=!1,this.message=t,this.name="StoryException"}}function y(t,e,n){if(null===t)return{result:n,exists:!1};let i=t.get(e);return void 0===i?{result:n,exists:!1}:{result:i,exists:!0}}class C extends p{static Create(t,n){if(n){if(n===i.Int&&Number.isInteger(Number(t)))return new b(Number(t));if(n===i.Float&&!isNaN(t))return new _(Number(t))}if("boolean"==typeof t){t=!!t?1:0}return"string"==typeof t?new T(String(t)):Number.isInteger(Number(t))?new b(Number(t)):isNaN(t)?t instanceof e?new P(s(t,e)):t instanceof g?new O(s(t,g)):null:new _(Number(t))}Copy(){return s(C.Create(this),p)}BadCastException(t){return new S("Can't cast "+this.valueObject+" from "+this.valueType+" to "+t)}}class v extends C{constructor(t){super(),this.value=t}get valueObject(){return this.value}toString(){return null===this.value?d("Value.value"):this.value.toString()}}class b extends v{constructor(t){super(t||0)}get isTruthy(){return 0!=this.value}get valueType(){return i.Int}Cast(t){if(null===this.value)return d("Value.value");if(t==this.valueType)return this;if(t==i.Float)return new _(this.value);if(t==i.String)return new T(""+this.value);throw this.BadCastException(t)}}class _ extends v{constructor(t){super(t||0)}get isTruthy(){return 0!=this.value}get valueType(){return i.Float}Cast(t){if(null===this.value)return d("Value.value");if(t==this.valueType)return this;if(t==i.Int)return new b(this.value);if(t==i.String)return new T(""+this.value);throw this.BadCastException(t)}}class T extends v{constructor(t){if(super(t||""),this._isNewline="\n"==this.value,this._isInlineWhitespace=!0,null===this.value)return d("Value.value");this.value.length>0&&this.value.split("").every(t=>" "==t||"\t"==t||(this._isInlineWhitespace=!1,!1))}get valueType(){return i.String}get isTruthy(){return null===this.value?d("Value.value"):this.value.length>0}get isNewline(){return this._isNewline}get isInlineWhitespace(){return this._isInlineWhitespace}get isNonWhitespace(){return!this.isNewline&&!this.isInlineWhitespace}Cast(t){if(t==this.valueType)return this;if(t==i.Int){let e=function(t,e=0){let n=parseInt(t);return Number.isNaN(n)?{result:e,exists:!1}:{result:n,exists:!0}}(this.value);if(e.exists)return new b(e.result);throw this.BadCastException(t)}if(t==i.Float){let e=function(t,e=0){let n=parseFloat(t);return Number.isNaN(n)?{result:e,exists:!1}:{result:n,exists:!0}}(this.value);if(e.exists)return new _(e.result);throw this.BadCastException(t)}throw this.BadCastException(t)}}class P extends v{constructor(t){super(t)}get valueType(){return i.DivertTarget}get targetPath(){return null===this.value?d("Value.value"):this.value}set targetPath(t){this.value=t}get isTruthy(){throw new Error("Shouldn't be checking the truthiness of a divert target")}Cast(t){if(t==this.valueType)return this;throw this.BadCastException(t)}toString(){return"DivertTargetValue("+this.targetPath+")"}}class w extends v{constructor(t,e=-1){super(t),this._contextIndex=e}get contextIndex(){return this._contextIndex}set contextIndex(t){this._contextIndex=t}get variableName(){return null===this.value?d("Value.value"):this.value}set variableName(t){this.value=t}get valueType(){return i.VariablePointer}get isTruthy(){throw new Error("Shouldn't be checking the truthiness of a variable pointer")}Cast(t){if(t==this.valueType)return this;throw this.BadCastException(t)}toString(){return"VariablePointerValue("+this.variableName+")"}Copy(){return new w(this.variableName,this.contextIndex)}}class O extends v{get isTruthy(){return null===this.value?d("this.value"):this.value.Count>0}get valueType(){return i.List}Cast(t){if(null===this.value)return d("Value.value");if(t==i.Int){let t=this.value.maxItem;return t.Key.isNull?new b(0):new b(t.Value)}if(t==i.Float){let t=this.value.maxItem;return t.Key.isNull?new _(0):new _(t.Value)}if(t==i.String){let t=this.value.maxItem;return t.Key.isNull?new T(""):new T(t.Key.toString())}if(t==this.valueType)return this;throw this.BadCastException(t)}constructor(t,e){super(null),t||e?t instanceof g?this.value=new g(t):t instanceof f&&"number"==typeof e&&(this.value=new g({Key:t,Value:e})):this.value=new g}static RetainListOriginsForAssignment(t,e){let n=a(t,O),i=a(e,O);return i&&null===i.value?d("newList.value"):n&&null===n.value?d("oldList.value"):void(n&&i&&0==i.value.Count&&i.value.SetInitialOriginNames(n.value.originNames))}}!function(t){t[t.Int=0]="Int",t[t.Float=1]="Float",t[t.List=2]="List",t[t.String=3]="String",t[t.DivertTarget=4]="DivertTarget",t[t.VariablePointer=5]="VariablePointer"}(i||(i={}));class E{constructor(){this.obj=null,this.approximate=!1}get correctObj(){return this.approximate?null:this.obj}get container(){return this.obj instanceof N?this.obj:null}copy(){let t=new E;return t.obj=this.obj,t.approximate=this.approximate,t}}class N extends p{constructor(){super(...arguments),this.name="",this._content=[],this.namedContent=new Map,this.visitsShouldBeCounted=!1,this.turnIndexShouldBeCounted=!1,this.countingAtStartOnly=!1,this._pathToFirstLeafContent=null}get hasValidName(){return null!=this.name&&this.name.length>0}get content(){return this._content}set content(t){this.AddContent(t)}get namedOnlyContent(){let t=new Map;for(let[e,n]of this.namedContent){let i=s(n,p);t.set(e,i)}for(let e of this.content){let n=l(e);null!=n&&n.hasValidName&&t.delete(n.name)}return 0==t.size&&(t=null),t}set namedOnlyContent(t){let e=this.namedOnlyContent;if(null!=e)for(let[t]of e)this.namedContent.delete(t);if(null!=t)for(let[,e]of t){let t=l(e);null!=t&&this.AddToNamedContentOnly(t)}}get countFlags(){let t=0;return this.visitsShouldBeCounted&&(t|=N.CountFlags.Visits),this.turnIndexShouldBeCounted&&(t|=N.CountFlags.Turns),this.countingAtStartOnly&&(t|=N.CountFlags.CountStartOnly),t==N.CountFlags.CountStartOnly&&(t=0),t}set countFlags(t){let e=t;(e&N.CountFlags.Visits)>0&&(this.visitsShouldBeCounted=!0),(e&N.CountFlags.Turns)>0&&(this.turnIndexShouldBeCounted=!0),(e&N.CountFlags.CountStartOnly)>0&&(this.countingAtStartOnly=!0)}get pathToFirstLeafContent(){return null==this._pathToFirstLeafContent&&(this._pathToFirstLeafContent=this.path.PathByAppendingPath(this.internalPathToFirstLeafContent)),this._pathToFirstLeafContent}get internalPathToFirstLeafContent(){let t=[],n=this;for(;n instanceof N;)n.content.length>0&&(t.push(new e.Component(0)),n=n.content[0]);return new e(t)}AddContent(t){if(t instanceof Array){let e=t;for(let t of e)this.AddContent(t)}else{let e=t;if(this._content.push(e),e.parent)throw new Error("content is already in "+e.parent);e.parent=this,this.TryAddNamedContent(e)}}TryAddNamedContent(t){let e=l(t);null!=e&&e.hasValidName&&this.AddToNamedContentOnly(e)}AddToNamedContentOnly(t){n.AssertType(t,p,"Can only add Runtime.Objects to a Runtime.Container"),s(t,p).parent=this,this.namedContent.set(t.name,t)}ContentAtPath(t,e=0,n=-1){-1==n&&(n=t.length);let i=new E;i.approximate=!1;let r=this,s=this;for(let l=e;l<n;++l){let e=t.GetComponent(l);if(null==r){i.approximate=!0;break}let n=r.ContentWithPathComponent(e);if(null==n){i.approximate=!0;break}s=n,r=a(n,N)}return i.obj=s,i}InsertContent(t,e){if(this.content[e]=t,t.parent)throw new Error("content is already in "+t.parent);t.parent=this,this.TryAddNamedContent(t)}AddContentsOfContainer(t){this.content=this.content.concat(t.content);for(let e of t.content)e.parent=this,this.TryAddNamedContent(e)}ContentWithPathComponent(t){if(t.isIndex)return t.index>=0&&t.index<this.content.length?this.content[t.index]:null;if(t.isParent)return this.parent;{if(null===t.name)return d("component.name");let e=y(this.namedContent,t.name,null);return e.exists?s(e.result,p):null}}BuildStringOfHierarchy(){let t;if(0==arguments.length)return t=new m,this.BuildStringOfHierarchy(t,0,null),t.toString();t=arguments[0];let e=arguments[1],i=arguments[2];function r(){for(let n=0;n<4*e;++n)t.Append(" ")}r(),t.Append("["),this.hasValidName&&t.AppendFormat(" ({0})",this.name),this==i&&t.Append("  <---"),t.AppendLine(),e++;for(let n=0;n<this.content.length;++n){let a=this.content[n];if(a instanceof N){a.BuildStringOfHierarchy(t,e,i)}else r(),a instanceof T?(t.Append('"'),t.Append(a.toString().replace("\n","\\n")),t.Append('"')):t.Append(a.toString());n!=this.content.length-1&&t.Append(","),a instanceof N||a!=i||t.Append("  <---"),t.AppendLine()}let a=new Map;for(let[t,e]of this.namedContent)this.content.indexOf(s(e,p))>=0||a.set(t,e);if(a.size>0){r(),t.AppendLine("-- named: --");for(let[,r]of a){n.AssertType(r,N,"Can only print out named Containers"),r.BuildStringOfHierarchy(t,e,i),t.AppendLine()}}e--,r(),t.Append("]")}}!function(t){let e;!function(t){t[t.Visits=1]="Visits",t[t.Turns=2]="Turns",t[t.CountStartOnly=4]="CountStartOnly"}(e=t.CountFlags||(t.CountFlags={}))}(N||(N={}));class x extends p{toString(){return"Glue"}}class A extends p{constructor(t=A.CommandType.NotSet){super(),this._commandType=t}get commandType(){return this._commandType}Copy(){return new A(this.commandType)}static EvalStart(){return new A(A.CommandType.EvalStart)}static EvalOutput(){return new A(A.CommandType.EvalOutput)}static EvalEnd(){return new A(A.CommandType.EvalEnd)}static Duplicate(){return new A(A.CommandType.Duplicate)}static PopEvaluatedValue(){return new A(A.CommandType.PopEvaluatedValue)}static PopFunction(){return new A(A.CommandType.PopFunction)}static PopTunnel(){return new A(A.CommandType.PopTunnel)}static BeginString(){return new A(A.CommandType.BeginString)}static EndString(){return new A(A.CommandType.EndString)}static NoOp(){return new A(A.CommandType.NoOp)}static ChoiceCount(){return new A(A.CommandType.ChoiceCount)}static Turns(){return new A(A.CommandType.Turns)}static TurnsSince(){return new A(A.CommandType.TurnsSince)}static ReadCount(){return new A(A.CommandType.ReadCount)}static Random(){return new A(A.CommandType.Random)}static SeedRandom(){return new A(A.CommandType.SeedRandom)}static VisitIndex(){return new A(A.CommandType.VisitIndex)}static SequenceShuffleIndex(){return new A(A.CommandType.SequenceShuffleIndex)}static StartThread(){return new A(A.CommandType.StartThread)}static Done(){return new A(A.CommandType.Done)}static End(){return new A(A.CommandType.End)}static ListFromInt(){return new A(A.CommandType.ListFromInt)}static ListRange(){return new A(A.CommandType.ListRange)}static ListRandom(){return new A(A.CommandType.ListRandom)}toString(){return this.commandType.toString()}}!function(t){let e;!function(t){t[t.NotSet=-1]="NotSet",t[t.EvalStart=0]="EvalStart",t[t.EvalOutput=1]="EvalOutput",t[t.EvalEnd=2]="EvalEnd",t[t.Duplicate=3]="Duplicate",t[t.PopEvaluatedValue=4]="PopEvaluatedValue",t[t.PopFunction=5]="PopFunction",t[t.PopTunnel=6]="PopTunnel",t[t.BeginString=7]="BeginString",t[t.EndString=8]="EndString",t[t.NoOp=9]="NoOp",t[t.ChoiceCount=10]="ChoiceCount",t[t.Turns=11]="Turns",t[t.TurnsSince=12]="TurnsSince",t[t.Random=13]="Random",t[t.SeedRandom=14]="SeedRandom",t[t.VisitIndex=15]="VisitIndex",t[t.SequenceShuffleIndex=16]="SequenceShuffleIndex",t[t.StartThread=17]="StartThread",t[t.Done=18]="Done",t[t.End=19]="End",t[t.ListFromInt=20]="ListFromInt",t[t.ListRange=21]="ListRange",t[t.ListRandom=22]="ListRandom",t[t.ReadCount=23]="ReadCount",t[t.TOTAL_VALUES=24]="TOTAL_VALUES"}(e=t.CommandType||(t.CommandType={}))}(A||(A={})),function(t){t[t.Tunnel=0]="Tunnel",t[t.Function=1]="Function",t[t.FunctionEvaluationFromGame=2]="FunctionEvaluationFromGame"}(r||(r={}));class I{constructor(){this.container=null,this.index=-1,2===arguments.length&&(this.container=arguments[0],this.index=arguments[1])}Resolve(){return this.index<0?this.container:null==this.container?null:0==this.container.content.length?this.container:this.index>=this.container.content.length?null:this.container.content[this.index]}get isNull(){return null==this.container}get path(){return this.isNull?null:this.index>=0?this.container.path.PathByAppendingComponent(new e.Component(this.index)):this.container.path}toString(){return this.container?"Ink Pointer -> "+this.container.path.toString()+" -- index "+this.index:"Ink Pointer (null)"}copy(){return new I(this.container,this.index)}static StartOf(t){return new I(t,0)}static get Null(){return new I(null,-1)}}class k extends p{constructor(t){super(),this._targetPath=null,this._targetPointer=I.Null,this.variableDivertName=null,this.pushesToStack=!1,this.stackPushType=0,this.isExternal=!1,this.externalArgs=0,this.isConditional=!1,this.pushesToStack=!1,void 0!==t&&(this.pushesToStack=!0,this.stackPushType=t)}get targetPath(){if(null!=this._targetPath&&this._targetPath.isRelative){let t=this.targetPointer.Resolve();t&&(this._targetPath=t.path)}return this._targetPath}set targetPath(t){this._targetPath=t,this._targetPointer=I.Null}get targetPointer(){if(this._targetPointer.isNull){let t=this.ResolvePath(this._targetPath).obj;if(null===this._targetPath)return d("this._targetPath");if(null===this._targetPath.lastComponent)return d("this._targetPath.lastComponent");if(this._targetPath.lastComponent.isIndex){if(null===t)return d("targetObj");this._targetPointer.container=t.parent instanceof N?t.parent:null,this._targetPointer.index=this._targetPath.lastComponent.index}else this._targetPointer=I.StartOf(t instanceof N?t:null)}return this._targetPointer.copy()}get targetPathString(){return null==this.targetPath?null:this.CompactPathString(this.targetPath)}set targetPathString(t){this.targetPath=null==t?null:new e(t)}get hasVariableTarget(){return null!=this.variableDivertName}Equals(t){let e=t;return e instanceof k&&this.hasVariableTarget==e.hasVariableTarget&&(this.hasVariableTarget?this.variableDivertName==e.variableDivertName:null===this.targetPath?d("this.targetPath"):this.targetPath.Equals(e.targetPath))}toString(){if(this.hasVariableTarget)return"Divert(variable: "+this.variableDivertName+")";if(null==this.targetPath)return"Divert(null)";{let t=new m,e=this.targetPath.toString();return t.Append("Divert"),this.isConditional&&t.Append("?"),this.pushesToStack&&(this.stackPushType==r.Function?t.Append(" function"):t.Append(" tunnel")),t.Append(" -> "),t.Append(this.targetPathString),t.Append(" ("),t.Append(e),t.Append(")"),t.toString()}}}class W extends p{constructor(t=!0){super(),this._pathOnChoice=null,this.hasCondition=!1,this.hasStartContent=!1,this.hasChoiceOnlyContent=!1,this.isInvisibleDefault=!1,this.onceOnly=!0,this.onceOnly=t}get pathOnChoice(){if(null!=this._pathOnChoice&&this._pathOnChoice.isRelative){let t=this.choiceTarget;t&&(this._pathOnChoice=t.path)}return this._pathOnChoice}set pathOnChoice(t){this._pathOnChoice=t}get choiceTarget(){return null===this._pathOnChoice?d("ChoicePoint._pathOnChoice"):this.ResolvePath(this._pathOnChoice).container}get pathStringOnChoice(){return null===this.pathOnChoice?d("ChoicePoint.pathOnChoice"):this.CompactPathString(this.pathOnChoice)}set pathStringOnChoice(t){this.pathOnChoice=new e(t)}get flags(){let t=0;return this.hasCondition&&(t|=1),this.hasStartContent&&(t|=2),this.hasChoiceOnlyContent&&(t|=4),this.isInvisibleDefault&&(t|=8),this.onceOnly&&(t|=16),t}set flags(t){this.hasCondition=(1&t)>0,this.hasStartContent=(2&t)>0,this.hasChoiceOnlyContent=(4&t)>0,this.isInvisibleDefault=(8&t)>0,this.onceOnly=(16&t)>0}toString(){if(null===this.pathOnChoice)return d("ChoicePoint.pathOnChoice");return"Choice: -> "+this.pathOnChoice.toString()}}class F extends p{constructor(t=null){super(),this.pathForCount=null,this.name=t}get containerForCount(){return null===this.pathForCount?null:this.ResolvePath(this.pathForCount).container}get pathStringForCount(){return null===this.pathForCount?null:this.CompactPathString(this.pathForCount)}set pathStringForCount(t){this.pathForCount=null===t?null:new e(t)}toString(){if(null!=this.name)return"var("+this.name+")";return"read_count("+this.pathStringForCount+")"}}class V extends p{constructor(t,e){super(),this.variableName=t||null,this.isNewDeclaration=!!e,this.isGlobal=!1}toString(){return"VarAssign to "+this.variableName}}class L extends p{}class R extends p{constructor(){if(super(),this._name=null,this._numberOfParameters=0,this._prototype=null,this._isPrototype=!1,this._operationFuncs=null,0===arguments.length)R.GenerateNativeFunctionsIfNecessary();else if(1===arguments.length){let t=arguments[0];R.GenerateNativeFunctionsIfNecessary(),this.name=t}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._isPrototype=!0,this.name=t,this.numberOfParameters=e}}static CallWithName(t){return new R(t)}static CallExistsWithName(t){return this.GenerateNativeFunctionsIfNecessary(),this._nativeFunctions.get(t)}get name(){return null===this._name?d("NativeFunctionCall._name"):this._name}set name(t){this._name=t,this._isPrototype||(null===R._nativeFunctions?d("NativeFunctionCall._nativeFunctions"):this._prototype=R._nativeFunctions.get(this._name)||null)}get numberOfParameters(){return this._prototype?this._prototype.numberOfParameters:this._numberOfParameters}set numberOfParameters(t){this._numberOfParameters=t}Call(t){if(this._prototype)return this._prototype.Call(t);if(this.numberOfParameters!=t.length)throw new Error("Unexpected number of parameters");let e=!1;for(let n of t){if(n instanceof L)throw new S('Attempting to perform operation on a void value. Did you forget to "return" a value from a function you called here?');n instanceof O&&(e=!0)}if(2==t.length&&e)return this.CallBinaryListOperation(t);let n=this.CoerceValuesToSingleType(t),r=n[0].valueType;return r==i.Int||r==i.Float||r==i.String||r==i.DivertTarget||r==i.List?this.CallType(n):null}CallType(t){let e=s(t[0],v),n=e.valueType,r=e,a=t.length;if(2==a||1==a){if(null===this._operationFuncs)return d("NativeFunctionCall._operationFuncs");let l=this._operationFuncs.get(n);if(!l){const t=i[n];throw new S("Cannot perform operation "+this.name+" on "+t)}if(2==a){let e=s(t[1],v),n=l;if(null===r.value||null===e.value)return d("NativeFunctionCall.Call BinaryOp values");let i=n(r.value,e.value);return v.Create(i)}{let t=l;if(null===r.value)return d("NativeFunctionCall.Call UnaryOp value");let n=t(r.value);return this.name===R.Int?v.Create(n,i.Int):this.name===R.Float?v.Create(n,i.Float):v.Create(n,e.valueType)}}throw new Error("Unexpected number of parameters to NativeFunctionCall: "+t.length)}CallBinaryListOperation(t){if(("+"==this.name||"-"==this.name)&&t[0]instanceof O&&t[1]instanceof b)return this.CallListIncrementOperation(t);let e=s(t[0],v),n=s(t[1],v);if(!("&&"!=this.name&&"||"!=this.name||e.valueType==i.List&&n.valueType==i.List)){if(null===this._operationFuncs)return d("NativeFunctionCall._operationFuncs");let t=this._operationFuncs.get(i.Int);if(null===t)return d("NativeFunctionCall.CallBinaryListOperation op");let r=t(e.isTruthy?1:0,n.isTruthy?1:0);return new b(r)}if(e.valueType==i.List&&n.valueType==i.List)return this.CallType([e,n]);throw new S("Can not call use "+this.name+" operation on "+i[e.valueType]+" and "+i[n.valueType])}CallListIncrementOperation(t){let e=s(t[0],O),n=s(t[1],b),r=new g;if(null===e.value)return d("NativeFunctionCall.CallListIncrementOperation listVal.value");for(let[t,a]of e.value){let s=f.fromSerializedKey(t);if(null===this._operationFuncs)return d("NativeFunctionCall._operationFuncs");let l=this._operationFuncs.get(i.Int);if(null===n.value)return d("NativeFunctionCall.CallListIncrementOperation intVal.value");let o=l(a,n.value),u=null;if(null===e.value.origins)return d("NativeFunctionCall.CallListIncrementOperation listVal.value.origins");for(let t of e.value.origins)if(t.name==s.originName){u=t;break}if(null!=u){let t=u.TryGetItemWithValue(o,f.Null);t.exists&&r.Add(t.result,o)}}return new O(r)}CoerceValuesToSingleType(t){let e=i.Int,n=null;for(let r of t){let t=s(r,v);t.valueType>e&&(e=t.valueType),t.valueType==i.List&&(n=a(t,O))}let r=[];if(i[e]==i[i.List])for(let e of t){let t=s(e,v);if(t.valueType==i.List)r.push(t);else{if(t.valueType!=i.Int){const e=i[t.valueType];throw new S("Cannot mix Lists and "+e+" values in this operation")}{let e=parseInt(t.valueObject);if(n=s(n,O),null===n.value)return d("NativeFunctionCall.CoerceValuesToSingleType specialCaseList.value");let i=n.value.originOfMaxItem;if(null===i)return d("NativeFunctionCall.CoerceValuesToSingleType list");let a=i.TryGetItemWithValue(e,f.Null);if(!a.exists)throw new S("Could not find List item with the value "+e+" in "+i.name);{let t=new O(a.result,e);r.push(t)}}}}else for(let n of t){let t=s(n,v).Cast(e);r.push(t)}return r}static Identity(t){return t}static GenerateNativeFunctionsIfNecessary(){if(null==this._nativeFunctions){this._nativeFunctions=new Map,this.AddIntBinaryOp(this.Add,(t,e)=>t+e),this.AddIntBinaryOp(this.Subtract,(t,e)=>t-e),this.AddIntBinaryOp(this.Multiply,(t,e)=>t*e),this.AddIntBinaryOp(this.Divide,(t,e)=>Math.floor(t/e)),this.AddIntBinaryOp(this.Mod,(t,e)=>t%e),this.AddIntUnaryOp(this.Negate,t=>-t),this.AddIntBinaryOp(this.Equal,(t,e)=>t==e?1:0),this.AddIntBinaryOp(this.Greater,(t,e)=>t>e?1:0),this.AddIntBinaryOp(this.Less,(t,e)=>t<e?1:0),this.AddIntBinaryOp(this.GreaterThanOrEquals,(t,e)=>t>=e?1:0),this.AddIntBinaryOp(this.LessThanOrEquals,(t,e)=>t<=e?1:0),this.AddIntBinaryOp(this.NotEquals,(t,e)=>t!=e?1:0),this.AddIntUnaryOp(this.Not,t=>0==t?1:0),this.AddIntBinaryOp(this.And,(t,e)=>0!=t&&0!=e?1:0),this.AddIntBinaryOp(this.Or,(t,e)=>0!=t||0!=e?1:0),this.AddIntBinaryOp(this.Max,(t,e)=>Math.max(t,e)),this.AddIntBinaryOp(this.Min,(t,e)=>Math.min(t,e)),this.AddIntBinaryOp(this.Pow,(t,e)=>Math.pow(t,e)),this.AddIntUnaryOp(this.Floor,R.Identity),this.AddIntUnaryOp(this.Ceiling,R.Identity),this.AddIntUnaryOp(this.Int,R.Identity),this.AddIntUnaryOp(this.Float,t=>t),this.AddFloatBinaryOp(this.Add,(t,e)=>t+e),this.AddFloatBinaryOp(this.Subtract,(t,e)=>t-e),this.AddFloatBinaryOp(this.Multiply,(t,e)=>t*e),this.AddFloatBinaryOp(this.Divide,(t,e)=>t/e),this.AddFloatBinaryOp(this.Mod,(t,e)=>t%e),this.AddFloatUnaryOp(this.Negate,t=>-t),this.AddFloatBinaryOp(this.Equal,(t,e)=>t==e?1:0),this.AddFloatBinaryOp(this.Greater,(t,e)=>t>e?1:0),this.AddFloatBinaryOp(this.Less,(t,e)=>t<e?1:0),this.AddFloatBinaryOp(this.GreaterThanOrEquals,(t,e)=>t>=e?1:0),this.AddFloatBinaryOp(this.LessThanOrEquals,(t,e)=>t<=e?1:0),this.AddFloatBinaryOp(this.NotEquals,(t,e)=>t!=e?1:0),this.AddFloatUnaryOp(this.Not,t=>0==t?1:0),this.AddFloatBinaryOp(this.And,(t,e)=>0!=t&&0!=e?1:0),this.AddFloatBinaryOp(this.Or,(t,e)=>0!=t||0!=e?1:0),this.AddFloatBinaryOp(this.Max,(t,e)=>Math.max(t,e)),this.AddFloatBinaryOp(this.Min,(t,e)=>Math.min(t,e)),this.AddFloatBinaryOp(this.Pow,(t,e)=>Math.pow(t,e)),this.AddFloatUnaryOp(this.Floor,t=>Math.floor(t)),this.AddFloatUnaryOp(this.Ceiling,t=>Math.ceil(t)),this.AddFloatUnaryOp(this.Int,t=>Math.floor(t)),this.AddFloatUnaryOp(this.Float,R.Identity),this.AddStringBinaryOp(this.Add,(t,e)=>t+e),this.AddStringBinaryOp(this.Equal,(t,e)=>t===e?1:0),this.AddStringBinaryOp(this.NotEquals,(t,e)=>t!==e?1:0),this.AddStringBinaryOp(this.Has,(t,e)=>t.includes(e)?1:0),this.AddStringBinaryOp(this.Hasnt,(t,e)=>t.includes(e)?0:1),this.AddListBinaryOp(this.Add,(t,e)=>t.Union(e)),this.AddListBinaryOp(this.Subtract,(t,e)=>t.Without(e)),this.AddListBinaryOp(this.Has,(t,e)=>t.Contains(e)?1:0),this.AddListBinaryOp(this.Hasnt,(t,e)=>t.Contains(e)?0:1),this.AddListBinaryOp(this.Intersect,(t,e)=>t.Intersect(e)),this.AddListBinaryOp(this.Equal,(t,e)=>t.Equals(e)?1:0),this.AddListBinaryOp(this.Greater,(t,e)=>t.GreaterThan(e)?1:0),this.AddListBinaryOp(this.Less,(t,e)=>t.LessThan(e)?1:0),this.AddListBinaryOp(this.GreaterThanOrEquals,(t,e)=>t.GreaterThanOrEquals(e)?1:0),this.AddListBinaryOp(this.LessThanOrEquals,(t,e)=>t.LessThanOrEquals(e)?1:0),this.AddListBinaryOp(this.NotEquals,(t,e)=>t.Equals(e)?0:1),this.AddListBinaryOp(this.And,(t,e)=>t.Count>0&&e.Count>0?1:0),this.AddListBinaryOp(this.Or,(t,e)=>t.Count>0||e.Count>0?1:0),this.AddListUnaryOp(this.Not,t=>0==t.Count?1:0),this.AddListUnaryOp(this.Invert,t=>t.inverse),this.AddListUnaryOp(this.All,t=>t.all),this.AddListUnaryOp(this.ListMin,t=>t.MinAsList()),this.AddListUnaryOp(this.ListMax,t=>t.MaxAsList()),this.AddListUnaryOp(this.Count,t=>t.Count),this.AddListUnaryOp(this.ValueOfList,t=>t.maxItem.Value);let t=(t,e)=>t.Equals(e)?1:0,e=(t,e)=>t.Equals(e)?0:1;this.AddOpToNativeFunc(this.Equal,2,i.DivertTarget,t),this.AddOpToNativeFunc(this.NotEquals,2,i.DivertTarget,e)}}AddOpFuncForType(t,e){null==this._operationFuncs&&(this._operationFuncs=new Map),this._operationFuncs.set(t,e)}static AddOpToNativeFunc(t,e,n,i){if(null===this._nativeFunctions)return d("NativeFunctionCall._nativeFunctions");let r=this._nativeFunctions.get(t);r||(r=new R(t,e),this._nativeFunctions.set(t,r)),r.AddOpFuncForType(n,i)}static AddIntBinaryOp(t,e){this.AddOpToNativeFunc(t,2,i.Int,e)}static AddIntUnaryOp(t,e){this.AddOpToNativeFunc(t,1,i.Int,e)}static AddFloatBinaryOp(t,e){this.AddOpToNativeFunc(t,2,i.Float,e)}static AddFloatUnaryOp(t,e){this.AddOpToNativeFunc(t,1,i.Float,e)}static AddStringBinaryOp(t,e){this.AddOpToNativeFunc(t,2,i.String,e)}static AddListBinaryOp(t,e){this.AddOpToNativeFunc(t,2,i.List,e)}static AddListUnaryOp(t,e){this.AddOpToNativeFunc(t,1,i.List,e)}toString(){return'Native "'+this.name+'"'}}R.Add="+",R.Subtract="-",R.Divide="/",R.Multiply="*",R.Mod="%",R.Negate="_",R.Equal="==",R.Greater=">",R.Less="<",R.GreaterThanOrEquals=">=",R.LessThanOrEquals="<=",R.NotEquals="!=",R.Not="!",R.And="&&",R.Or="||",R.Min="MIN",R.Max="MAX",R.Pow="POW",R.Floor="FLOOR",R.Ceiling="CEILING",R.Int="INT",R.Float="FLOAT",R.Has="?",R.Hasnt="!?",R.Intersect="^",R.ListMin="LIST_MIN",R.ListMax="LIST_MAX",R.All="LIST_ALL",R.Count="LIST_COUNT",R.ValueOfList="LIST_VALUE",R.Invert="LIST_INVERT",R._nativeFunctions=null;class j extends p{constructor(t){super(),this.text=t.toString()||""}toString(){return"# "+this.text}}class D extends p{constructor(){super(...arguments),this.text="",this.index=0,this.threadAtGeneration=null,this.sourcePath="",this.targetPath=null,this.isInvisibleDefault=!1,this.originalThreadIndex=0}get pathStringOnChoice(){return null===this.targetPath?d("Choice.targetPath"):this.targetPath.toString()}set pathStringOnChoice(t){this.targetPath=new e(t)}}class G{constructor(t,e){this._name=t||"",this._items=null,this._itemNameToValues=e||new Map}get name(){return this._name}get items(){if(null==this._items){this._items=new Map;for(let[t,e]of this._itemNameToValues){let n=new f(this.name,t);this._items.set(n.serialized(),e)}}return this._items}ValueForItem(t){if(!t.itemName)return 0;let e=this._itemNameToValues.get(t.itemName);return void 0!==e?e:0}ContainsItem(t){return!!t.itemName&&(t.originName==this.name&&this._itemNameToValues.has(t.itemName))}ContainsItemWithName(t){return this._itemNameToValues.has(t)}TryGetItemWithValue(t,e){for(let[e,n]of this._itemNameToValues)if(n==t)return{result:new f(this.name,e),exists:!0};return{result:f.Null,exists:!1}}TryGetValueForItem(t,e){if(!t.itemName)return{result:0,exists:!1};let n=this._itemNameToValues.get(t.itemName);return n?{result:n,exists:!0}:{result:0,exists:!1}}}class B{constructor(t){this._lists=new Map,this._allUnambiguousListValueCache=new Map;for(let e of t){this._lists.set(e.name,e);for(let[t,n]of e.items){let e=f.fromSerializedKey(t),i=new O(e,n);if(!e.itemName)throw new Error("item.itemName is null or undefined.");this._allUnambiguousListValueCache.set(e.itemName,i),this._allUnambiguousListValueCache.set(e.fullName,i)}}}get lists(){let t=[];for(let[,e]of this._lists)t.push(e);return t}TryListGetDefinition(t,e){if(null===t)return{result:e,exists:!1};let n=this._lists.get(t);return n?{result:n,exists:!0}:{result:e,exists:!1}}FindSingleItemListWithName(t){if(null===t)return d("name");let e=this._allUnambiguousListValueCache.get(t);return void 0!==e?e:null}}class M{static JArrayToRuntimeObjList(t,e=!1){let n=t.length;e&&n--;let i=[];for(let e=0;e<n;e++){let n=t[e],r=this.JTokenToRuntimeObject(n);if(null===r)return d("runtimeObj");i.push(r)}return i}static WriteDictionaryRuntimeObjs(t,e){t.WriteObjectStart();for(let[n,i]of e)t.WritePropertyStart(n),this.WriteRuntimeObject(t,i),t.WritePropertyEnd();t.WriteObjectEnd()}static WriteListRuntimeObjs(t,e){t.WriteArrayStart();for(let n of e)this.WriteRuntimeObject(t,n);t.WriteArrayEnd()}static WriteIntDictionary(t,e){t.WriteObjectStart();for(let[n,i]of e)t.WriteIntProperty(n,i);t.WriteObjectEnd()}static WriteRuntimeObject(t,e){let n=a(e,N);if(n)return void this.WriteRuntimeContainer(t,n);let i=a(e,k);if(i){let e,n="->";return i.isExternal?n="x()":i.pushesToStack&&(i.stackPushType==r.Function?n="f()":i.stackPushType==r.Tunnel&&(n="->t->")),e=i.hasVariableTarget?i.variableDivertName:i.targetPathString,t.WriteObjectStart(),t.WriteProperty(n,e),i.hasVariableTarget&&t.WriteProperty("var",!0),i.isConditional&&t.WriteProperty("c",!0),i.externalArgs>0&&t.WriteIntProperty("exArgs",i.externalArgs),void t.WriteObjectEnd()}let s=a(e,W);if(s)return t.WriteObjectStart(),t.WriteProperty("*",s.pathStringOnChoice),t.WriteIntProperty("flg",s.flags),void t.WriteObjectEnd();let l=a(e,b);if(l)return void t.WriteInt(l.value);let o=a(e,_);if(o)return void t.WriteFloat(o.value);let u=a(e,T);if(u)return void(u.isNewline?t.Write("\n",!1):(t.WriteStringStart(),t.WriteStringInner("^"),t.WriteStringInner(u.value),t.WriteStringEnd()));let h=a(e,O);if(h)return void this.WriteInkList(t,h);let c=a(e,P);if(c)return t.WriteObjectStart(),null===c.value?d("divTargetVal.value"):(t.WriteProperty("^->",c.value.componentsString),void t.WriteObjectEnd());let p=a(e,w);if(p)return t.WriteObjectStart(),t.WriteProperty("^var",p.value),t.WriteIntProperty("ci",p.contextIndex),void t.WriteObjectEnd();if(a(e,x))return void t.Write("<>");let m=a(e,A);if(m)return void t.Write(M._controlCommandNames[m.commandType]);let f=a(e,R);if(f){let e=f.name;return"^"==e&&(e="L^"),void t.Write(e)}let g=a(e,F);if(g){t.WriteObjectStart();let e=g.pathStringForCount;return null!=e?t.WriteProperty("CNT?",e):t.WriteProperty("VAR?",g.name),void t.WriteObjectEnd()}let S=a(e,V);if(S){t.WriteObjectStart();let e=S.isGlobal?"VAR=":"temp=";return t.WriteProperty(e,S.variableName),S.isNewDeclaration||t.WriteProperty("re",!0),void t.WriteObjectEnd()}if(a(e,L))return void t.Write("void");let y=a(e,j);if(y)return t.WriteObjectStart(),t.WriteProperty("#",y.text),void t.WriteObjectEnd();let C=a(e,D);if(!C)throw new Error("Failed to convert runtime object to Json token: "+e);this.WriteChoice(t,C)}static JObjectToDictionaryRuntimeObjs(t){let e=new Map;for(let n in t)if(t.hasOwnProperty(n)){let i=this.JTokenToRuntimeObject(t[n]);if(null===i)return d("inkObject");e.set(n,i)}return e}static JObjectToIntDictionary(t){let e=new Map;for(let n in t)t.hasOwnProperty(n)&&e.set(n,parseInt(t[n]));return e}static JTokenToRuntimeObject(t){if("number"==typeof t&&!isNaN(t))return v.Create(t);if("string"==typeof t){let e=t.toString(),n=e[0];if("^"==n)return new T(e.substring(1));if("\n"==n&&1==e.length)return new T("\n");if("<>"==e)return new x;for(let t=0;t<M._controlCommandNames.length;++t){if(e==M._controlCommandNames[t])return new A(t)}if("L^"==e&&(e="^"),R.CallExistsWithName(e))return R.CallWithName(e);if("->->"==e)return A.PopTunnel();if("~ret"==e)return A.PopFunction();if("void"==e)return new L}if("object"==typeof t&&!Array.isArray(t)){let n,i=t;if(i["^->"])return n=i["^->"],new P(new e(n.toString()));if(i["^var"]){n=i["^var"];let t=new w(n.toString());return"ci"in i&&(n=i.ci,t.contextIndex=parseInt(n)),t}let a=!1,s=!1,l=r.Function,o=!1;if((n=i["->"])?a=!0:(n=i["f()"])?(a=!0,s=!0,l=r.Function):(n=i["->t->"])?(a=!0,s=!0,l=r.Tunnel):(n=i["x()"])&&(a=!0,o=!0,s=!1,l=r.Function),a){let t=new k;t.pushesToStack=s,t.stackPushType=l,t.isExternal=o;let e=n.toString();return(n=i.var)?t.variableDivertName=e:t.targetPathString=e,t.isConditional=!!i.c,o&&(n=i.exArgs)&&(t.externalArgs=parseInt(n)),t}if(n=i["*"]){let t=new W;return t.pathStringOnChoice=n.toString(),(n=i.flg)&&(t.flags=parseInt(n)),t}if(n=i["VAR?"])return new F(n.toString());if(n=i["CNT?"]){let t=new F;return t.pathStringForCount=n.toString(),t}let u=!1,h=!1;if((n=i["VAR="])?(u=!0,h=!0):(n=i["temp="])&&(u=!0,h=!1),u){let t=n.toString(),e=!i.re,r=new V(t,e);return r.isGlobal=h,r}if(void 0!==i["#"])return n=i["#"],new j(n.toString());if(n=i.list){let t=n,e=new g;if(n=i.origins){let t=n;e.SetInitialOriginNames(t)}for(let n in t)if(t.hasOwnProperty(n)){let i=t[n],r=new f(n),a=parseInt(i);e.Add(r,a)}return new O(e)}if(null!=i.originalChoicePath)return this.JObjectToChoice(i)}if(Array.isArray(t))return this.JArrayToContainer(t);if(null==t)return null;throw new Error("Failed to convert token to runtime object: "+JSON.stringify(t))}static WriteRuntimeContainer(t,e,n=!1){if(t.WriteArrayStart(),null===e)return d("container");for(let n of e.content)this.WriteRuntimeObject(t,n);let i=e.namedOnlyContent,r=e.countFlags,s=null!=e.name&&!n,l=null!=i||r>0||s;if(l&&t.WriteObjectStart(),null!=i)for(let[e,n]of i){let i=e,r=a(n,N);t.WritePropertyStart(i),this.WriteRuntimeContainer(t,r,!0),t.WritePropertyEnd()}s&&t.WriteProperty("#n",e.name),l?t.WriteObjectEnd():t.WriteNull(),t.WriteArrayEnd()}static JArrayToContainer(t){let e=new N;e.content=this.JArrayToRuntimeObjList(t,!0);let n=t[t.length-1];if(null!=n){let t=new Map;for(let i in n)if("#f"==i)e.countFlags=parseInt(n[i]);else if("#n"==i)e.name=n[i].toString();else{let e=this.JTokenToRuntimeObject(n[i]),r=a(e,N);r&&(r.name=i),t.set(i,e)}e.namedOnlyContent=t}return e}static JObjectToChoice(t){let e=new D;return e.text=t.text.toString(),e.index=parseInt(t.index),e.sourcePath=t.originalChoicePath.toString(),e.originalThreadIndex=parseInt(t.originalThreadIndex),e.pathStringOnChoice=t.targetPath.toString(),e}static WriteChoice(t,e){t.WriteObjectStart(),t.WriteProperty("text",e.text),t.WriteIntProperty("index",e.index),t.WriteProperty("originalChoicePath",e.sourcePath),t.WriteIntProperty("originalThreadIndex",e.originalThreadIndex),t.WriteProperty("targetPath",e.pathStringOnChoice),t.WriteObjectEnd()}static WriteInkList(t,e){let n=e.value;if(null===n)return d("rawList");t.WriteObjectStart(),t.WritePropertyStart("list"),t.WriteObjectStart();for(let[e,i]of n){let n=f.fromSerializedKey(e),r=i;if(null===n.itemName)return d("item.itemName");t.WritePropertyNameStart(),t.WritePropertyNameInner(n.originName?n.originName:"?"),t.WritePropertyNameInner("."),t.WritePropertyNameInner(n.itemName),t.WritePropertyNameEnd(),t.Write(r),t.WritePropertyEnd()}if(t.WriteObjectEnd(),t.WritePropertyEnd(),0==n.Count&&null!=n.originNames&&n.originNames.length>0){t.WritePropertyStart("origins"),t.WriteArrayStart();for(let e of n.originNames)t.Write(e);t.WriteArrayEnd(),t.WritePropertyEnd()}t.WriteObjectEnd()}static ListDefinitionsToJToken(t){let e={};for(let n of t.lists){let t={};for(let[e,i]of n.items){let n=f.fromSerializedKey(e);if(null===n.itemName)return d("item.itemName");t[n.itemName]=i}e[n.name]=t}return e}static JTokenToListDefinitions(t){let e=t,n=[];for(let t in e)if(e.hasOwnProperty(t)){let i=t.toString(),r=e[t],a=new Map;for(let n in r)if(e.hasOwnProperty(t)){let t=r[n];a.set(n,parseInt(t))}let s=new G(i,a);n.push(s)}return new B(n)}}M._controlCommandNames=(()=>{let t=[];t[A.CommandType.EvalStart]="ev",t[A.CommandType.EvalOutput]="out",t[A.CommandType.EvalEnd]="/ev",t[A.CommandType.Duplicate]="du",t[A.CommandType.PopEvaluatedValue]="pop",t[A.CommandType.PopFunction]="~ret",t[A.CommandType.PopTunnel]="->->",t[A.CommandType.BeginString]="str",t[A.CommandType.EndString]="/str",t[A.CommandType.NoOp]="nop",t[A.CommandType.ChoiceCount]="choiceCnt",t[A.CommandType.Turns]="turn",t[A.CommandType.TurnsSince]="turns",t[A.CommandType.ReadCount]="readc",t[A.CommandType.Random]="rnd",t[A.CommandType.SeedRandom]="srnd",t[A.CommandType.VisitIndex]="visit",t[A.CommandType.SequenceShuffleIndex]="seq",t[A.CommandType.StartThread]="thread",t[A.CommandType.Done]="done",t[A.CommandType.End]="end",t[A.CommandType.ListFromInt]="listInt",t[A.CommandType.ListRange]="range",t[A.CommandType.ListRandom]="lrnd";for(let e=0;e<A.CommandType.TOTAL_VALUES;++e)if(null==t[e])throw new Error("Control command not accounted for in serialisation");return t})();class q{constructor(){if(this._threadCounter=0,this._startOfRoot=I.Null,arguments[0]instanceof X){let t=arguments[0];this._startOfRoot=I.StartOf(t.rootContentContainer),this.Reset()}else{let t=arguments[0];this._threads=[];for(let e of t._threads)this._threads.push(e.Copy());this._threadCounter=t._threadCounter,this._startOfRoot=t._startOfRoot}}get elements(){return this.callStack}get depth(){return this.elements.length}get currentElement(){let t=this._threads[this._threads.length-1].callstack;return t[t.length-1]}get currentElementIndex(){return this.callStack.length-1}get currentThread(){return this._threads[this._threads.length-1]}set currentThread(t){n.Assert(1==this._threads.length,"Shouldn't be directly setting the current thread when we have a stack of them"),this._threads.length=0,this._threads.push(t)}get canPop(){return this.callStack.length>1}Reset(){this._threads=[],this._threads.push(new q.Thread),this._threads[0].callstack.push(new q.Element(r.Tunnel,this._startOfRoot))}SetJsonToken(t,e){this._threads.length=0;let n=t.threads;for(let t of n){let n=t,i=new q.Thread(n,e);this._threads.push(i)}this._threadCounter=parseInt(t.threadCounter),this._startOfRoot=I.StartOf(e.rootContentContainer)}WriteJson(t){t.WriteObject(t=>{t.WritePropertyStart("threads"),t.WriteArrayStart();for(let e of this._threads)e.WriteJson(t);t.WriteArrayEnd(),t.WritePropertyEnd(),t.WritePropertyStart("threadCounter"),t.WriteInt(this._threadCounter),t.WritePropertyEnd()})}PushThread(){let t=this.currentThread.Copy();this._threadCounter++,t.threadIndex=this._threadCounter,this._threads.push(t)}ForkThread(){let t=this.currentThread.Copy();return this._threadCounter++,t.threadIndex=this._threadCounter,t}PopThread(){if(!this.canPopThread)throw new Error("Can't pop thread");this._threads.splice(this._threads.indexOf(this.currentThread),1)}get canPopThread(){return this._threads.length>1&&!this.elementIsEvaluateFromGame}get elementIsEvaluateFromGame(){return this.currentElement.type==r.FunctionEvaluationFromGame}Push(t,e=0,n=0){let i=new q.Element(t,this.currentElement.currentPointer,!1);i.evaluationStackHeightWhenPushed=e,i.functionStartInOutputStream=n,this.callStack.push(i)}CanPop(t=null){return!!this.canPop&&(null==t||this.currentElement.type==t)}Pop(t=null){if(!this.CanPop(t))throw new Error("Mismatched push/pop in Callstack");this.callStack.pop()}GetTemporaryVariableWithName(t,e=-1){-1==e&&(e=this.currentElementIndex+1);let n=y(this.callStack[e-1].temporaryVariables,t,null);return n.exists?n.result:null}SetTemporaryVariable(t,e,n,i=-1){-1==i&&(i=this.currentElementIndex+1);let r=this.callStack[i-1];if(!n&&!r.temporaryVariables.get(t))throw new S("Could not find temporary variable to set: "+t);let a=y(r.temporaryVariables,t,null);a.exists&&O.RetainListOriginsForAssignment(a.result,e),r.temporaryVariables.set(t,e)}ContextForVariableNamed(t){return this.currentElement.temporaryVariables.get(t)?this.currentElementIndex+1:0}ThreadWithIndex(t){let e=this._threads.filter(e=>{if(e.threadIndex==t)return e});return e.length>0?e[0]:null}get callStack(){return this.currentThread.callstack}get callStackTrace(){let t=new m;for(let e=0;e<this._threads.length;e++){let n=this._threads[e],i=e==this._threads.length-1;t.AppendFormat("=== THREAD {0}/{1} {2}===\n",e+1,this._threads.length,i?"(current) ":"");for(let e=0;e<n.callstack.length;e++){n.callstack[e].type==r.Function?t.Append("  [FUNCTION] "):t.Append("  [TUNNEL] ");let i=n.callstack[e].currentPointer;if(!i.isNull){if(t.Append("<SOMEWHERE IN "),null===i.container)return d("pointer.container");t.Append(i.container.path.toString()),t.AppendLine(">")}}}return t.toString()}}!function(t){class n{constructor(t,e,n=!1){this.evaluationStackHeightWhenPushed=0,this.functionStartInOutputStream=0,this.currentPointer=e.copy(),this.inExpressionEvaluation=n,this.temporaryVariables=new Map,this.type=t}Copy(){let t=new n(this.type,this.currentPointer,this.inExpressionEvaluation);return t.temporaryVariables=new Map(this.temporaryVariables),t.evaluationStackHeightWhenPushed=this.evaluationStackHeightWhenPushed,t.functionStartInOutputStream=this.functionStartInOutputStream,t}}t.Element=n;class i{constructor(){if(this.threadIndex=0,this.previousPointer=I.Null,this.callstack=[],arguments[0]&&arguments[1]){let t=arguments[0],i=arguments[1];this.threadIndex=parseInt(t.threadIndex);let r=t.callstack;for(let t of r){let r,a=t,s=parseInt(a.type),l=I.Null,o=a.cPath;if(void 0!==o){r=o.toString();let t=i.ContentAtPath(new e(r));if(l.container=t.container,l.index=parseInt(a.idx),null==t.obj)throw new Error("When loading state, internal story location couldn't be found: "+r+". Has the story changed since this save data was created?");if(t.approximate){if(null===l.container)return d("pointer.container");i.Warning("When loading state, exact internal story location couldn't be found: '"+r+"', so it was approximated to '"+l.container.path.toString()+"' to recover. Has the story changed since this save data was created?")}}let u=!!a.exp,h=new n(s,l,u),c=a.temp;void 0!==c?h.temporaryVariables=M.JObjectToDictionaryRuntimeObjs(c):h.temporaryVariables.clear(),this.callstack.push(h)}let a=t.previousContentObject;if(void 0!==a){let t=new e(a.toString());this.previousPointer=i.PointerAtPath(t)}}}Copy(){let t=new i;t.threadIndex=this.threadIndex;for(let e of this.callstack)t.callstack.push(e.Copy());return t.previousPointer=this.previousPointer.copy(),t}WriteJson(t){t.WriteObjectStart(),t.WritePropertyStart("callstack"),t.WriteArrayStart();for(let e of this.callstack){if(t.WriteObjectStart(),!e.currentPointer.isNull){if(null===e.currentPointer.container)return d("el.currentPointer.container");t.WriteProperty("cPath",e.currentPointer.container.path.componentsString),t.WriteIntProperty("idx",e.currentPointer.index)}t.WriteProperty("exp",e.inExpressionEvaluation),t.WriteIntProperty("type",e.type),e.temporaryVariables.size>0&&(t.WritePropertyStart("temp"),M.WriteDictionaryRuntimeObjs(t,e.temporaryVariables),t.WritePropertyEnd()),t.WriteObjectEnd()}if(t.WriteArrayEnd(),t.WritePropertyEnd(),t.WriteIntProperty("threadIndex",this.threadIndex),!this.previousPointer.isNull){let e=this.previousPointer.Resolve();if(null===e)return d("this.previousPointer.Resolve()");t.WriteProperty("previousContentObject",e.path.toString())}t.WriteObjectEnd()}}t.Thread=i}(q||(q={}));class J{constructor(t,e){this.variableChangedEventCallbacks=[],this.patch=null,this._batchObservingVariableChanges=!1,this._defaultGlobalVariables=new Map,this._changedVariablesForBatchObs=new Set,this._globalVariables=new Map,this._callStack=t,this._listDefsOrigin=e;try{return new Proxy(this,{get:(t,e)=>e in t?t[e]:t.$(e),set:(t,e,n)=>(e in t?t[e]=n:t.$(e,n),!0)})}catch(t){}}variableChangedEvent(t,e){for(let n of this.variableChangedEventCallbacks)n(t,e)}get batchObservingVariableChanges(){return this._batchObservingVariableChanges}set batchObservingVariableChanges(t){if(this._batchObservingVariableChanges=t,t)this._changedVariablesForBatchObs=new Set;else if(null!=this._changedVariablesForBatchObs){for(let t of this._changedVariablesForBatchObs){let e=this._globalVariables.get(t);e?this.variableChangedEvent(t,e):d("currentValue")}this._changedVariablesForBatchObs=null}}get callStack(){return this._callStack}set callStack(t){this._callStack=t}$(t,e){if(void 0===e){let e=null;return null!==this.patch&&(e=this.patch.TryGetGlobal(t,null),e.exists)?e.result.valueObject:(e=this._globalVariables.get(t),void 0===e&&(e=this._defaultGlobalVariables.get(t)),void 0!==e?e.valueObject:null)}{if(void 0===this._defaultGlobalVariables.get(t))throw new S("Cannot assign to a variable ("+t+") that hasn't been declared in the story");let n=v.Create(e);if(null==n)throw new S(null==e?"Cannot pass null to VariableState":"Invalid value passed to VariableState: "+e.toString());this.SetGlobal(t,n)}}ApplyPatch(){if(null===this.patch)return d("this.patch");for(let[t,e]of this.patch.globals)this._globalVariables.set(t,e);if(null!==this._changedVariablesForBatchObs)for(let t of this.patch.changedVariables)this._changedVariablesForBatchObs.add(t);this.patch=null}SetJsonToken(t){this._globalVariables.clear();for(let[e,n]of this._defaultGlobalVariables){let i=t[e];if(void 0!==i){let t=M.JTokenToRuntimeObject(i);if(null===t)return d("tokenInkObject");this._globalVariables.set(e,t)}else this._globalVariables.set(e,n)}}WriteJson(t){t.WriteObjectStart();for(let[e,n]of this._globalVariables){let i=e,r=n;if(J.dontSaveDefaultValues&&this._defaultGlobalVariables.has(i)){let t=this._defaultGlobalVariables.get(i);if(this.RuntimeObjectsEqual(r,t))continue}t.WritePropertyStart(i),M.WriteRuntimeObject(t,r),t.WritePropertyEnd()}t.WriteObjectEnd()}RuntimeObjectsEqual(t,e){if(null===t)return d("obj1");if(null===e)return d("obj2");if(t.constructor!==e.constructor)return!1;let n=a(t,b);if(null!==n)return n.value===s(e,b).value;let i=a(t,_);if(null!==i)return i.value===s(e,_).value;let r=a(t,v),l=a(e,v);if(null!==r&&null!==l)return u(r.valueObject)&&u(l.valueObject)?r.valueObject.Equals(l.valueObject):r.valueObject===l.valueObject;throw new Error("FastRoughDefinitelyEquals: Unsupported runtime object type: "+t.constructor.name)}GetVariableWithName(t,e=-1){let n=this.GetRawVariableWithName(t,e),i=a(n,w);return null!==i&&(n=this.ValueAtVariablePointer(i)),n}TryGetDefaultVariableValue(t){let e=y(this._defaultGlobalVariables,t,null);return e.exists?e.result:null}GlobalVariableExistsWithName(t){return this._globalVariables.has(t)||null!==this._defaultGlobalVariables&&this._defaultGlobalVariables.has(t)}GetRawVariableWithName(t,e){let n=null;if(0==e||-1==e){let e=null;if(null!==this.patch&&(e=this.patch.TryGetGlobal(t,null),e.exists))return e.result;if(e=y(this._globalVariables,t,null),e.exists)return e.result;if(null!==this._defaultGlobalVariables&&(e=y(this._defaultGlobalVariables,t,null),e.exists))return e.result;if(null===this._listDefsOrigin)return d("VariablesState._listDefsOrigin");let n=this._listDefsOrigin.FindSingleItemListWithName(t);if(n)return n}return n=this._callStack.GetTemporaryVariableWithName(t,e),n}ValueAtVariablePointer(t){return this.GetVariableWithName(t.variableName,t.contextIndex)}Assign(t,e){let n=t.variableName;if(null===n)return d("name");let i=-1,r=!1;if(r=t.isNewDeclaration?t.isGlobal:this.GlobalVariableExistsWithName(n),t.isNewDeclaration){let t=a(e,w);if(null!==t){e=this.ResolveVariablePointer(t)}}else{let t=null;do{t=a(this.GetRawVariableWithName(n,i),w),null!=t&&(n=t.variableName,i=t.contextIndex,r=0==i)}while(null!=t)}r?this.SetGlobal(n,e):this._callStack.SetTemporaryVariable(n,e,t.isNewDeclaration,i)}SnapshotDefaultGlobals(){this._defaultGlobalVariables=new Map(this._globalVariables)}RetainListOriginsForAssignment(t,e){let n=s(t,O),i=s(e,O);n.value&&i.value&&0==i.value.Count&&i.value.SetInitialOriginNames(n.value.originNames)}SetGlobal(t,e){let n=null;if(null===this.patch&&(n=y(this._globalVariables,t,null)),null!==this.patch&&(n=this.patch.TryGetGlobal(t,null),n.exists||(n=y(this._globalVariables,t,null))),O.RetainListOriginsForAssignment(n.result,e),null===t)return d("variableName");if(null!==this.patch?this.patch.SetGlobal(t,e):this._globalVariables.set(t,e),null!==this.variableChangedEvent&&null!==n&&e!==n.result)if(this.batchObservingVariableChanges){if(null===this._changedVariablesForBatchObs)return d("this._changedVariablesForBatchObs");null!==this.patch?this.patch.AddChangedVariable(t):null!==this._changedVariablesForBatchObs&&this._changedVariablesForBatchObs.add(t)}else this.variableChangedEvent(t,e)}ResolveVariablePointer(t){let e=t.contextIndex;-1==e&&(e=this.GetContextIndexOfVariableNamed(t.variableName));let n=a(this.GetRawVariableWithName(t.variableName,e),w);return null!=n?n:new w(t.variableName,e)}GetContextIndexOfVariableNamed(t){return this.GlobalVariableExistsWithName(t)?0:this._callStack.currentElementIndex}ObserveVariableChange(t){this.variableChangedEventCallbacks.push(t)}}J.dontSaveDefaultValues=!0;class K{constructor(t){this.seed=t%2147483647,this.seed<=0&&(this.seed+=2147483646)}next(){return this.seed=16807*this.seed%2147483647}nextFloat(){return(this.next()-1)/2147483646}}class U{constructor(){if(this._changedVariables=new Set,this._visitCounts=new Map,this._turnIndices=new Map,1===arguments.length&&null!==arguments[0]){let t=arguments[0];this._globals=new Map(t._globals),this._changedVariables=new Set(t._changedVariables),this._visitCounts=new Map(t._visitCounts),this._turnIndices=new Map(t._turnIndices)}else this._globals=new Map,this._changedVariables=new Set,this._visitCounts=new Map,this._turnIndices=new Map}get globals(){return this._globals}get changedVariables(){return this._changedVariables}get visitCounts(){return this._visitCounts}get turnIndices(){return this._turnIndices}TryGetGlobal(t,e){return null!==t&&this._globals.has(t)?{result:this._globals.get(t),exists:!0}:{result:e,exists:!1}}SetGlobal(t,e){this._globals.set(t,e)}AddChangedVariable(t){return this._changedVariables.add(t)}TryGetVisitCount(t,e){return this._visitCounts.has(t)?{result:this._visitCounts.get(t),exists:!0}:{result:e,exists:!1}}SetVisitCount(t,e){this._visitCounts.set(t,e)}SetTurnIndex(t,e){this._turnIndices.set(t,e)}TryGetTurnIndex(t,e){return this._turnIndices.has(t)?{result:this._turnIndices.get(t),exists:!0}:{result:e,exists:!1}}}class z{static TextToDictionary(t){return new z.Reader(t).ToDictionary()}static TextToArray(t){return new z.Reader(t).ToArray()}}!function(t){t.Reader=class{constructor(t){this._rootObject=JSON.parse(t)}ToDictionary(){return this._rootObject}ToArray(){return this._rootObject}};class e{constructor(){this._currentPropertyName=null,this._currentString=null,this._stateStack=[],this._collectionStack=[],this._propertyNameStack=[],this._jsonObject=null}WriteObject(t){this.WriteObjectStart(),t(this),this.WriteObjectEnd()}WriteObjectStart(){this.StartNewObject(!0);let e={};if(this.state===t.Writer.State.Property){this.Assert(null!==this.currentCollection),this.Assert(null!==this.currentPropertyName);let t=this._propertyNameStack.pop();this.currentCollection[t]=e,this._collectionStack.push(e)}else this.state===t.Writer.State.Array?(this.Assert(null!==this.currentCollection),this.currentCollection.push(e),this._collectionStack.push(e)):(this.Assert(this.state===t.Writer.State.None),this._jsonObject=e,this._collectionStack.push(e));this._stateStack.push(new t.Writer.StateElement(t.Writer.State.Object))}WriteObjectEnd(){this.Assert(this.state===t.Writer.State.Object),this._collectionStack.pop(),this._stateStack.pop()}WriteProperty(t,e){if(this.WritePropertyStart(t),arguments[1]instanceof Function){(0,arguments[1])(this)}else{let t=arguments[1];this.Write(t)}this.WritePropertyEnd()}WriteIntProperty(t,e){this.WritePropertyStart(t),this.WriteInt(e),this.WritePropertyEnd()}WriteFloatProperty(t,e){this.WritePropertyStart(t),this.WriteFloat(e),this.WritePropertyEnd()}WritePropertyStart(e){this.Assert(this.state===t.Writer.State.Object),this._propertyNameStack.push(e),this.IncrementChildCount(),this._stateStack.push(new t.Writer.StateElement(t.Writer.State.Property))}WritePropertyEnd(){this.Assert(this.state===t.Writer.State.Property),this.Assert(1===this.childCount),this._stateStack.pop()}WritePropertyNameStart(){this.Assert(this.state===t.Writer.State.Object),this.IncrementChildCount(),this._currentPropertyName="",this._stateStack.push(new t.Writer.StateElement(t.Writer.State.Property)),this._stateStack.push(new t.Writer.StateElement(t.Writer.State.PropertyName))}WritePropertyNameEnd(){this.Assert(this.state===t.Writer.State.PropertyName),this.Assert(null!==this._currentPropertyName),this._propertyNameStack.push(this._currentPropertyName),this._currentPropertyName=null,this._stateStack.pop()}WritePropertyNameInner(e){this.Assert(this.state===t.Writer.State.PropertyName),this.Assert(null!==this._currentPropertyName),this._currentPropertyName+=e}WriteArrayStart(){this.StartNewObject(!0);let e=[];if(this.state===t.Writer.State.Property){this.Assert(null!==this.currentCollection),this.Assert(null!==this.currentPropertyName);let t=this._propertyNameStack.pop();this.currentCollection[t]=e,this._collectionStack.push(e)}else this.state===t.Writer.State.Array?(this.Assert(null!==this.currentCollection),this.currentCollection.push(e),this._collectionStack.push(e)):(this.Assert(this.state===t.Writer.State.None),this._jsonObject=e,this._collectionStack.push(e));this._stateStack.push(new t.Writer.StateElement(t.Writer.State.Array))}WriteArrayEnd(){this.Assert(this.state===t.Writer.State.Array),this._collectionStack.pop(),this._stateStack.pop()}Write(t,e=!0){null!==t?(this.StartNewObject(!1),this._addToCurrentObject(t)):console.error("Warning: trying to write a null string")}WriteInt(t){null!==t&&(this.StartNewObject(!1),this._addToCurrentObject(Math.floor(t)))}WriteFloat(t){null!==t&&(this.StartNewObject(!1),t==Number.POSITIVE_INFINITY?this._addToCurrentObject(34e37):t==Number.NEGATIVE_INFINITY?this._addToCurrentObject(-34e37):isNaN(t)?this._addToCurrentObject(0):this._addToCurrentObject(t))}WriteNull(){this.StartNewObject(!1),this._addToCurrentObject(null)}WriteStringStart(){this.StartNewObject(!1),this._currentString="",this._stateStack.push(new t.Writer.StateElement(t.Writer.State.String))}WriteStringEnd(){this.Assert(this.state==t.Writer.State.String),this._stateStack.pop(),this._addToCurrentObject(this._currentString),this._currentString=null}WriteStringInner(e,n=!0){this.Assert(this.state===t.Writer.State.String),null!==e?this._currentString+=e:console.error("Warning: trying to write a null string")}ToString(){return null===this._jsonObject?"":JSON.stringify(this._jsonObject)}StartNewObject(e){e?this.Assert(this.state===t.Writer.State.None||this.state===t.Writer.State.Property||this.state===t.Writer.State.Array):this.Assert(this.state===t.Writer.State.Property||this.state===t.Writer.State.Array),this.state===t.Writer.State.Property&&this.Assert(0===this.childCount),this.state!==t.Writer.State.Array&&this.state!==t.Writer.State.Property||this.IncrementChildCount()}get state(){return this._stateStack.length>0?this._stateStack[this._stateStack.length-1].type:t.Writer.State.None}get childCount(){return this._stateStack.length>0?this._stateStack[this._stateStack.length-1].childCount:0}get currentCollection(){return this._collectionStack.length>0?this._collectionStack[this._collectionStack.length-1]:null}get currentPropertyName(){return this._propertyNameStack.length>0?this._propertyNameStack[this._propertyNameStack.length-1]:null}IncrementChildCount(){this.Assert(this._stateStack.length>0);let t=this._stateStack.pop();t.childCount++,this._stateStack.push(t)}Assert(t){if(!t)throw Error("Assert failed while writing JSON")}_addToCurrentObject(e){this.Assert(null!==this.currentCollection),this.state===t.Writer.State.Array?(this.Assert(Array.isArray(this.currentCollection)),this.currentCollection.push(e)):this.state===t.Writer.State.Property&&(this.Assert(!Array.isArray(this.currentCollection)),this.Assert(null!==this.currentPropertyName),this.currentCollection[this.currentPropertyName]=e,this._propertyNameStack.pop())}}t.Writer=e,function(e){let n;!function(t){t[t.None=0]="None",t[t.Object=1]="Object",t[t.Array=2]="Array",t[t.Property=3]="Property",t[t.PropertyName=4]="PropertyName",t[t.String=5]="String"}(n=e.State||(e.State={}));e.StateElement=class{constructor(e){this.type=t.Writer.State.None,this.childCount=0,this.type=e}}}(e=t.Writer||(t.Writer={}))}(z||(z={}));class H{constructor(t){this.kInkSaveStateVersion=8,this.kMinCompatibleLoadVersion=8,this._currentErrors=null,this._currentWarnings=null,this.divertedPointer=I.Null,this._currentTurnIndex=0,this.storySeed=0,this.previousRandom=0,this.didSafeExit=!1,this._currentText=null,this._currentTags=null,this._outputStreamTextDirty=!0,this._outputStreamTagsDirty=!0,this._patch=null,this.story=t,this._outputStream=[],this.OutputStreamDirty(),this._evaluationStack=[],this.callStack=new q(t),this._variablesState=new J(this.callStack,t.listDefinitions),this._visitCounts=new Map,this._turnIndices=new Map,this.currentTurnIndex=-1;let e=(new Date).getTime();this.storySeed=new K(e).next()%100,this.previousRandom=0,this._currentChoices=[],this.GoToStart()}ToJson(t=!1){let e=new z.Writer;return this.WriteJson(e),e.ToString()}toJson(t=!1){return this.ToJson(t)}LoadJson(t){let e=z.TextToDictionary(t);this.LoadJsonObj(e)}VisitCountAtPathString(t){let n;if(null!==this._patch){let i=this.story.ContentAtPath(new e(t)).container;if(null===i)throw new Error("Content at path not found: "+t);if(n=this._patch.TryGetVisitCount(i,0),n.exists)return n.result}return n=y(this._visitCounts,t,null),n.exists?n.result:0}VisitCountForContainer(t){if(null===t)return d("container");if(!t.visitsShouldBeCounted)return this.story.Error("Read count for target ("+t.name+" - on "+t.debugMetadata+") unknown. The story may need to be compiled with countAllVisits flag (-c)."),0;if(null!==this._patch){let e=this._patch.TryGetVisitCount(t,0);if(e.exists)return e.result}let e=t.path.toString(),n=y(this._visitCounts,e,null);return n.exists?n.result:0}IncrementVisitCountForContainer(t){if(null!==this._patch){let e=this.VisitCountForContainer(t);return e++,void this._patch.SetVisitCount(t,e)}let e=t.path.toString(),n=y(this._visitCounts,e,null);n.exists?this._visitCounts.set(e,n.result+1):this._visitCounts.set(e,1)}RecordTurnIndexVisitToContainer(t){if(null!==this._patch)return void this._patch.SetTurnIndex(t,this.currentTurnIndex);let e=t.path.toString();this._turnIndices.set(e,this.currentTurnIndex)}TurnsSinceForContainer(t){if(t.turnIndexShouldBeCounted||this.story.Error("TURNS_SINCE() for target ("+t.name+" - on "+t.debugMetadata+") unknown. The story may need to be compiled with countAllVisits flag (-c)."),null!==this._patch){let e=this._patch.TryGetTurnIndex(t,0);if(e.exists)return this.currentTurnIndex-e.result}let e=t.path.toString(),n=y(this._turnIndices,e,0);return n.exists?this.currentTurnIndex-n.result:-1}get callstackDepth(){return this.callStack.depth}get outputStream(){return this._outputStream}get currentChoices(){return this.canContinue?[]:this._currentChoices}get generatedChoices(){return this._currentChoices}get currentErrors(){return this._currentErrors}get currentWarnings(){return this._currentWarnings}get variablesState(){return this._variablesState}set variablesState(t){this._variablesState=t}get evaluationStack(){return this._evaluationStack}get visitCounts(){return this._visitCounts}get turnIndices(){return this._turnIndices}get currentTurnIndex(){return this._currentTurnIndex}set currentTurnIndex(t){this._currentTurnIndex=t}get currentPathString(){let t=this.currentPointer;return t.isNull?null:null===t.path?d("pointer.path"):t.path.toString()}get currentPointer(){return this.callStack.currentElement.currentPointer.copy()}set currentPointer(t){this.callStack.currentElement.currentPointer=t.copy()}get previousPointer(){return this.callStack.currentThread.previousPointer.copy()}set previousPointer(t){this.callStack.currentThread.previousPointer=t.copy()}get canContinue(){return!this.currentPointer.isNull&&!this.hasError}get hasError(){return null!=this.currentErrors&&this.currentErrors.length>0}get hasWarning(){return null!=this.currentWarnings&&this.currentWarnings.length>0}get currentText(){if(this._outputStreamTextDirty){let t=new m;for(let e of this._outputStream){let n=a(e,T);null!==n&&t.Append(n.value)}this._currentText=this.CleanOutputWhitespace(t.toString()),this._outputStreamTextDirty=!1}return this._currentText}CleanOutputWhitespace(t){let e=new m,n=-1,i=0;for(let r=0;r<t.length;r++){let a=t.charAt(r),s=" "==a||"\t"==a;s&&-1==n&&(n=r),s||("\n"!=a&&n>0&&n!=i&&e.Append(" "),n=-1),"\n"==a&&(i=r+1),s||e.Append(a)}return e.toString()}get currentTags(){if(this._outputStreamTagsDirty){this._currentTags=[];for(let t of this._outputStream){let e=a(t,j);null!==e&&this._currentTags.push(e.text)}this._outputStreamTagsDirty=!1}return this._currentTags}get inExpressionEvaluation(){return this.callStack.currentElement.inExpressionEvaluation}set inExpressionEvaluation(t){this.callStack.currentElement.inExpressionEvaluation=t}GoToStart(){this.callStack.currentElement.currentPointer=I.StartOf(this.story.mainContentContainer)}CopyAndStartPatching(){let t=new H(this.story);return t._patch=new U(this._patch),t.outputStream.push.apply(t.outputStream,this._outputStream),t.OutputStreamDirty(),t._currentChoices.push.apply(t._currentChoices,this._currentChoices),this.hasError&&(t._currentErrors=[],t._currentErrors.push.apply(t._currentErrors,this.currentErrors||[])),this.hasWarning&&(t._currentWarnings=[],t._currentWarnings.push.apply(t._currentWarnings,this.currentWarnings||[])),t.callStack=new q(this.callStack),t.variablesState=this.variablesState,t.variablesState.callStack=t.callStack,t.variablesState.patch=t._patch,t.evaluationStack.push.apply(t.evaluationStack,this.evaluationStack),this.divertedPointer.isNull||(t.divertedPointer=this.divertedPointer.copy()),t.previousPointer=this.previousPointer.copy(),t._visitCounts=this._visitCounts,t._turnIndices=this._turnIndices,t.currentTurnIndex=this.currentTurnIndex,t.storySeed=this.storySeed,t.previousRandom=this.previousRandom,t.didSafeExit=this.didSafeExit,t}RestoreAfterPatch(){this.variablesState.callStack=this.callStack,this.variablesState.patch=this._patch}ApplyAnyPatch(){if(null!==this._patch){this.variablesState.ApplyPatch();for(let[t,e]of this._patch.visitCounts)this.ApplyCountChanges(t,e,!0);for(let[t,e]of this._patch.turnIndices)this.ApplyCountChanges(t,e,!1);this._patch=null}}ApplyCountChanges(t,e,n){(n?this._visitCounts:this._turnIndices).set(t.path.toString(),e)}WriteJson(t){t.WriteObjectStart();let e=!1;for(let n of this._currentChoices){if(null===n.threadAtGeneration)return d("c.threadAtGeneration");n.originalThreadIndex=n.threadAtGeneration.threadIndex,null===this.callStack.ThreadWithIndex(n.originalThreadIndex)&&(e||(e=!0,t.WritePropertyStart("choiceThreads"),t.WriteObjectStart()),t.WritePropertyStart(n.originalThreadIndex),n.threadAtGeneration.WriteJson(t),t.WritePropertyEnd())}if(e&&(t.WriteObjectEnd(),t.WritePropertyEnd()),t.WriteProperty("callstackThreads",t=>this.callStack.WriteJson(t)),t.WriteProperty("variablesState",t=>this.variablesState.WriteJson(t)),t.WriteProperty("evalStack",t=>M.WriteListRuntimeObjs(t,this.evaluationStack)),t.WriteProperty("outputStream",t=>M.WriteListRuntimeObjs(t,this._outputStream)),t.WriteProperty("currentChoices",t=>{t.WriteArrayStart();for(let e of this._currentChoices)M.WriteChoice(t,e);t.WriteArrayEnd()}),!this.divertedPointer.isNull){if(null===this.divertedPointer.path)return d("divertedPointer");t.WriteProperty("currentDivertTarget",this.divertedPointer.path.componentsString)}t.WriteProperty("visitCounts",t=>M.WriteIntDictionary(t,this._visitCounts)),t.WriteProperty("turnIndices",t=>M.WriteIntDictionary(t,this._turnIndices)),t.WriteIntProperty("turnIdx",this.currentTurnIndex),t.WriteIntProperty("storySeed",this.storySeed),t.WriteIntProperty("previousRandom",this.previousRandom),t.WriteIntProperty("inkSaveVersion",this.kInkSaveStateVersion),t.WriteIntProperty("inkFormatVersion",X.inkVersionCurrent),t.WriteObjectEnd()}LoadJsonObj(t){let n=t,i=n.inkSaveVersion;if(null==i)throw new S("ink save format incorrect, can't load.");if(parseInt(i)<this.kMinCompatibleLoadVersion)throw new S("Ink save format isn't compatible with the current version (saw '"+i+"', but minimum is "+this.kMinCompatibleLoadVersion+"), so can't load.");this.callStack.SetJsonToken(n.callstackThreads,this.story),this.variablesState.SetJsonToken(n.variablesState),this._evaluationStack=M.JArrayToRuntimeObjList(n.evalStack),this._outputStream=M.JArrayToRuntimeObjList(n.outputStream),this.OutputStreamDirty(),this._currentChoices=M.JArrayToRuntimeObjList(n.currentChoices);let r=n.currentDivertTarget;if(null!=r){let t=new e(r.toString());this.divertedPointer=this.story.PointerAtPath(t)}this._visitCounts=M.JObjectToIntDictionary(n.visitCounts),this._turnIndices=M.JObjectToIntDictionary(n.turnIndices),this.currentTurnIndex=parseInt(n.turnIdx),this.storySeed=parseInt(n.storySeed),this.previousRandom=parseInt(n.previousRandom);let a=n.choiceThreads;for(let t of this._currentChoices){let e=this.callStack.ThreadWithIndex(t.originalThreadIndex);if(null!=e)t.threadAtGeneration=e.Copy();else{let e=a[t.originalThreadIndex.toString()];t.threadAtGeneration=new q.Thread(e,this.story)}}}ResetErrors(){this._currentErrors=null,this._currentWarnings=null}ResetOutput(t=null){this._outputStream.length=0,null!==t&&this._outputStream.push.apply(this._outputStream,t),this.OutputStreamDirty()}PushToOutputStream(t){let e=a(t,T);if(null!==e){let t=this.TrySplittingHeadTailWhitespace(e);if(null!==t){for(let e of t)this.PushToOutputStreamIndividual(e);return void this.OutputStreamDirty()}}this.PushToOutputStreamIndividual(t),this.OutputStreamDirty()}PopFromOutputStream(t){this.outputStream.splice(this.outputStream.length-t,t),this.OutputStreamDirty()}TrySplittingHeadTailWhitespace(t){let e=t.value;if(null===e)return d("single.value");let n=-1,i=-1;for(let t=0;t<e.length;++t){let r=e[t];if("\n"!=r){if(" "==r||"\t"==r)continue;break}-1==n&&(n=t),i=t}let r=-1,a=-1;for(let t=0;t<e.length;++t){let n=e[t];if("\n"!=n){if(" "==n||"\t"==n)continue;break}-1==r&&(r=t),a=t}if(-1==n&&-1==r)return null;let s=[],l=0,o=e.length;if(-1!=n){if(n>0){let t=new T(e.substring(0,n));s.push(t)}s.push(new T("\n")),l=i+1}if(-1!=r&&(o=a),o>l){let t=e.substring(l,o-l);s.push(new T(t))}if(-1!=r&&a>i&&(s.push(new T("\n")),r<e.length-1)){let t=e.length-r-1,n=new T(e.substring(r+1,t));s.push(n)}return s}PushToOutputStreamIndividual(t){let e=a(t,x),n=a(t,T),i=!0;if(e)this.TrimNewlinesFromOutputStream(),i=!0;else if(n){let t=-1,e=this.callStack.currentElement;e.type==r.Function&&(t=e.functionStartInOutputStream);let a=-1;for(let e=this._outputStream.length-1;e>=0;e--){let n=this._outputStream[e],i=n instanceof A?n:null;if(null!=(n instanceof x?n:null)){a=e;break}if(null!=i&&i.commandType==A.CommandType.BeginString){e>=t&&(t=-1);break}}let s=-1;if(s=-1!=a&&-1!=t?Math.min(t,a):-1!=a?a:t,-1!=s){if(n.isNewline)i=!1;else if(n.isNonWhitespace&&(a>-1&&this.RemoveExistingGlue(),t>-1)){let t=this.callStack.elements;for(let e=t.length-1;e>=0;e--){let n=t[e];if(n.type!=r.Function)break;n.functionStartInOutputStream=-1}}}else n.isNewline&&(!this.outputStreamEndsInNewline&&this.outputStreamContainsContent||(i=!1))}if(i){if(null===t)return d("obj");this._outputStream.push(t),this.OutputStreamDirty()}}TrimNewlinesFromOutputStream(){let t=-1,e=this._outputStream.length-1;for(;e>=0;){let n=this._outputStream[e],i=a(n,A),r=a(n,T);if(null!=i||null!=r&&r.isNonWhitespace)break;null!=r&&r.isNewline&&(t=e),e--}if(t>=0)for(e=t;e<this._outputStream.length;){a(this._outputStream[e],T)?this._outputStream.splice(e,1):e++}this.OutputStreamDirty()}RemoveExistingGlue(){for(let t=this._outputStream.length-1;t>=0;t--){let e=this._outputStream[t];if(e instanceof x)this._outputStream.splice(t,1);else if(e instanceof A)break}this.OutputStreamDirty()}get outputStreamEndsInNewline(){if(this._outputStream.length>0)for(let t=this._outputStream.length-1;t>=0;t--){if(this._outputStream[t]instanceof A)break;let e=this._outputStream[t];if(e instanceof T){if(e.isNewline)return!0;if(e.isNonWhitespace)break}}return!1}get outputStreamContainsContent(){for(let t=0;t<this._outputStream.length;t++)if(this._outputStream[t]instanceof T)return!0;return!1}get inStringEvaluation(){for(let t=this._outputStream.length-1;t>=0;t--){let e=a(this._outputStream[t],A);if(e instanceof A&&e.commandType==A.CommandType.BeginString)return!0}return!1}PushEvaluationStack(t){let e=a(t,O);if(e){let t=e.value;if(null===t)return d("rawList");if(null!=t.originNames){t.origins||(t.origins=[]),t.origins.length=0;for(let e of t.originNames){if(null===this.story.listDefinitions)return d("StoryState.story.listDefinitions");let n=this.story.listDefinitions.TryListGetDefinition(e,null);if(null===n.result)return d("StoryState def.result");t.origins.indexOf(n.result)<0&&t.origins.push(n.result)}}}if(null===t)return d("obj");this.evaluationStack.push(t)}PopEvaluationStack(t){if(void 0===t){return o(this.evaluationStack.pop())}if(t>this.evaluationStack.length)throw new Error("trying to pop too many objects");return o(this.evaluationStack.splice(this.evaluationStack.length-t,t))}PeekEvaluationStack(){return this.evaluationStack[this.evaluationStack.length-1]}ForceEnd(){this.callStack.Reset(),this._currentChoices.length=0,this.currentPointer=I.Null,this.previousPointer=I.Null,this.didSafeExit=!0}TrimWhitespaceFromFunctionEnd(){n.Assert(this.callStack.currentElement.type==r.Function);let t=this.callStack.currentElement.functionStartInOutputStream;-1==t&&(t=0);for(let e=this._outputStream.length-1;e>=t;e--){let t=this._outputStream[e],n=a(t,T),i=a(t,A);if(null!=n){if(i)break;if(!n.isNewline&&!n.isInlineWhitespace)break;this._outputStream.splice(e,1),this.OutputStreamDirty()}}}PopCallStack(t=null){this.callStack.currentElement.type==r.Function&&this.TrimWhitespaceFromFunctionEnd(),this.callStack.Pop(t)}SetChosenPath(t,e){this._currentChoices.length=0;let n=this.story.PointerAtPath(t);n.isNull||-1!=n.index||(n.index=0),this.currentPointer=n,e&&this.currentTurnIndex++}StartFunctionEvaluationFromGame(t,e){this.callStack.Push(r.FunctionEvaluationFromGame,this.evaluationStack.length),this.callStack.currentElement.currentPointer=I.StartOf(t),this.PassArgumentsToEvaluationStack(e)}PassArgumentsToEvaluationStack(t){if(null!=t)for(let e=0;e<t.length;e++){if("number"!=typeof t[e]&&"string"!=typeof t[e])throw new Error("ink arguments when calling EvaluateFunction / ChoosePathStringWithParameters  must be int, float or string");this.PushEvaluationStack(v.Create(t[e]))}}TryExitFunctionEvaluationFromGame(){return this.callStack.currentElement.type==r.FunctionEvaluationFromGame&&(this.currentPointer=I.Null,this.didSafeExit=!0,!0)}CompleteFunctionEvaluationFromGame(){if(this.callStack.currentElement.type!=r.FunctionEvaluationFromGame)throw new S("Expected external function evaluation to be complete. Stack trace: "+this.callStack.callStackTrace);let t=this.callStack.currentElement.evaluationStackHeightWhenPushed,e=null;for(;this.evaluationStack.length>t;){let t=this.PopEvaluationStack();null===e&&(e=t)}if(this.PopCallStack(r.FunctionEvaluationFromGame),e){if(e instanceof L)return null;let t=s(e,v);return t.valueType==i.DivertTarget?t.valueObject.toString():t.valueObject}return null}AddError(t,e){e?(null==this._currentWarnings&&(this._currentWarnings=[]),this._currentWarnings.push(t)):(null==this._currentErrors&&(this._currentErrors=[]),this._currentErrors.push(t))}OutputStreamDirty(){this._outputStreamTextDirty=!0,this._outputStreamTagsDirty=!0}}class ${constructor(){this.startTime=void 0}get ElapsedMilliseconds(){return void 0===this.startTime?0:(new Date).getTime()-this.startTime}Start(){this.startTime=(new Date).getTime()}Stop(){this.startTime=void 0}}Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&t>-9007199254740992&&t<9007199254740992&&Math.floor(t)===t});class X extends p{constructor(){let t;super(),this.inkVersionMinimumCompatible=18,this._prevContainers=[],this.allowExternalFunctionFallbacks=!1,this._listDefinitions=null,this._variableObservers=null,this._hasValidatedExternals=!1,this._temporaryEvaluationContainer=null,this._asyncContinueActive=!1,this._stateSnapshotAtLastNewline=null,this._recursiveContinueCount=0,this._asyncSaving=!1,this._profiler=null;let e=null,n=null;if(arguments[0]instanceof N)t=arguments[0],void 0!==arguments[1]&&(e=arguments[1]),this._mainContentContainer=t;else if("string"==typeof arguments[0]){let t=arguments[0];n=z.TextToDictionary(t)}else n=arguments[0];if(null!=e&&(this._listDefinitions=new B(e)),this._externals=new Map,null!==n){let t=n,e=t.inkVersion;if(null==e)throw new Error("ink version number not found. Are you sure it's a valid .ink.json file?");let i=parseInt(e);if(i>X.inkVersionCurrent)throw new Error("Version of ink used to build story was newer than the current version of the engine");if(i<this.inkVersionMinimumCompatible)throw new Error("Version of ink used to build story is too old to be loaded by this version of the engine");i!=X.inkVersionCurrent&&console.warn("WARNING: Version of ink used to build story doesn't match current version of engine. Non-critical, but recommend synchronising.");let r,a=t.root;if(null==a)throw new Error("Root node for ink not found. Are you sure it's a valid .ink.json file?");(r=t.listDefs)&&(this._listDefinitions=M.JTokenToListDefinitions(r)),this._mainContentContainer=s(M.JTokenToRuntimeObject(a),N),this.ResetState()}}get currentChoices(){let t=[];if(null===this._state)return d("this._state");for(let e of this._state.currentChoices)e.isInvisibleDefault||(e.index=t.length,t.push(e));return t}get currentText(){return this.IfAsyncWeCant("call currentText since it's a work in progress"),this.state.currentText}get currentTags(){return this.IfAsyncWeCant("call currentTags since it's a work in progress"),this.state.currentTags}get currentErrors(){return this.state.currentErrors}get currentWarnings(){return this.state.currentWarnings}get hasError(){return this.state.hasError}get hasWarning(){return this.state.hasWarning}get variablesState(){return this.state.variablesState}get listDefinitions(){return this._listDefinitions}get state(){return this._state}StartProfiling(){}EndProfiling(){}ToJson(t){let e=!1;if(t||(e=!0,t=new z.Writer),t.WriteObjectStart(),t.WriteIntProperty("inkVersion",X.inkVersionCurrent),t.WriteProperty("root",t=>M.WriteRuntimeContainer(t,this._mainContentContainer)),null!=this._listDefinitions){t.WritePropertyStart("listDefs"),t.WriteObjectStart();for(let e of this._listDefinitions.lists){t.WritePropertyStart(e.name),t.WriteObjectStart();for(let[n,i]of e.items){let e=f.fromSerializedKey(n),r=i;t.WriteIntProperty(e.itemName,r)}t.WriteObjectEnd(),t.WritePropertyEnd()}t.WriteObjectEnd(),t.WritePropertyEnd()}if(t.WriteObjectEnd(),e)return t.ToString()}ResetState(){this.IfAsyncWeCant("ResetState"),this._state=new H(this),this._state.variablesState.ObserveVariableChange(this.VariableStateDidChangeEvent.bind(this)),this.ResetGlobals()}ResetErrors(){if(null===this._state)return d("this._state");this._state.ResetErrors()}ResetCallstack(){if(this.IfAsyncWeCant("ResetCallstack"),null===this._state)return d("this._state");this._state.ForceEnd()}ResetGlobals(){if(this._mainContentContainer.namedContent.get("global decl")){let t=this.state.currentPointer.copy();this.ChoosePath(new e("global decl"),!1),this.ContinueInternal(),this.state.currentPointer=t}this.state.variablesState.SnapshotDefaultGlobals()}Continue(){return this.ContinueAsync(0),this.currentText}get canContinue(){return this.state.canContinue}get asyncContinueComplete(){return!this._asyncContinueActive}ContinueAsync(t){this._hasValidatedExternals||this.ValidateExternalBindings(),this.ContinueInternal(t)}ContinueInternal(t=0){null!=this._profiler&&this._profiler.PreContinue();let e=t>0;if(this._recursiveContinueCount++,!this._asyncContinueActive){if(this._asyncContinueActive=e,!this.canContinue)throw new S("Can't continue - should check canContinue before calling Continue");this._state.didSafeExit=!1,this._state.ResetOutput(),1==this._recursiveContinueCount&&(this._state.variablesState.batchObservingVariableChanges=!0)}let n=new $;n.Start();let i=!1;do{try{i=this.ContinueSingleStep()}catch(t){if(!(t instanceof S))throw t;this.AddError(t.message,void 0,t.useEndLineNumber);break}if(i)break;if(this._asyncContinueActive&&n.ElapsedMilliseconds>t)break}while(this.canContinue);n.Stop(),!i&&this.canContinue||(null!==this._stateSnapshotAtLastNewline&&this.RestoreStateSnapshot(),this.canContinue||(this.state.callStack.canPopThread&&this.AddError("Thread available to pop, threads should always be flat by the end of evaluation?"),0!=this.state.generatedChoices.length||this.state.didSafeExit||null!=this._temporaryEvaluationContainer||(this.state.callStack.CanPop(r.Tunnel)?this.AddError("unexpectedly reached end of content. Do you need a '->->' to return from a tunnel?"):this.state.callStack.CanPop(r.Function)?this.AddError("unexpectedly reached end of content. Do you need a '~ return'?"):this.state.callStack.canPop?this.AddError("unexpectedly reached end of content for unknown reason. Please debug compiler!"):this.AddError("ran out of content. Do you need a '-> DONE' or '-> END'?"))),this.state.didSafeExit=!1,1==this._recursiveContinueCount&&(this._state.variablesState.batchObservingVariableChanges=!1),this._asyncContinueActive=!1),this._recursiveContinueCount--,null!=this._profiler&&this._profiler.PostContinue()}ContinueSingleStep(){if(null!=this._profiler&&this._profiler.PreStep(),this.Step(),null!=this._profiler&&this._profiler.PostStep(),this.canContinue||this.state.callStack.elementIsEvaluateFromGame||this.TryFollowDefaultInvisibleChoice(),null!=this._profiler&&this._profiler.PreSnapshot(),!this.state.inStringEvaluation){if(null!==this._stateSnapshotAtLastNewline){if(null===this._stateSnapshotAtLastNewline.currentTags)return d("this._stateAtLastNewline.currentTags");if(null===this.state.currentTags)return d("this.state.currentTags");let t=this.CalculateNewlineOutputStateChange(this._stateSnapshotAtLastNewline.currentText,this.state.currentText,this._stateSnapshotAtLastNewline.currentTags.length,this.state.currentTags.length);if(t==X.OutputStateChange.ExtendedBeyondNewline)return this.RestoreStateSnapshot(),!0;t==X.OutputStateChange.NewlineRemoved&&this.DiscardSnapshot()}this.state.outputStreamEndsInNewline&&(this.canContinue?null==this._stateSnapshotAtLastNewline&&this.StateSnapshot():this.DiscardSnapshot())}return null!=this._profiler&&this._profiler.PostSnapshot(),!1}CalculateNewlineOutputStateChange(t,e,n,i){if(null===t)return d("prevText");if(null===e)return d("currText");let r=e.length>=t.length&&"\n"==e.charAt(t.length-1);if(n==i&&t.length==e.length&&r)return X.OutputStateChange.NoChange;if(!r)return X.OutputStateChange.NewlineRemoved;if(i>n)return X.OutputStateChange.ExtendedBeyondNewline;for(let n=t.length;n<e.length;n++){let t=e.charAt(n);if(" "!=t&&"\t"!=t)return X.OutputStateChange.ExtendedBeyondNewline}return X.OutputStateChange.NoChange}ContinueMaximally(){this.IfAsyncWeCant("ContinueMaximally");let t=new m;for(;this.canContinue;)t.Append(this.Continue());return t.toString()}ContentAtPath(t){return this.mainContentContainer.ContentAtPath(t)}KnotContainerWithName(t){let e=this.mainContentContainer.namedContent.get(t);return e instanceof N?e:null}PointerAtPath(t){if(0==t.length)return I.Null;let e=new I,n=t.length,i=null;return null===t.lastComponent?d("path.lastComponent"):(t.lastComponent.isIndex?(n=t.length-1,i=this.mainContentContainer.ContentAtPath(t,void 0,n),e.container=i.container,e.index=t.lastComponent.index):(i=this.mainContentContainer.ContentAtPath(t),e.container=i.container,e.index=-1),null==i.obj||i.obj==this.mainContentContainer&&n>0?this.Error("Failed to find content at path '"+t+"', and no approximation of it was possible."):i.approximate&&this.Warning("Failed to find content at path '"+t+"', so it was approximated to: '"+i.obj.path+"'."),e)}StateSnapshot(){this._stateSnapshotAtLastNewline=this._state,this._state=this._state.CopyAndStartPatching()}RestoreStateSnapshot(){null===this._stateSnapshotAtLastNewline&&d("_stateSnapshotAtLastNewline"),this._stateSnapshotAtLastNewline.RestoreAfterPatch(),this._state=this._stateSnapshotAtLastNewline,this._stateSnapshotAtLastNewline=null,this._asyncSaving||this._state.ApplyAnyPatch()}DiscardSnapshot(){this._asyncSaving||this._state.ApplyAnyPatch(),this._stateSnapshotAtLastNewline=null}CopyStateForBackgroundThreadSave(){if(this.IfAsyncWeCant("start saving on a background thread"),this._asyncSaving)throw new Error("Story is already in background saving mode, can't call CopyStateForBackgroundThreadSave again!");let t=this._state;return this._state=this._state.CopyAndStartPatching(),this._asyncSaving=!0,t}BackgroundSaveComplete(){null===this._stateSnapshotAtLastNewline&&this._state.ApplyAnyPatch(),this._asyncSaving=!1}Step(){let t=!0,e=this.state.currentPointer.copy();if(e.isNull)return;let n=a(e.Resolve(),N);for(;n&&(this.VisitContainer(n,!0),0!=n.content.length);)e=I.StartOf(n),n=a(e.Resolve(),N);this.state.currentPointer=e.copy(),null!=this._profiler&&this._profiler.Step(this.state.callStack);let i=e.Resolve(),r=this.PerformLogicAndFlowControl(i);if(this.state.currentPointer.isNull)return;r&&(t=!1);let s=a(i,W);if(s){let e=this.ProcessChoice(s);e&&this.state.generatedChoices.push(e),i=null,t=!1}if(i instanceof N&&(t=!1),t){let t=a(i,w);if(t&&-1==t.contextIndex){let e=this.state.callStack.ContextForVariableNamed(t.variableName);i=new w(t.variableName,e)}this.state.inExpressionEvaluation?this.state.PushEvaluationStack(i):this.state.PushToOutputStream(i)}this.NextContent();let l=a(i,A);l&&l.commandType==A.CommandType.StartThread&&this.state.callStack.PushThread()}VisitContainer(t,e){t.countingAtStartOnly&&!e||(t.visitsShouldBeCounted&&this.state.IncrementVisitCountForContainer(t),t.turnIndexShouldBeCounted&&this.state.RecordTurnIndexVisitToContainer(t))}VisitChangedContainersDueToDivert(){let t=this.state.previousPointer.copy(),e=this.state.currentPointer.copy();if(e.isNull||-1==e.index)return;if(this._prevContainers.length=0,!t.isNull){let e=a(t.Resolve(),N)||a(t.container,N);for(;e;)this._prevContainers.push(e),e=a(e.parent,N)}let n=e.Resolve();if(null==n)return;let i=a(n.parent,N);for(;i&&(this._prevContainers.indexOf(i)<0||i.countingAtStartOnly);){let t=i.content.length>0&&n==i.content[0];this.VisitContainer(i,t),n=i,i=a(i.parent,N)}}ProcessChoice(t){let e=!0;if(t.hasCondition){let t=this.state.PopEvaluationStack();this.IsTruthy(t)||(e=!1)}let n="",i="";if(t.hasChoiceOnlyContent){i=s(this.state.PopEvaluationStack(),T).value||""}if(t.hasStartContent){n=s(this.state.PopEvaluationStack(),T).value||""}if(t.onceOnly){this.state.VisitCountForContainer(t.choiceTarget)>0&&(e=!1)}if(!e)return null;let r=new D;return r.targetPath=t.pathOnChoice,r.sourcePath=t.path.toString(),r.isInvisibleDefault=t.isInvisibleDefault,r.threadAtGeneration=this.state.callStack.ForkThread(),r.text=(n+i).replace(/^[ \t]+|[ \t]+$/g,""),r}IsTruthy(t){if(t instanceof v){let e=t;if(e instanceof P){let t=e;return this.Error("Shouldn't use a divert target (to "+t.targetPath+") as a conditional value. Did you intend a function call 'likeThis()' or a read count check 'likeThis'? (no arrows)"),!1}return e.isTruthy}return!1}PerformLogicAndFlowControl(t){if(null==t)return!1;if(t instanceof k){let e=t;if(e.isConditional){let t=this.state.PopEvaluationStack();if(!this.IsTruthy(t))return!0}if(e.hasVariableTarget){let t=e.variableDivertName,n=this.state.variablesState.GetVariableWithName(t);if(null==n)this.Error("Tried to divert using a target from a variable that could not be found ("+t+")");else if(!(n instanceof P)){let e=a(n,b),i="Tried to divert to a target from a variable, but the variable ("+t+") didn't contain a divert target, it ";e instanceof b&&0==e.value?i+="was empty/null (the value 0).":i+="contained '"+n+"'.",this.Error(i)}let i=s(n,P);this.state.divertedPointer=this.PointerAtPath(i.targetPath)}else{if(e.isExternal)return this.CallExternalFunction(e.targetPathString,e.externalArgs),!0;this.state.divertedPointer=e.targetPointer.copy()}return e.pushesToStack&&this.state.callStack.Push(e.stackPushType,void 0,this.state.outputStream.length),this.state.divertedPointer.isNull&&!e.isExternal&&(e&&e.debugMetadata&&null!=e.debugMetadata.sourceName?this.Error("Divert target doesn't exist: "+e.debugMetadata.sourceName):this.Error("Divert resolution failed: "+e)),!0}if(t instanceof A){let e=t;switch(e.commandType){case A.CommandType.EvalStart:this.Assert(!1===this.state.inExpressionEvaluation,"Already in expression evaluation?"),this.state.inExpressionEvaluation=!0;break;case A.CommandType.EvalEnd:this.Assert(!0===this.state.inExpressionEvaluation,"Not in expression evaluation mode"),this.state.inExpressionEvaluation=!1;break;case A.CommandType.EvalOutput:if(this.state.evaluationStack.length>0){let t=this.state.PopEvaluationStack();if(!(t instanceof L)){let e=new T(t.toString());this.state.PushToOutputStream(e)}}break;case A.CommandType.NoOp:break;case A.CommandType.Duplicate:this.state.PushEvaluationStack(this.state.PeekEvaluationStack());break;case A.CommandType.PopEvaluatedValue:this.state.PopEvaluationStack();break;case A.CommandType.PopFunction:case A.CommandType.PopTunnel:let t=e.commandType==A.CommandType.PopFunction?r.Function:r.Tunnel,n=null;if(t==r.Tunnel){let t=this.state.PopEvaluationStack();n=a(t,P),null===n&&this.Assert(t instanceof L,"Expected void if ->-> doesn't override target")}if(this.state.TryExitFunctionEvaluationFromGame())break;if(this.state.callStack.currentElement.type==t&&this.state.callStack.canPop)this.state.PopCallStack(),n&&(this.state.divertedPointer=this.PointerAtPath(n.targetPath));else{let e=new Map;e.set(r.Function,"function return statement (~ return)"),e.set(r.Tunnel,"tunnel onwards statement (->->)");let n=e.get(this.state.callStack.currentElement.type);this.state.callStack.canPop||(n="end of flow (-> END or choice)");let i="Found "+e.get(t)+", when expected "+n;this.Error(i)}break;case A.CommandType.BeginString:this.state.PushToOutputStream(e),this.Assert(!0===this.state.inExpressionEvaluation,"Expected to be in an expression when evaluating a string"),this.state.inExpressionEvaluation=!1;break;case A.CommandType.EndString:let i=[],l=0;for(let t=this.state.outputStream.length-1;t>=0;--t){let e=this.state.outputStream[t];l++;let n=a(e,A);if(n&&n.commandType==A.CommandType.BeginString)break;e instanceof T&&i.push(e)}this.state.PopFromOutputStream(l),i=i.reverse();let o=new m;for(let t of i)o.Append(t.toString());this.state.inExpressionEvaluation=!0,this.state.PushEvaluationStack(new T(o.toString()));break;case A.CommandType.ChoiceCount:let u=this.state.generatedChoices.length;this.state.PushEvaluationStack(new b(u));break;case A.CommandType.Turns:this.state.PushEvaluationStack(new b(this.state.currentTurnIndex+1));break;case A.CommandType.TurnsSince:case A.CommandType.ReadCount:let h=this.state.PopEvaluationStack();if(!(h instanceof P)){let t="";h instanceof b&&(t=". Did you accidentally pass a read count ('knot_name') instead of a target ('-> knot_name')?"),this.Error("TURNS_SINCE / READ_COUNT expected a divert target (knot, stitch, label name), but saw "+h+t);break}let c,p=s(h,P),y=a(this.ContentAtPath(p.targetPath).correctObj,N);null!=y?c=e.commandType==A.CommandType.TurnsSince?this.state.TurnsSinceForContainer(y):this.state.VisitCountForContainer(y):(c=e.commandType==A.CommandType.TurnsSince?-1:0,this.Warning("Failed to find container for "+e.toString()+" lookup at "+p.targetPath.toString())),this.state.PushEvaluationStack(new b(c));break;case A.CommandType.Random:{let t=a(this.state.PopEvaluationStack(),b),e=a(this.state.PopEvaluationStack(),b);if(null==e||e instanceof b==!1)return this.Error("Invalid value for minimum parameter of RANDOM(min, max)");if(null==t||e instanceof b==!1)return this.Error("Invalid value for maximum parameter of RANDOM(min, max)");if(null===t.value)return d("maxInt.value");if(null===e.value)return d("minInt.value");let n=t.value-e.value+1;n<=0&&this.Error("RANDOM was called with minimum as "+e.value+" and maximum as "+t.value+". The maximum must be larger");let i=this.state.storySeed+this.state.previousRandom,r=new K(i).next(),s=r%n+e.value;this.state.PushEvaluationStack(new b(s)),this.state.previousRandom=r;break}case A.CommandType.SeedRandom:let C=a(this.state.PopEvaluationStack(),b);if(null==C||C instanceof b==!1)return this.Error("Invalid value passed to SEED_RANDOM");if(null===C.value)return d("minInt.value");this.state.storySeed=C.value,this.state.previousRandom=0,this.state.PushEvaluationStack(new L);break;case A.CommandType.VisitIndex:let _=this.state.VisitCountForContainer(this.state.currentPointer.container)-1;this.state.PushEvaluationStack(new b(_));break;case A.CommandType.SequenceShuffleIndex:let w=this.NextSequenceShuffleIndex();this.state.PushEvaluationStack(new b(w));break;case A.CommandType.StartThread:break;case A.CommandType.Done:this.state.callStack.canPopThread?this.state.callStack.PopThread():(this.state.didSafeExit=!0,this.state.currentPointer=I.Null);break;case A.CommandType.End:this.state.ForceEnd();break;case A.CommandType.ListFromInt:let E=a(this.state.PopEvaluationStack(),b),x=s(this.state.PopEvaluationStack(),T);if(null===E)throw new S("Passed non-integer when creating a list element from a numerical value.");let k=null;if(null===this.listDefinitions)return d("this.listDefinitions");let W=this.listDefinitions.TryListGetDefinition(x.value,null);if(!W.exists)throw new S("Failed to find LIST called "+x.value);{if(null===E.value)return d("minInt.value");let t=W.result.TryGetItemWithValue(E.value,f.Null);t.exists&&(k=new O(t.result,E.value))}null==k&&(k=new O),this.state.PushEvaluationStack(k);break;case A.CommandType.ListRange:let F=a(this.state.PopEvaluationStack(),v),V=a(this.state.PopEvaluationStack(),v),R=a(this.state.PopEvaluationStack(),O);if(null===R||null===V||null===F)throw new S("Expected list, minimum and maximum for LIST_RANGE");if(null===R.value)return d("targetList.value");let j=R.value.ListWithSubRange(V.valueObject,F.valueObject);this.state.PushEvaluationStack(new O(j));break;case A.CommandType.ListRandom:{let t=this.state.PopEvaluationStack();if(null===t)throw new S("Expected list for LIST_RANDOM");let e=t.value,n=null;if(null===e)throw d("list");if(0==e.Count)n=new g;else{let t=this.state.storySeed+this.state.previousRandom,i=new K(t).next(),r=i%e.Count,a=e.entries();for(let t=0;t<=r-1;t++)a.next();let s=a.next().value,l={Key:f.fromSerializedKey(s[0]),Value:s[1]};if(null===l.Key.originName)return d("randomItem.Key.originName");n=new g(l.Key.originName,this),n.Add(l.Key,l.Value),this.state.previousRandom=i}this.state.PushEvaluationStack(new O(n));break}default:this.Error("unhandled ControlCommand: "+e)}return!0}if(t instanceof V){let e=t,n=this.state.PopEvaluationStack();return this.state.variablesState.Assign(e,n),!0}if(t instanceof F){let e=t,n=null;if(null!=e.pathForCount){let t=e.containerForCount,i=this.state.VisitCountForContainer(t);n=new b(i)}else n=this.state.variablesState.GetVariableWithName(e.name),null==n&&(this.Warning("Variable not found: '"+e.name+"'. Using default value of 0 (false). This can happen with temporary variables if the declaration hasn't yet been hit. Globals are always given a default value on load if a value doesn't exist in the save state."),n=new b(0));return this.state.PushEvaluationStack(n),!0}if(t instanceof R){let e=t,n=this.state.PopEvaluationStack(e.numberOfParameters),i=e.Call(n);return this.state.PushEvaluationStack(i),!0}return!1}ChoosePathString(t,n=!0,i=[]){if(this.IfAsyncWeCant("call ChoosePathString right now"),n)this.ResetCallstack();else if(this.state.callStack.currentElement.type==r.Function){let e="",n=this.state.callStack.currentElement.currentPointer.container;throw null!=n&&(e="("+n.path.toString()+") "),new Error("Story was running a function "+e+"when you called ChoosePathString("+t+") - this is almost certainly not not what you want! Full stack trace: \n"+this.state.callStack.callStackTrace)}this.state.PassArgumentsToEvaluationStack(i),this.ChoosePath(new e(t))}IfAsyncWeCant(t){if(this._asyncContinueActive)throw new Error("Can't "+t+". Story is in the middle of a ContinueAsync(). Make more ContinueAsync() calls or a single Continue() call beforehand.")}ChoosePath(t,e=!0){this.state.SetChosenPath(t,e),this.VisitChangedContainersDueToDivert()}ChooseChoiceIndex(t){t=t;let e=this.currentChoices;this.Assert(t>=0&&t<e.length,"choice out of range");let n=e[t];return null===n.threadAtGeneration?d("choiceToChoose.threadAtGeneration"):null===n.targetPath?d("choiceToChoose.targetPath"):(this.state.callStack.currentThread=n.threadAtGeneration,void this.ChoosePath(n.targetPath))}HasFunction(t){try{return null!=this.KnotContainerWithName(t)}catch(t){return!1}}EvaluateFunction(t,e=[],n=!1){if(this.IfAsyncWeCant("evaluate a function"),null==t)throw new Error("Function is null");if(""==t||""==t.trim())throw new Error("Function is empty or white space.");let i=this.KnotContainerWithName(t);if(null==i)throw new Error("Function doesn't exist: '"+t+"'");let r=[];r.push.apply(r,this.state.outputStream),this._state.ResetOutput(),this.state.StartFunctionEvaluationFromGame(i,e);let a=new m;for(;this.canContinue;)a.Append(this.Continue());let s=a.toString();this._state.ResetOutput(r);let l=this.state.CompleteFunctionEvaluationFromGame();return n?{returned:l,output:s}:l}EvaluateExpression(t){let e=this.state.callStack.elements.length;this.state.callStack.Push(r.Tunnel),this._temporaryEvaluationContainer=t,this.state.GoToStart();let n=this.state.evaluationStack.length;return this.Continue(),this._temporaryEvaluationContainer=null,this.state.callStack.elements.length>e&&this.state.PopCallStack(),this.state.evaluationStack.length>n?this.state.PopEvaluationStack():null}CallExternalFunction(t,e){if(null===t)return d("funcName");let n=this._externals.get(t),i=null;if(!(void 0!==n)){if(this.allowExternalFunctionFallbacks)return i=this.KnotContainerWithName(t),this.Assert(null!==i,"Trying to call EXTERNAL function '"+t+"' which has not been bound, and fallback ink function could not be found."),this.state.callStack.Push(r.Function,void 0,this.state.outputStream.length),void(this.state.divertedPointer=I.StartOf(i));this.Assert(!1,"Trying to call EXTERNAL function '"+t+"' which has not been bound (and ink fallbacks disabled).")}let a=[];for(let t=0;t<e;++t){let t=s(this.state.PopEvaluationStack(),v).valueObject;a.push(t)}a.reverse();let l=n(a),o=null;null!=l?(o=v.Create(l),this.Assert(null!==o,"Could not create ink value from returned object of type "+typeof l)):o=new L,this.state.PushEvaluationStack(o)}BindExternalFunctionGeneral(t,e){this.IfAsyncWeCant("bind an external function"),this.Assert(!this._externals.has(t),"Function '"+t+"' has already been bound."),this._externals.set(t,e)}TryCoerce(t){return t}BindExternalFunction(t,e){this.Assert(null!=e,"Can't bind a null function"),this.BindExternalFunctionGeneral(t,t=>{this.Assert(t.length>=e.length,"External function expected "+e.length+" arguments");let n=[];for(let e=0,i=t.length;e<i;e++)n[e]=this.TryCoerce(t[e]);return e.apply(null,n)})}UnbindExternalFunction(t){this.IfAsyncWeCant("unbind an external a function"),this.Assert(this._externals.has(t),"Function '"+t+"' has not been bound."),this._externals.delete(t)}ValidateExternalBindings(){let t=null,e=null,n=arguments[1]||new Set;if(arguments[0]instanceof N&&(t=arguments[0]),arguments[0]instanceof p&&(e=arguments[0]),null===t&&null===e)if(this.ValidateExternalBindings(this._mainContentContainer,n),this._hasValidatedExternals=!0,0==n.size)this._hasValidatedExternals=!0;else{let t="Error: Missing function binding for external";t+=n.size>1?"s":"",t+=": '",t+=Array.from(n).join("', '"),t+="' ",t+=this.allowExternalFunctionFallbacks?", and no fallback ink function found.":" (ink fallbacks disabled)",this.Error(t)}else if(null!=t){for(let e of t.content){let t=e;null!=t&&t.hasValidName||this.ValidateExternalBindings(e,n)}for(let[,e]of t.namedContent)this.ValidateExternalBindings(a(e,p),n)}else if(null!=e){let t=a(e,k);if(t&&t.isExternal){let e=t.targetPathString;if(null===e)return d("name");if(!this._externals.has(e))if(this.allowExternalFunctionFallbacks){this.mainContentContainer.namedContent.has(e)||n.add(e)}else n.add(e)}}}ObserveVariable(t,e){if(this.IfAsyncWeCant("observe a new variable"),null===this._variableObservers&&(this._variableObservers=new Map),!this.state.variablesState.GlobalVariableExistsWithName(t))throw new S("Cannot observe variable '"+t+"' because it wasn't declared in the ink story.");this._variableObservers.has(t)?this._variableObservers.get(t).push(e):this._variableObservers.set(t,[e])}ObserveVariables(t,e){for(let n=0,i=t.length;n<i;n++)this.ObserveVariable(t[n],e[n])}RemoveVariableObserver(t,e){if(this.IfAsyncWeCant("remove a variable observer"),null!==this._variableObservers)if(void 0!==e){if(this._variableObservers.has(e)){let n=this._variableObservers.get(e);null!==t?n.splice(n.indexOf(t),1):this._variableObservers.delete(e)}}else if(null!==t){let e=this._variableObservers.keys();for(let n of e){let e=this._variableObservers.get(n);e.splice(e.indexOf(t),1)}}}VariableStateDidChangeEvent(t,e){if(null===this._variableObservers)return;let n=this._variableObservers.get(t);if(void 0!==n){if(!(e instanceof v))throw new Error("Tried to get the value of a variable that isn't a standard type");let i=s(e,v);for(let e of n)e(t,i.valueObject)}}get globalTags(){return this.TagsAtStartOfFlowContainerWithPathString("")}TagsForContentAtPath(t){return this.TagsAtStartOfFlowContainerWithPathString(t)}TagsAtStartOfFlowContainerWithPathString(t){let n=new e(t),i=this.ContentAtPath(n).container;if(null===i)return d("flowContainer");for(;;){let t=i.content[0];if(!(t instanceof N))break;i=t}let r=null;for(let t of i.content){let e=a(t,j);if(!e)break;null==r&&(r=[]),r.push(e.text)}return r}BuildStringOfHierarchy(){let t=new m;return this.mainContentContainer.BuildStringOfHierarchy(t,0,this.state.currentPointer.Resolve()),t.toString()}BuildStringOfContainer(t){let e=new m;return t.BuildStringOfHierarchy(e,0,this.state.currentPointer.Resolve()),e.toString()}NextContent(){if(this.state.previousPointer=this.state.currentPointer.copy(),!this.state.divertedPointer.isNull&&(this.state.currentPointer=this.state.divertedPointer.copy(),this.state.divertedPointer=I.Null,this.VisitChangedContainersDueToDivert(),!this.state.currentPointer.isNull))return;if(!this.IncrementContentPointer()){let t=!1;this.state.callStack.CanPop(r.Function)?(this.state.PopCallStack(r.Function),this.state.inExpressionEvaluation&&this.state.PushEvaluationStack(new L),t=!0):this.state.callStack.canPopThread?(this.state.callStack.PopThread(),t=!0):this.state.TryExitFunctionEvaluationFromGame(),t&&!this.state.currentPointer.isNull&&this.NextContent()}}IncrementContentPointer(){let t=!0,e=this.state.callStack.currentElement.currentPointer.copy();if(e.index++,null===e.container)return d("pointer.container");for(;e.index>=e.container.content.length;){t=!1;let n=a(e.container.parent,N);if(n instanceof N==!1)break;let i=n.content.indexOf(e.container);if(-1==i)break;if(e=new I(n,i),e.index++,t=!0,null===e.container)return d("pointer.container")}return t||(e=I.Null),this.state.callStack.currentElement.currentPointer=e.copy(),t}TryFollowDefaultInvisibleChoice(){let t=this._state.currentChoices,e=t.filter(t=>t.isInvisibleDefault);if(0==e.length||t.length>e.length)return!1;let n=e[0];return null===n.targetPath?d("choice.targetPath"):null===n.threadAtGeneration?d("choice.threadAtGeneration"):(this.state.callStack.currentThread=n.threadAtGeneration,this.ChoosePath(n.targetPath,!1),!0)}NextSequenceShuffleIndex(){let t=a(this.state.PopEvaluationStack(),b);if(!(t instanceof b))return this.Error("expected number of elements in sequence for shuffle index"),0;let e=this.state.currentPointer.container;if(null===e)return d("seqContainer");if(null===t.value)return d("numElementsIntVal.value");let n=t.value,i=s(this.state.PopEvaluationStack(),b).value;if(null===i)return d("seqCount");let r=i/n,l=i%n,o=e.path.toString(),u=0;for(let t=0,e=o.length;t<e;t++)u+=o.charCodeAt(t)||0;let h=u+r+this.state.storySeed,c=new K(Math.floor(h)),p=[];for(let t=0;t<n;++t)p.push(t);for(let t=0;t<=l;++t){let e=c.next()%p.length,n=p[e];if(p.splice(e,1),t==l)return n}throw new Error("Should never reach here")}Error(t,e=!1){let n=new S(t);throw n.useEndLineNumber=e,n}Warning(t){this.AddError(t,!0)}AddError(t,e=!1,n=!1){let i=this.currentDebugMetadata,r=e?"WARNING":"ERROR";if(null!=i){let e=n?i.endLineNumber:i.startLineNumber;t="RUNTIME "+r+": '"+i.fileName+"' line "+e+": "+t}else t=this.state.currentPointer.isNull?"RUNTIME "+r+": "+t:"RUNTIME "+r+": ("+this.state.currentPointer+"): "+t;this.state.AddError(t,e),e||this.state.ForceEnd()}Assert(t,e=null){if(0==t)throw null==e&&(e="Story assert"),new Error(e+" "+this.currentDebugMetadata)}get currentDebugMetadata(){let t,e=this.state.currentPointer;if(!e.isNull&&null!==e.Resolve()&&(t=e.Resolve().debugMetadata,null!==t))return t;for(let n=this.state.callStack.elements.length-1;n>=0;--n)if(e=this.state.callStack.elements[n].currentPointer,!e.isNull&&null!==e.Resolve()&&(t=e.Resolve().debugMetadata,null!==t))return t;for(let e=this.state.outputStream.length-1;e>=0;--e){if(t=this.state.outputStream[e].debugMetadata,null!==t)return t}return null}get mainContentContainer(){return this._temporaryEvaluationContainer?this._temporaryEvaluationContainer:this._mainContentContainer}}X.inkVersionCurrent=19,function(t){let e;!function(t){t[t.NoChange=0]="NoChange",t[t.ExtendedBeyondNewline=1]="ExtendedBeyondNewline",t[t.NewlineRemoved=2]="NewlineRemoved"}(e=t.OutputStateChange||(t.OutputStateChange={}))}(X||(X={})),t.InkList=g,t.Story=X,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ink-es2015.js.map


/***/ }),

/***/ "./pages/index.js":
/*!************************!*\
  !*** ./pages/index.js ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(module) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Home; });
/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ "./node_modules/react/jsx-dev-runtime.js");
/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var next_head__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/head */ "./node_modules/next/dist/next-server/lib/head.js");
/* harmony import */ var next_head__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_head__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var inkjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! inkjs */ "./node_modules/inkjs/dist/ink-es2015.js");
/* harmony import */ var inkjs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(inkjs__WEBPACK_IMPORTED_MODULE_3__);


var _jsxFileName = "C:\\Users\\mael\\Documents\\Cours\\mini-projet-2\\app\\pages\\index.js",
    _s = $RefreshSig$();




function Home() {
  _s();

  Object(react__WEBPACK_IMPORTED_MODULE_2__["useEffect"])(function () {
    fetch("story.json").then(function (response) {
      console.log(response);
      return response.text();
    }).then(function (storyContent) {
      console.log(storyContent);
      story = new inkjs__WEBPACK_IMPORTED_MODULE_3___default.a.Story(storyContent);
      continueStory();
    });
  });
  return /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])("div", {
    children: [/*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])(next_head__WEBPACK_IMPORTED_MODULE_1___default.a, {
      children: /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])("title", {
        children: "Dating Sim"
      }, void 0, false, {
        fileName: _jsxFileName,
        lineNumber: 24,
        columnNumber: 17
      }, this)
    }, void 0, false, {
      fileName: _jsxFileName,
      lineNumber: 23,
      columnNumber: 13
    }, this), /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])("main", {
      children: /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])("h1", {
        children: "Dating Sim"
      }, void 0, false, {
        fileName: _jsxFileName,
        lineNumber: 28,
        columnNumber: 17
      }, this)
    }, void 0, false, {
      fileName: _jsxFileName,
      lineNumber: 27,
      columnNumber: 13
    }, this)]
  }, void 0, true, {
    fileName: _jsxFileName,
    lineNumber: 22,
    columnNumber: 9
  }, this);
}

_s(Home, "OD7bBpZva5O2jO+Puf00hKivP7c=");

_c = Home;

var _c;

$RefreshReg$(_c, "Home");

;
    var _a, _b;
    // Legacy CSS implementations will `eval` browser code in a Node.js context
    // to extract CSS. For backwards compatibility, we need to check we're in a
    // browser context before continuing.
    if (typeof self !== 'undefined' &&
        // AMP / No-JS mode does not inject these helpers:
        '$RefreshHelpers$' in self) {
        var currentExports = module.__proto__.exports;
        var prevExports = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevExports) !== null && _b !== void 0 ? _b : null;
        // This cannot happen in MainTemplate because the exports mismatch between
        // templating and execution.
        self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.i);
        // A module can be accepted automatically based on its exports, e.g. when
        // it is a Refresh Boundary.
        if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {
            // Save the previous exports on update so we can compare the boundary
            // signatures.
            module.hot.dispose(function (data) {
                data.prevExports = currentExports;
            });
            // Unconditionally accept an update to this module, we'll check if it's
            // still a Refresh Boundary later.
            module.hot.accept();
            // This field is set when the previous version of this module was a
            // Refresh Boundary, letting us know we need to check for invalidation or
            // enqueue an update.
            if (prevExports !== null) {
                // A boundary can become ineligible if its exports are incompatible
                // with the previous exports.
                //
                // For example, if you add/remove/change exports, we'll want to
                // re-execute the importing modules, and force those components to
                // re-render. Similarly, if you convert a class component to a
                // function, we want to invalidate the boundary.
                if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevExports, currentExports)) {
                    module.hot.invalidate();
                }
                else {
                    self.$RefreshHelpers$.scheduleUpdate();
                }
            }
        }
        else {
            // Since we just executed the code for the module, it's possible that the
            // new exports made it ineligible for being a boundary.
            // We only care about the case when we were _previously_ a boundary,
            // because we already accepted this update (accidental side effect).
            var isNoLongerABoundary = prevExports !== null;
            if (isNoLongerABoundary) {
                module.hot.invalidate();
            }
        }
    }

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../node_modules/webpack/buildin/harmony-module.js */ "./node_modules/webpack/buildin/harmony-module.js")(module)))

/***/ })

})
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL2lua2pzL2Rpc3QvaW5rLWVzMjAxNS5qcyIsIndlYnBhY2s6Ly9fTl9FLy4vcGFnZXMvaW5kZXguanMiXSwibmFtZXMiOlsiSG9tZSIsInVzZUVmZmVjdCIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwiY29uc29sZSIsImxvZyIsInRleHQiLCJzdG9yeUNvbnRlbnQiLCJzdG9yeSIsImlua2pzIiwiU3RvcnkiLCJjb250aW51ZVN0b3J5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxlQUFlLEtBQW9ELFlBQVksU0FBbUYsQ0FBQyxtQkFBbUIsYUFBYSxRQUFRLGNBQWMsc0dBQXNHLG1CQUFtQix3QkFBd0Isc0VBQXNFLGtDQUFrQyxpRkFBaUYsc0NBQXNDLG9DQUFvQyxnRUFBZ0UsaUJBQWlCLHdCQUF3QixxQkFBcUIsK0JBQStCLFdBQVcsMERBQTBELFdBQVcsK0JBQStCLHdEQUF3RCxnQkFBZ0IsY0FBYyxhQUFhLCtCQUErQixvQkFBb0IsZ0NBQWdDLHFDQUFxQyw2QkFBNkIsc0NBQXNDLElBQUksNkNBQTZDLFNBQVMsa0JBQWtCLFlBQVksMEJBQTBCLGdCQUFnQiwyQkFBMkIsdUJBQXVCLGdCQUFnQixZQUFZLGtEQUFrRCxRQUFRLFlBQVksNEJBQTRCLDRDQUE0QyxZQUFZLHVCQUF1Qix5Q0FBeUMsU0FBUyx1QkFBdUIscUxBQXFMLHdCQUF3QixzSEFBc0gsaUhBQWlILHdDQUF3QyxtSkFBbUosV0FBVyw2QkFBNkIsVUFBVSxvQkFBb0IsMERBQTBELDBDQUEwQyxtQ0FBbUMsSUFBSSw4REFBOEQsU0FBUyw0QkFBNEIsWUFBWSx5RkFBeUYsVUFBVSxnQkFBZ0IsZ0NBQWdDLGdCQUFnQiw4QkFBOEIsbUJBQW1CLEVBQUUsa0JBQWtCLEVBQUUsR0FBRyxjQUFjLHFDQUFxQyxjQUFjLHlCQUF5QixjQUFjLHNEQUFzRCxnQkFBZ0IsU0FBUywyQkFBMkIsUUFBUSxlQUFlLHlFQUF5RSxjQUFjLHFC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QWtGLGlEQUFpRCxLQUFLLHdJQUF3SSwyQ0FBMkMsS0FBSyxLQUFLLGdFQUFnRSxZQUFZLDJCQUEyQix5R0FBeUcsbUNBQW1DLE1BQU0sYUFBYSx1SEFBdUgsK0NBQStDLEdBQUcsU0FBUywrREFBK0QsU0FBUyxFQUFFO0FBQ2h4OUc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNEQTtBQUNBO0FBRUE7QUFFZSxTQUFTQSxJQUFULEdBQWdCO0FBQUE7O0FBRTNCQyx5REFBUyxDQUFDLFlBQU07QUFDWkMsU0FBSyxDQUFDLFlBQUQsQ0FBTCxDQUNLQyxJQURMLENBQ1UsVUFBVUMsUUFBVixFQUFvQjtBQUN0QkMsYUFBTyxDQUFDQyxHQUFSLENBQVlGLFFBQVo7QUFDQSxhQUFPQSxRQUFRLENBQUNHLElBQVQsRUFBUDtBQUNILEtBSkwsRUFLS0osSUFMTCxDQUtVLFVBQVVLLFlBQVYsRUFBd0I7QUFDMUJILGFBQU8sQ0FBQ0MsR0FBUixDQUFZRSxZQUFaO0FBQ0FDLFdBQUssR0FBRyxJQUFJQyw0Q0FBSyxDQUFDQyxLQUFWLENBQWdCSCxZQUFoQixDQUFSO0FBQ0FJLG1CQUFhO0FBQ2hCLEtBVEw7QUFVSCxHQVhRLENBQVQ7QUFhQSxzQkFDSTtBQUFBLDRCQUNJLHFFQUFDLGdEQUFEO0FBQUEsNkJBQ0k7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFESjtBQUFBO0FBQUE7QUFBQTtBQUFBLFlBREosZUFLSTtBQUFBLDZCQUNJO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREo7QUFBQTtBQUFBO0FBQUE7QUFBQSxZQUxKO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxVQURKO0FBYUg7O0dBNUJ1QlosSTs7S0FBQUEsSSIsImZpbGUiOiJzdGF0aWMvd2VicGFjay9wYWdlcy9pbmRleC5hMzQ5ODFiZGFlYjI3NDI1Zjk5Mi5ob3QtdXBkYXRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIWZ1bmN0aW9uKHQsZSl7XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHMmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGU/ZShleHBvcnRzKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtcImV4cG9ydHNcIl0sZSk6ZSgodD10fHxzZWxmKS5pbmtqcz17fSl9KHRoaXMsKGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2NsYXNzIGV7Y29uc3RydWN0b3IoKXtpZih0aGlzLl9jb21wb25lbnRzPVtdLHRoaXMuX2NvbXBvbmVudHNTdHJpbmc9bnVsbCx0aGlzLl9pc1JlbGF0aXZlPSExLFwic3RyaW5nXCI9PXR5cGVvZiBhcmd1bWVudHNbMF0pe2xldCB0PWFyZ3VtZW50c1swXTt0aGlzLmNvbXBvbmVudHNTdHJpbmc9dH1lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YgZS5Db21wb25lbnQmJmFyZ3VtZW50c1sxXWluc3RhbmNlb2YgZSl7bGV0IHQ9YXJndW1lbnRzWzBdLGU9YXJndW1lbnRzWzFdO3RoaXMuX2NvbXBvbmVudHMucHVzaCh0KSx0aGlzLl9jb21wb25lbnRzPXRoaXMuX2NvbXBvbmVudHMuY29uY2F0KGUuX2NvbXBvbmVudHMpfWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBBcnJheSl7bGV0IHQ9YXJndW1lbnRzWzBdLGU9ISFhcmd1bWVudHNbMV07dGhpcy5fY29tcG9uZW50cz10aGlzLl9jb21wb25lbnRzLmNvbmNhdCh0KSx0aGlzLl9pc1JlbGF0aXZlPWV9fWdldCBpc1JlbGF0aXZlKCl7cmV0dXJuIHRoaXMuX2lzUmVsYXRpdmV9Z2V0IGNvbXBvbmVudENvdW50KCl7cmV0dXJuIHRoaXMuX2NvbXBvbmVudHMubGVuZ3RofWdldCBoZWFkKCl7cmV0dXJuIHRoaXMuX2NvbXBvbmVudHMubGVuZ3RoPjA/dGhpcy5fY29tcG9uZW50c1swXTpudWxsfWdldCB0YWlsKCl7aWYodGhpcy5fY29tcG9uZW50cy5sZW5ndGg+PTIpe2xldCB0PXRoaXMuX2NvbXBvbmVudHMuc2xpY2UoMSx0aGlzLl9jb21wb25lbnRzLmxlbmd0aCk7cmV0dXJuIG5ldyBlKHQpfXJldHVybiBlLnNlbGZ9Z2V0IGxlbmd0aCgpe3JldHVybiB0aGlzLl9jb21wb25lbnRzLmxlbmd0aH1nZXQgbGFzdENvbXBvbmVudCgpe2xldCB0PXRoaXMuX2NvbXBvbmVudHMubGVuZ3RoLTE7cmV0dXJuIHQ+PTA/dGhpcy5fY29tcG9uZW50c1t0XTpudWxsfWdldCBjb250YWluc05hbWVkQ29tcG9uZW50KCl7Zm9yKGxldCB0PTAsZT10aGlzLl9jb21wb25lbnRzLmxlbmd0aDt0PGU7dCsrKWlmKCF0aGlzLl9jb21wb25lbnRzW3RdLmlzSW5kZXgpcmV0dXJuITA7cmV0dXJuITF9c3RhdGljIGdldCBzZWxmKCl7bGV0IHQ9bmV3IGU7cmV0dXJuIHQuX2lzUmVsYXRpdmU9ITAsdH1HZXRDb21wb25lbnQodCl7cmV0dXJuIHRoaXMuX2NvbXBvbmVudHNbdF19UGF0aEJ5QXBwZW5kaW5nUGF0aCh0KXtsZXQgbj1uZXcgZSxpPTA7Zm9yKGxldCBlPTA7ZTx0Ll9jb21wb25lbnRzLmxlbmd0aCYmdC5fY29tcG9uZW50c1tlXS5pc1BhcmVudDsrK2UpaSsrO2ZvcihsZXQgdD0wO3Q8dGhpcy5fY29tcG9uZW50cy5sZW5ndGgtaTsrK3Qpbi5fY29tcG9uZW50cy5wdXNoKHRoaXMuX2NvbXBvbmVudHNbdF0pO2ZvcihsZXQgZT1pO2U8dC5fY29tcG9uZW50cy5sZW5ndGg7KytlKW4uX2NvbXBvbmVudHMucHVzaCh0Ll9jb21wb25lbnRzW2VdKTtyZXR1cm4gbn1nZXQgY29tcG9uZW50c1N0cmluZygpe3JldHVybiBudWxsPT10aGlzLl9jb21wb25lbnRzU3RyaW5nJiYodGhpcy5fY29tcG9uZW50c1N0cmluZz10aGlzLl9jb21wb25lbnRzLmpvaW4oXCIuXCIpLHRoaXMuaXNSZWxhdGl2ZSYmKHRoaXMuX2NvbXBvbmVudHNTdHJpbmc9XCIuXCIrdGhpcy5fY29tcG9uZW50c1N0cmluZykpLHRoaXMuX2NvbXBvbmVudHNTdHJpbmd9c2V0IGNvbXBvbmVudHNTdHJpbmcodCl7aWYodGhpcy5fY29tcG9uZW50cy5sZW5ndGg9MCx0aGlzLl9jb21wb25lbnRzU3RyaW5nPXQsbnVsbD09dGhpcy5fY29tcG9uZW50c1N0cmluZ3x8XCJcIj09dGhpcy5fY29tcG9uZW50c1N0cmluZylyZXR1cm47XCIuXCI9PXRoaXMuX2NvbXBvbmVudHNTdHJpbmdbMF0mJih0aGlzLl9pc1JlbGF0aXZlPSEwLHRoaXMuX2NvbXBvbmVudHNTdHJpbmc9dGhpcy5fY29tcG9uZW50c1N0cmluZy5zdWJzdHJpbmcoMSkpO2xldCBuPXRoaXMuX2NvbXBvbmVudHNTdHJpbmcuc3BsaXQoXCIuXCIpO2ZvcihsZXQgdCBvZiBuKS9eKFxcLXxcXCspPyhbMC05XSt8SW5maW5pdHkpJC8udGVzdCh0KT90aGlzLl9jb21wb25lbnRzLnB1c2gobmV3IGUuQ29tcG9uZW50KHBhcnNlSW50KHQpKSk6dGhpcy5fY29tcG9uZW50cy5wdXNoKG5ldyBlLkNvbXBvbmVudCh0KSl9dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy5jb21wb25lbnRzU3RyaW5nfUVxdWFscyh0KXtpZihudWxsPT10KXJldHVybiExO2lmKHQuX2NvbXBvbmVudHMubGVuZ3RoIT10aGlzLl9jb21wb25lbnRzLmxlbmd0aClyZXR1cm4hMTtpZih0LmlzUmVsYXRpdmUhPXRoaXMuaXNSZWxhdGl2ZSlyZXR1cm4hMTtmb3IobGV0IGU9MCxuPXQuX2NvbXBvbmVudHMubGVuZ3RoO2U8bjtlKyspaWYoIXQuX2NvbXBvbmVudHNbZV0uRXF1YWxzKHRoaXMuX2NvbXBvbmVudHNbZV0pKXJldHVybiExO3JldHVybiEwfVBhdGhCeUFwcGVuZGluZ0NvbXBvbmVudCh0KXtsZXQgbj1uZXcgZTtyZXR1cm4gbi5fY29tcG9uZW50cy5wdXNoLmFwcGx5KG4uX2NvbXBvbmVudHMsdGhpcy5fY29tcG9uZW50cyksbi5fY29tcG9uZW50cy5wdXNoKHQpLG59fXZhciBuLGkscjtmdW5jdGlvbiBhKHQsZSl7cmV0dXJuIHQgaW5zdGFuY2VvZiBlP2godCk6bnVsbH1mdW5jdGlvbiBzKHQsZSl7aWYodCBpbnN0YW5jZW9mIGUpcmV0dXJuIGgodCk7dGhyb3cgbmV3IEVycm9yKGAke3R9IGlzIG5vdCBvZiB0eXBlICR7ZX1gKX1mdW5jdGlvbiBsKHQpe3JldHVybiB0Lmhhc1ZhbGlkTmFtZSYmdC5uYW1lP3Q6bnVsbH1mdW5jdGlvbiBvKHQpe3JldHVybiB2b2lkIDA9PT10P251bGw6dH1mdW5jdGlvbiB1KHQpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiB0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0LkVxdWFsc31mdW5jdGlvbiBoKHQsZSl7cmV0dXJuIHR9ZS5wYXJlbnRJZD1cIl5cIixmdW5jdGlvbih0KXtjbGFzcyBle2NvbnN0cnVjdG9yKHQpe3RoaXMuaW5kZXg9LTEsdGhpcy5uYW1lPW51bGwsXCJzdHJpbmdcIj09dHlwZW9mIHQ/dGhpcy5uYW1lPXQ6dGhpcy5pbmRleD10fWdldCBpc0luZGV4KCl7cmV0dXJuIHRoaXMuaW5kZXg+PTB9Z2V0IGlzUGFyZW50KCl7cmV0dXJuIHRoaXMubmFtZT09dC5wYXJlbnRJZH1zdGF0aWMgVG9QYXJlbnQoKXtyZXR1cm4gbmV3IGUodC5wYXJlbnRJZCl9dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy5pc0luZGV4P3RoaXMuaW5kZXgudG9TdHJpbmcoKTp0aGlzLm5hbWV9RXF1YWxzKHQpe3JldHVybiBudWxsIT10JiZ0LmlzSW5kZXg9PXRoaXMuaXNJbmRleCYmKHRoaXMuaXNJbmRleD90aGlzLmluZGV4PT10LmluZGV4OnRoaXMubmFtZT09dC5uYW1lKX19dC5Db21wb25lbnQ9ZX0oZXx8KGU9e30pKSxmdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQsZSl7aWYoIXQpdGhyb3cgdm9pZCAwIT09ZSYmY29uc29sZS53YXJuKGUpLGNvbnNvbGUudHJhY2UmJmNvbnNvbGUudHJhY2UoKSxuZXcgRXJyb3IoXCJcIil9dC5Bc3NlcnRUeXBlPWZ1bmN0aW9uKHQsbixpKXtlKHQgaW5zdGFuY2VvZiBuLGkpfSx0LkFzc2VydD1lfShufHwobj17fSkpO2NsYXNzIGMgZXh0ZW5kcyBFcnJvcnt9ZnVuY3Rpb24gZCh0KXt0aHJvdyBuZXcgYyh0K1wiIGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpfWNsYXNzIHB7Y29uc3RydWN0b3IoKXt0aGlzLnBhcmVudD1udWxsLHRoaXMuX2RlYnVnTWV0YWRhdGE9bnVsbCx0aGlzLl9wYXRoPW51bGx9Z2V0IGRlYnVnTWV0YWRhdGEoKXtyZXR1cm4gbnVsbD09PXRoaXMuX2RlYnVnTWV0YWRhdGEmJnRoaXMucGFyZW50P3RoaXMucGFyZW50LmRlYnVnTWV0YWRhdGE6dGhpcy5fZGVidWdNZXRhZGF0YX1zZXQgZGVidWdNZXRhZGF0YSh0KXt0aGlzLl9kZWJ1Z01ldGFkYXRhPXR9Z2V0IG93bkRlYnVnTWV0YWRhdGEoKXtyZXR1cm4gdGhpcy5fZGVidWdNZXRhZGF0YX1EZWJ1Z0xpbmVOdW1iZXJPZlBhdGgodCl7aWYobnVsbD09PXQpcmV0dXJuIG51bGw7bGV0IGU9dGhpcy5yb290Q29udGVudENvbnRhaW5lcjtpZihlKXtsZXQgbj1lLkNvbnRlbnRBdFBhdGgodCkub2JqO2lmKG4pe2xldCB0PW4uZGVidWdNZXRhZGF0YTtpZihudWxsIT09dClyZXR1cm4gdC5zdGFydExpbmVOdW1iZXJ9fXJldHVybiBudWxsfWdldCBwYXRoKCl7aWYobnVsbD09dGhpcy5fcGF0aClpZihudWxsPT10aGlzLnBhcmVudCl0aGlzLl9wYXRoPW5ldyBlO2Vsc2V7bGV0IHQ9W10sbj10aGlzLGk9YShuLnBhcmVudCxOKTtmb3IoO251bGwhPT1pOyl7bGV0IHI9bChuKTtudWxsIT1yJiZyLmhhc1ZhbGlkTmFtZT90LnVuc2hpZnQobmV3IGUuQ29tcG9uZW50KHIubmFtZSkpOnQudW5zaGlmdChuZXcgZS5Db21wb25lbnQoaS5jb250ZW50LmluZGV4T2YobikpKSxuPWksaT1hKGkucGFyZW50LE4pfXRoaXMuX3BhdGg9bmV3IGUodCl9cmV0dXJuIHRoaXMuX3BhdGh9UmVzb2x2ZVBhdGgodCl7aWYobnVsbD09PXQpcmV0dXJuIGQoXCJwYXRoXCIpO2lmKHQuaXNSZWxhdGl2ZSl7bGV0IGU9YSh0aGlzLE4pO3JldHVybiBudWxsPT09ZSYmKG4uQXNzZXJ0KG51bGwhPT10aGlzLnBhcmVudCxcIkNhbid0IHJlc29sdmUgcmVsYXRpdmUgcGF0aCBiZWNhdXNlIHdlIGRvbid0IGhhdmUgYSBwYXJlbnRcIiksZT1hKHRoaXMucGFyZW50LE4pLG4uQXNzZXJ0KG51bGwhPT1lLFwiRXhwZWN0ZWQgcGFyZW50IHRvIGJlIGEgY29udGFpbmVyXCIpLG4uQXNzZXJ0KHQuR2V0Q29tcG9uZW50KDApLmlzUGFyZW50KSx0PXQudGFpbCksbnVsbD09PWU/ZChcIm5lYXJlc3RDb250YWluZXJcIik6ZS5Db250ZW50QXRQYXRoKHQpfXtsZXQgZT10aGlzLnJvb3RDb250ZW50Q29udGFpbmVyO3JldHVybiBudWxsPT09ZT9kKFwiY29udGVudENvbnRhaW5lclwiKTplLkNvbnRlbnRBdFBhdGgodCl9fUNvbnZlcnRQYXRoVG9SZWxhdGl2ZSh0KXtsZXQgbj10aGlzLnBhdGgsaT1NYXRoLm1pbih0Lmxlbmd0aCxuLmxlbmd0aCkscj0tMTtmb3IobGV0IGU9MDtlPGk7KytlKXtsZXQgaT1uLkdldENvbXBvbmVudChlKSxhPXQuR2V0Q29tcG9uZW50KGUpO2lmKCFpLkVxdWFscyhhKSlicmVhaztyPWV9aWYoLTE9PXIpcmV0dXJuIHQ7bGV0IGE9bi5jb21wb25lbnRDb3VudC0xLXIscz1bXTtmb3IobGV0IHQ9MDt0PGE7Kyt0KXMucHVzaChlLkNvbXBvbmVudC5Ub1BhcmVudCgpKTtmb3IobGV0IGU9cisxO2U8dC5jb21wb25lbnRDb3VudDsrK2Upcy5wdXNoKHQuR2V0Q29tcG9uZW50KGUpKTtyZXR1cm4gbmV3IGUocywhMCl9Q29tcGFjdFBhdGhTdHJpbmcodCl7bGV0IGU9bnVsbCxuPW51bGw7aWYodC5pc1JlbGF0aXZlKW49dC5jb21wb25lbnRzU3RyaW5nLGU9dGhpcy5wYXRoLlBhdGhCeUFwcGVuZGluZ1BhdGgodCkuY29tcG9uZW50c1N0cmluZztlbHNle249dGhpcy5Db252ZXJ0UGF0aFRvUmVsYXRpdmUodCkuY29tcG9uZW50c1N0cmluZyxlPXQuY29tcG9uZW50c1N0cmluZ31yZXR1cm4gbi5sZW5ndGg8ZS5sZW5ndGg/bjplfWdldCByb290Q29udGVudENvbnRhaW5lcigpe2xldCB0PXRoaXM7Zm9yKDt0LnBhcmVudDspdD10LnBhcmVudDtyZXR1cm4gYSh0LE4pfUNvcHkoKXt0aHJvdyBFcnJvcihcIk5vdCBJbXBsZW1lbnRlZDogRG9lc24ndCBzdXBwb3J0IGNvcHlpbmdcIil9U2V0Q2hpbGQodCxlLG4pe3RbZV0mJih0W2VdPW51bGwpLHRbZV09bix0W2VdJiYodFtlXS5wYXJlbnQ9dGhpcyl9fWNsYXNzIG17Y29uc3RydWN0b3IodCl7dD12b2lkIDAhPT10P3QudG9TdHJpbmcoKTpcIlwiLHRoaXMuc3RyaW5nPXR9Z2V0IExlbmd0aCgpe3JldHVybiB0aGlzLnN0cmluZy5sZW5ndGh9QXBwZW5kKHQpe251bGwhPT10JiYodGhpcy5zdHJpbmcrPXQpfUFwcGVuZExpbmUodCl7dm9pZCAwIT09dCYmdGhpcy5BcHBlbmQodCksdGhpcy5zdHJpbmcrPVwiXFxuXCJ9QXBwZW5kRm9ybWF0KHQsLi4uZSl7dGhpcy5zdHJpbmcrPXQucmVwbGFjZSgveyhcXGQrKX0vZywodCxuKT0+dm9pZCAwIT09ZVtuXT9lW25dOnQpfXRvU3RyaW5nKCl7cmV0dXJuIHRoaXMuc3RyaW5nfX1jbGFzcyBme2NvbnN0cnVjdG9yKCl7aWYodGhpcy5vcmlnaW5OYW1lPW51bGwsdGhpcy5pdGVtTmFtZT1udWxsLHZvaWQgMCE9PWFyZ3VtZW50c1sxXSl7bGV0IHQ9YXJndW1lbnRzWzBdLGU9YXJndW1lbnRzWzFdO3RoaXMub3JpZ2luTmFtZT10LHRoaXMuaXRlbU5hbWU9ZX1lbHNlIGlmKGFyZ3VtZW50c1swXSl7bGV0IHQ9YXJndW1lbnRzWzBdLnRvU3RyaW5nKCkuc3BsaXQoXCIuXCIpO3RoaXMub3JpZ2luTmFtZT10WzBdLHRoaXMuaXRlbU5hbWU9dFsxXX19c3RhdGljIGdldCBOdWxsKCl7cmV0dXJuIG5ldyBmKG51bGwsbnVsbCl9Z2V0IGlzTnVsbCgpe3JldHVybiBudWxsPT10aGlzLm9yaWdpbk5hbWUmJm51bGw9PXRoaXMuaXRlbU5hbWV9Z2V0IGZ1bGxOYW1lKCl7cmV0dXJuKG51bGwhPT10aGlzLm9yaWdpbk5hbWU/dGhpcy5vcmlnaW5OYW1lOlwiP1wiKStcIi5cIit0aGlzLml0ZW1OYW1lfXRvU3RyaW5nKCl7cmV0dXJuIHRoaXMuZnVsbE5hbWV9RXF1YWxzKHQpe2lmKHQgaW5zdGFuY2VvZiBmKXtsZXQgZT10O3JldHVybiBlLml0ZW1OYW1lPT10aGlzLml0ZW1OYW1lJiZlLm9yaWdpbk5hbWU9PXRoaXMub3JpZ2luTmFtZX1yZXR1cm4hMX1jb3B5KCl7cmV0dXJuIG5ldyBmKHRoaXMub3JpZ2luTmFtZSx0aGlzLml0ZW1OYW1lKX1zZXJpYWxpemVkKCl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KHtvcmlnaW5OYW1lOnRoaXMub3JpZ2luTmFtZSxpdGVtTmFtZTp0aGlzLml0ZW1OYW1lfSl9c3RhdGljIGZyb21TZXJpYWxpemVkS2V5KHQpe2xldCBlPUpTT04ucGFyc2UodCk7aWYoIWYuaXNMaWtlSW5rTGlzdEl0ZW0oZSkpcmV0dXJuIGYuTnVsbDtsZXQgbj1lO3JldHVybiBuZXcgZihuLm9yaWdpbk5hbWUsbi5pdGVtTmFtZSl9c3RhdGljIGlzTGlrZUlua0xpc3RJdGVtKHQpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiB0JiYoISghdC5oYXNPd25Qcm9wZXJ0eShcIm9yaWdpbk5hbWVcIil8fCF0Lmhhc093blByb3BlcnR5KFwiaXRlbU5hbWVcIikpJiYoKFwic3RyaW5nXCI9PXR5cGVvZiB0Lm9yaWdpbk5hbWV8fG51bGw9PT10eXBlb2YgdC5vcmlnaW5OYW1lKSYmKFwic3RyaW5nXCI9PXR5cGVvZiB0Lml0ZW1OYW1lfHxudWxsPT09dHlwZW9mIHQuaXRlbU5hbWUpKSl9fWNsYXNzIGcgZXh0ZW5kcyBNYXB7Y29uc3RydWN0b3IoKXtpZihzdXBlcihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGc/YXJndW1lbnRzWzBdOltdKSx0aGlzLm9yaWdpbnM9bnVsbCx0aGlzLl9vcmlnaW5OYW1lcz1bXSxhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGcpe2xldCB0PWFyZ3VtZW50c1swXTt0Ll9vcmlnaW5OYW1lcyYmKHRoaXMuX29yaWdpbk5hbWVzPXQuX29yaWdpbk5hbWVzLnNsaWNlKCkpfWVsc2UgaWYoXCJzdHJpbmdcIj09dHlwZW9mIGFyZ3VtZW50c1swXSl7bGV0IHQ9YXJndW1lbnRzWzBdLGU9YXJndW1lbnRzWzFdO3RoaXMuU2V0SW5pdGlhbE9yaWdpbk5hbWUodCk7bGV0IG49ZS5saXN0RGVmaW5pdGlvbnMuVHJ5TGlzdEdldERlZmluaXRpb24odCxudWxsKTtpZighbi5leGlzdHMpdGhyb3cgbmV3IEVycm9yKFwiSW5rTGlzdCBvcmlnaW4gY291bGQgbm90IGJlIGZvdW5kIGluIHN0b3J5IHdoZW4gY29uc3RydWN0aW5nIG5ldyBsaXN0OiBcIit0KTt0aGlzLm9yaWdpbnM9W24ucmVzdWx0XX1lbHNlIGlmKFwib2JqZWN0XCI9PXR5cGVvZiBhcmd1bWVudHNbMF0mJmFyZ3VtZW50c1swXS5oYXNPd25Qcm9wZXJ0eShcIktleVwiKSYmYXJndW1lbnRzWzBdLmhhc093blByb3BlcnR5KFwiVmFsdWVcIikpe2xldCB0PWFyZ3VtZW50c1swXTt0aGlzLkFkZCh0LktleSx0LlZhbHVlKX19QWRkSXRlbSh0KXtpZih0IGluc3RhbmNlb2YgZil7bGV0IGU9dDtpZihudWxsPT1lLm9yaWdpbk5hbWUpcmV0dXJuIHZvaWQgdGhpcy5BZGRJdGVtKGUuaXRlbU5hbWUpO2lmKG51bGw9PT10aGlzLm9yaWdpbnMpcmV0dXJuIGQoXCJ0aGlzLm9yaWdpbnNcIik7Zm9yKGxldCB0IG9mIHRoaXMub3JpZ2lucylpZih0Lm5hbWU9PWUub3JpZ2luTmFtZSl7bGV0IG49dC5UcnlHZXRWYWx1ZUZvckl0ZW0oZSwwKTtpZihuLmV4aXN0cylyZXR1cm4gdm9pZCB0aGlzLkFkZChlLG4ucmVzdWx0KTt0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgYWRkIHRoZSBpdGVtIFwiK2UrXCIgdG8gdGhpcyBsaXN0IGJlY2F1c2UgaXQgZG9lc24ndCBleGlzdCBpbiB0aGUgb3JpZ2luYWwgbGlzdCBkZWZpbml0aW9uIGluIGluay5cIil9dGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGFkZCBpdGVtIHRvIGxpc3QgYmVjYXVzZSB0aGUgaXRlbSB3YXMgZnJvbSBhIG5ldyBsaXN0IGRlZmluaXRpb24gdGhhdCB3YXNuJ3QgcHJldmlvdXNseSBrbm93biB0byB0aGlzIGxpc3QuIE9ubHkgaXRlbXMgZnJvbSBwcmV2aW91c2x5IGtub3duIGxpc3RzIGNhbiBiZSB1c2VkLCBzbyB0aGF0IHRoZSBpbnQgdmFsdWUgY2FuIGJlIGZvdW5kLlwiKX17bGV0IGU9dCxuPW51bGw7aWYobnVsbD09PXRoaXMub3JpZ2lucylyZXR1cm4gZChcInRoaXMub3JpZ2luc1wiKTtmb3IobGV0IHQgb2YgdGhpcy5vcmlnaW5zKXtpZihudWxsPT09ZSlyZXR1cm4gZChcIml0ZW1OYW1lXCIpO2lmKHQuQ29udGFpbnNJdGVtV2l0aE5hbWUoZSkpe2lmKG51bGwhPW4pdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGFkZCB0aGUgaXRlbSBcIitlK1wiIHRvIHRoaXMgbGlzdCBiZWNhdXNlIGl0IGNvdWxkIGNvbWUgZnJvbSBlaXRoZXIgXCIrdC5uYW1lK1wiIG9yIFwiK24ubmFtZSk7bj10fX1pZihudWxsPT1uKXRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBhZGQgdGhlIGl0ZW0gXCIrZStcIiB0byB0aGlzIGxpc3QgYmVjYXVzZSBpdCBpc24ndCBrbm93biB0byBhbnkgbGlzdCBkZWZpbml0aW9ucyBwcmV2aW91c2x5IGFzc29jaWF0ZWQgd2l0aCB0aGlzIGxpc3QuXCIpO2xldCBpPW5ldyBmKG4ubmFtZSxlKSxyPW4uVmFsdWVGb3JJdGVtKGkpO3RoaXMuQWRkKGkscil9fUNvbnRhaW5zSXRlbU5hbWVkKHQpe2ZvcihsZXRbZV1vZiB0aGlzKXtpZihmLmZyb21TZXJpYWxpemVkS2V5KGUpLml0ZW1OYW1lPT10KXJldHVybiEwfXJldHVybiExfUNvbnRhaW5zS2V5KHQpe3JldHVybiB0aGlzLmhhcyh0LnNlcmlhbGl6ZWQoKSl9QWRkKHQsZSl7bGV0IG49dC5zZXJpYWxpemVkKCk7aWYodGhpcy5oYXMobikpdGhyb3cgbmV3IEVycm9yKFwiVGhlIE1hcCBhbHJlYWR5IGNvbnRhaW5zIGFuIGVudHJ5IGZvciBcIit0KTt0aGlzLnNldChuLGUpfVJlbW92ZSh0KXtyZXR1cm4gdGhpcy5kZWxldGUodC5zZXJpYWxpemVkKCkpfWdldCBDb3VudCgpe3JldHVybiB0aGlzLnNpemV9Z2V0IG9yaWdpbk9mTWF4SXRlbSgpe2lmKG51bGw9PXRoaXMub3JpZ2lucylyZXR1cm4gbnVsbDtsZXQgdD10aGlzLm1heEl0ZW0uS2V5Lm9yaWdpbk5hbWUsZT1udWxsO3JldHVybiB0aGlzLm9yaWdpbnMuZXZlcnkobj0+bi5uYW1lIT10fHwoZT1uLCExKSksZX1nZXQgb3JpZ2luTmFtZXMoKXtpZih0aGlzLkNvdW50PjApe251bGw9PXRoaXMuX29yaWdpbk5hbWVzJiZ0aGlzLkNvdW50PjA/dGhpcy5fb3JpZ2luTmFtZXM9W106KHRoaXMuX29yaWdpbk5hbWVzfHwodGhpcy5fb3JpZ2luTmFtZXM9W10pLHRoaXMuX29yaWdpbk5hbWVzLmxlbmd0aD0wKTtmb3IobGV0W3Rdb2YgdGhpcyl7bGV0IGU9Zi5mcm9tU2VyaWFsaXplZEtleSh0KTtpZihudWxsPT09ZS5vcmlnaW5OYW1lKXJldHVybiBkKFwiaXRlbS5vcmlnaW5OYW1lXCIpO3RoaXMuX29yaWdpbk5hbWVzLnB1c2goZS5vcmlnaW5OYW1lKX19cmV0dXJuIHRoaXMuX29yaWdpbk5hbWVzfVNldEluaXRpYWxPcmlnaW5OYW1lKHQpe3RoaXMuX29yaWdpbk5hbWVzPVt0XX1TZXRJbml0aWFsT3JpZ2luTmFtZXModCl7dGhpcy5fb3JpZ2luTmFtZXM9bnVsbD09dD9udWxsOnQuc2xpY2UoKX1nZXQgbWF4SXRlbSgpe2xldCB0PXtLZXk6Zi5OdWxsLFZhbHVlOjB9O2ZvcihsZXRbZSxuXW9mIHRoaXMpe2xldCBpPWYuZnJvbVNlcmlhbGl6ZWRLZXkoZSk7KHQuS2V5LmlzTnVsbHx8bj50LlZhbHVlKSYmKHQ9e0tleTppLFZhbHVlOm59KX1yZXR1cm4gdH1nZXQgbWluSXRlbSgpe2xldCB0PXtLZXk6Zi5OdWxsLFZhbHVlOjB9O2ZvcihsZXRbZSxuXW9mIHRoaXMpe2xldCBpPWYuZnJvbVNlcmlhbGl6ZWRLZXkoZSk7KHQuS2V5LmlzTnVsbHx8bjx0LlZhbHVlKSYmKHQ9e0tleTppLFZhbHVlOm59KX1yZXR1cm4gdH1nZXQgaW52ZXJzZSgpe2xldCB0PW5ldyBnO2lmKG51bGwhPXRoaXMub3JpZ2lucylmb3IobGV0IGUgb2YgdGhpcy5vcmlnaW5zKWZvcihsZXRbbixpXW9mIGUuaXRlbXMpe2xldCBlPWYuZnJvbVNlcmlhbGl6ZWRLZXkobik7dGhpcy5Db250YWluc0tleShlKXx8dC5BZGQoZSxpKX1yZXR1cm4gdH1nZXQgYWxsKCl7bGV0IHQ9bmV3IGc7aWYobnVsbCE9dGhpcy5vcmlnaW5zKWZvcihsZXQgZSBvZiB0aGlzLm9yaWdpbnMpZm9yKGxldFtuLGldb2YgZS5pdGVtcyl7bGV0IGU9Zi5mcm9tU2VyaWFsaXplZEtleShuKTt0LnNldChlLnNlcmlhbGl6ZWQoKSxpKX1yZXR1cm4gdH1Vbmlvbih0KXtsZXQgZT1uZXcgZyh0aGlzKTtmb3IobGV0W24saV1vZiB0KWUuc2V0KG4saSk7cmV0dXJuIGV9SW50ZXJzZWN0KHQpe2xldCBlPW5ldyBnO2ZvcihsZXRbbixpXW9mIHRoaXMpdC5oYXMobikmJmUuc2V0KG4saSk7cmV0dXJuIGV9V2l0aG91dCh0KXtsZXQgZT1uZXcgZyh0aGlzKTtmb3IobGV0W25db2YgdCllLmRlbGV0ZShuKTtyZXR1cm4gZX1Db250YWlucyh0KXtmb3IobGV0W2Vdb2YgdClpZighdGhpcy5oYXMoZSkpcmV0dXJuITE7cmV0dXJuITB9R3JlYXRlclRoYW4odCl7cmV0dXJuIDAhPXRoaXMuQ291bnQmJigwPT10LkNvdW50fHx0aGlzLm1pbkl0ZW0uVmFsdWU+dC5tYXhJdGVtLlZhbHVlKX1HcmVhdGVyVGhhbk9yRXF1YWxzKHQpe3JldHVybiAwIT10aGlzLkNvdW50JiYoMD09dC5Db3VudHx8dGhpcy5taW5JdGVtLlZhbHVlPj10Lm1pbkl0ZW0uVmFsdWUmJnRoaXMubWF4SXRlbS5WYWx1ZT49dC5tYXhJdGVtLlZhbHVlKX1MZXNzVGhhbih0KXtyZXR1cm4gMCE9dC5Db3VudCYmKDA9PXRoaXMuQ291bnR8fHRoaXMubWF4SXRlbS5WYWx1ZTx0Lm1pbkl0ZW0uVmFsdWUpfUxlc3NUaGFuT3JFcXVhbHModCl7cmV0dXJuIDAhPXQuQ291bnQmJigwPT10aGlzLkNvdW50fHx0aGlzLm1heEl0ZW0uVmFsdWU8PXQubWF4SXRlbS5WYWx1ZSYmdGhpcy5taW5JdGVtLlZhbHVlPD10Lm1pbkl0ZW0uVmFsdWUpfU1heEFzTGlzdCgpe3JldHVybiB0aGlzLkNvdW50PjA/bmV3IGcodGhpcy5tYXhJdGVtKTpuZXcgZ31NaW5Bc0xpc3QoKXtyZXR1cm4gdGhpcy5Db3VudD4wP25ldyBnKHRoaXMubWluSXRlbSk6bmV3IGd9TGlzdFdpdGhTdWJSYW5nZSh0LGUpe2lmKDA9PXRoaXMuQ291bnQpcmV0dXJuIG5ldyBnO2xldCBuPXRoaXMub3JkZXJlZEl0ZW1zLGk9MCxyPU51bWJlci5NQVhfU0FGRV9JTlRFR0VSO051bWJlci5pc0ludGVnZXIodCk/aT10OnQgaW5zdGFuY2VvZiBnJiZ0LkNvdW50PjAmJihpPXQubWluSXRlbS5WYWx1ZSksTnVtYmVyLmlzSW50ZWdlcihlKT9yPWU6dCBpbnN0YW5jZW9mIGcmJnQuQ291bnQ+MCYmKHI9ZS5tYXhJdGVtLlZhbHVlKTtsZXQgYT1uZXcgZzthLlNldEluaXRpYWxPcmlnaW5OYW1lcyh0aGlzLm9yaWdpbk5hbWVzKTtmb3IobGV0IHQgb2Ygbil0LlZhbHVlPj1pJiZ0LlZhbHVlPD1yJiZhLkFkZCh0LktleSx0LlZhbHVlKTtyZXR1cm4gYX1FcXVhbHModCl7aWYodCBpbnN0YW5jZW9mIGc9PSExKXJldHVybiExO2lmKHQuQ291bnQhPXRoaXMuQ291bnQpcmV0dXJuITE7Zm9yKGxldFtlXW9mIHRoaXMpaWYoIXQuaGFzKGUpKXJldHVybiExO3JldHVybiEwfWdldCBvcmRlcmVkSXRlbXMoKXtsZXQgdD1uZXcgQXJyYXk7Zm9yKGxldFtlLG5db2YgdGhpcyl7bGV0IGk9Zi5mcm9tU2VyaWFsaXplZEtleShlKTt0LnB1c2goe0tleTppLFZhbHVlOm59KX1yZXR1cm4gdC5zb3J0KCh0LGUpPT5udWxsPT09dC5LZXkub3JpZ2luTmFtZT9kKFwieC5LZXkub3JpZ2luTmFtZVwiKTpudWxsPT09ZS5LZXkub3JpZ2luTmFtZT9kKFwieS5LZXkub3JpZ2luTmFtZVwiKTp0LlZhbHVlPT1lLlZhbHVlP3QuS2V5Lm9yaWdpbk5hbWUubG9jYWxlQ29tcGFyZShlLktleS5vcmlnaW5OYW1lKTp0LlZhbHVlPGUuVmFsdWU/LTE6dC5WYWx1ZT5lLlZhbHVlPzE6MCksdH10b1N0cmluZygpe2xldCB0PXRoaXMub3JkZXJlZEl0ZW1zLGU9bmV3IG07Zm9yKGxldCBuPTA7bjx0Lmxlbmd0aDtuKyspe24+MCYmZS5BcHBlbmQoXCIsIFwiKTtsZXQgaT10W25dLktleTtpZihudWxsPT09aS5pdGVtTmFtZSlyZXR1cm4gZChcIml0ZW0uaXRlbU5hbWVcIik7ZS5BcHBlbmQoaS5pdGVtTmFtZSl9cmV0dXJuIGUudG9TdHJpbmcoKX12YWx1ZU9mKCl7cmV0dXJuIE5hTn19Y2xhc3MgUyBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMudXNlRW5kTGluZU51bWJlcj0hMSx0aGlzLm1lc3NhZ2U9dCx0aGlzLm5hbWU9XCJTdG9yeUV4Y2VwdGlvblwifX1mdW5jdGlvbiB5KHQsZSxuKXtpZihudWxsPT09dClyZXR1cm57cmVzdWx0Om4sZXhpc3RzOiExfTtsZXQgaT10LmdldChlKTtyZXR1cm4gdm9pZCAwPT09aT97cmVzdWx0Om4sZXhpc3RzOiExfTp7cmVzdWx0OmksZXhpc3RzOiEwfX1jbGFzcyBDIGV4dGVuZHMgcHtzdGF0aWMgQ3JlYXRlKHQsbil7aWYobil7aWYobj09PWkuSW50JiZOdW1iZXIuaXNJbnRlZ2VyKE51bWJlcih0KSkpcmV0dXJuIG5ldyBiKE51bWJlcih0KSk7aWYobj09PWkuRmxvYXQmJiFpc05hTih0KSlyZXR1cm4gbmV3IF8oTnVtYmVyKHQpKX1pZihcImJvb2xlYW5cIj09dHlwZW9mIHQpe3Q9ISF0PzE6MH1yZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdD9uZXcgVChTdHJpbmcodCkpOk51bWJlci5pc0ludGVnZXIoTnVtYmVyKHQpKT9uZXcgYihOdW1iZXIodCkpOmlzTmFOKHQpP3QgaW5zdGFuY2VvZiBlP25ldyBQKHModCxlKSk6dCBpbnN0YW5jZW9mIGc/bmV3IE8ocyh0LGcpKTpudWxsOm5ldyBfKE51bWJlcih0KSl9Q29weSgpe3JldHVybiBzKEMuQ3JlYXRlKHRoaXMpLHApfUJhZENhc3RFeGNlcHRpb24odCl7cmV0dXJuIG5ldyBTKFwiQ2FuJ3QgY2FzdCBcIit0aGlzLnZhbHVlT2JqZWN0K1wiIGZyb20gXCIrdGhpcy52YWx1ZVR5cGUrXCIgdG8gXCIrdCl9fWNsYXNzIHYgZXh0ZW5kcyBDe2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy52YWx1ZT10fWdldCB2YWx1ZU9iamVjdCgpe3JldHVybiB0aGlzLnZhbHVlfXRvU3RyaW5nKCl7cmV0dXJuIG51bGw9PT10aGlzLnZhbHVlP2QoXCJWYWx1ZS52YWx1ZVwiKTp0aGlzLnZhbHVlLnRvU3RyaW5nKCl9fWNsYXNzIGIgZXh0ZW5kcyB2e2NvbnN0cnVjdG9yKHQpe3N1cGVyKHR8fDApfWdldCBpc1RydXRoeSgpe3JldHVybiAwIT10aGlzLnZhbHVlfWdldCB2YWx1ZVR5cGUoKXtyZXR1cm4gaS5JbnR9Q2FzdCh0KXtpZihudWxsPT09dGhpcy52YWx1ZSlyZXR1cm4gZChcIlZhbHVlLnZhbHVlXCIpO2lmKHQ9PXRoaXMudmFsdWVUeXBlKXJldHVybiB0aGlzO2lmKHQ9PWkuRmxvYXQpcmV0dXJuIG5ldyBfKHRoaXMudmFsdWUpO2lmKHQ9PWkuU3RyaW5nKXJldHVybiBuZXcgVChcIlwiK3RoaXMudmFsdWUpO3Rocm93IHRoaXMuQmFkQ2FzdEV4Y2VwdGlvbih0KX19Y2xhc3MgXyBleHRlbmRzIHZ7Y29uc3RydWN0b3IodCl7c3VwZXIodHx8MCl9Z2V0IGlzVHJ1dGh5KCl7cmV0dXJuIDAhPXRoaXMudmFsdWV9Z2V0IHZhbHVlVHlwZSgpe3JldHVybiBpLkZsb2F0fUNhc3QodCl7aWYobnVsbD09PXRoaXMudmFsdWUpcmV0dXJuIGQoXCJWYWx1ZS52YWx1ZVwiKTtpZih0PT10aGlzLnZhbHVlVHlwZSlyZXR1cm4gdGhpcztpZih0PT1pLkludClyZXR1cm4gbmV3IGIodGhpcy52YWx1ZSk7aWYodD09aS5TdHJpbmcpcmV0dXJuIG5ldyBUKFwiXCIrdGhpcy52YWx1ZSk7dGhyb3cgdGhpcy5CYWRDYXN0RXhjZXB0aW9uKHQpfX1jbGFzcyBUIGV4dGVuZHMgdntjb25zdHJ1Y3Rvcih0KXtpZihzdXBlcih0fHxcIlwiKSx0aGlzLl9pc05ld2xpbmU9XCJcXG5cIj09dGhpcy52YWx1ZSx0aGlzLl9pc0lubGluZVdoaXRlc3BhY2U9ITAsbnVsbD09PXRoaXMudmFsdWUpcmV0dXJuIGQoXCJWYWx1ZS52YWx1ZVwiKTt0aGlzLnZhbHVlLmxlbmd0aD4wJiZ0aGlzLnZhbHVlLnNwbGl0KFwiXCIpLmV2ZXJ5KHQ9PlwiIFwiPT10fHxcIlxcdFwiPT10fHwodGhpcy5faXNJbmxpbmVXaGl0ZXNwYWNlPSExLCExKSl9Z2V0IHZhbHVlVHlwZSgpe3JldHVybiBpLlN0cmluZ31nZXQgaXNUcnV0aHkoKXtyZXR1cm4gbnVsbD09PXRoaXMudmFsdWU/ZChcIlZhbHVlLnZhbHVlXCIpOnRoaXMudmFsdWUubGVuZ3RoPjB9Z2V0IGlzTmV3bGluZSgpe3JldHVybiB0aGlzLl9pc05ld2xpbmV9Z2V0IGlzSW5saW5lV2hpdGVzcGFjZSgpe3JldHVybiB0aGlzLl9pc0lubGluZVdoaXRlc3BhY2V9Z2V0IGlzTm9uV2hpdGVzcGFjZSgpe3JldHVybiF0aGlzLmlzTmV3bGluZSYmIXRoaXMuaXNJbmxpbmVXaGl0ZXNwYWNlfUNhc3QodCl7aWYodD09dGhpcy52YWx1ZVR5cGUpcmV0dXJuIHRoaXM7aWYodD09aS5JbnQpe2xldCBlPWZ1bmN0aW9uKHQsZT0wKXtsZXQgbj1wYXJzZUludCh0KTtyZXR1cm4gTnVtYmVyLmlzTmFOKG4pP3tyZXN1bHQ6ZSxleGlzdHM6ITF9OntyZXN1bHQ6bixleGlzdHM6ITB9fSh0aGlzLnZhbHVlKTtpZihlLmV4aXN0cylyZXR1cm4gbmV3IGIoZS5yZXN1bHQpO3Rocm93IHRoaXMuQmFkQ2FzdEV4Y2VwdGlvbih0KX1pZih0PT1pLkZsb2F0KXtsZXQgZT1mdW5jdGlvbih0LGU9MCl7bGV0IG49cGFyc2VGbG9hdCh0KTtyZXR1cm4gTnVtYmVyLmlzTmFOKG4pP3tyZXN1bHQ6ZSxleGlzdHM6ITF9OntyZXN1bHQ6bixleGlzdHM6ITB9fSh0aGlzLnZhbHVlKTtpZihlLmV4aXN0cylyZXR1cm4gbmV3IF8oZS5yZXN1bHQpO3Rocm93IHRoaXMuQmFkQ2FzdEV4Y2VwdGlvbih0KX10aHJvdyB0aGlzLkJhZENhc3RFeGNlcHRpb24odCl9fWNsYXNzIFAgZXh0ZW5kcyB2e2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpfWdldCB2YWx1ZVR5cGUoKXtyZXR1cm4gaS5EaXZlcnRUYXJnZXR9Z2V0IHRhcmdldFBhdGgoKXtyZXR1cm4gbnVsbD09PXRoaXMudmFsdWU/ZChcIlZhbHVlLnZhbHVlXCIpOnRoaXMudmFsdWV9c2V0IHRhcmdldFBhdGgodCl7dGhpcy52YWx1ZT10fWdldCBpc1RydXRoeSgpe3Rocm93IG5ldyBFcnJvcihcIlNob3VsZG4ndCBiZSBjaGVja2luZyB0aGUgdHJ1dGhpbmVzcyBvZiBhIGRpdmVydCB0YXJnZXRcIil9Q2FzdCh0KXtpZih0PT10aGlzLnZhbHVlVHlwZSlyZXR1cm4gdGhpczt0aHJvdyB0aGlzLkJhZENhc3RFeGNlcHRpb24odCl9dG9TdHJpbmcoKXtyZXR1cm5cIkRpdmVydFRhcmdldFZhbHVlKFwiK3RoaXMudGFyZ2V0UGF0aCtcIilcIn19Y2xhc3MgdyBleHRlbmRzIHZ7Y29uc3RydWN0b3IodCxlPS0xKXtzdXBlcih0KSx0aGlzLl9jb250ZXh0SW5kZXg9ZX1nZXQgY29udGV4dEluZGV4KCl7cmV0dXJuIHRoaXMuX2NvbnRleHRJbmRleH1zZXQgY29udGV4dEluZGV4KHQpe3RoaXMuX2NvbnRleHRJbmRleD10fWdldCB2YXJpYWJsZU5hbWUoKXtyZXR1cm4gbnVsbD09PXRoaXMudmFsdWU/ZChcIlZhbHVlLnZhbHVlXCIpOnRoaXMudmFsdWV9c2V0IHZhcmlhYmxlTmFtZSh0KXt0aGlzLnZhbHVlPXR9Z2V0IHZhbHVlVHlwZSgpe3JldHVybiBpLlZhcmlhYmxlUG9pbnRlcn1nZXQgaXNUcnV0aHkoKXt0aHJvdyBuZXcgRXJyb3IoXCJTaG91bGRuJ3QgYmUgY2hlY2tpbmcgdGhlIHRydXRoaW5lc3Mgb2YgYSB2YXJpYWJsZSBwb2ludGVyXCIpfUNhc3QodCl7aWYodD09dGhpcy52YWx1ZVR5cGUpcmV0dXJuIHRoaXM7dGhyb3cgdGhpcy5CYWRDYXN0RXhjZXB0aW9uKHQpfXRvU3RyaW5nKCl7cmV0dXJuXCJWYXJpYWJsZVBvaW50ZXJWYWx1ZShcIit0aGlzLnZhcmlhYmxlTmFtZStcIilcIn1Db3B5KCl7cmV0dXJuIG5ldyB3KHRoaXMudmFyaWFibGVOYW1lLHRoaXMuY29udGV4dEluZGV4KX19Y2xhc3MgTyBleHRlbmRzIHZ7Z2V0IGlzVHJ1dGh5KCl7cmV0dXJuIG51bGw9PT10aGlzLnZhbHVlP2QoXCJ0aGlzLnZhbHVlXCIpOnRoaXMudmFsdWUuQ291bnQ+MH1nZXQgdmFsdWVUeXBlKCl7cmV0dXJuIGkuTGlzdH1DYXN0KHQpe2lmKG51bGw9PT10aGlzLnZhbHVlKXJldHVybiBkKFwiVmFsdWUudmFsdWVcIik7aWYodD09aS5JbnQpe2xldCB0PXRoaXMudmFsdWUubWF4SXRlbTtyZXR1cm4gdC5LZXkuaXNOdWxsP25ldyBiKDApOm5ldyBiKHQuVmFsdWUpfWlmKHQ9PWkuRmxvYXQpe2xldCB0PXRoaXMudmFsdWUubWF4SXRlbTtyZXR1cm4gdC5LZXkuaXNOdWxsP25ldyBfKDApOm5ldyBfKHQuVmFsdWUpfWlmKHQ9PWkuU3RyaW5nKXtsZXQgdD10aGlzLnZhbHVlLm1heEl0ZW07cmV0dXJuIHQuS2V5LmlzTnVsbD9uZXcgVChcIlwiKTpuZXcgVCh0LktleS50b1N0cmluZygpKX1pZih0PT10aGlzLnZhbHVlVHlwZSlyZXR1cm4gdGhpczt0aHJvdyB0aGlzLkJhZENhc3RFeGNlcHRpb24odCl9Y29uc3RydWN0b3IodCxlKXtzdXBlcihudWxsKSx0fHxlP3QgaW5zdGFuY2VvZiBnP3RoaXMudmFsdWU9bmV3IGcodCk6dCBpbnN0YW5jZW9mIGYmJlwibnVtYmVyXCI9PXR5cGVvZiBlJiYodGhpcy52YWx1ZT1uZXcgZyh7S2V5OnQsVmFsdWU6ZX0pKTp0aGlzLnZhbHVlPW5ldyBnfXN0YXRpYyBSZXRhaW5MaXN0T3JpZ2luc0ZvckFzc2lnbm1lbnQodCxlKXtsZXQgbj1hKHQsTyksaT1hKGUsTyk7cmV0dXJuIGkmJm51bGw9PT1pLnZhbHVlP2QoXCJuZXdMaXN0LnZhbHVlXCIpOm4mJm51bGw9PT1uLnZhbHVlP2QoXCJvbGRMaXN0LnZhbHVlXCIpOnZvaWQobiYmaSYmMD09aS52YWx1ZS5Db3VudCYmaS52YWx1ZS5TZXRJbml0aWFsT3JpZ2luTmFtZXMobi52YWx1ZS5vcmlnaW5OYW1lcykpfX0hZnVuY3Rpb24odCl7dFt0LkludD0wXT1cIkludFwiLHRbdC5GbG9hdD0xXT1cIkZsb2F0XCIsdFt0Lkxpc3Q9Ml09XCJMaXN0XCIsdFt0LlN0cmluZz0zXT1cIlN0cmluZ1wiLHRbdC5EaXZlcnRUYXJnZXQ9NF09XCJEaXZlcnRUYXJnZXRcIix0W3QuVmFyaWFibGVQb2ludGVyPTVdPVwiVmFyaWFibGVQb2ludGVyXCJ9KGl8fChpPXt9KSk7Y2xhc3MgRXtjb25zdHJ1Y3Rvcigpe3RoaXMub2JqPW51bGwsdGhpcy5hcHByb3hpbWF0ZT0hMX1nZXQgY29ycmVjdE9iaigpe3JldHVybiB0aGlzLmFwcHJveGltYXRlP251bGw6dGhpcy5vYmp9Z2V0IGNvbnRhaW5lcigpe3JldHVybiB0aGlzLm9iaiBpbnN0YW5jZW9mIE4/dGhpcy5vYmo6bnVsbH1jb3B5KCl7bGV0IHQ9bmV3IEU7cmV0dXJuIHQub2JqPXRoaXMub2JqLHQuYXBwcm94aW1hdGU9dGhpcy5hcHByb3hpbWF0ZSx0fX1jbGFzcyBOIGV4dGVuZHMgcHtjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy5uYW1lPVwiXCIsdGhpcy5fY29udGVudD1bXSx0aGlzLm5hbWVkQ29udGVudD1uZXcgTWFwLHRoaXMudmlzaXRzU2hvdWxkQmVDb3VudGVkPSExLHRoaXMudHVybkluZGV4U2hvdWxkQmVDb3VudGVkPSExLHRoaXMuY291bnRpbmdBdFN0YXJ0T25seT0hMSx0aGlzLl9wYXRoVG9GaXJzdExlYWZDb250ZW50PW51bGx9Z2V0IGhhc1ZhbGlkTmFtZSgpe3JldHVybiBudWxsIT10aGlzLm5hbWUmJnRoaXMubmFtZS5sZW5ndGg+MH1nZXQgY29udGVudCgpe3JldHVybiB0aGlzLl9jb250ZW50fXNldCBjb250ZW50KHQpe3RoaXMuQWRkQ29udGVudCh0KX1nZXQgbmFtZWRPbmx5Q29udGVudCgpe2xldCB0PW5ldyBNYXA7Zm9yKGxldFtlLG5db2YgdGhpcy5uYW1lZENvbnRlbnQpe2xldCBpPXMobixwKTt0LnNldChlLGkpfWZvcihsZXQgZSBvZiB0aGlzLmNvbnRlbnQpe2xldCBuPWwoZSk7bnVsbCE9biYmbi5oYXNWYWxpZE5hbWUmJnQuZGVsZXRlKG4ubmFtZSl9cmV0dXJuIDA9PXQuc2l6ZSYmKHQ9bnVsbCksdH1zZXQgbmFtZWRPbmx5Q29udGVudCh0KXtsZXQgZT10aGlzLm5hbWVkT25seUNvbnRlbnQ7aWYobnVsbCE9ZSlmb3IobGV0W3Rdb2YgZSl0aGlzLm5hbWVkQ29udGVudC5kZWxldGUodCk7aWYobnVsbCE9dClmb3IobGV0WyxlXW9mIHQpe2xldCB0PWwoZSk7bnVsbCE9dCYmdGhpcy5BZGRUb05hbWVkQ29udGVudE9ubHkodCl9fWdldCBjb3VudEZsYWdzKCl7bGV0IHQ9MDtyZXR1cm4gdGhpcy52aXNpdHNTaG91bGRCZUNvdW50ZWQmJih0fD1OLkNvdW50RmxhZ3MuVmlzaXRzKSx0aGlzLnR1cm5JbmRleFNob3VsZEJlQ291bnRlZCYmKHR8PU4uQ291bnRGbGFncy5UdXJucyksdGhpcy5jb3VudGluZ0F0U3RhcnRPbmx5JiYodHw9Ti5Db3VudEZsYWdzLkNvdW50U3RhcnRPbmx5KSx0PT1OLkNvdW50RmxhZ3MuQ291bnRTdGFydE9ubHkmJih0PTApLHR9c2V0IGNvdW50RmxhZ3ModCl7bGV0IGU9dDsoZSZOLkNvdW50RmxhZ3MuVmlzaXRzKT4wJiYodGhpcy52aXNpdHNTaG91bGRCZUNvdW50ZWQ9ITApLChlJk4uQ291bnRGbGFncy5UdXJucyk+MCYmKHRoaXMudHVybkluZGV4U2hvdWxkQmVDb3VudGVkPSEwKSwoZSZOLkNvdW50RmxhZ3MuQ291bnRTdGFydE9ubHkpPjAmJih0aGlzLmNvdW50aW5nQXRTdGFydE9ubHk9ITApfWdldCBwYXRoVG9GaXJzdExlYWZDb250ZW50KCl7cmV0dXJuIG51bGw9PXRoaXMuX3BhdGhUb0ZpcnN0TGVhZkNvbnRlbnQmJih0aGlzLl9wYXRoVG9GaXJzdExlYWZDb250ZW50PXRoaXMucGF0aC5QYXRoQnlBcHBlbmRpbmdQYXRoKHRoaXMuaW50ZXJuYWxQYXRoVG9GaXJzdExlYWZDb250ZW50KSksdGhpcy5fcGF0aFRvRmlyc3RMZWFmQ29udGVudH1nZXQgaW50ZXJuYWxQYXRoVG9GaXJzdExlYWZDb250ZW50KCl7bGV0IHQ9W10sbj10aGlzO2Zvcig7biBpbnN0YW5jZW9mIE47KW4uY29udGVudC5sZW5ndGg+MCYmKHQucHVzaChuZXcgZS5Db21wb25lbnQoMCkpLG49bi5jb250ZW50WzBdKTtyZXR1cm4gbmV3IGUodCl9QWRkQ29udGVudCh0KXtpZih0IGluc3RhbmNlb2YgQXJyYXkpe2xldCBlPXQ7Zm9yKGxldCB0IG9mIGUpdGhpcy5BZGRDb250ZW50KHQpfWVsc2V7bGV0IGU9dDtpZih0aGlzLl9jb250ZW50LnB1c2goZSksZS5wYXJlbnQpdGhyb3cgbmV3IEVycm9yKFwiY29udGVudCBpcyBhbHJlYWR5IGluIFwiK2UucGFyZW50KTtlLnBhcmVudD10aGlzLHRoaXMuVHJ5QWRkTmFtZWRDb250ZW50KGUpfX1UcnlBZGROYW1lZENvbnRlbnQodCl7bGV0IGU9bCh0KTtudWxsIT1lJiZlLmhhc1ZhbGlkTmFtZSYmdGhpcy5BZGRUb05hbWVkQ29udGVudE9ubHkoZSl9QWRkVG9OYW1lZENvbnRlbnRPbmx5KHQpe24uQXNzZXJ0VHlwZSh0LHAsXCJDYW4gb25seSBhZGQgUnVudGltZS5PYmplY3RzIHRvIGEgUnVudGltZS5Db250YWluZXJcIikscyh0LHApLnBhcmVudD10aGlzLHRoaXMubmFtZWRDb250ZW50LnNldCh0Lm5hbWUsdCl9Q29udGVudEF0UGF0aCh0LGU9MCxuPS0xKXstMT09biYmKG49dC5sZW5ndGgpO2xldCBpPW5ldyBFO2kuYXBwcm94aW1hdGU9ITE7bGV0IHI9dGhpcyxzPXRoaXM7Zm9yKGxldCBsPWU7bDxuOysrbCl7bGV0IGU9dC5HZXRDb21wb25lbnQobCk7aWYobnVsbD09cil7aS5hcHByb3hpbWF0ZT0hMDticmVha31sZXQgbj1yLkNvbnRlbnRXaXRoUGF0aENvbXBvbmVudChlKTtpZihudWxsPT1uKXtpLmFwcHJveGltYXRlPSEwO2JyZWFrfXM9bixyPWEobixOKX1yZXR1cm4gaS5vYmo9cyxpfUluc2VydENvbnRlbnQodCxlKXtpZih0aGlzLmNvbnRlbnRbZV09dCx0LnBhcmVudCl0aHJvdyBuZXcgRXJyb3IoXCJjb250ZW50IGlzIGFscmVhZHkgaW4gXCIrdC5wYXJlbnQpO3QucGFyZW50PXRoaXMsdGhpcy5UcnlBZGROYW1lZENvbnRlbnQodCl9QWRkQ29udGVudHNPZkNvbnRhaW5lcih0KXt0aGlzLmNvbnRlbnQ9dGhpcy5jb250ZW50LmNvbmNhdCh0LmNvbnRlbnQpO2ZvcihsZXQgZSBvZiB0LmNvbnRlbnQpZS5wYXJlbnQ9dGhpcyx0aGlzLlRyeUFkZE5hbWVkQ29udGVudChlKX1Db250ZW50V2l0aFBhdGhDb21wb25lbnQodCl7aWYodC5pc0luZGV4KXJldHVybiB0LmluZGV4Pj0wJiZ0LmluZGV4PHRoaXMuY29udGVudC5sZW5ndGg/dGhpcy5jb250ZW50W3QuaW5kZXhdOm51bGw7aWYodC5pc1BhcmVudClyZXR1cm4gdGhpcy5wYXJlbnQ7e2lmKG51bGw9PT10Lm5hbWUpcmV0dXJuIGQoXCJjb21wb25lbnQubmFtZVwiKTtsZXQgZT15KHRoaXMubmFtZWRDb250ZW50LHQubmFtZSxudWxsKTtyZXR1cm4gZS5leGlzdHM/cyhlLnJlc3VsdCxwKTpudWxsfX1CdWlsZFN0cmluZ09mSGllcmFyY2h5KCl7bGV0IHQ7aWYoMD09YXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdD1uZXcgbSx0aGlzLkJ1aWxkU3RyaW5nT2ZIaWVyYXJjaHkodCwwLG51bGwpLHQudG9TdHJpbmcoKTt0PWFyZ3VtZW50c1swXTtsZXQgZT1hcmd1bWVudHNbMV0saT1hcmd1bWVudHNbMl07ZnVuY3Rpb24gcigpe2ZvcihsZXQgbj0wO248NCplOysrbil0LkFwcGVuZChcIiBcIil9cigpLHQuQXBwZW5kKFwiW1wiKSx0aGlzLmhhc1ZhbGlkTmFtZSYmdC5BcHBlbmRGb3JtYXQoXCIgKHswfSlcIix0aGlzLm5hbWUpLHRoaXM9PWkmJnQuQXBwZW5kKFwiICA8LS0tXCIpLHQuQXBwZW5kTGluZSgpLGUrKztmb3IobGV0IG49MDtuPHRoaXMuY29udGVudC5sZW5ndGg7KytuKXtsZXQgYT10aGlzLmNvbnRlbnRbbl07aWYoYSBpbnN0YW5jZW9mIE4pe2EuQnVpbGRTdHJpbmdPZkhpZXJhcmNoeSh0LGUsaSl9ZWxzZSByKCksYSBpbnN0YW5jZW9mIFQ/KHQuQXBwZW5kKCdcIicpLHQuQXBwZW5kKGEudG9TdHJpbmcoKS5yZXBsYWNlKFwiXFxuXCIsXCJcXFxcblwiKSksdC5BcHBlbmQoJ1wiJykpOnQuQXBwZW5kKGEudG9TdHJpbmcoKSk7biE9dGhpcy5jb250ZW50Lmxlbmd0aC0xJiZ0LkFwcGVuZChcIixcIiksYSBpbnN0YW5jZW9mIE58fGEhPWl8fHQuQXBwZW5kKFwiICA8LS0tXCIpLHQuQXBwZW5kTGluZSgpfWxldCBhPW5ldyBNYXA7Zm9yKGxldFt0LGVdb2YgdGhpcy5uYW1lZENvbnRlbnQpdGhpcy5jb250ZW50LmluZGV4T2YocyhlLHApKT49MHx8YS5zZXQodCxlKTtpZihhLnNpemU+MCl7cigpLHQuQXBwZW5kTGluZShcIi0tIG5hbWVkOiAtLVwiKTtmb3IobGV0WyxyXW9mIGEpe24uQXNzZXJ0VHlwZShyLE4sXCJDYW4gb25seSBwcmludCBvdXQgbmFtZWQgQ29udGFpbmVyc1wiKSxyLkJ1aWxkU3RyaW5nT2ZIaWVyYXJjaHkodCxlLGkpLHQuQXBwZW5kTGluZSgpfX1lLS0scigpLHQuQXBwZW5kKFwiXVwiKX19IWZ1bmN0aW9uKHQpe2xldCBlOyFmdW5jdGlvbih0KXt0W3QuVmlzaXRzPTFdPVwiVmlzaXRzXCIsdFt0LlR1cm5zPTJdPVwiVHVybnNcIix0W3QuQ291bnRTdGFydE9ubHk9NF09XCJDb3VudFN0YXJ0T25seVwifShlPXQuQ291bnRGbGFnc3x8KHQuQ291bnRGbGFncz17fSkpfShOfHwoTj17fSkpO2NsYXNzIHggZXh0ZW5kcyBwe3RvU3RyaW5nKCl7cmV0dXJuXCJHbHVlXCJ9fWNsYXNzIEEgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKHQ9QS5Db21tYW5kVHlwZS5Ob3RTZXQpe3N1cGVyKCksdGhpcy5fY29tbWFuZFR5cGU9dH1nZXQgY29tbWFuZFR5cGUoKXtyZXR1cm4gdGhpcy5fY29tbWFuZFR5cGV9Q29weSgpe3JldHVybiBuZXcgQSh0aGlzLmNvbW1hbmRUeXBlKX1zdGF0aWMgRXZhbFN0YXJ0KCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuRXZhbFN0YXJ0KX1zdGF0aWMgRXZhbE91dHB1dCgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLkV2YWxPdXRwdXQpfXN0YXRpYyBFdmFsRW5kKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuRXZhbEVuZCl9c3RhdGljIER1cGxpY2F0ZSgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLkR1cGxpY2F0ZSl9c3RhdGljIFBvcEV2YWx1YXRlZFZhbHVlKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuUG9wRXZhbHVhdGVkVmFsdWUpfXN0YXRpYyBQb3BGdW5jdGlvbigpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLlBvcEZ1bmN0aW9uKX1zdGF0aWMgUG9wVHVubmVsKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuUG9wVHVubmVsKX1zdGF0aWMgQmVnaW5TdHJpbmcoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5CZWdpblN0cmluZyl9c3RhdGljIEVuZFN0cmluZygpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLkVuZFN0cmluZyl9c3RhdGljIE5vT3AoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5Ob09wKX1zdGF0aWMgQ2hvaWNlQ291bnQoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5DaG9pY2VDb3VudCl9c3RhdGljIFR1cm5zKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuVHVybnMpfXN0YXRpYyBUdXJuc1NpbmNlKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuVHVybnNTaW5jZSl9c3RhdGljIFJlYWRDb3VudCgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLlJlYWRDb3VudCl9c3RhdGljIFJhbmRvbSgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLlJhbmRvbSl9c3RhdGljIFNlZWRSYW5kb20oKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5TZWVkUmFuZG9tKX1zdGF0aWMgVmlzaXRJbmRleCgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLlZpc2l0SW5kZXgpfXN0YXRpYyBTZXF1ZW5jZVNodWZmbGVJbmRleCgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLlNlcXVlbmNlU2h1ZmZsZUluZGV4KX1zdGF0aWMgU3RhcnRUaHJlYWQoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5TdGFydFRocmVhZCl9c3RhdGljIERvbmUoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5Eb25lKX1zdGF0aWMgRW5kKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuRW5kKX1zdGF0aWMgTGlzdEZyb21JbnQoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5MaXN0RnJvbUludCl9c3RhdGljIExpc3RSYW5nZSgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLkxpc3RSYW5nZSl9c3RhdGljIExpc3RSYW5kb20oKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5MaXN0UmFuZG9tKX10b1N0cmluZygpe3JldHVybiB0aGlzLmNvbW1hbmRUeXBlLnRvU3RyaW5nKCl9fSFmdW5jdGlvbih0KXtsZXQgZTshZnVuY3Rpb24odCl7dFt0Lk5vdFNldD0tMV09XCJOb3RTZXRcIix0W3QuRXZhbFN0YXJ0PTBdPVwiRXZhbFN0YXJ0XCIsdFt0LkV2YWxPdXRwdXQ9MV09XCJFdmFsT3V0cHV0XCIsdFt0LkV2YWxFbmQ9Ml09XCJFdmFsRW5kXCIsdFt0LkR1cGxpY2F0ZT0zXT1cIkR1cGxpY2F0ZVwiLHRbdC5Qb3BFdmFsdWF0ZWRWYWx1ZT00XT1cIlBvcEV2YWx1YXRlZFZhbHVlXCIsdFt0LlBvcEZ1bmN0aW9uPTVdPVwiUG9wRnVuY3Rpb25cIix0W3QuUG9wVHVubmVsPTZdPVwiUG9wVHVubmVsXCIsdFt0LkJlZ2luU3RyaW5nPTddPVwiQmVnaW5TdHJpbmdcIix0W3QuRW5kU3RyaW5nPThdPVwiRW5kU3RyaW5nXCIsdFt0Lk5vT3A9OV09XCJOb09wXCIsdFt0LkNob2ljZUNvdW50PTEwXT1cIkNob2ljZUNvdW50XCIsdFt0LlR1cm5zPTExXT1cIlR1cm5zXCIsdFt0LlR1cm5zU2luY2U9MTJdPVwiVHVybnNTaW5jZVwiLHRbdC5SYW5kb209MTNdPVwiUmFuZG9tXCIsdFt0LlNlZWRSYW5kb209MTRdPVwiU2VlZFJhbmRvbVwiLHRbdC5WaXNpdEluZGV4PTE1XT1cIlZpc2l0SW5kZXhcIix0W3QuU2VxdWVuY2VTaHVmZmxlSW5kZXg9MTZdPVwiU2VxdWVuY2VTaHVmZmxlSW5kZXhcIix0W3QuU3RhcnRUaHJlYWQ9MTddPVwiU3RhcnRUaHJlYWRcIix0W3QuRG9uZT0xOF09XCJEb25lXCIsdFt0LkVuZD0xOV09XCJFbmRcIix0W3QuTGlzdEZyb21JbnQ9MjBdPVwiTGlzdEZyb21JbnRcIix0W3QuTGlzdFJhbmdlPTIxXT1cIkxpc3RSYW5nZVwiLHRbdC5MaXN0UmFuZG9tPTIyXT1cIkxpc3RSYW5kb21cIix0W3QuUmVhZENvdW50PTIzXT1cIlJlYWRDb3VudFwiLHRbdC5UT1RBTF9WQUxVRVM9MjRdPVwiVE9UQUxfVkFMVUVTXCJ9KGU9dC5Db21tYW5kVHlwZXx8KHQuQ29tbWFuZFR5cGU9e30pKX0oQXx8KEE9e30pKSxmdW5jdGlvbih0KXt0W3QuVHVubmVsPTBdPVwiVHVubmVsXCIsdFt0LkZ1bmN0aW9uPTFdPVwiRnVuY3Rpb25cIix0W3QuRnVuY3Rpb25FdmFsdWF0aW9uRnJvbUdhbWU9Ml09XCJGdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZVwifShyfHwocj17fSkpO2NsYXNzIEl7Y29uc3RydWN0b3IoKXt0aGlzLmNvbnRhaW5lcj1udWxsLHRoaXMuaW5kZXg9LTEsMj09PWFyZ3VtZW50cy5sZW5ndGgmJih0aGlzLmNvbnRhaW5lcj1hcmd1bWVudHNbMF0sdGhpcy5pbmRleD1hcmd1bWVudHNbMV0pfVJlc29sdmUoKXtyZXR1cm4gdGhpcy5pbmRleDwwP3RoaXMuY29udGFpbmVyOm51bGw9PXRoaXMuY29udGFpbmVyP251bGw6MD09dGhpcy5jb250YWluZXIuY29udGVudC5sZW5ndGg/dGhpcy5jb250YWluZXI6dGhpcy5pbmRleD49dGhpcy5jb250YWluZXIuY29udGVudC5sZW5ndGg/bnVsbDp0aGlzLmNvbnRhaW5lci5jb250ZW50W3RoaXMuaW5kZXhdfWdldCBpc051bGwoKXtyZXR1cm4gbnVsbD09dGhpcy5jb250YWluZXJ9Z2V0IHBhdGgoKXtyZXR1cm4gdGhpcy5pc051bGw/bnVsbDp0aGlzLmluZGV4Pj0wP3RoaXMuY29udGFpbmVyLnBhdGguUGF0aEJ5QXBwZW5kaW5nQ29tcG9uZW50KG5ldyBlLkNvbXBvbmVudCh0aGlzLmluZGV4KSk6dGhpcy5jb250YWluZXIucGF0aH10b1N0cmluZygpe3JldHVybiB0aGlzLmNvbnRhaW5lcj9cIkluayBQb2ludGVyIC0+IFwiK3RoaXMuY29udGFpbmVyLnBhdGgudG9TdHJpbmcoKStcIiAtLSBpbmRleCBcIit0aGlzLmluZGV4OlwiSW5rIFBvaW50ZXIgKG51bGwpXCJ9Y29weSgpe3JldHVybiBuZXcgSSh0aGlzLmNvbnRhaW5lcix0aGlzLmluZGV4KX1zdGF0aWMgU3RhcnRPZih0KXtyZXR1cm4gbmV3IEkodCwwKX1zdGF0aWMgZ2V0IE51bGwoKXtyZXR1cm4gbmV3IEkobnVsbCwtMSl9fWNsYXNzIGsgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy5fdGFyZ2V0UGF0aD1udWxsLHRoaXMuX3RhcmdldFBvaW50ZXI9SS5OdWxsLHRoaXMudmFyaWFibGVEaXZlcnROYW1lPW51bGwsdGhpcy5wdXNoZXNUb1N0YWNrPSExLHRoaXMuc3RhY2tQdXNoVHlwZT0wLHRoaXMuaXNFeHRlcm5hbD0hMSx0aGlzLmV4dGVybmFsQXJncz0wLHRoaXMuaXNDb25kaXRpb25hbD0hMSx0aGlzLnB1c2hlc1RvU3RhY2s9ITEsdm9pZCAwIT09dCYmKHRoaXMucHVzaGVzVG9TdGFjaz0hMCx0aGlzLnN0YWNrUHVzaFR5cGU9dCl9Z2V0IHRhcmdldFBhdGgoKXtpZihudWxsIT10aGlzLl90YXJnZXRQYXRoJiZ0aGlzLl90YXJnZXRQYXRoLmlzUmVsYXRpdmUpe2xldCB0PXRoaXMudGFyZ2V0UG9pbnRlci5SZXNvbHZlKCk7dCYmKHRoaXMuX3RhcmdldFBhdGg9dC5wYXRoKX1yZXR1cm4gdGhpcy5fdGFyZ2V0UGF0aH1zZXQgdGFyZ2V0UGF0aCh0KXt0aGlzLl90YXJnZXRQYXRoPXQsdGhpcy5fdGFyZ2V0UG9pbnRlcj1JLk51bGx9Z2V0IHRhcmdldFBvaW50ZXIoKXtpZih0aGlzLl90YXJnZXRQb2ludGVyLmlzTnVsbCl7bGV0IHQ9dGhpcy5SZXNvbHZlUGF0aCh0aGlzLl90YXJnZXRQYXRoKS5vYmo7aWYobnVsbD09PXRoaXMuX3RhcmdldFBhdGgpcmV0dXJuIGQoXCJ0aGlzLl90YXJnZXRQYXRoXCIpO2lmKG51bGw9PT10aGlzLl90YXJnZXRQYXRoLmxhc3RDb21wb25lbnQpcmV0dXJuIGQoXCJ0aGlzLl90YXJnZXRQYXRoLmxhc3RDb21wb25lbnRcIik7aWYodGhpcy5fdGFyZ2V0UGF0aC5sYXN0Q29tcG9uZW50LmlzSW5kZXgpe2lmKG51bGw9PT10KXJldHVybiBkKFwidGFyZ2V0T2JqXCIpO3RoaXMuX3RhcmdldFBvaW50ZXIuY29udGFpbmVyPXQucGFyZW50IGluc3RhbmNlb2YgTj90LnBhcmVudDpudWxsLHRoaXMuX3RhcmdldFBvaW50ZXIuaW5kZXg9dGhpcy5fdGFyZ2V0UGF0aC5sYXN0Q29tcG9uZW50LmluZGV4fWVsc2UgdGhpcy5fdGFyZ2V0UG9pbnRlcj1JLlN0YXJ0T2YodCBpbnN0YW5jZW9mIE4/dDpudWxsKX1yZXR1cm4gdGhpcy5fdGFyZ2V0UG9pbnRlci5jb3B5KCl9Z2V0IHRhcmdldFBhdGhTdHJpbmcoKXtyZXR1cm4gbnVsbD09dGhpcy50YXJnZXRQYXRoP251bGw6dGhpcy5Db21wYWN0UGF0aFN0cmluZyh0aGlzLnRhcmdldFBhdGgpfXNldCB0YXJnZXRQYXRoU3RyaW5nKHQpe3RoaXMudGFyZ2V0UGF0aD1udWxsPT10P251bGw6bmV3IGUodCl9Z2V0IGhhc1ZhcmlhYmxlVGFyZ2V0KCl7cmV0dXJuIG51bGwhPXRoaXMudmFyaWFibGVEaXZlcnROYW1lfUVxdWFscyh0KXtsZXQgZT10O3JldHVybiBlIGluc3RhbmNlb2YgayYmdGhpcy5oYXNWYXJpYWJsZVRhcmdldD09ZS5oYXNWYXJpYWJsZVRhcmdldCYmKHRoaXMuaGFzVmFyaWFibGVUYXJnZXQ/dGhpcy52YXJpYWJsZURpdmVydE5hbWU9PWUudmFyaWFibGVEaXZlcnROYW1lOm51bGw9PT10aGlzLnRhcmdldFBhdGg/ZChcInRoaXMudGFyZ2V0UGF0aFwiKTp0aGlzLnRhcmdldFBhdGguRXF1YWxzKGUudGFyZ2V0UGF0aCkpfXRvU3RyaW5nKCl7aWYodGhpcy5oYXNWYXJpYWJsZVRhcmdldClyZXR1cm5cIkRpdmVydCh2YXJpYWJsZTogXCIrdGhpcy52YXJpYWJsZURpdmVydE5hbWUrXCIpXCI7aWYobnVsbD09dGhpcy50YXJnZXRQYXRoKXJldHVyblwiRGl2ZXJ0KG51bGwpXCI7e2xldCB0PW5ldyBtLGU9dGhpcy50YXJnZXRQYXRoLnRvU3RyaW5nKCk7cmV0dXJuIHQuQXBwZW5kKFwiRGl2ZXJ0XCIpLHRoaXMuaXNDb25kaXRpb25hbCYmdC5BcHBlbmQoXCI/XCIpLHRoaXMucHVzaGVzVG9TdGFjayYmKHRoaXMuc3RhY2tQdXNoVHlwZT09ci5GdW5jdGlvbj90LkFwcGVuZChcIiBmdW5jdGlvblwiKTp0LkFwcGVuZChcIiB0dW5uZWxcIikpLHQuQXBwZW5kKFwiIC0+IFwiKSx0LkFwcGVuZCh0aGlzLnRhcmdldFBhdGhTdHJpbmcpLHQuQXBwZW5kKFwiIChcIiksdC5BcHBlbmQoZSksdC5BcHBlbmQoXCIpXCIpLHQudG9TdHJpbmcoKX19fWNsYXNzIFcgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKHQ9ITApe3N1cGVyKCksdGhpcy5fcGF0aE9uQ2hvaWNlPW51bGwsdGhpcy5oYXNDb25kaXRpb249ITEsdGhpcy5oYXNTdGFydENvbnRlbnQ9ITEsdGhpcy5oYXNDaG9pY2VPbmx5Q29udGVudD0hMSx0aGlzLmlzSW52aXNpYmxlRGVmYXVsdD0hMSx0aGlzLm9uY2VPbmx5PSEwLHRoaXMub25jZU9ubHk9dH1nZXQgcGF0aE9uQ2hvaWNlKCl7aWYobnVsbCE9dGhpcy5fcGF0aE9uQ2hvaWNlJiZ0aGlzLl9wYXRoT25DaG9pY2UuaXNSZWxhdGl2ZSl7bGV0IHQ9dGhpcy5jaG9pY2VUYXJnZXQ7dCYmKHRoaXMuX3BhdGhPbkNob2ljZT10LnBhdGgpfXJldHVybiB0aGlzLl9wYXRoT25DaG9pY2V9c2V0IHBhdGhPbkNob2ljZSh0KXt0aGlzLl9wYXRoT25DaG9pY2U9dH1nZXQgY2hvaWNlVGFyZ2V0KCl7cmV0dXJuIG51bGw9PT10aGlzLl9wYXRoT25DaG9pY2U/ZChcIkNob2ljZVBvaW50Ll9wYXRoT25DaG9pY2VcIik6dGhpcy5SZXNvbHZlUGF0aCh0aGlzLl9wYXRoT25DaG9pY2UpLmNvbnRhaW5lcn1nZXQgcGF0aFN0cmluZ09uQ2hvaWNlKCl7cmV0dXJuIG51bGw9PT10aGlzLnBhdGhPbkNob2ljZT9kKFwiQ2hvaWNlUG9pbnQucGF0aE9uQ2hvaWNlXCIpOnRoaXMuQ29tcGFjdFBhdGhTdHJpbmcodGhpcy5wYXRoT25DaG9pY2UpfXNldCBwYXRoU3RyaW5nT25DaG9pY2UodCl7dGhpcy5wYXRoT25DaG9pY2U9bmV3IGUodCl9Z2V0IGZsYWdzKCl7bGV0IHQ9MDtyZXR1cm4gdGhpcy5oYXNDb25kaXRpb24mJih0fD0xKSx0aGlzLmhhc1N0YXJ0Q29udGVudCYmKHR8PTIpLHRoaXMuaGFzQ2hvaWNlT25seUNvbnRlbnQmJih0fD00KSx0aGlzLmlzSW52aXNpYmxlRGVmYXVsdCYmKHR8PTgpLHRoaXMub25jZU9ubHkmJih0fD0xNiksdH1zZXQgZmxhZ3ModCl7dGhpcy5oYXNDb25kaXRpb249KDEmdCk+MCx0aGlzLmhhc1N0YXJ0Q29udGVudD0oMiZ0KT4wLHRoaXMuaGFzQ2hvaWNlT25seUNvbnRlbnQ9KDQmdCk+MCx0aGlzLmlzSW52aXNpYmxlRGVmYXVsdD0oOCZ0KT4wLHRoaXMub25jZU9ubHk9KDE2JnQpPjB9dG9TdHJpbmcoKXtpZihudWxsPT09dGhpcy5wYXRoT25DaG9pY2UpcmV0dXJuIGQoXCJDaG9pY2VQb2ludC5wYXRoT25DaG9pY2VcIik7cmV0dXJuXCJDaG9pY2U6IC0+IFwiK3RoaXMucGF0aE9uQ2hvaWNlLnRvU3RyaW5nKCl9fWNsYXNzIEYgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKHQ9bnVsbCl7c3VwZXIoKSx0aGlzLnBhdGhGb3JDb3VudD1udWxsLHRoaXMubmFtZT10fWdldCBjb250YWluZXJGb3JDb3VudCgpe3JldHVybiBudWxsPT09dGhpcy5wYXRoRm9yQ291bnQ/bnVsbDp0aGlzLlJlc29sdmVQYXRoKHRoaXMucGF0aEZvckNvdW50KS5jb250YWluZXJ9Z2V0IHBhdGhTdHJpbmdGb3JDb3VudCgpe3JldHVybiBudWxsPT09dGhpcy5wYXRoRm9yQ291bnQ/bnVsbDp0aGlzLkNvbXBhY3RQYXRoU3RyaW5nKHRoaXMucGF0aEZvckNvdW50KX1zZXQgcGF0aFN0cmluZ0ZvckNvdW50KHQpe3RoaXMucGF0aEZvckNvdW50PW51bGw9PT10P251bGw6bmV3IGUodCl9dG9TdHJpbmcoKXtpZihudWxsIT10aGlzLm5hbWUpcmV0dXJuXCJ2YXIoXCIrdGhpcy5uYW1lK1wiKVwiO3JldHVyblwicmVhZF9jb3VudChcIit0aGlzLnBhdGhTdHJpbmdGb3JDb3VudCtcIilcIn19Y2xhc3MgViBleHRlbmRzIHB7Y29uc3RydWN0b3IodCxlKXtzdXBlcigpLHRoaXMudmFyaWFibGVOYW1lPXR8fG51bGwsdGhpcy5pc05ld0RlY2xhcmF0aW9uPSEhZSx0aGlzLmlzR2xvYmFsPSExfXRvU3RyaW5nKCl7cmV0dXJuXCJWYXJBc3NpZ24gdG8gXCIrdGhpcy52YXJpYWJsZU5hbWV9fWNsYXNzIEwgZXh0ZW5kcyBwe31jbGFzcyBSIGV4dGVuZHMgcHtjb25zdHJ1Y3Rvcigpe2lmKHN1cGVyKCksdGhpcy5fbmFtZT1udWxsLHRoaXMuX251bWJlck9mUGFyYW1ldGVycz0wLHRoaXMuX3Byb3RvdHlwZT1udWxsLHRoaXMuX2lzUHJvdG90eXBlPSExLHRoaXMuX29wZXJhdGlvbkZ1bmNzPW51bGwsMD09PWFyZ3VtZW50cy5sZW5ndGgpUi5HZW5lcmF0ZU5hdGl2ZUZ1bmN0aW9uc0lmTmVjZXNzYXJ5KCk7ZWxzZSBpZigxPT09YXJndW1lbnRzLmxlbmd0aCl7bGV0IHQ9YXJndW1lbnRzWzBdO1IuR2VuZXJhdGVOYXRpdmVGdW5jdGlvbnNJZk5lY2Vzc2FyeSgpLHRoaXMubmFtZT10fWVsc2UgaWYoMj09PWFyZ3VtZW50cy5sZW5ndGgpe2xldCB0PWFyZ3VtZW50c1swXSxlPWFyZ3VtZW50c1sxXTt0aGlzLl9pc1Byb3RvdHlwZT0hMCx0aGlzLm5hbWU9dCx0aGlzLm51bWJlck9mUGFyYW1ldGVycz1lfX1zdGF0aWMgQ2FsbFdpdGhOYW1lKHQpe3JldHVybiBuZXcgUih0KX1zdGF0aWMgQ2FsbEV4aXN0c1dpdGhOYW1lKHQpe3JldHVybiB0aGlzLkdlbmVyYXRlTmF0aXZlRnVuY3Rpb25zSWZOZWNlc3NhcnkoKSx0aGlzLl9uYXRpdmVGdW5jdGlvbnMuZ2V0KHQpfWdldCBuYW1lKCl7cmV0dXJuIG51bGw9PT10aGlzLl9uYW1lP2QoXCJOYXRpdmVGdW5jdGlvbkNhbGwuX25hbWVcIik6dGhpcy5fbmFtZX1zZXQgbmFtZSh0KXt0aGlzLl9uYW1lPXQsdGhpcy5faXNQcm90b3R5cGV8fChudWxsPT09Ui5fbmF0aXZlRnVuY3Rpb25zP2QoXCJOYXRpdmVGdW5jdGlvbkNhbGwuX25hdGl2ZUZ1bmN0aW9uc1wiKTp0aGlzLl9wcm90b3R5cGU9Ui5fbmF0aXZlRnVuY3Rpb25zLmdldCh0aGlzLl9uYW1lKXx8bnVsbCl9Z2V0IG51bWJlck9mUGFyYW1ldGVycygpe3JldHVybiB0aGlzLl9wcm90b3R5cGU/dGhpcy5fcHJvdG90eXBlLm51bWJlck9mUGFyYW1ldGVyczp0aGlzLl9udW1iZXJPZlBhcmFtZXRlcnN9c2V0IG51bWJlck9mUGFyYW1ldGVycyh0KXt0aGlzLl9udW1iZXJPZlBhcmFtZXRlcnM9dH1DYWxsKHQpe2lmKHRoaXMuX3Byb3RvdHlwZSlyZXR1cm4gdGhpcy5fcHJvdG90eXBlLkNhbGwodCk7aWYodGhpcy5udW1iZXJPZlBhcmFtZXRlcnMhPXQubGVuZ3RoKXRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgbnVtYmVyIG9mIHBhcmFtZXRlcnNcIik7bGV0IGU9ITE7Zm9yKGxldCBuIG9mIHQpe2lmKG4gaW5zdGFuY2VvZiBMKXRocm93IG5ldyBTKCdBdHRlbXB0aW5nIHRvIHBlcmZvcm0gb3BlcmF0aW9uIG9uIGEgdm9pZCB2YWx1ZS4gRGlkIHlvdSBmb3JnZXQgdG8gXCJyZXR1cm5cIiBhIHZhbHVlIGZyb20gYSBmdW5jdGlvbiB5b3UgY2FsbGVkIGhlcmU/Jyk7biBpbnN0YW5jZW9mIE8mJihlPSEwKX1pZigyPT10Lmxlbmd0aCYmZSlyZXR1cm4gdGhpcy5DYWxsQmluYXJ5TGlzdE9wZXJhdGlvbih0KTtsZXQgbj10aGlzLkNvZXJjZVZhbHVlc1RvU2luZ2xlVHlwZSh0KSxyPW5bMF0udmFsdWVUeXBlO3JldHVybiByPT1pLkludHx8cj09aS5GbG9hdHx8cj09aS5TdHJpbmd8fHI9PWkuRGl2ZXJ0VGFyZ2V0fHxyPT1pLkxpc3Q/dGhpcy5DYWxsVHlwZShuKTpudWxsfUNhbGxUeXBlKHQpe2xldCBlPXModFswXSx2KSxuPWUudmFsdWVUeXBlLHI9ZSxhPXQubGVuZ3RoO2lmKDI9PWF8fDE9PWEpe2lmKG51bGw9PT10aGlzLl9vcGVyYXRpb25GdW5jcylyZXR1cm4gZChcIk5hdGl2ZUZ1bmN0aW9uQ2FsbC5fb3BlcmF0aW9uRnVuY3NcIik7bGV0IGw9dGhpcy5fb3BlcmF0aW9uRnVuY3MuZ2V0KG4pO2lmKCFsKXtjb25zdCB0PWlbbl07dGhyb3cgbmV3IFMoXCJDYW5ub3QgcGVyZm9ybSBvcGVyYXRpb24gXCIrdGhpcy5uYW1lK1wiIG9uIFwiK3QpfWlmKDI9PWEpe2xldCBlPXModFsxXSx2KSxuPWw7aWYobnVsbD09PXIudmFsdWV8fG51bGw9PT1lLnZhbHVlKXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLkNhbGwgQmluYXJ5T3AgdmFsdWVzXCIpO2xldCBpPW4oci52YWx1ZSxlLnZhbHVlKTtyZXR1cm4gdi5DcmVhdGUoaSl9e2xldCB0PWw7aWYobnVsbD09PXIudmFsdWUpcmV0dXJuIGQoXCJOYXRpdmVGdW5jdGlvbkNhbGwuQ2FsbCBVbmFyeU9wIHZhbHVlXCIpO2xldCBuPXQoci52YWx1ZSk7cmV0dXJuIHRoaXMubmFtZT09PVIuSW50P3YuQ3JlYXRlKG4saS5JbnQpOnRoaXMubmFtZT09PVIuRmxvYXQ/di5DcmVhdGUobixpLkZsb2F0KTp2LkNyZWF0ZShuLGUudmFsdWVUeXBlKX19dGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBudW1iZXIgb2YgcGFyYW1ldGVycyB0byBOYXRpdmVGdW5jdGlvbkNhbGw6IFwiK3QubGVuZ3RoKX1DYWxsQmluYXJ5TGlzdE9wZXJhdGlvbih0KXtpZigoXCIrXCI9PXRoaXMubmFtZXx8XCItXCI9PXRoaXMubmFtZSkmJnRbMF1pbnN0YW5jZW9mIE8mJnRbMV1pbnN0YW5jZW9mIGIpcmV0dXJuIHRoaXMuQ2FsbExpc3RJbmNyZW1lbnRPcGVyYXRpb24odCk7bGV0IGU9cyh0WzBdLHYpLG49cyh0WzFdLHYpO2lmKCEoXCImJlwiIT10aGlzLm5hbWUmJlwifHxcIiE9dGhpcy5uYW1lfHxlLnZhbHVlVHlwZT09aS5MaXN0JiZuLnZhbHVlVHlwZT09aS5MaXN0KSl7aWYobnVsbD09PXRoaXMuX29wZXJhdGlvbkZ1bmNzKXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLl9vcGVyYXRpb25GdW5jc1wiKTtsZXQgdD10aGlzLl9vcGVyYXRpb25GdW5jcy5nZXQoaS5JbnQpO2lmKG51bGw9PT10KXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLkNhbGxCaW5hcnlMaXN0T3BlcmF0aW9uIG9wXCIpO2xldCByPXQoZS5pc1RydXRoeT8xOjAsbi5pc1RydXRoeT8xOjApO3JldHVybiBuZXcgYihyKX1pZihlLnZhbHVlVHlwZT09aS5MaXN0JiZuLnZhbHVlVHlwZT09aS5MaXN0KXJldHVybiB0aGlzLkNhbGxUeXBlKFtlLG5dKTt0aHJvdyBuZXcgUyhcIkNhbiBub3QgY2FsbCB1c2UgXCIrdGhpcy5uYW1lK1wiIG9wZXJhdGlvbiBvbiBcIitpW2UudmFsdWVUeXBlXStcIiBhbmQgXCIraVtuLnZhbHVlVHlwZV0pfUNhbGxMaXN0SW5jcmVtZW50T3BlcmF0aW9uKHQpe2xldCBlPXModFswXSxPKSxuPXModFsxXSxiKSxyPW5ldyBnO2lmKG51bGw9PT1lLnZhbHVlKXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLkNhbGxMaXN0SW5jcmVtZW50T3BlcmF0aW9uIGxpc3RWYWwudmFsdWVcIik7Zm9yKGxldFt0LGFdb2YgZS52YWx1ZSl7bGV0IHM9Zi5mcm9tU2VyaWFsaXplZEtleSh0KTtpZihudWxsPT09dGhpcy5fb3BlcmF0aW9uRnVuY3MpcmV0dXJuIGQoXCJOYXRpdmVGdW5jdGlvbkNhbGwuX29wZXJhdGlvbkZ1bmNzXCIpO2xldCBsPXRoaXMuX29wZXJhdGlvbkZ1bmNzLmdldChpLkludCk7aWYobnVsbD09PW4udmFsdWUpcmV0dXJuIGQoXCJOYXRpdmVGdW5jdGlvbkNhbGwuQ2FsbExpc3RJbmNyZW1lbnRPcGVyYXRpb24gaW50VmFsLnZhbHVlXCIpO2xldCBvPWwoYSxuLnZhbHVlKSx1PW51bGw7aWYobnVsbD09PWUudmFsdWUub3JpZ2lucylyZXR1cm4gZChcIk5hdGl2ZUZ1bmN0aW9uQ2FsbC5DYWxsTGlzdEluY3JlbWVudE9wZXJhdGlvbiBsaXN0VmFsLnZhbHVlLm9yaWdpbnNcIik7Zm9yKGxldCB0IG9mIGUudmFsdWUub3JpZ2lucylpZih0Lm5hbWU9PXMub3JpZ2luTmFtZSl7dT10O2JyZWFrfWlmKG51bGwhPXUpe2xldCB0PXUuVHJ5R2V0SXRlbVdpdGhWYWx1ZShvLGYuTnVsbCk7dC5leGlzdHMmJnIuQWRkKHQucmVzdWx0LG8pfX1yZXR1cm4gbmV3IE8ocil9Q29lcmNlVmFsdWVzVG9TaW5nbGVUeXBlKHQpe2xldCBlPWkuSW50LG49bnVsbDtmb3IobGV0IHIgb2YgdCl7bGV0IHQ9cyhyLHYpO3QudmFsdWVUeXBlPmUmJihlPXQudmFsdWVUeXBlKSx0LnZhbHVlVHlwZT09aS5MaXN0JiYobj1hKHQsTykpfWxldCByPVtdO2lmKGlbZV09PWlbaS5MaXN0XSlmb3IobGV0IGUgb2YgdCl7bGV0IHQ9cyhlLHYpO2lmKHQudmFsdWVUeXBlPT1pLkxpc3Qpci5wdXNoKHQpO2Vsc2V7aWYodC52YWx1ZVR5cGUhPWkuSW50KXtjb25zdCBlPWlbdC52YWx1ZVR5cGVdO3Rocm93IG5ldyBTKFwiQ2Fubm90IG1peCBMaXN0cyBhbmQgXCIrZStcIiB2YWx1ZXMgaW4gdGhpcyBvcGVyYXRpb25cIil9e2xldCBlPXBhcnNlSW50KHQudmFsdWVPYmplY3QpO2lmKG49cyhuLE8pLG51bGw9PT1uLnZhbHVlKXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLkNvZXJjZVZhbHVlc1RvU2luZ2xlVHlwZSBzcGVjaWFsQ2FzZUxpc3QudmFsdWVcIik7bGV0IGk9bi52YWx1ZS5vcmlnaW5PZk1heEl0ZW07aWYobnVsbD09PWkpcmV0dXJuIGQoXCJOYXRpdmVGdW5jdGlvbkNhbGwuQ29lcmNlVmFsdWVzVG9TaW5nbGVUeXBlIGxpc3RcIik7bGV0IGE9aS5UcnlHZXRJdGVtV2l0aFZhbHVlKGUsZi5OdWxsKTtpZighYS5leGlzdHMpdGhyb3cgbmV3IFMoXCJDb3VsZCBub3QgZmluZCBMaXN0IGl0ZW0gd2l0aCB0aGUgdmFsdWUgXCIrZStcIiBpbiBcIitpLm5hbWUpO3tsZXQgdD1uZXcgTyhhLnJlc3VsdCxlKTtyLnB1c2godCl9fX19ZWxzZSBmb3IobGV0IG4gb2YgdCl7bGV0IHQ9cyhuLHYpLkNhc3QoZSk7ci5wdXNoKHQpfXJldHVybiByfXN0YXRpYyBJZGVudGl0eSh0KXtyZXR1cm4gdH1zdGF0aWMgR2VuZXJhdGVOYXRpdmVGdW5jdGlvbnNJZk5lY2Vzc2FyeSgpe2lmKG51bGw9PXRoaXMuX25hdGl2ZUZ1bmN0aW9ucyl7dGhpcy5fbmF0aXZlRnVuY3Rpb25zPW5ldyBNYXAsdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLkFkZCwodCxlKT0+dCtlKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuU3VidHJhY3QsKHQsZSk9PnQtZSksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLk11bHRpcGx5LCh0LGUpPT50KmUpLHRoaXMuQWRkSW50QmluYXJ5T3AodGhpcy5EaXZpZGUsKHQsZSk9Pk1hdGguZmxvb3IodC9lKSksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLk1vZCwodCxlKT0+dCVlKSx0aGlzLkFkZEludFVuYXJ5T3AodGhpcy5OZWdhdGUsdD0+LXQpLHRoaXMuQWRkSW50QmluYXJ5T3AodGhpcy5FcXVhbCwodCxlKT0+dD09ZT8xOjApLHRoaXMuQWRkSW50QmluYXJ5T3AodGhpcy5HcmVhdGVyLCh0LGUpPT50PmU/MTowKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuTGVzcywodCxlKT0+dDxlPzE6MCksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLkdyZWF0ZXJUaGFuT3JFcXVhbHMsKHQsZSk9PnQ+PWU/MTowKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuTGVzc1RoYW5PckVxdWFscywodCxlKT0+dDw9ZT8xOjApLHRoaXMuQWRkSW50QmluYXJ5T3AodGhpcy5Ob3RFcXVhbHMsKHQsZSk9PnQhPWU/MTowKSx0aGlzLkFkZEludFVuYXJ5T3AodGhpcy5Ob3QsdD0+MD09dD8xOjApLHRoaXMuQWRkSW50QmluYXJ5T3AodGhpcy5BbmQsKHQsZSk9PjAhPXQmJjAhPWU/MTowKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuT3IsKHQsZSk9PjAhPXR8fDAhPWU/MTowKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuTWF4LCh0LGUpPT5NYXRoLm1heCh0LGUpKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuTWluLCh0LGUpPT5NYXRoLm1pbih0LGUpKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuUG93LCh0LGUpPT5NYXRoLnBvdyh0LGUpKSx0aGlzLkFkZEludFVuYXJ5T3AodGhpcy5GbG9vcixSLklkZW50aXR5KSx0aGlzLkFkZEludFVuYXJ5T3AodGhpcy5DZWlsaW5nLFIuSWRlbnRpdHkpLHRoaXMuQWRkSW50VW5hcnlPcCh0aGlzLkludCxSLklkZW50aXR5KSx0aGlzLkFkZEludFVuYXJ5T3AodGhpcy5GbG9hdCx0PT50KSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5BZGQsKHQsZSk9PnQrZSksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuU3VidHJhY3QsKHQsZSk9PnQtZSksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuTXVsdGlwbHksKHQsZSk9PnQqZSksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuRGl2aWRlLCh0LGUpPT50L2UpLHRoaXMuQWRkRmxvYXRCaW5hcnlPcCh0aGlzLk1vZCwodCxlKT0+dCVlKSx0aGlzLkFkZEZsb2F0VW5hcnlPcCh0aGlzLk5lZ2F0ZSx0PT4tdCksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuRXF1YWwsKHQsZSk9PnQ9PWU/MTowKSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5HcmVhdGVyLCh0LGUpPT50PmU/MTowKSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5MZXNzLCh0LGUpPT50PGU/MTowKSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5HcmVhdGVyVGhhbk9yRXF1YWxzLCh0LGUpPT50Pj1lPzE6MCksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuTGVzc1RoYW5PckVxdWFscywodCxlKT0+dDw9ZT8xOjApLHRoaXMuQWRkRmxvYXRCaW5hcnlPcCh0aGlzLk5vdEVxdWFscywodCxlKT0+dCE9ZT8xOjApLHRoaXMuQWRkRmxvYXRVbmFyeU9wKHRoaXMuTm90LHQ9PjA9PXQ/MTowKSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5BbmQsKHQsZSk9PjAhPXQmJjAhPWU/MTowKSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5PciwodCxlKT0+MCE9dHx8MCE9ZT8xOjApLHRoaXMuQWRkRmxvYXRCaW5hcnlPcCh0aGlzLk1heCwodCxlKT0+TWF0aC5tYXgodCxlKSksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuTWluLCh0LGUpPT5NYXRoLm1pbih0LGUpKSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5Qb3csKHQsZSk9Pk1hdGgucG93KHQsZSkpLHRoaXMuQWRkRmxvYXRVbmFyeU9wKHRoaXMuRmxvb3IsdD0+TWF0aC5mbG9vcih0KSksdGhpcy5BZGRGbG9hdFVuYXJ5T3AodGhpcy5DZWlsaW5nLHQ9Pk1hdGguY2VpbCh0KSksdGhpcy5BZGRGbG9hdFVuYXJ5T3AodGhpcy5JbnQsdD0+TWF0aC5mbG9vcih0KSksdGhpcy5BZGRGbG9hdFVuYXJ5T3AodGhpcy5GbG9hdCxSLklkZW50aXR5KSx0aGlzLkFkZFN0cmluZ0JpbmFyeU9wKHRoaXMuQWRkLCh0LGUpPT50K2UpLHRoaXMuQWRkU3RyaW5nQmluYXJ5T3AodGhpcy5FcXVhbCwodCxlKT0+dD09PWU/MTowKSx0aGlzLkFkZFN0cmluZ0JpbmFyeU9wKHRoaXMuTm90RXF1YWxzLCh0LGUpPT50IT09ZT8xOjApLHRoaXMuQWRkU3RyaW5nQmluYXJ5T3AodGhpcy5IYXMsKHQsZSk9PnQuaW5jbHVkZXMoZSk/MTowKSx0aGlzLkFkZFN0cmluZ0JpbmFyeU9wKHRoaXMuSGFzbnQsKHQsZSk9PnQuaW5jbHVkZXMoZSk/MDoxKSx0aGlzLkFkZExpc3RCaW5hcnlPcCh0aGlzLkFkZCwodCxlKT0+dC5VbmlvbihlKSksdGhpcy5BZGRMaXN0QmluYXJ5T3AodGhpcy5TdWJ0cmFjdCwodCxlKT0+dC5XaXRob3V0KGUpKSx0aGlzLkFkZExpc3RCaW5hcnlPcCh0aGlzLkhhcywodCxlKT0+dC5Db250YWlucyhlKT8xOjApLHRoaXMuQWRkTGlzdEJpbmFyeU9wKHRoaXMuSGFzbnQsKHQsZSk9PnQuQ29udGFpbnMoZSk/MDoxKSx0aGlzLkFkZExpc3RCaW5hcnlPcCh0aGlzLkludGVyc2VjdCwodCxlKT0+dC5JbnRlcnNlY3QoZSkpLHRoaXMuQWRkTGlzdEJpbmFyeU9wKHRoaXMuRXF1YWwsKHQsZSk9PnQuRXF1YWxzKGUpPzE6MCksdGhpcy5BZGRMaXN0QmluYXJ5T3AodGhpcy5HcmVhdGVyLCh0LGUpPT50LkdyZWF0ZXJUaGFuKGUpPzE6MCksdGhpcy5BZGRMaXN0QmluYXJ5T3AodGhpcy5MZXNzLCh0LGUpPT50Lkxlc3NUaGFuKGUpPzE6MCksdGhpcy5BZGRMaXN0QmluYXJ5T3AodGhpcy5HcmVhdGVyVGhhbk9yRXF1YWxzLCh0LGUpPT50LkdyZWF0ZXJUaGFuT3JFcXVhbHMoZSk/MTowKSx0aGlzLkFkZExpc3RCaW5hcnlPcCh0aGlzLkxlc3NUaGFuT3JFcXVhbHMsKHQsZSk9PnQuTGVzc1RoYW5PckVxdWFscyhlKT8xOjApLHRoaXMuQWRkTGlzdEJpbmFyeU9wKHRoaXMuTm90RXF1YWxzLCh0LGUpPT50LkVxdWFscyhlKT8wOjEpLHRoaXMuQWRkTGlzdEJpbmFyeU9wKHRoaXMuQW5kLCh0LGUpPT50LkNvdW50PjAmJmUuQ291bnQ+MD8xOjApLHRoaXMuQWRkTGlzdEJpbmFyeU9wKHRoaXMuT3IsKHQsZSk9PnQuQ291bnQ+MHx8ZS5Db3VudD4wPzE6MCksdGhpcy5BZGRMaXN0VW5hcnlPcCh0aGlzLk5vdCx0PT4wPT10LkNvdW50PzE6MCksdGhpcy5BZGRMaXN0VW5hcnlPcCh0aGlzLkludmVydCx0PT50LmludmVyc2UpLHRoaXMuQWRkTGlzdFVuYXJ5T3AodGhpcy5BbGwsdD0+dC5hbGwpLHRoaXMuQWRkTGlzdFVuYXJ5T3AodGhpcy5MaXN0TWluLHQ9PnQuTWluQXNMaXN0KCkpLHRoaXMuQWRkTGlzdFVuYXJ5T3AodGhpcy5MaXN0TWF4LHQ9PnQuTWF4QXNMaXN0KCkpLHRoaXMuQWRkTGlzdFVuYXJ5T3AodGhpcy5Db3VudCx0PT50LkNvdW50KSx0aGlzLkFkZExpc3RVbmFyeU9wKHRoaXMuVmFsdWVPZkxpc3QsdD0+dC5tYXhJdGVtLlZhbHVlKTtsZXQgdD0odCxlKT0+dC5FcXVhbHMoZSk/MTowLGU9KHQsZSk9PnQuRXF1YWxzKGUpPzA6MTt0aGlzLkFkZE9wVG9OYXRpdmVGdW5jKHRoaXMuRXF1YWwsMixpLkRpdmVydFRhcmdldCx0KSx0aGlzLkFkZE9wVG9OYXRpdmVGdW5jKHRoaXMuTm90RXF1YWxzLDIsaS5EaXZlcnRUYXJnZXQsZSl9fUFkZE9wRnVuY0ZvclR5cGUodCxlKXtudWxsPT10aGlzLl9vcGVyYXRpb25GdW5jcyYmKHRoaXMuX29wZXJhdGlvbkZ1bmNzPW5ldyBNYXApLHRoaXMuX29wZXJhdGlvbkZ1bmNzLnNldCh0LGUpfXN0YXRpYyBBZGRPcFRvTmF0aXZlRnVuYyh0LGUsbixpKXtpZihudWxsPT09dGhpcy5fbmF0aXZlRnVuY3Rpb25zKXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLl9uYXRpdmVGdW5jdGlvbnNcIik7bGV0IHI9dGhpcy5fbmF0aXZlRnVuY3Rpb25zLmdldCh0KTtyfHwocj1uZXcgUih0LGUpLHRoaXMuX25hdGl2ZUZ1bmN0aW9ucy5zZXQodCxyKSksci5BZGRPcEZ1bmNGb3JUeXBlKG4saSl9c3RhdGljIEFkZEludEJpbmFyeU9wKHQsZSl7dGhpcy5BZGRPcFRvTmF0aXZlRnVuYyh0LDIsaS5JbnQsZSl9c3RhdGljIEFkZEludFVuYXJ5T3AodCxlKXt0aGlzLkFkZE9wVG9OYXRpdmVGdW5jKHQsMSxpLkludCxlKX1zdGF0aWMgQWRkRmxvYXRCaW5hcnlPcCh0LGUpe3RoaXMuQWRkT3BUb05hdGl2ZUZ1bmModCwyLGkuRmxvYXQsZSl9c3RhdGljIEFkZEZsb2F0VW5hcnlPcCh0LGUpe3RoaXMuQWRkT3BUb05hdGl2ZUZ1bmModCwxLGkuRmxvYXQsZSl9c3RhdGljIEFkZFN0cmluZ0JpbmFyeU9wKHQsZSl7dGhpcy5BZGRPcFRvTmF0aXZlRnVuYyh0LDIsaS5TdHJpbmcsZSl9c3RhdGljIEFkZExpc3RCaW5hcnlPcCh0LGUpe3RoaXMuQWRkT3BUb05hdGl2ZUZ1bmModCwyLGkuTGlzdCxlKX1zdGF0aWMgQWRkTGlzdFVuYXJ5T3AodCxlKXt0aGlzLkFkZE9wVG9OYXRpdmVGdW5jKHQsMSxpLkxpc3QsZSl9dG9TdHJpbmcoKXtyZXR1cm4nTmF0aXZlIFwiJyt0aGlzLm5hbWUrJ1wiJ319Ui5BZGQ9XCIrXCIsUi5TdWJ0cmFjdD1cIi1cIixSLkRpdmlkZT1cIi9cIixSLk11bHRpcGx5PVwiKlwiLFIuTW9kPVwiJVwiLFIuTmVnYXRlPVwiX1wiLFIuRXF1YWw9XCI9PVwiLFIuR3JlYXRlcj1cIj5cIixSLkxlc3M9XCI8XCIsUi5HcmVhdGVyVGhhbk9yRXF1YWxzPVwiPj1cIixSLkxlc3NUaGFuT3JFcXVhbHM9XCI8PVwiLFIuTm90RXF1YWxzPVwiIT1cIixSLk5vdD1cIiFcIixSLkFuZD1cIiYmXCIsUi5Pcj1cInx8XCIsUi5NaW49XCJNSU5cIixSLk1heD1cIk1BWFwiLFIuUG93PVwiUE9XXCIsUi5GbG9vcj1cIkZMT09SXCIsUi5DZWlsaW5nPVwiQ0VJTElOR1wiLFIuSW50PVwiSU5UXCIsUi5GbG9hdD1cIkZMT0FUXCIsUi5IYXM9XCI/XCIsUi5IYXNudD1cIiE/XCIsUi5JbnRlcnNlY3Q9XCJeXCIsUi5MaXN0TWluPVwiTElTVF9NSU5cIixSLkxpc3RNYXg9XCJMSVNUX01BWFwiLFIuQWxsPVwiTElTVF9BTExcIixSLkNvdW50PVwiTElTVF9DT1VOVFwiLFIuVmFsdWVPZkxpc3Q9XCJMSVNUX1ZBTFVFXCIsUi5JbnZlcnQ9XCJMSVNUX0lOVkVSVFwiLFIuX25hdGl2ZUZ1bmN0aW9ucz1udWxsO2NsYXNzIGogZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy50ZXh0PXQudG9TdHJpbmcoKXx8XCJcIn10b1N0cmluZygpe3JldHVyblwiIyBcIit0aGlzLnRleHR9fWNsYXNzIEQgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLnRleHQ9XCJcIix0aGlzLmluZGV4PTAsdGhpcy50aHJlYWRBdEdlbmVyYXRpb249bnVsbCx0aGlzLnNvdXJjZVBhdGg9XCJcIix0aGlzLnRhcmdldFBhdGg9bnVsbCx0aGlzLmlzSW52aXNpYmxlRGVmYXVsdD0hMSx0aGlzLm9yaWdpbmFsVGhyZWFkSW5kZXg9MH1nZXQgcGF0aFN0cmluZ09uQ2hvaWNlKCl7cmV0dXJuIG51bGw9PT10aGlzLnRhcmdldFBhdGg/ZChcIkNob2ljZS50YXJnZXRQYXRoXCIpOnRoaXMudGFyZ2V0UGF0aC50b1N0cmluZygpfXNldCBwYXRoU3RyaW5nT25DaG9pY2UodCl7dGhpcy50YXJnZXRQYXRoPW5ldyBlKHQpfX1jbGFzcyBHe2NvbnN0cnVjdG9yKHQsZSl7dGhpcy5fbmFtZT10fHxcIlwiLHRoaXMuX2l0ZW1zPW51bGwsdGhpcy5faXRlbU5hbWVUb1ZhbHVlcz1lfHxuZXcgTWFwfWdldCBuYW1lKCl7cmV0dXJuIHRoaXMuX25hbWV9Z2V0IGl0ZW1zKCl7aWYobnVsbD09dGhpcy5faXRlbXMpe3RoaXMuX2l0ZW1zPW5ldyBNYXA7Zm9yKGxldFt0LGVdb2YgdGhpcy5faXRlbU5hbWVUb1ZhbHVlcyl7bGV0IG49bmV3IGYodGhpcy5uYW1lLHQpO3RoaXMuX2l0ZW1zLnNldChuLnNlcmlhbGl6ZWQoKSxlKX19cmV0dXJuIHRoaXMuX2l0ZW1zfVZhbHVlRm9ySXRlbSh0KXtpZighdC5pdGVtTmFtZSlyZXR1cm4gMDtsZXQgZT10aGlzLl9pdGVtTmFtZVRvVmFsdWVzLmdldCh0Lml0ZW1OYW1lKTtyZXR1cm4gdm9pZCAwIT09ZT9lOjB9Q29udGFpbnNJdGVtKHQpe3JldHVybiEhdC5pdGVtTmFtZSYmKHQub3JpZ2luTmFtZT09dGhpcy5uYW1lJiZ0aGlzLl9pdGVtTmFtZVRvVmFsdWVzLmhhcyh0Lml0ZW1OYW1lKSl9Q29udGFpbnNJdGVtV2l0aE5hbWUodCl7cmV0dXJuIHRoaXMuX2l0ZW1OYW1lVG9WYWx1ZXMuaGFzKHQpfVRyeUdldEl0ZW1XaXRoVmFsdWUodCxlKXtmb3IobGV0W2Usbl1vZiB0aGlzLl9pdGVtTmFtZVRvVmFsdWVzKWlmKG49PXQpcmV0dXJue3Jlc3VsdDpuZXcgZih0aGlzLm5hbWUsZSksZXhpc3RzOiEwfTtyZXR1cm57cmVzdWx0OmYuTnVsbCxleGlzdHM6ITF9fVRyeUdldFZhbHVlRm9ySXRlbSh0LGUpe2lmKCF0Lml0ZW1OYW1lKXJldHVybntyZXN1bHQ6MCxleGlzdHM6ITF9O2xldCBuPXRoaXMuX2l0ZW1OYW1lVG9WYWx1ZXMuZ2V0KHQuaXRlbU5hbWUpO3JldHVybiBuP3tyZXN1bHQ6bixleGlzdHM6ITB9OntyZXN1bHQ6MCxleGlzdHM6ITF9fX1jbGFzcyBCe2NvbnN0cnVjdG9yKHQpe3RoaXMuX2xpc3RzPW5ldyBNYXAsdGhpcy5fYWxsVW5hbWJpZ3VvdXNMaXN0VmFsdWVDYWNoZT1uZXcgTWFwO2ZvcihsZXQgZSBvZiB0KXt0aGlzLl9saXN0cy5zZXQoZS5uYW1lLGUpO2ZvcihsZXRbdCxuXW9mIGUuaXRlbXMpe2xldCBlPWYuZnJvbVNlcmlhbGl6ZWRLZXkodCksaT1uZXcgTyhlLG4pO2lmKCFlLml0ZW1OYW1lKXRocm93IG5ldyBFcnJvcihcIml0ZW0uaXRlbU5hbWUgaXMgbnVsbCBvciB1bmRlZmluZWQuXCIpO3RoaXMuX2FsbFVuYW1iaWd1b3VzTGlzdFZhbHVlQ2FjaGUuc2V0KGUuaXRlbU5hbWUsaSksdGhpcy5fYWxsVW5hbWJpZ3VvdXNMaXN0VmFsdWVDYWNoZS5zZXQoZS5mdWxsTmFtZSxpKX19fWdldCBsaXN0cygpe2xldCB0PVtdO2ZvcihsZXRbLGVdb2YgdGhpcy5fbGlzdHMpdC5wdXNoKGUpO3JldHVybiB0fVRyeUxpc3RHZXREZWZpbml0aW9uKHQsZSl7aWYobnVsbD09PXQpcmV0dXJue3Jlc3VsdDplLGV4aXN0czohMX07bGV0IG49dGhpcy5fbGlzdHMuZ2V0KHQpO3JldHVybiBuP3tyZXN1bHQ6bixleGlzdHM6ITB9OntyZXN1bHQ6ZSxleGlzdHM6ITF9fUZpbmRTaW5nbGVJdGVtTGlzdFdpdGhOYW1lKHQpe2lmKG51bGw9PT10KXJldHVybiBkKFwibmFtZVwiKTtsZXQgZT10aGlzLl9hbGxVbmFtYmlndW91c0xpc3RWYWx1ZUNhY2hlLmdldCh0KTtyZXR1cm4gdm9pZCAwIT09ZT9lOm51bGx9fWNsYXNzIE17c3RhdGljIEpBcnJheVRvUnVudGltZU9iakxpc3QodCxlPSExKXtsZXQgbj10Lmxlbmd0aDtlJiZuLS07bGV0IGk9W107Zm9yKGxldCBlPTA7ZTxuO2UrKyl7bGV0IG49dFtlXSxyPXRoaXMuSlRva2VuVG9SdW50aW1lT2JqZWN0KG4pO2lmKG51bGw9PT1yKXJldHVybiBkKFwicnVudGltZU9ialwiKTtpLnB1c2gocil9cmV0dXJuIGl9c3RhdGljIFdyaXRlRGljdGlvbmFyeVJ1bnRpbWVPYmpzKHQsZSl7dC5Xcml0ZU9iamVjdFN0YXJ0KCk7Zm9yKGxldFtuLGldb2YgZSl0LldyaXRlUHJvcGVydHlTdGFydChuKSx0aGlzLldyaXRlUnVudGltZU9iamVjdCh0LGkpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpO3QuV3JpdGVPYmplY3RFbmQoKX1zdGF0aWMgV3JpdGVMaXN0UnVudGltZU9ianModCxlKXt0LldyaXRlQXJyYXlTdGFydCgpO2ZvcihsZXQgbiBvZiBlKXRoaXMuV3JpdGVSdW50aW1lT2JqZWN0KHQsbik7dC5Xcml0ZUFycmF5RW5kKCl9c3RhdGljIFdyaXRlSW50RGljdGlvbmFyeSh0LGUpe3QuV3JpdGVPYmplY3RTdGFydCgpO2ZvcihsZXRbbixpXW9mIGUpdC5Xcml0ZUludFByb3BlcnR5KG4saSk7dC5Xcml0ZU9iamVjdEVuZCgpfXN0YXRpYyBXcml0ZVJ1bnRpbWVPYmplY3QodCxlKXtsZXQgbj1hKGUsTik7aWYobilyZXR1cm4gdm9pZCB0aGlzLldyaXRlUnVudGltZUNvbnRhaW5lcih0LG4pO2xldCBpPWEoZSxrKTtpZihpKXtsZXQgZSxuPVwiLT5cIjtyZXR1cm4gaS5pc0V4dGVybmFsP249XCJ4KClcIjppLnB1c2hlc1RvU3RhY2smJihpLnN0YWNrUHVzaFR5cGU9PXIuRnVuY3Rpb24/bj1cImYoKVwiOmkuc3RhY2tQdXNoVHlwZT09ci5UdW5uZWwmJihuPVwiLT50LT5cIikpLGU9aS5oYXNWYXJpYWJsZVRhcmdldD9pLnZhcmlhYmxlRGl2ZXJ0TmFtZTppLnRhcmdldFBhdGhTdHJpbmcsdC5Xcml0ZU9iamVjdFN0YXJ0KCksdC5Xcml0ZVByb3BlcnR5KG4sZSksaS5oYXNWYXJpYWJsZVRhcmdldCYmdC5Xcml0ZVByb3BlcnR5KFwidmFyXCIsITApLGkuaXNDb25kaXRpb25hbCYmdC5Xcml0ZVByb3BlcnR5KFwiY1wiLCEwKSxpLmV4dGVybmFsQXJncz4wJiZ0LldyaXRlSW50UHJvcGVydHkoXCJleEFyZ3NcIixpLmV4dGVybmFsQXJncyksdm9pZCB0LldyaXRlT2JqZWN0RW5kKCl9bGV0IHM9YShlLFcpO2lmKHMpcmV0dXJuIHQuV3JpdGVPYmplY3RTdGFydCgpLHQuV3JpdGVQcm9wZXJ0eShcIipcIixzLnBhdGhTdHJpbmdPbkNob2ljZSksdC5Xcml0ZUludFByb3BlcnR5KFwiZmxnXCIscy5mbGFncyksdm9pZCB0LldyaXRlT2JqZWN0RW5kKCk7bGV0IGw9YShlLGIpO2lmKGwpcmV0dXJuIHZvaWQgdC5Xcml0ZUludChsLnZhbHVlKTtsZXQgbz1hKGUsXyk7aWYobylyZXR1cm4gdm9pZCB0LldyaXRlRmxvYXQoby52YWx1ZSk7bGV0IHU9YShlLFQpO2lmKHUpcmV0dXJuIHZvaWQodS5pc05ld2xpbmU/dC5Xcml0ZShcIlxcblwiLCExKToodC5Xcml0ZVN0cmluZ1N0YXJ0KCksdC5Xcml0ZVN0cmluZ0lubmVyKFwiXlwiKSx0LldyaXRlU3RyaW5nSW5uZXIodS52YWx1ZSksdC5Xcml0ZVN0cmluZ0VuZCgpKSk7bGV0IGg9YShlLE8pO2lmKGgpcmV0dXJuIHZvaWQgdGhpcy5Xcml0ZUlua0xpc3QodCxoKTtsZXQgYz1hKGUsUCk7aWYoYylyZXR1cm4gdC5Xcml0ZU9iamVjdFN0YXJ0KCksbnVsbD09PWMudmFsdWU/ZChcImRpdlRhcmdldFZhbC52YWx1ZVwiKToodC5Xcml0ZVByb3BlcnR5KFwiXi0+XCIsYy52YWx1ZS5jb21wb25lbnRzU3RyaW5nKSx2b2lkIHQuV3JpdGVPYmplY3RFbmQoKSk7bGV0IHA9YShlLHcpO2lmKHApcmV0dXJuIHQuV3JpdGVPYmplY3RTdGFydCgpLHQuV3JpdGVQcm9wZXJ0eShcIl52YXJcIixwLnZhbHVlKSx0LldyaXRlSW50UHJvcGVydHkoXCJjaVwiLHAuY29udGV4dEluZGV4KSx2b2lkIHQuV3JpdGVPYmplY3RFbmQoKTtpZihhKGUseCkpcmV0dXJuIHZvaWQgdC5Xcml0ZShcIjw+XCIpO2xldCBtPWEoZSxBKTtpZihtKXJldHVybiB2b2lkIHQuV3JpdGUoTS5fY29udHJvbENvbW1hbmROYW1lc1ttLmNvbW1hbmRUeXBlXSk7bGV0IGY9YShlLFIpO2lmKGYpe2xldCBlPWYubmFtZTtyZXR1cm5cIl5cIj09ZSYmKGU9XCJMXlwiKSx2b2lkIHQuV3JpdGUoZSl9bGV0IGc9YShlLEYpO2lmKGcpe3QuV3JpdGVPYmplY3RTdGFydCgpO2xldCBlPWcucGF0aFN0cmluZ0ZvckNvdW50O3JldHVybiBudWxsIT1lP3QuV3JpdGVQcm9wZXJ0eShcIkNOVD9cIixlKTp0LldyaXRlUHJvcGVydHkoXCJWQVI/XCIsZy5uYW1lKSx2b2lkIHQuV3JpdGVPYmplY3RFbmQoKX1sZXQgUz1hKGUsVik7aWYoUyl7dC5Xcml0ZU9iamVjdFN0YXJ0KCk7bGV0IGU9Uy5pc0dsb2JhbD9cIlZBUj1cIjpcInRlbXA9XCI7cmV0dXJuIHQuV3JpdGVQcm9wZXJ0eShlLFMudmFyaWFibGVOYW1lKSxTLmlzTmV3RGVjbGFyYXRpb258fHQuV3JpdGVQcm9wZXJ0eShcInJlXCIsITApLHZvaWQgdC5Xcml0ZU9iamVjdEVuZCgpfWlmKGEoZSxMKSlyZXR1cm4gdm9pZCB0LldyaXRlKFwidm9pZFwiKTtsZXQgeT1hKGUsaik7aWYoeSlyZXR1cm4gdC5Xcml0ZU9iamVjdFN0YXJ0KCksdC5Xcml0ZVByb3BlcnR5KFwiI1wiLHkudGV4dCksdm9pZCB0LldyaXRlT2JqZWN0RW5kKCk7bGV0IEM9YShlLEQpO2lmKCFDKXRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBjb252ZXJ0IHJ1bnRpbWUgb2JqZWN0IHRvIEpzb24gdG9rZW46IFwiK2UpO3RoaXMuV3JpdGVDaG9pY2UodCxDKX1zdGF0aWMgSk9iamVjdFRvRGljdGlvbmFyeVJ1bnRpbWVPYmpzKHQpe2xldCBlPW5ldyBNYXA7Zm9yKGxldCBuIGluIHQpaWYodC5oYXNPd25Qcm9wZXJ0eShuKSl7bGV0IGk9dGhpcy5KVG9rZW5Ub1J1bnRpbWVPYmplY3QodFtuXSk7aWYobnVsbD09PWkpcmV0dXJuIGQoXCJpbmtPYmplY3RcIik7ZS5zZXQobixpKX1yZXR1cm4gZX1zdGF0aWMgSk9iamVjdFRvSW50RGljdGlvbmFyeSh0KXtsZXQgZT1uZXcgTWFwO2ZvcihsZXQgbiBpbiB0KXQuaGFzT3duUHJvcGVydHkobikmJmUuc2V0KG4scGFyc2VJbnQodFtuXSkpO3JldHVybiBlfXN0YXRpYyBKVG9rZW5Ub1J1bnRpbWVPYmplY3QodCl7aWYoXCJudW1iZXJcIj09dHlwZW9mIHQmJiFpc05hTih0KSlyZXR1cm4gdi5DcmVhdGUodCk7aWYoXCJzdHJpbmdcIj09dHlwZW9mIHQpe2xldCBlPXQudG9TdHJpbmcoKSxuPWVbMF07aWYoXCJeXCI9PW4pcmV0dXJuIG5ldyBUKGUuc3Vic3RyaW5nKDEpKTtpZihcIlxcblwiPT1uJiYxPT1lLmxlbmd0aClyZXR1cm4gbmV3IFQoXCJcXG5cIik7aWYoXCI8PlwiPT1lKXJldHVybiBuZXcgeDtmb3IobGV0IHQ9MDt0PE0uX2NvbnRyb2xDb21tYW5kTmFtZXMubGVuZ3RoOysrdCl7aWYoZT09TS5fY29udHJvbENvbW1hbmROYW1lc1t0XSlyZXR1cm4gbmV3IEEodCl9aWYoXCJMXlwiPT1lJiYoZT1cIl5cIiksUi5DYWxsRXhpc3RzV2l0aE5hbWUoZSkpcmV0dXJuIFIuQ2FsbFdpdGhOYW1lKGUpO2lmKFwiLT4tPlwiPT1lKXJldHVybiBBLlBvcFR1bm5lbCgpO2lmKFwifnJldFwiPT1lKXJldHVybiBBLlBvcEZ1bmN0aW9uKCk7aWYoXCJ2b2lkXCI9PWUpcmV0dXJuIG5ldyBMfWlmKFwib2JqZWN0XCI9PXR5cGVvZiB0JiYhQXJyYXkuaXNBcnJheSh0KSl7bGV0IG4saT10O2lmKGlbXCJeLT5cIl0pcmV0dXJuIG49aVtcIl4tPlwiXSxuZXcgUChuZXcgZShuLnRvU3RyaW5nKCkpKTtpZihpW1wiXnZhclwiXSl7bj1pW1wiXnZhclwiXTtsZXQgdD1uZXcgdyhuLnRvU3RyaW5nKCkpO3JldHVyblwiY2lcImluIGkmJihuPWkuY2ksdC5jb250ZXh0SW5kZXg9cGFyc2VJbnQobikpLHR9bGV0IGE9ITEscz0hMSxsPXIuRnVuY3Rpb24sbz0hMTtpZigobj1pW1wiLT5cIl0pP2E9ITA6KG49aVtcImYoKVwiXSk/KGE9ITAscz0hMCxsPXIuRnVuY3Rpb24pOihuPWlbXCItPnQtPlwiXSk/KGE9ITAscz0hMCxsPXIuVHVubmVsKToobj1pW1wieCgpXCJdKSYmKGE9ITAsbz0hMCxzPSExLGw9ci5GdW5jdGlvbiksYSl7bGV0IHQ9bmV3IGs7dC5wdXNoZXNUb1N0YWNrPXMsdC5zdGFja1B1c2hUeXBlPWwsdC5pc0V4dGVybmFsPW87bGV0IGU9bi50b1N0cmluZygpO3JldHVybihuPWkudmFyKT90LnZhcmlhYmxlRGl2ZXJ0TmFtZT1lOnQudGFyZ2V0UGF0aFN0cmluZz1lLHQuaXNDb25kaXRpb25hbD0hIWkuYyxvJiYobj1pLmV4QXJncykmJih0LmV4dGVybmFsQXJncz1wYXJzZUludChuKSksdH1pZihuPWlbXCIqXCJdKXtsZXQgdD1uZXcgVztyZXR1cm4gdC5wYXRoU3RyaW5nT25DaG9pY2U9bi50b1N0cmluZygpLChuPWkuZmxnKSYmKHQuZmxhZ3M9cGFyc2VJbnQobikpLHR9aWYobj1pW1wiVkFSP1wiXSlyZXR1cm4gbmV3IEYobi50b1N0cmluZygpKTtpZihuPWlbXCJDTlQ/XCJdKXtsZXQgdD1uZXcgRjtyZXR1cm4gdC5wYXRoU3RyaW5nRm9yQ291bnQ9bi50b1N0cmluZygpLHR9bGV0IHU9ITEsaD0hMTtpZigobj1pW1wiVkFSPVwiXSk/KHU9ITAsaD0hMCk6KG49aVtcInRlbXA9XCJdKSYmKHU9ITAsaD0hMSksdSl7bGV0IHQ9bi50b1N0cmluZygpLGU9IWkucmUscj1uZXcgVih0LGUpO3JldHVybiByLmlzR2xvYmFsPWgscn1pZih2b2lkIDAhPT1pW1wiI1wiXSlyZXR1cm4gbj1pW1wiI1wiXSxuZXcgaihuLnRvU3RyaW5nKCkpO2lmKG49aS5saXN0KXtsZXQgdD1uLGU9bmV3IGc7aWYobj1pLm9yaWdpbnMpe2xldCB0PW47ZS5TZXRJbml0aWFsT3JpZ2luTmFtZXModCl9Zm9yKGxldCBuIGluIHQpaWYodC5oYXNPd25Qcm9wZXJ0eShuKSl7bGV0IGk9dFtuXSxyPW5ldyBmKG4pLGE9cGFyc2VJbnQoaSk7ZS5BZGQocixhKX1yZXR1cm4gbmV3IE8oZSl9aWYobnVsbCE9aS5vcmlnaW5hbENob2ljZVBhdGgpcmV0dXJuIHRoaXMuSk9iamVjdFRvQ2hvaWNlKGkpfWlmKEFycmF5LmlzQXJyYXkodCkpcmV0dXJuIHRoaXMuSkFycmF5VG9Db250YWluZXIodCk7aWYobnVsbD09dClyZXR1cm4gbnVsbDt0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gY29udmVydCB0b2tlbiB0byBydW50aW1lIG9iamVjdDogXCIrSlNPTi5zdHJpbmdpZnkodCkpfXN0YXRpYyBXcml0ZVJ1bnRpbWVDb250YWluZXIodCxlLG49ITEpe2lmKHQuV3JpdGVBcnJheVN0YXJ0KCksbnVsbD09PWUpcmV0dXJuIGQoXCJjb250YWluZXJcIik7Zm9yKGxldCBuIG9mIGUuY29udGVudCl0aGlzLldyaXRlUnVudGltZU9iamVjdCh0LG4pO2xldCBpPWUubmFtZWRPbmx5Q29udGVudCxyPWUuY291bnRGbGFncyxzPW51bGwhPWUubmFtZSYmIW4sbD1udWxsIT1pfHxyPjB8fHM7aWYobCYmdC5Xcml0ZU9iamVjdFN0YXJ0KCksbnVsbCE9aSlmb3IobGV0W2Usbl1vZiBpKXtsZXQgaT1lLHI9YShuLE4pO3QuV3JpdGVQcm9wZXJ0eVN0YXJ0KGkpLHRoaXMuV3JpdGVSdW50aW1lQ29udGFpbmVyKHQsciwhMCksdC5Xcml0ZVByb3BlcnR5RW5kKCl9cyYmdC5Xcml0ZVByb3BlcnR5KFwiI25cIixlLm5hbWUpLGw/dC5Xcml0ZU9iamVjdEVuZCgpOnQuV3JpdGVOdWxsKCksdC5Xcml0ZUFycmF5RW5kKCl9c3RhdGljIEpBcnJheVRvQ29udGFpbmVyKHQpe2xldCBlPW5ldyBOO2UuY29udGVudD10aGlzLkpBcnJheVRvUnVudGltZU9iakxpc3QodCwhMCk7bGV0IG49dFt0Lmxlbmd0aC0xXTtpZihudWxsIT1uKXtsZXQgdD1uZXcgTWFwO2ZvcihsZXQgaSBpbiBuKWlmKFwiI2ZcIj09aSllLmNvdW50RmxhZ3M9cGFyc2VJbnQobltpXSk7ZWxzZSBpZihcIiNuXCI9PWkpZS5uYW1lPW5baV0udG9TdHJpbmcoKTtlbHNle2xldCBlPXRoaXMuSlRva2VuVG9SdW50aW1lT2JqZWN0KG5baV0pLHI9YShlLE4pO3ImJihyLm5hbWU9aSksdC5zZXQoaSxlKX1lLm5hbWVkT25seUNvbnRlbnQ9dH1yZXR1cm4gZX1zdGF0aWMgSk9iamVjdFRvQ2hvaWNlKHQpe2xldCBlPW5ldyBEO3JldHVybiBlLnRleHQ9dC50ZXh0LnRvU3RyaW5nKCksZS5pbmRleD1wYXJzZUludCh0LmluZGV4KSxlLnNvdXJjZVBhdGg9dC5vcmlnaW5hbENob2ljZVBhdGgudG9TdHJpbmcoKSxlLm9yaWdpbmFsVGhyZWFkSW5kZXg9cGFyc2VJbnQodC5vcmlnaW5hbFRocmVhZEluZGV4KSxlLnBhdGhTdHJpbmdPbkNob2ljZT10LnRhcmdldFBhdGgudG9TdHJpbmcoKSxlfXN0YXRpYyBXcml0ZUNob2ljZSh0LGUpe3QuV3JpdGVPYmplY3RTdGFydCgpLHQuV3JpdGVQcm9wZXJ0eShcInRleHRcIixlLnRleHQpLHQuV3JpdGVJbnRQcm9wZXJ0eShcImluZGV4XCIsZS5pbmRleCksdC5Xcml0ZVByb3BlcnR5KFwib3JpZ2luYWxDaG9pY2VQYXRoXCIsZS5zb3VyY2VQYXRoKSx0LldyaXRlSW50UHJvcGVydHkoXCJvcmlnaW5hbFRocmVhZEluZGV4XCIsZS5vcmlnaW5hbFRocmVhZEluZGV4KSx0LldyaXRlUHJvcGVydHkoXCJ0YXJnZXRQYXRoXCIsZS5wYXRoU3RyaW5nT25DaG9pY2UpLHQuV3JpdGVPYmplY3RFbmQoKX1zdGF0aWMgV3JpdGVJbmtMaXN0KHQsZSl7bGV0IG49ZS52YWx1ZTtpZihudWxsPT09bilyZXR1cm4gZChcInJhd0xpc3RcIik7dC5Xcml0ZU9iamVjdFN0YXJ0KCksdC5Xcml0ZVByb3BlcnR5U3RhcnQoXCJsaXN0XCIpLHQuV3JpdGVPYmplY3RTdGFydCgpO2ZvcihsZXRbZSxpXW9mIG4pe2xldCBuPWYuZnJvbVNlcmlhbGl6ZWRLZXkoZSkscj1pO2lmKG51bGw9PT1uLml0ZW1OYW1lKXJldHVybiBkKFwiaXRlbS5pdGVtTmFtZVwiKTt0LldyaXRlUHJvcGVydHlOYW1lU3RhcnQoKSx0LldyaXRlUHJvcGVydHlOYW1lSW5uZXIobi5vcmlnaW5OYW1lP24ub3JpZ2luTmFtZTpcIj9cIiksdC5Xcml0ZVByb3BlcnR5TmFtZUlubmVyKFwiLlwiKSx0LldyaXRlUHJvcGVydHlOYW1lSW5uZXIobi5pdGVtTmFtZSksdC5Xcml0ZVByb3BlcnR5TmFtZUVuZCgpLHQuV3JpdGUociksdC5Xcml0ZVByb3BlcnR5RW5kKCl9aWYodC5Xcml0ZU9iamVjdEVuZCgpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpLDA9PW4uQ291bnQmJm51bGwhPW4ub3JpZ2luTmFtZXMmJm4ub3JpZ2luTmFtZXMubGVuZ3RoPjApe3QuV3JpdGVQcm9wZXJ0eVN0YXJ0KFwib3JpZ2luc1wiKSx0LldyaXRlQXJyYXlTdGFydCgpO2ZvcihsZXQgZSBvZiBuLm9yaWdpbk5hbWVzKXQuV3JpdGUoZSk7dC5Xcml0ZUFycmF5RW5kKCksdC5Xcml0ZVByb3BlcnR5RW5kKCl9dC5Xcml0ZU9iamVjdEVuZCgpfXN0YXRpYyBMaXN0RGVmaW5pdGlvbnNUb0pUb2tlbih0KXtsZXQgZT17fTtmb3IobGV0IG4gb2YgdC5saXN0cyl7bGV0IHQ9e307Zm9yKGxldFtlLGldb2Ygbi5pdGVtcyl7bGV0IG49Zi5mcm9tU2VyaWFsaXplZEtleShlKTtpZihudWxsPT09bi5pdGVtTmFtZSlyZXR1cm4gZChcIml0ZW0uaXRlbU5hbWVcIik7dFtuLml0ZW1OYW1lXT1pfWVbbi5uYW1lXT10fXJldHVybiBlfXN0YXRpYyBKVG9rZW5Ub0xpc3REZWZpbml0aW9ucyh0KXtsZXQgZT10LG49W107Zm9yKGxldCB0IGluIGUpaWYoZS5oYXNPd25Qcm9wZXJ0eSh0KSl7bGV0IGk9dC50b1N0cmluZygpLHI9ZVt0XSxhPW5ldyBNYXA7Zm9yKGxldCBuIGluIHIpaWYoZS5oYXNPd25Qcm9wZXJ0eSh0KSl7bGV0IHQ9cltuXTthLnNldChuLHBhcnNlSW50KHQpKX1sZXQgcz1uZXcgRyhpLGEpO24ucHVzaChzKX1yZXR1cm4gbmV3IEIobil9fU0uX2NvbnRyb2xDb21tYW5kTmFtZXM9KCgpPT57bGV0IHQ9W107dFtBLkNvbW1hbmRUeXBlLkV2YWxTdGFydF09XCJldlwiLHRbQS5Db21tYW5kVHlwZS5FdmFsT3V0cHV0XT1cIm91dFwiLHRbQS5Db21tYW5kVHlwZS5FdmFsRW5kXT1cIi9ldlwiLHRbQS5Db21tYW5kVHlwZS5EdXBsaWNhdGVdPVwiZHVcIix0W0EuQ29tbWFuZFR5cGUuUG9wRXZhbHVhdGVkVmFsdWVdPVwicG9wXCIsdFtBLkNvbW1hbmRUeXBlLlBvcEZ1bmN0aW9uXT1cIn5yZXRcIix0W0EuQ29tbWFuZFR5cGUuUG9wVHVubmVsXT1cIi0+LT5cIix0W0EuQ29tbWFuZFR5cGUuQmVnaW5TdHJpbmddPVwic3RyXCIsdFtBLkNvbW1hbmRUeXBlLkVuZFN0cmluZ109XCIvc3RyXCIsdFtBLkNvbW1hbmRUeXBlLk5vT3BdPVwibm9wXCIsdFtBLkNvbW1hbmRUeXBlLkNob2ljZUNvdW50XT1cImNob2ljZUNudFwiLHRbQS5Db21tYW5kVHlwZS5UdXJuc109XCJ0dXJuXCIsdFtBLkNvbW1hbmRUeXBlLlR1cm5zU2luY2VdPVwidHVybnNcIix0W0EuQ29tbWFuZFR5cGUuUmVhZENvdW50XT1cInJlYWRjXCIsdFtBLkNvbW1hbmRUeXBlLlJhbmRvbV09XCJybmRcIix0W0EuQ29tbWFuZFR5cGUuU2VlZFJhbmRvbV09XCJzcm5kXCIsdFtBLkNvbW1hbmRUeXBlLlZpc2l0SW5kZXhdPVwidmlzaXRcIix0W0EuQ29tbWFuZFR5cGUuU2VxdWVuY2VTaHVmZmxlSW5kZXhdPVwic2VxXCIsdFtBLkNvbW1hbmRUeXBlLlN0YXJ0VGhyZWFkXT1cInRocmVhZFwiLHRbQS5Db21tYW5kVHlwZS5Eb25lXT1cImRvbmVcIix0W0EuQ29tbWFuZFR5cGUuRW5kXT1cImVuZFwiLHRbQS5Db21tYW5kVHlwZS5MaXN0RnJvbUludF09XCJsaXN0SW50XCIsdFtBLkNvbW1hbmRUeXBlLkxpc3RSYW5nZV09XCJyYW5nZVwiLHRbQS5Db21tYW5kVHlwZS5MaXN0UmFuZG9tXT1cImxybmRcIjtmb3IobGV0IGU9MDtlPEEuQ29tbWFuZFR5cGUuVE9UQUxfVkFMVUVTOysrZSlpZihudWxsPT10W2VdKXRocm93IG5ldyBFcnJvcihcIkNvbnRyb2wgY29tbWFuZCBub3QgYWNjb3VudGVkIGZvciBpbiBzZXJpYWxpc2F0aW9uXCIpO3JldHVybiB0fSkoKTtjbGFzcyBxe2NvbnN0cnVjdG9yKCl7aWYodGhpcy5fdGhyZWFkQ291bnRlcj0wLHRoaXMuX3N0YXJ0T2ZSb290PUkuTnVsbCxhcmd1bWVudHNbMF1pbnN0YW5jZW9mIFgpe2xldCB0PWFyZ3VtZW50c1swXTt0aGlzLl9zdGFydE9mUm9vdD1JLlN0YXJ0T2YodC5yb290Q29udGVudENvbnRhaW5lciksdGhpcy5SZXNldCgpfWVsc2V7bGV0IHQ9YXJndW1lbnRzWzBdO3RoaXMuX3RocmVhZHM9W107Zm9yKGxldCBlIG9mIHQuX3RocmVhZHMpdGhpcy5fdGhyZWFkcy5wdXNoKGUuQ29weSgpKTt0aGlzLl90aHJlYWRDb3VudGVyPXQuX3RocmVhZENvdW50ZXIsdGhpcy5fc3RhcnRPZlJvb3Q9dC5fc3RhcnRPZlJvb3R9fWdldCBlbGVtZW50cygpe3JldHVybiB0aGlzLmNhbGxTdGFja31nZXQgZGVwdGgoKXtyZXR1cm4gdGhpcy5lbGVtZW50cy5sZW5ndGh9Z2V0IGN1cnJlbnRFbGVtZW50KCl7bGV0IHQ9dGhpcy5fdGhyZWFkc1t0aGlzLl90aHJlYWRzLmxlbmd0aC0xXS5jYWxsc3RhY2s7cmV0dXJuIHRbdC5sZW5ndGgtMV19Z2V0IGN1cnJlbnRFbGVtZW50SW5kZXgoKXtyZXR1cm4gdGhpcy5jYWxsU3RhY2subGVuZ3RoLTF9Z2V0IGN1cnJlbnRUaHJlYWQoKXtyZXR1cm4gdGhpcy5fdGhyZWFkc1t0aGlzLl90aHJlYWRzLmxlbmd0aC0xXX1zZXQgY3VycmVudFRocmVhZCh0KXtuLkFzc2VydCgxPT10aGlzLl90aHJlYWRzLmxlbmd0aCxcIlNob3VsZG4ndCBiZSBkaXJlY3RseSBzZXR0aW5nIHRoZSBjdXJyZW50IHRocmVhZCB3aGVuIHdlIGhhdmUgYSBzdGFjayBvZiB0aGVtXCIpLHRoaXMuX3RocmVhZHMubGVuZ3RoPTAsdGhpcy5fdGhyZWFkcy5wdXNoKHQpfWdldCBjYW5Qb3AoKXtyZXR1cm4gdGhpcy5jYWxsU3RhY2subGVuZ3RoPjF9UmVzZXQoKXt0aGlzLl90aHJlYWRzPVtdLHRoaXMuX3RocmVhZHMucHVzaChuZXcgcS5UaHJlYWQpLHRoaXMuX3RocmVhZHNbMF0uY2FsbHN0YWNrLnB1c2gobmV3IHEuRWxlbWVudChyLlR1bm5lbCx0aGlzLl9zdGFydE9mUm9vdCkpfVNldEpzb25Ub2tlbih0LGUpe3RoaXMuX3RocmVhZHMubGVuZ3RoPTA7bGV0IG49dC50aHJlYWRzO2ZvcihsZXQgdCBvZiBuKXtsZXQgbj10LGk9bmV3IHEuVGhyZWFkKG4sZSk7dGhpcy5fdGhyZWFkcy5wdXNoKGkpfXRoaXMuX3RocmVhZENvdW50ZXI9cGFyc2VJbnQodC50aHJlYWRDb3VudGVyKSx0aGlzLl9zdGFydE9mUm9vdD1JLlN0YXJ0T2YoZS5yb290Q29udGVudENvbnRhaW5lcil9V3JpdGVKc29uKHQpe3QuV3JpdGVPYmplY3QodD0+e3QuV3JpdGVQcm9wZXJ0eVN0YXJ0KFwidGhyZWFkc1wiKSx0LldyaXRlQXJyYXlTdGFydCgpO2ZvcihsZXQgZSBvZiB0aGlzLl90aHJlYWRzKWUuV3JpdGVKc29uKHQpO3QuV3JpdGVBcnJheUVuZCgpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpLHQuV3JpdGVQcm9wZXJ0eVN0YXJ0KFwidGhyZWFkQ291bnRlclwiKSx0LldyaXRlSW50KHRoaXMuX3RocmVhZENvdW50ZXIpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpfSl9UHVzaFRocmVhZCgpe2xldCB0PXRoaXMuY3VycmVudFRocmVhZC5Db3B5KCk7dGhpcy5fdGhyZWFkQ291bnRlcisrLHQudGhyZWFkSW5kZXg9dGhpcy5fdGhyZWFkQ291bnRlcix0aGlzLl90aHJlYWRzLnB1c2godCl9Rm9ya1RocmVhZCgpe2xldCB0PXRoaXMuY3VycmVudFRocmVhZC5Db3B5KCk7cmV0dXJuIHRoaXMuX3RocmVhZENvdW50ZXIrKyx0LnRocmVhZEluZGV4PXRoaXMuX3RocmVhZENvdW50ZXIsdH1Qb3BUaHJlYWQoKXtpZighdGhpcy5jYW5Qb3BUaHJlYWQpdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgcG9wIHRocmVhZFwiKTt0aGlzLl90aHJlYWRzLnNwbGljZSh0aGlzLl90aHJlYWRzLmluZGV4T2YodGhpcy5jdXJyZW50VGhyZWFkKSwxKX1nZXQgY2FuUG9wVGhyZWFkKCl7cmV0dXJuIHRoaXMuX3RocmVhZHMubGVuZ3RoPjEmJiF0aGlzLmVsZW1lbnRJc0V2YWx1YXRlRnJvbUdhbWV9Z2V0IGVsZW1lbnRJc0V2YWx1YXRlRnJvbUdhbWUoKXtyZXR1cm4gdGhpcy5jdXJyZW50RWxlbWVudC50eXBlPT1yLkZ1bmN0aW9uRXZhbHVhdGlvbkZyb21HYW1lfVB1c2godCxlPTAsbj0wKXtsZXQgaT1uZXcgcS5FbGVtZW50KHQsdGhpcy5jdXJyZW50RWxlbWVudC5jdXJyZW50UG9pbnRlciwhMSk7aS5ldmFsdWF0aW9uU3RhY2tIZWlnaHRXaGVuUHVzaGVkPWUsaS5mdW5jdGlvblN0YXJ0SW5PdXRwdXRTdHJlYW09bix0aGlzLmNhbGxTdGFjay5wdXNoKGkpfUNhblBvcCh0PW51bGwpe3JldHVybiEhdGhpcy5jYW5Qb3AmJihudWxsPT10fHx0aGlzLmN1cnJlbnRFbGVtZW50LnR5cGU9PXQpfVBvcCh0PW51bGwpe2lmKCF0aGlzLkNhblBvcCh0KSl0aHJvdyBuZXcgRXJyb3IoXCJNaXNtYXRjaGVkIHB1c2gvcG9wIGluIENhbGxzdGFja1wiKTt0aGlzLmNhbGxTdGFjay5wb3AoKX1HZXRUZW1wb3JhcnlWYXJpYWJsZVdpdGhOYW1lKHQsZT0tMSl7LTE9PWUmJihlPXRoaXMuY3VycmVudEVsZW1lbnRJbmRleCsxKTtsZXQgbj15KHRoaXMuY2FsbFN0YWNrW2UtMV0udGVtcG9yYXJ5VmFyaWFibGVzLHQsbnVsbCk7cmV0dXJuIG4uZXhpc3RzP24ucmVzdWx0Om51bGx9U2V0VGVtcG9yYXJ5VmFyaWFibGUodCxlLG4saT0tMSl7LTE9PWkmJihpPXRoaXMuY3VycmVudEVsZW1lbnRJbmRleCsxKTtsZXQgcj10aGlzLmNhbGxTdGFja1tpLTFdO2lmKCFuJiYhci50ZW1wb3JhcnlWYXJpYWJsZXMuZ2V0KHQpKXRocm93IG5ldyBTKFwiQ291bGQgbm90IGZpbmQgdGVtcG9yYXJ5IHZhcmlhYmxlIHRvIHNldDogXCIrdCk7bGV0IGE9eShyLnRlbXBvcmFyeVZhcmlhYmxlcyx0LG51bGwpO2EuZXhpc3RzJiZPLlJldGFpbkxpc3RPcmlnaW5zRm9yQXNzaWdubWVudChhLnJlc3VsdCxlKSxyLnRlbXBvcmFyeVZhcmlhYmxlcy5zZXQodCxlKX1Db250ZXh0Rm9yVmFyaWFibGVOYW1lZCh0KXtyZXR1cm4gdGhpcy5jdXJyZW50RWxlbWVudC50ZW1wb3JhcnlWYXJpYWJsZXMuZ2V0KHQpP3RoaXMuY3VycmVudEVsZW1lbnRJbmRleCsxOjB9VGhyZWFkV2l0aEluZGV4KHQpe2xldCBlPXRoaXMuX3RocmVhZHMuZmlsdGVyKGU9PntpZihlLnRocmVhZEluZGV4PT10KXJldHVybiBlfSk7cmV0dXJuIGUubGVuZ3RoPjA/ZVswXTpudWxsfWdldCBjYWxsU3RhY2soKXtyZXR1cm4gdGhpcy5jdXJyZW50VGhyZWFkLmNhbGxzdGFja31nZXQgY2FsbFN0YWNrVHJhY2UoKXtsZXQgdD1uZXcgbTtmb3IobGV0IGU9MDtlPHRoaXMuX3RocmVhZHMubGVuZ3RoO2UrKyl7bGV0IG49dGhpcy5fdGhyZWFkc1tlXSxpPWU9PXRoaXMuX3RocmVhZHMubGVuZ3RoLTE7dC5BcHBlbmRGb3JtYXQoXCI9PT0gVEhSRUFEIHswfS97MX0gezJ9PT09XFxuXCIsZSsxLHRoaXMuX3RocmVhZHMubGVuZ3RoLGk/XCIoY3VycmVudCkgXCI6XCJcIik7Zm9yKGxldCBlPTA7ZTxuLmNhbGxzdGFjay5sZW5ndGg7ZSsrKXtuLmNhbGxzdGFja1tlXS50eXBlPT1yLkZ1bmN0aW9uP3QuQXBwZW5kKFwiICBbRlVOQ1RJT05dIFwiKTp0LkFwcGVuZChcIiAgW1RVTk5FTF0gXCIpO2xldCBpPW4uY2FsbHN0YWNrW2VdLmN1cnJlbnRQb2ludGVyO2lmKCFpLmlzTnVsbCl7aWYodC5BcHBlbmQoXCI8U09NRVdIRVJFIElOIFwiKSxudWxsPT09aS5jb250YWluZXIpcmV0dXJuIGQoXCJwb2ludGVyLmNvbnRhaW5lclwiKTt0LkFwcGVuZChpLmNvbnRhaW5lci5wYXRoLnRvU3RyaW5nKCkpLHQuQXBwZW5kTGluZShcIj5cIil9fX1yZXR1cm4gdC50b1N0cmluZygpfX0hZnVuY3Rpb24odCl7Y2xhc3Mgbntjb25zdHJ1Y3Rvcih0LGUsbj0hMSl7dGhpcy5ldmFsdWF0aW9uU3RhY2tIZWlnaHRXaGVuUHVzaGVkPTAsdGhpcy5mdW5jdGlvblN0YXJ0SW5PdXRwdXRTdHJlYW09MCx0aGlzLmN1cnJlbnRQb2ludGVyPWUuY29weSgpLHRoaXMuaW5FeHByZXNzaW9uRXZhbHVhdGlvbj1uLHRoaXMudGVtcG9yYXJ5VmFyaWFibGVzPW5ldyBNYXAsdGhpcy50eXBlPXR9Q29weSgpe2xldCB0PW5ldyBuKHRoaXMudHlwZSx0aGlzLmN1cnJlbnRQb2ludGVyLHRoaXMuaW5FeHByZXNzaW9uRXZhbHVhdGlvbik7cmV0dXJuIHQudGVtcG9yYXJ5VmFyaWFibGVzPW5ldyBNYXAodGhpcy50ZW1wb3JhcnlWYXJpYWJsZXMpLHQuZXZhbHVhdGlvblN0YWNrSGVpZ2h0V2hlblB1c2hlZD10aGlzLmV2YWx1YXRpb25TdGFja0hlaWdodFdoZW5QdXNoZWQsdC5mdW5jdGlvblN0YXJ0SW5PdXRwdXRTdHJlYW09dGhpcy5mdW5jdGlvblN0YXJ0SW5PdXRwdXRTdHJlYW0sdH19dC5FbGVtZW50PW47Y2xhc3MgaXtjb25zdHJ1Y3Rvcigpe2lmKHRoaXMudGhyZWFkSW5kZXg9MCx0aGlzLnByZXZpb3VzUG9pbnRlcj1JLk51bGwsdGhpcy5jYWxsc3RhY2s9W10sYXJndW1lbnRzWzBdJiZhcmd1bWVudHNbMV0pe2xldCB0PWFyZ3VtZW50c1swXSxpPWFyZ3VtZW50c1sxXTt0aGlzLnRocmVhZEluZGV4PXBhcnNlSW50KHQudGhyZWFkSW5kZXgpO2xldCByPXQuY2FsbHN0YWNrO2ZvcihsZXQgdCBvZiByKXtsZXQgcixhPXQscz1wYXJzZUludChhLnR5cGUpLGw9SS5OdWxsLG89YS5jUGF0aDtpZih2b2lkIDAhPT1vKXtyPW8udG9TdHJpbmcoKTtsZXQgdD1pLkNvbnRlbnRBdFBhdGgobmV3IGUocikpO2lmKGwuY29udGFpbmVyPXQuY29udGFpbmVyLGwuaW5kZXg9cGFyc2VJbnQoYS5pZHgpLG51bGw9PXQub2JqKXRocm93IG5ldyBFcnJvcihcIldoZW4gbG9hZGluZyBzdGF0ZSwgaW50ZXJuYWwgc3RvcnkgbG9jYXRpb24gY291bGRuJ3QgYmUgZm91bmQ6IFwiK3IrXCIuIEhhcyB0aGUgc3RvcnkgY2hhbmdlZCBzaW5jZSB0aGlzIHNhdmUgZGF0YSB3YXMgY3JlYXRlZD9cIik7aWYodC5hcHByb3hpbWF0ZSl7aWYobnVsbD09PWwuY29udGFpbmVyKXJldHVybiBkKFwicG9pbnRlci5jb250YWluZXJcIik7aS5XYXJuaW5nKFwiV2hlbiBsb2FkaW5nIHN0YXRlLCBleGFjdCBpbnRlcm5hbCBzdG9yeSBsb2NhdGlvbiBjb3VsZG4ndCBiZSBmb3VuZDogJ1wiK3IrXCInLCBzbyBpdCB3YXMgYXBwcm94aW1hdGVkIHRvICdcIitsLmNvbnRhaW5lci5wYXRoLnRvU3RyaW5nKCkrXCInIHRvIHJlY292ZXIuIEhhcyB0aGUgc3RvcnkgY2hhbmdlZCBzaW5jZSB0aGlzIHNhdmUgZGF0YSB3YXMgY3JlYXRlZD9cIil9fWxldCB1PSEhYS5leHAsaD1uZXcgbihzLGwsdSksYz1hLnRlbXA7dm9pZCAwIT09Yz9oLnRlbXBvcmFyeVZhcmlhYmxlcz1NLkpPYmplY3RUb0RpY3Rpb25hcnlSdW50aW1lT2JqcyhjKTpoLnRlbXBvcmFyeVZhcmlhYmxlcy5jbGVhcigpLHRoaXMuY2FsbHN0YWNrLnB1c2goaCl9bGV0IGE9dC5wcmV2aW91c0NvbnRlbnRPYmplY3Q7aWYodm9pZCAwIT09YSl7bGV0IHQ9bmV3IGUoYS50b1N0cmluZygpKTt0aGlzLnByZXZpb3VzUG9pbnRlcj1pLlBvaW50ZXJBdFBhdGgodCl9fX1Db3B5KCl7bGV0IHQ9bmV3IGk7dC50aHJlYWRJbmRleD10aGlzLnRocmVhZEluZGV4O2ZvcihsZXQgZSBvZiB0aGlzLmNhbGxzdGFjayl0LmNhbGxzdGFjay5wdXNoKGUuQ29weSgpKTtyZXR1cm4gdC5wcmV2aW91c1BvaW50ZXI9dGhpcy5wcmV2aW91c1BvaW50ZXIuY29weSgpLHR9V3JpdGVKc29uKHQpe3QuV3JpdGVPYmplY3RTdGFydCgpLHQuV3JpdGVQcm9wZXJ0eVN0YXJ0KFwiY2FsbHN0YWNrXCIpLHQuV3JpdGVBcnJheVN0YXJ0KCk7Zm9yKGxldCBlIG9mIHRoaXMuY2FsbHN0YWNrKXtpZih0LldyaXRlT2JqZWN0U3RhcnQoKSwhZS5jdXJyZW50UG9pbnRlci5pc051bGwpe2lmKG51bGw9PT1lLmN1cnJlbnRQb2ludGVyLmNvbnRhaW5lcilyZXR1cm4gZChcImVsLmN1cnJlbnRQb2ludGVyLmNvbnRhaW5lclwiKTt0LldyaXRlUHJvcGVydHkoXCJjUGF0aFwiLGUuY3VycmVudFBvaW50ZXIuY29udGFpbmVyLnBhdGguY29tcG9uZW50c1N0cmluZyksdC5Xcml0ZUludFByb3BlcnR5KFwiaWR4XCIsZS5jdXJyZW50UG9pbnRlci5pbmRleCl9dC5Xcml0ZVByb3BlcnR5KFwiZXhwXCIsZS5pbkV4cHJlc3Npb25FdmFsdWF0aW9uKSx0LldyaXRlSW50UHJvcGVydHkoXCJ0eXBlXCIsZS50eXBlKSxlLnRlbXBvcmFyeVZhcmlhYmxlcy5zaXplPjAmJih0LldyaXRlUHJvcGVydHlTdGFydChcInRlbXBcIiksTS5Xcml0ZURpY3Rpb25hcnlSdW50aW1lT2Jqcyh0LGUudGVtcG9yYXJ5VmFyaWFibGVzKSx0LldyaXRlUHJvcGVydHlFbmQoKSksdC5Xcml0ZU9iamVjdEVuZCgpfWlmKHQuV3JpdGVBcnJheUVuZCgpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpLHQuV3JpdGVJbnRQcm9wZXJ0eShcInRocmVhZEluZGV4XCIsdGhpcy50aHJlYWRJbmRleCksIXRoaXMucHJldmlvdXNQb2ludGVyLmlzTnVsbCl7bGV0IGU9dGhpcy5wcmV2aW91c1BvaW50ZXIuUmVzb2x2ZSgpO2lmKG51bGw9PT1lKXJldHVybiBkKFwidGhpcy5wcmV2aW91c1BvaW50ZXIuUmVzb2x2ZSgpXCIpO3QuV3JpdGVQcm9wZXJ0eShcInByZXZpb3VzQ29udGVudE9iamVjdFwiLGUucGF0aC50b1N0cmluZygpKX10LldyaXRlT2JqZWN0RW5kKCl9fXQuVGhyZWFkPWl9KHF8fChxPXt9KSk7Y2xhc3MgSntjb25zdHJ1Y3Rvcih0LGUpe3RoaXMudmFyaWFibGVDaGFuZ2VkRXZlbnRDYWxsYmFja3M9W10sdGhpcy5wYXRjaD1udWxsLHRoaXMuX2JhdGNoT2JzZXJ2aW5nVmFyaWFibGVDaGFuZ2VzPSExLHRoaXMuX2RlZmF1bHRHbG9iYWxWYXJpYWJsZXM9bmV3IE1hcCx0aGlzLl9jaGFuZ2VkVmFyaWFibGVzRm9yQmF0Y2hPYnM9bmV3IFNldCx0aGlzLl9nbG9iYWxWYXJpYWJsZXM9bmV3IE1hcCx0aGlzLl9jYWxsU3RhY2s9dCx0aGlzLl9saXN0RGVmc09yaWdpbj1lO3RyeXtyZXR1cm4gbmV3IFByb3h5KHRoaXMse2dldDoodCxlKT0+ZSBpbiB0P3RbZV06dC4kKGUpLHNldDoodCxlLG4pPT4oZSBpbiB0P3RbZV09bjp0LiQoZSxuKSwhMCl9KX1jYXRjaCh0KXt9fXZhcmlhYmxlQ2hhbmdlZEV2ZW50KHQsZSl7Zm9yKGxldCBuIG9mIHRoaXMudmFyaWFibGVDaGFuZ2VkRXZlbnRDYWxsYmFja3Mpbih0LGUpfWdldCBiYXRjaE9ic2VydmluZ1ZhcmlhYmxlQ2hhbmdlcygpe3JldHVybiB0aGlzLl9iYXRjaE9ic2VydmluZ1ZhcmlhYmxlQ2hhbmdlc31zZXQgYmF0Y2hPYnNlcnZpbmdWYXJpYWJsZUNoYW5nZXModCl7aWYodGhpcy5fYmF0Y2hPYnNlcnZpbmdWYXJpYWJsZUNoYW5nZXM9dCx0KXRoaXMuX2NoYW5nZWRWYXJpYWJsZXNGb3JCYXRjaE9icz1uZXcgU2V0O2Vsc2UgaWYobnVsbCE9dGhpcy5fY2hhbmdlZFZhcmlhYmxlc0ZvckJhdGNoT2JzKXtmb3IobGV0IHQgb2YgdGhpcy5fY2hhbmdlZFZhcmlhYmxlc0ZvckJhdGNoT2JzKXtsZXQgZT10aGlzLl9nbG9iYWxWYXJpYWJsZXMuZ2V0KHQpO2U/dGhpcy52YXJpYWJsZUNoYW5nZWRFdmVudCh0LGUpOmQoXCJjdXJyZW50VmFsdWVcIil9dGhpcy5fY2hhbmdlZFZhcmlhYmxlc0ZvckJhdGNoT2JzPW51bGx9fWdldCBjYWxsU3RhY2soKXtyZXR1cm4gdGhpcy5fY2FsbFN0YWNrfXNldCBjYWxsU3RhY2sodCl7dGhpcy5fY2FsbFN0YWNrPXR9JCh0LGUpe2lmKHZvaWQgMD09PWUpe2xldCBlPW51bGw7cmV0dXJuIG51bGwhPT10aGlzLnBhdGNoJiYoZT10aGlzLnBhdGNoLlRyeUdldEdsb2JhbCh0LG51bGwpLGUuZXhpc3RzKT9lLnJlc3VsdC52YWx1ZU9iamVjdDooZT10aGlzLl9nbG9iYWxWYXJpYWJsZXMuZ2V0KHQpLHZvaWQgMD09PWUmJihlPXRoaXMuX2RlZmF1bHRHbG9iYWxWYXJpYWJsZXMuZ2V0KHQpKSx2b2lkIDAhPT1lP2UudmFsdWVPYmplY3Q6bnVsbCl9e2lmKHZvaWQgMD09PXRoaXMuX2RlZmF1bHRHbG9iYWxWYXJpYWJsZXMuZ2V0KHQpKXRocm93IG5ldyBTKFwiQ2Fubm90IGFzc2lnbiB0byBhIHZhcmlhYmxlIChcIit0K1wiKSB0aGF0IGhhc24ndCBiZWVuIGRlY2xhcmVkIGluIHRoZSBzdG9yeVwiKTtsZXQgbj12LkNyZWF0ZShlKTtpZihudWxsPT1uKXRocm93IG5ldyBTKG51bGw9PWU/XCJDYW5ub3QgcGFzcyBudWxsIHRvIFZhcmlhYmxlU3RhdGVcIjpcIkludmFsaWQgdmFsdWUgcGFzc2VkIHRvIFZhcmlhYmxlU3RhdGU6IFwiK2UudG9TdHJpbmcoKSk7dGhpcy5TZXRHbG9iYWwodCxuKX19QXBwbHlQYXRjaCgpe2lmKG51bGw9PT10aGlzLnBhdGNoKXJldHVybiBkKFwidGhpcy5wYXRjaFwiKTtmb3IobGV0W3QsZV1vZiB0aGlzLnBhdGNoLmdsb2JhbHMpdGhpcy5fZ2xvYmFsVmFyaWFibGVzLnNldCh0LGUpO2lmKG51bGwhPT10aGlzLl9jaGFuZ2VkVmFyaWFibGVzRm9yQmF0Y2hPYnMpZm9yKGxldCB0IG9mIHRoaXMucGF0Y2guY2hhbmdlZFZhcmlhYmxlcyl0aGlzLl9jaGFuZ2VkVmFyaWFibGVzRm9yQmF0Y2hPYnMuYWRkKHQpO3RoaXMucGF0Y2g9bnVsbH1TZXRKc29uVG9rZW4odCl7dGhpcy5fZ2xvYmFsVmFyaWFibGVzLmNsZWFyKCk7Zm9yKGxldFtlLG5db2YgdGhpcy5fZGVmYXVsdEdsb2JhbFZhcmlhYmxlcyl7bGV0IGk9dFtlXTtpZih2b2lkIDAhPT1pKXtsZXQgdD1NLkpUb2tlblRvUnVudGltZU9iamVjdChpKTtpZihudWxsPT09dClyZXR1cm4gZChcInRva2VuSW5rT2JqZWN0XCIpO3RoaXMuX2dsb2JhbFZhcmlhYmxlcy5zZXQoZSx0KX1lbHNlIHRoaXMuX2dsb2JhbFZhcmlhYmxlcy5zZXQoZSxuKX19V3JpdGVKc29uKHQpe3QuV3JpdGVPYmplY3RTdGFydCgpO2ZvcihsZXRbZSxuXW9mIHRoaXMuX2dsb2JhbFZhcmlhYmxlcyl7bGV0IGk9ZSxyPW47aWYoSi5kb250U2F2ZURlZmF1bHRWYWx1ZXMmJnRoaXMuX2RlZmF1bHRHbG9iYWxWYXJpYWJsZXMuaGFzKGkpKXtsZXQgdD10aGlzLl9kZWZhdWx0R2xvYmFsVmFyaWFibGVzLmdldChpKTtpZih0aGlzLlJ1bnRpbWVPYmplY3RzRXF1YWwocix0KSljb250aW51ZX10LldyaXRlUHJvcGVydHlTdGFydChpKSxNLldyaXRlUnVudGltZU9iamVjdCh0LHIpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpfXQuV3JpdGVPYmplY3RFbmQoKX1SdW50aW1lT2JqZWN0c0VxdWFsKHQsZSl7aWYobnVsbD09PXQpcmV0dXJuIGQoXCJvYmoxXCIpO2lmKG51bGw9PT1lKXJldHVybiBkKFwib2JqMlwiKTtpZih0LmNvbnN0cnVjdG9yIT09ZS5jb25zdHJ1Y3RvcilyZXR1cm4hMTtsZXQgbj1hKHQsYik7aWYobnVsbCE9PW4pcmV0dXJuIG4udmFsdWU9PT1zKGUsYikudmFsdWU7bGV0IGk9YSh0LF8pO2lmKG51bGwhPT1pKXJldHVybiBpLnZhbHVlPT09cyhlLF8pLnZhbHVlO2xldCByPWEodCx2KSxsPWEoZSx2KTtpZihudWxsIT09ciYmbnVsbCE9PWwpcmV0dXJuIHUoci52YWx1ZU9iamVjdCkmJnUobC52YWx1ZU9iamVjdCk/ci52YWx1ZU9iamVjdC5FcXVhbHMobC52YWx1ZU9iamVjdCk6ci52YWx1ZU9iamVjdD09PWwudmFsdWVPYmplY3Q7dGhyb3cgbmV3IEVycm9yKFwiRmFzdFJvdWdoRGVmaW5pdGVseUVxdWFsczogVW5zdXBwb3J0ZWQgcnVudGltZSBvYmplY3QgdHlwZTogXCIrdC5jb25zdHJ1Y3Rvci5uYW1lKX1HZXRWYXJpYWJsZVdpdGhOYW1lKHQsZT0tMSl7bGV0IG49dGhpcy5HZXRSYXdWYXJpYWJsZVdpdGhOYW1lKHQsZSksaT1hKG4sdyk7cmV0dXJuIG51bGwhPT1pJiYobj10aGlzLlZhbHVlQXRWYXJpYWJsZVBvaW50ZXIoaSkpLG59VHJ5R2V0RGVmYXVsdFZhcmlhYmxlVmFsdWUodCl7bGV0IGU9eSh0aGlzLl9kZWZhdWx0R2xvYmFsVmFyaWFibGVzLHQsbnVsbCk7cmV0dXJuIGUuZXhpc3RzP2UucmVzdWx0Om51bGx9R2xvYmFsVmFyaWFibGVFeGlzdHNXaXRoTmFtZSh0KXtyZXR1cm4gdGhpcy5fZ2xvYmFsVmFyaWFibGVzLmhhcyh0KXx8bnVsbCE9PXRoaXMuX2RlZmF1bHRHbG9iYWxWYXJpYWJsZXMmJnRoaXMuX2RlZmF1bHRHbG9iYWxWYXJpYWJsZXMuaGFzKHQpfUdldFJhd1ZhcmlhYmxlV2l0aE5hbWUodCxlKXtsZXQgbj1udWxsO2lmKDA9PWV8fC0xPT1lKXtsZXQgZT1udWxsO2lmKG51bGwhPT10aGlzLnBhdGNoJiYoZT10aGlzLnBhdGNoLlRyeUdldEdsb2JhbCh0LG51bGwpLGUuZXhpc3RzKSlyZXR1cm4gZS5yZXN1bHQ7aWYoZT15KHRoaXMuX2dsb2JhbFZhcmlhYmxlcyx0LG51bGwpLGUuZXhpc3RzKXJldHVybiBlLnJlc3VsdDtpZihudWxsIT09dGhpcy5fZGVmYXVsdEdsb2JhbFZhcmlhYmxlcyYmKGU9eSh0aGlzLl9kZWZhdWx0R2xvYmFsVmFyaWFibGVzLHQsbnVsbCksZS5leGlzdHMpKXJldHVybiBlLnJlc3VsdDtpZihudWxsPT09dGhpcy5fbGlzdERlZnNPcmlnaW4pcmV0dXJuIGQoXCJWYXJpYWJsZXNTdGF0ZS5fbGlzdERlZnNPcmlnaW5cIik7bGV0IG49dGhpcy5fbGlzdERlZnNPcmlnaW4uRmluZFNpbmdsZUl0ZW1MaXN0V2l0aE5hbWUodCk7aWYobilyZXR1cm4gbn1yZXR1cm4gbj10aGlzLl9jYWxsU3RhY2suR2V0VGVtcG9yYXJ5VmFyaWFibGVXaXRoTmFtZSh0LGUpLG59VmFsdWVBdFZhcmlhYmxlUG9pbnRlcih0KXtyZXR1cm4gdGhpcy5HZXRWYXJpYWJsZVdpdGhOYW1lKHQudmFyaWFibGVOYW1lLHQuY29udGV4dEluZGV4KX1Bc3NpZ24odCxlKXtsZXQgbj10LnZhcmlhYmxlTmFtZTtpZihudWxsPT09bilyZXR1cm4gZChcIm5hbWVcIik7bGV0IGk9LTEscj0hMTtpZihyPXQuaXNOZXdEZWNsYXJhdGlvbj90LmlzR2xvYmFsOnRoaXMuR2xvYmFsVmFyaWFibGVFeGlzdHNXaXRoTmFtZShuKSx0LmlzTmV3RGVjbGFyYXRpb24pe2xldCB0PWEoZSx3KTtpZihudWxsIT09dCl7ZT10aGlzLlJlc29sdmVWYXJpYWJsZVBvaW50ZXIodCl9fWVsc2V7bGV0IHQ9bnVsbDtkb3t0PWEodGhpcy5HZXRSYXdWYXJpYWJsZVdpdGhOYW1lKG4saSksdyksbnVsbCE9dCYmKG49dC52YXJpYWJsZU5hbWUsaT10LmNvbnRleHRJbmRleCxyPTA9PWkpfXdoaWxlKG51bGwhPXQpfXI/dGhpcy5TZXRHbG9iYWwobixlKTp0aGlzLl9jYWxsU3RhY2suU2V0VGVtcG9yYXJ5VmFyaWFibGUobixlLHQuaXNOZXdEZWNsYXJhdGlvbixpKX1TbmFwc2hvdERlZmF1bHRHbG9iYWxzKCl7dGhpcy5fZGVmYXVsdEdsb2JhbFZhcmlhYmxlcz1uZXcgTWFwKHRoaXMuX2dsb2JhbFZhcmlhYmxlcyl9UmV0YWluTGlzdE9yaWdpbnNGb3JBc3NpZ25tZW50KHQsZSl7bGV0IG49cyh0LE8pLGk9cyhlLE8pO24udmFsdWUmJmkudmFsdWUmJjA9PWkudmFsdWUuQ291bnQmJmkudmFsdWUuU2V0SW5pdGlhbE9yaWdpbk5hbWVzKG4udmFsdWUub3JpZ2luTmFtZXMpfVNldEdsb2JhbCh0LGUpe2xldCBuPW51bGw7aWYobnVsbD09PXRoaXMucGF0Y2gmJihuPXkodGhpcy5fZ2xvYmFsVmFyaWFibGVzLHQsbnVsbCkpLG51bGwhPT10aGlzLnBhdGNoJiYobj10aGlzLnBhdGNoLlRyeUdldEdsb2JhbCh0LG51bGwpLG4uZXhpc3RzfHwobj15KHRoaXMuX2dsb2JhbFZhcmlhYmxlcyx0LG51bGwpKSksTy5SZXRhaW5MaXN0T3JpZ2luc0ZvckFzc2lnbm1lbnQobi5yZXN1bHQsZSksbnVsbD09PXQpcmV0dXJuIGQoXCJ2YXJpYWJsZU5hbWVcIik7aWYobnVsbCE9PXRoaXMucGF0Y2g/dGhpcy5wYXRjaC5TZXRHbG9iYWwodCxlKTp0aGlzLl9nbG9iYWxWYXJpYWJsZXMuc2V0KHQsZSksbnVsbCE9PXRoaXMudmFyaWFibGVDaGFuZ2VkRXZlbnQmJm51bGwhPT1uJiZlIT09bi5yZXN1bHQpaWYodGhpcy5iYXRjaE9ic2VydmluZ1ZhcmlhYmxlQ2hhbmdlcyl7aWYobnVsbD09PXRoaXMuX2NoYW5nZWRWYXJpYWJsZXNGb3JCYXRjaE9icylyZXR1cm4gZChcInRoaXMuX2NoYW5nZWRWYXJpYWJsZXNGb3JCYXRjaE9ic1wiKTtudWxsIT09dGhpcy5wYXRjaD90aGlzLnBhdGNoLkFkZENoYW5nZWRWYXJpYWJsZSh0KTpudWxsIT09dGhpcy5fY2hhbmdlZFZhcmlhYmxlc0ZvckJhdGNoT2JzJiZ0aGlzLl9jaGFuZ2VkVmFyaWFibGVzRm9yQmF0Y2hPYnMuYWRkKHQpfWVsc2UgdGhpcy52YXJpYWJsZUNoYW5nZWRFdmVudCh0LGUpfVJlc29sdmVWYXJpYWJsZVBvaW50ZXIodCl7bGV0IGU9dC5jb250ZXh0SW5kZXg7LTE9PWUmJihlPXRoaXMuR2V0Q29udGV4dEluZGV4T2ZWYXJpYWJsZU5hbWVkKHQudmFyaWFibGVOYW1lKSk7bGV0IG49YSh0aGlzLkdldFJhd1ZhcmlhYmxlV2l0aE5hbWUodC52YXJpYWJsZU5hbWUsZSksdyk7cmV0dXJuIG51bGwhPW4/bjpuZXcgdyh0LnZhcmlhYmxlTmFtZSxlKX1HZXRDb250ZXh0SW5kZXhPZlZhcmlhYmxlTmFtZWQodCl7cmV0dXJuIHRoaXMuR2xvYmFsVmFyaWFibGVFeGlzdHNXaXRoTmFtZSh0KT8wOnRoaXMuX2NhbGxTdGFjay5jdXJyZW50RWxlbWVudEluZGV4fU9ic2VydmVWYXJpYWJsZUNoYW5nZSh0KXt0aGlzLnZhcmlhYmxlQ2hhbmdlZEV2ZW50Q2FsbGJhY2tzLnB1c2godCl9fUouZG9udFNhdmVEZWZhdWx0VmFsdWVzPSEwO2NsYXNzIEt7Y29uc3RydWN0b3IodCl7dGhpcy5zZWVkPXQlMjE0NzQ4MzY0Nyx0aGlzLnNlZWQ8PTAmJih0aGlzLnNlZWQrPTIxNDc0ODM2NDYpfW5leHQoKXtyZXR1cm4gdGhpcy5zZWVkPTE2ODA3KnRoaXMuc2VlZCUyMTQ3NDgzNjQ3fW5leHRGbG9hdCgpe3JldHVybih0aGlzLm5leHQoKS0xKS8yMTQ3NDgzNjQ2fX1jbGFzcyBVe2NvbnN0cnVjdG9yKCl7aWYodGhpcy5fY2hhbmdlZFZhcmlhYmxlcz1uZXcgU2V0LHRoaXMuX3Zpc2l0Q291bnRzPW5ldyBNYXAsdGhpcy5fdHVybkluZGljZXM9bmV3IE1hcCwxPT09YXJndW1lbnRzLmxlbmd0aCYmbnVsbCE9PWFyZ3VtZW50c1swXSl7bGV0IHQ9YXJndW1lbnRzWzBdO3RoaXMuX2dsb2JhbHM9bmV3IE1hcCh0Ll9nbG9iYWxzKSx0aGlzLl9jaGFuZ2VkVmFyaWFibGVzPW5ldyBTZXQodC5fY2hhbmdlZFZhcmlhYmxlcyksdGhpcy5fdmlzaXRDb3VudHM9bmV3IE1hcCh0Ll92aXNpdENvdW50cyksdGhpcy5fdHVybkluZGljZXM9bmV3IE1hcCh0Ll90dXJuSW5kaWNlcyl9ZWxzZSB0aGlzLl9nbG9iYWxzPW5ldyBNYXAsdGhpcy5fY2hhbmdlZFZhcmlhYmxlcz1uZXcgU2V0LHRoaXMuX3Zpc2l0Q291bnRzPW5ldyBNYXAsdGhpcy5fdHVybkluZGljZXM9bmV3IE1hcH1nZXQgZ2xvYmFscygpe3JldHVybiB0aGlzLl9nbG9iYWxzfWdldCBjaGFuZ2VkVmFyaWFibGVzKCl7cmV0dXJuIHRoaXMuX2NoYW5nZWRWYXJpYWJsZXN9Z2V0IHZpc2l0Q291bnRzKCl7cmV0dXJuIHRoaXMuX3Zpc2l0Q291bnRzfWdldCB0dXJuSW5kaWNlcygpe3JldHVybiB0aGlzLl90dXJuSW5kaWNlc31UcnlHZXRHbG9iYWwodCxlKXtyZXR1cm4gbnVsbCE9PXQmJnRoaXMuX2dsb2JhbHMuaGFzKHQpP3tyZXN1bHQ6dGhpcy5fZ2xvYmFscy5nZXQodCksZXhpc3RzOiEwfTp7cmVzdWx0OmUsZXhpc3RzOiExfX1TZXRHbG9iYWwodCxlKXt0aGlzLl9nbG9iYWxzLnNldCh0LGUpfUFkZENoYW5nZWRWYXJpYWJsZSh0KXtyZXR1cm4gdGhpcy5fY2hhbmdlZFZhcmlhYmxlcy5hZGQodCl9VHJ5R2V0VmlzaXRDb3VudCh0LGUpe3JldHVybiB0aGlzLl92aXNpdENvdW50cy5oYXModCk/e3Jlc3VsdDp0aGlzLl92aXNpdENvdW50cy5nZXQodCksZXhpc3RzOiEwfTp7cmVzdWx0OmUsZXhpc3RzOiExfX1TZXRWaXNpdENvdW50KHQsZSl7dGhpcy5fdmlzaXRDb3VudHMuc2V0KHQsZSl9U2V0VHVybkluZGV4KHQsZSl7dGhpcy5fdHVybkluZGljZXMuc2V0KHQsZSl9VHJ5R2V0VHVybkluZGV4KHQsZSl7cmV0dXJuIHRoaXMuX3R1cm5JbmRpY2VzLmhhcyh0KT97cmVzdWx0OnRoaXMuX3R1cm5JbmRpY2VzLmdldCh0KSxleGlzdHM6ITB9OntyZXN1bHQ6ZSxleGlzdHM6ITF9fX1jbGFzcyB6e3N0YXRpYyBUZXh0VG9EaWN0aW9uYXJ5KHQpe3JldHVybiBuZXcgei5SZWFkZXIodCkuVG9EaWN0aW9uYXJ5KCl9c3RhdGljIFRleHRUb0FycmF5KHQpe3JldHVybiBuZXcgei5SZWFkZXIodCkuVG9BcnJheSgpfX0hZnVuY3Rpb24odCl7dC5SZWFkZXI9Y2xhc3N7Y29uc3RydWN0b3IodCl7dGhpcy5fcm9vdE9iamVjdD1KU09OLnBhcnNlKHQpfVRvRGljdGlvbmFyeSgpe3JldHVybiB0aGlzLl9yb290T2JqZWN0fVRvQXJyYXkoKXtyZXR1cm4gdGhpcy5fcm9vdE9iamVjdH19O2NsYXNzIGV7Y29uc3RydWN0b3IoKXt0aGlzLl9jdXJyZW50UHJvcGVydHlOYW1lPW51bGwsdGhpcy5fY3VycmVudFN0cmluZz1udWxsLHRoaXMuX3N0YXRlU3RhY2s9W10sdGhpcy5fY29sbGVjdGlvblN0YWNrPVtdLHRoaXMuX3Byb3BlcnR5TmFtZVN0YWNrPVtdLHRoaXMuX2pzb25PYmplY3Q9bnVsbH1Xcml0ZU9iamVjdCh0KXt0aGlzLldyaXRlT2JqZWN0U3RhcnQoKSx0KHRoaXMpLHRoaXMuV3JpdGVPYmplY3RFbmQoKX1Xcml0ZU9iamVjdFN0YXJ0KCl7dGhpcy5TdGFydE5ld09iamVjdCghMCk7bGV0IGU9e307aWYodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLlByb3BlcnR5KXt0aGlzLkFzc2VydChudWxsIT09dGhpcy5jdXJyZW50Q29sbGVjdGlvbiksdGhpcy5Bc3NlcnQobnVsbCE9PXRoaXMuY3VycmVudFByb3BlcnR5TmFtZSk7bGV0IHQ9dGhpcy5fcHJvcGVydHlOYW1lU3RhY2sucG9wKCk7dGhpcy5jdXJyZW50Q29sbGVjdGlvblt0XT1lLHRoaXMuX2NvbGxlY3Rpb25TdGFjay5wdXNoKGUpfWVsc2UgdGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLkFycmF5Pyh0aGlzLkFzc2VydChudWxsIT09dGhpcy5jdXJyZW50Q29sbGVjdGlvbiksdGhpcy5jdXJyZW50Q29sbGVjdGlvbi5wdXNoKGUpLHRoaXMuX2NvbGxlY3Rpb25TdGFjay5wdXNoKGUpKToodGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLk5vbmUpLHRoaXMuX2pzb25PYmplY3Q9ZSx0aGlzLl9jb2xsZWN0aW9uU3RhY2sucHVzaChlKSk7dGhpcy5fc3RhdGVTdGFjay5wdXNoKG5ldyB0LldyaXRlci5TdGF0ZUVsZW1lbnQodC5Xcml0ZXIuU3RhdGUuT2JqZWN0KSl9V3JpdGVPYmplY3RFbmQoKXt0aGlzLkFzc2VydCh0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuT2JqZWN0KSx0aGlzLl9jb2xsZWN0aW9uU3RhY2sucG9wKCksdGhpcy5fc3RhdGVTdGFjay5wb3AoKX1Xcml0ZVByb3BlcnR5KHQsZSl7aWYodGhpcy5Xcml0ZVByb3BlcnR5U3RhcnQodCksYXJndW1lbnRzWzFdaW5zdGFuY2VvZiBGdW5jdGlvbil7KDAsYXJndW1lbnRzWzFdKSh0aGlzKX1lbHNle2xldCB0PWFyZ3VtZW50c1sxXTt0aGlzLldyaXRlKHQpfXRoaXMuV3JpdGVQcm9wZXJ0eUVuZCgpfVdyaXRlSW50UHJvcGVydHkodCxlKXt0aGlzLldyaXRlUHJvcGVydHlTdGFydCh0KSx0aGlzLldyaXRlSW50KGUpLHRoaXMuV3JpdGVQcm9wZXJ0eUVuZCgpfVdyaXRlRmxvYXRQcm9wZXJ0eSh0LGUpe3RoaXMuV3JpdGVQcm9wZXJ0eVN0YXJ0KHQpLHRoaXMuV3JpdGVGbG9hdChlKSx0aGlzLldyaXRlUHJvcGVydHlFbmQoKX1Xcml0ZVByb3BlcnR5U3RhcnQoZSl7dGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLk9iamVjdCksdGhpcy5fcHJvcGVydHlOYW1lU3RhY2sucHVzaChlKSx0aGlzLkluY3JlbWVudENoaWxkQ291bnQoKSx0aGlzLl9zdGF0ZVN0YWNrLnB1c2gobmV3IHQuV3JpdGVyLlN0YXRlRWxlbWVudCh0LldyaXRlci5TdGF0ZS5Qcm9wZXJ0eSkpfVdyaXRlUHJvcGVydHlFbmQoKXt0aGlzLkFzc2VydCh0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuUHJvcGVydHkpLHRoaXMuQXNzZXJ0KDE9PT10aGlzLmNoaWxkQ291bnQpLHRoaXMuX3N0YXRlU3RhY2sucG9wKCl9V3JpdGVQcm9wZXJ0eU5hbWVTdGFydCgpe3RoaXMuQXNzZXJ0KHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5PYmplY3QpLHRoaXMuSW5jcmVtZW50Q2hpbGRDb3VudCgpLHRoaXMuX2N1cnJlbnRQcm9wZXJ0eU5hbWU9XCJcIix0aGlzLl9zdGF0ZVN0YWNrLnB1c2gobmV3IHQuV3JpdGVyLlN0YXRlRWxlbWVudCh0LldyaXRlci5TdGF0ZS5Qcm9wZXJ0eSkpLHRoaXMuX3N0YXRlU3RhY2sucHVzaChuZXcgdC5Xcml0ZXIuU3RhdGVFbGVtZW50KHQuV3JpdGVyLlN0YXRlLlByb3BlcnR5TmFtZSkpfVdyaXRlUHJvcGVydHlOYW1lRW5kKCl7dGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLlByb3BlcnR5TmFtZSksdGhpcy5Bc3NlcnQobnVsbCE9PXRoaXMuX2N1cnJlbnRQcm9wZXJ0eU5hbWUpLHRoaXMuX3Byb3BlcnR5TmFtZVN0YWNrLnB1c2godGhpcy5fY3VycmVudFByb3BlcnR5TmFtZSksdGhpcy5fY3VycmVudFByb3BlcnR5TmFtZT1udWxsLHRoaXMuX3N0YXRlU3RhY2sucG9wKCl9V3JpdGVQcm9wZXJ0eU5hbWVJbm5lcihlKXt0aGlzLkFzc2VydCh0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuUHJvcGVydHlOYW1lKSx0aGlzLkFzc2VydChudWxsIT09dGhpcy5fY3VycmVudFByb3BlcnR5TmFtZSksdGhpcy5fY3VycmVudFByb3BlcnR5TmFtZSs9ZX1Xcml0ZUFycmF5U3RhcnQoKXt0aGlzLlN0YXJ0TmV3T2JqZWN0KCEwKTtsZXQgZT1bXTtpZih0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuUHJvcGVydHkpe3RoaXMuQXNzZXJ0KG51bGwhPT10aGlzLmN1cnJlbnRDb2xsZWN0aW9uKSx0aGlzLkFzc2VydChudWxsIT09dGhpcy5jdXJyZW50UHJvcGVydHlOYW1lKTtsZXQgdD10aGlzLl9wcm9wZXJ0eU5hbWVTdGFjay5wb3AoKTt0aGlzLmN1cnJlbnRDb2xsZWN0aW9uW3RdPWUsdGhpcy5fY29sbGVjdGlvblN0YWNrLnB1c2goZSl9ZWxzZSB0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuQXJyYXk/KHRoaXMuQXNzZXJ0KG51bGwhPT10aGlzLmN1cnJlbnRDb2xsZWN0aW9uKSx0aGlzLmN1cnJlbnRDb2xsZWN0aW9uLnB1c2goZSksdGhpcy5fY29sbGVjdGlvblN0YWNrLnB1c2goZSkpOih0aGlzLkFzc2VydCh0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuTm9uZSksdGhpcy5fanNvbk9iamVjdD1lLHRoaXMuX2NvbGxlY3Rpb25TdGFjay5wdXNoKGUpKTt0aGlzLl9zdGF0ZVN0YWNrLnB1c2gobmV3IHQuV3JpdGVyLlN0YXRlRWxlbWVudCh0LldyaXRlci5TdGF0ZS5BcnJheSkpfVdyaXRlQXJyYXlFbmQoKXt0aGlzLkFzc2VydCh0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuQXJyYXkpLHRoaXMuX2NvbGxlY3Rpb25TdGFjay5wb3AoKSx0aGlzLl9zdGF0ZVN0YWNrLnBvcCgpfVdyaXRlKHQsZT0hMCl7bnVsbCE9PXQ/KHRoaXMuU3RhcnROZXdPYmplY3QoITEpLHRoaXMuX2FkZFRvQ3VycmVudE9iamVjdCh0KSk6Y29uc29sZS5lcnJvcihcIldhcm5pbmc6IHRyeWluZyB0byB3cml0ZSBhIG51bGwgc3RyaW5nXCIpfVdyaXRlSW50KHQpe251bGwhPT10JiYodGhpcy5TdGFydE5ld09iamVjdCghMSksdGhpcy5fYWRkVG9DdXJyZW50T2JqZWN0KE1hdGguZmxvb3IodCkpKX1Xcml0ZUZsb2F0KHQpe251bGwhPT10JiYodGhpcy5TdGFydE5ld09iamVjdCghMSksdD09TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZP3RoaXMuX2FkZFRvQ3VycmVudE9iamVjdCgzNGUzNyk6dD09TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZP3RoaXMuX2FkZFRvQ3VycmVudE9iamVjdCgtMzRlMzcpOmlzTmFOKHQpP3RoaXMuX2FkZFRvQ3VycmVudE9iamVjdCgwKTp0aGlzLl9hZGRUb0N1cnJlbnRPYmplY3QodCkpfVdyaXRlTnVsbCgpe3RoaXMuU3RhcnROZXdPYmplY3QoITEpLHRoaXMuX2FkZFRvQ3VycmVudE9iamVjdChudWxsKX1Xcml0ZVN0cmluZ1N0YXJ0KCl7dGhpcy5TdGFydE5ld09iamVjdCghMSksdGhpcy5fY3VycmVudFN0cmluZz1cIlwiLHRoaXMuX3N0YXRlU3RhY2sucHVzaChuZXcgdC5Xcml0ZXIuU3RhdGVFbGVtZW50KHQuV3JpdGVyLlN0YXRlLlN0cmluZykpfVdyaXRlU3RyaW5nRW5kKCl7dGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09dC5Xcml0ZXIuU3RhdGUuU3RyaW5nKSx0aGlzLl9zdGF0ZVN0YWNrLnBvcCgpLHRoaXMuX2FkZFRvQ3VycmVudE9iamVjdCh0aGlzLl9jdXJyZW50U3RyaW5nKSx0aGlzLl9jdXJyZW50U3RyaW5nPW51bGx9V3JpdGVTdHJpbmdJbm5lcihlLG49ITApe3RoaXMuQXNzZXJ0KHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5TdHJpbmcpLG51bGwhPT1lP3RoaXMuX2N1cnJlbnRTdHJpbmcrPWU6Y29uc29sZS5lcnJvcihcIldhcm5pbmc6IHRyeWluZyB0byB3cml0ZSBhIG51bGwgc3RyaW5nXCIpfVRvU3RyaW5nKCl7cmV0dXJuIG51bGw9PT10aGlzLl9qc29uT2JqZWN0P1wiXCI6SlNPTi5zdHJpbmdpZnkodGhpcy5fanNvbk9iamVjdCl9U3RhcnROZXdPYmplY3QoZSl7ZT90aGlzLkFzc2VydCh0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuTm9uZXx8dGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLlByb3BlcnR5fHx0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuQXJyYXkpOnRoaXMuQXNzZXJ0KHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5Qcm9wZXJ0eXx8dGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLkFycmF5KSx0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuUHJvcGVydHkmJnRoaXMuQXNzZXJ0KDA9PT10aGlzLmNoaWxkQ291bnQpLHRoaXMuc3RhdGUhPT10LldyaXRlci5TdGF0ZS5BcnJheSYmdGhpcy5zdGF0ZSE9PXQuV3JpdGVyLlN0YXRlLlByb3BlcnR5fHx0aGlzLkluY3JlbWVudENoaWxkQ291bnQoKX1nZXQgc3RhdGUoKXtyZXR1cm4gdGhpcy5fc3RhdGVTdGFjay5sZW5ndGg+MD90aGlzLl9zdGF0ZVN0YWNrW3RoaXMuX3N0YXRlU3RhY2subGVuZ3RoLTFdLnR5cGU6dC5Xcml0ZXIuU3RhdGUuTm9uZX1nZXQgY2hpbGRDb3VudCgpe3JldHVybiB0aGlzLl9zdGF0ZVN0YWNrLmxlbmd0aD4wP3RoaXMuX3N0YXRlU3RhY2tbdGhpcy5fc3RhdGVTdGFjay5sZW5ndGgtMV0uY2hpbGRDb3VudDowfWdldCBjdXJyZW50Q29sbGVjdGlvbigpe3JldHVybiB0aGlzLl9jb2xsZWN0aW9uU3RhY2subGVuZ3RoPjA/dGhpcy5fY29sbGVjdGlvblN0YWNrW3RoaXMuX2NvbGxlY3Rpb25TdGFjay5sZW5ndGgtMV06bnVsbH1nZXQgY3VycmVudFByb3BlcnR5TmFtZSgpe3JldHVybiB0aGlzLl9wcm9wZXJ0eU5hbWVTdGFjay5sZW5ndGg+MD90aGlzLl9wcm9wZXJ0eU5hbWVTdGFja1t0aGlzLl9wcm9wZXJ0eU5hbWVTdGFjay5sZW5ndGgtMV06bnVsbH1JbmNyZW1lbnRDaGlsZENvdW50KCl7dGhpcy5Bc3NlcnQodGhpcy5fc3RhdGVTdGFjay5sZW5ndGg+MCk7bGV0IHQ9dGhpcy5fc3RhdGVTdGFjay5wb3AoKTt0LmNoaWxkQ291bnQrKyx0aGlzLl9zdGF0ZVN0YWNrLnB1c2godCl9QXNzZXJ0KHQpe2lmKCF0KXRocm93IEVycm9yKFwiQXNzZXJ0IGZhaWxlZCB3aGlsZSB3cml0aW5nIEpTT05cIil9X2FkZFRvQ3VycmVudE9iamVjdChlKXt0aGlzLkFzc2VydChudWxsIT09dGhpcy5jdXJyZW50Q29sbGVjdGlvbiksdGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLkFycmF5Pyh0aGlzLkFzc2VydChBcnJheS5pc0FycmF5KHRoaXMuY3VycmVudENvbGxlY3Rpb24pKSx0aGlzLmN1cnJlbnRDb2xsZWN0aW9uLnB1c2goZSkpOnRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5Qcm9wZXJ0eSYmKHRoaXMuQXNzZXJ0KCFBcnJheS5pc0FycmF5KHRoaXMuY3VycmVudENvbGxlY3Rpb24pKSx0aGlzLkFzc2VydChudWxsIT09dGhpcy5jdXJyZW50UHJvcGVydHlOYW1lKSx0aGlzLmN1cnJlbnRDb2xsZWN0aW9uW3RoaXMuY3VycmVudFByb3BlcnR5TmFtZV09ZSx0aGlzLl9wcm9wZXJ0eU5hbWVTdGFjay5wb3AoKSl9fXQuV3JpdGVyPWUsZnVuY3Rpb24oZSl7bGV0IG47IWZ1bmN0aW9uKHQpe3RbdC5Ob25lPTBdPVwiTm9uZVwiLHRbdC5PYmplY3Q9MV09XCJPYmplY3RcIix0W3QuQXJyYXk9Ml09XCJBcnJheVwiLHRbdC5Qcm9wZXJ0eT0zXT1cIlByb3BlcnR5XCIsdFt0LlByb3BlcnR5TmFtZT00XT1cIlByb3BlcnR5TmFtZVwiLHRbdC5TdHJpbmc9NV09XCJTdHJpbmdcIn0obj1lLlN0YXRlfHwoZS5TdGF0ZT17fSkpO2UuU3RhdGVFbGVtZW50PWNsYXNze2NvbnN0cnVjdG9yKGUpe3RoaXMudHlwZT10LldyaXRlci5TdGF0ZS5Ob25lLHRoaXMuY2hpbGRDb3VudD0wLHRoaXMudHlwZT1lfX19KGU9dC5Xcml0ZXJ8fCh0LldyaXRlcj17fSkpfSh6fHwoej17fSkpO2NsYXNzIEh7Y29uc3RydWN0b3IodCl7dGhpcy5rSW5rU2F2ZVN0YXRlVmVyc2lvbj04LHRoaXMua01pbkNvbXBhdGlibGVMb2FkVmVyc2lvbj04LHRoaXMuX2N1cnJlbnRFcnJvcnM9bnVsbCx0aGlzLl9jdXJyZW50V2FybmluZ3M9bnVsbCx0aGlzLmRpdmVydGVkUG9pbnRlcj1JLk51bGwsdGhpcy5fY3VycmVudFR1cm5JbmRleD0wLHRoaXMuc3RvcnlTZWVkPTAsdGhpcy5wcmV2aW91c1JhbmRvbT0wLHRoaXMuZGlkU2FmZUV4aXQ9ITEsdGhpcy5fY3VycmVudFRleHQ9bnVsbCx0aGlzLl9jdXJyZW50VGFncz1udWxsLHRoaXMuX291dHB1dFN0cmVhbVRleHREaXJ0eT0hMCx0aGlzLl9vdXRwdXRTdHJlYW1UYWdzRGlydHk9ITAsdGhpcy5fcGF0Y2g9bnVsbCx0aGlzLnN0b3J5PXQsdGhpcy5fb3V0cHV0U3RyZWFtPVtdLHRoaXMuT3V0cHV0U3RyZWFtRGlydHkoKSx0aGlzLl9ldmFsdWF0aW9uU3RhY2s9W10sdGhpcy5jYWxsU3RhY2s9bmV3IHEodCksdGhpcy5fdmFyaWFibGVzU3RhdGU9bmV3IEoodGhpcy5jYWxsU3RhY2ssdC5saXN0RGVmaW5pdGlvbnMpLHRoaXMuX3Zpc2l0Q291bnRzPW5ldyBNYXAsdGhpcy5fdHVybkluZGljZXM9bmV3IE1hcCx0aGlzLmN1cnJlbnRUdXJuSW5kZXg9LTE7bGV0IGU9KG5ldyBEYXRlKS5nZXRUaW1lKCk7dGhpcy5zdG9yeVNlZWQ9bmV3IEsoZSkubmV4dCgpJTEwMCx0aGlzLnByZXZpb3VzUmFuZG9tPTAsdGhpcy5fY3VycmVudENob2ljZXM9W10sdGhpcy5Hb1RvU3RhcnQoKX1Ub0pzb24odD0hMSl7bGV0IGU9bmV3IHouV3JpdGVyO3JldHVybiB0aGlzLldyaXRlSnNvbihlKSxlLlRvU3RyaW5nKCl9dG9Kc29uKHQ9ITEpe3JldHVybiB0aGlzLlRvSnNvbih0KX1Mb2FkSnNvbih0KXtsZXQgZT16LlRleHRUb0RpY3Rpb25hcnkodCk7dGhpcy5Mb2FkSnNvbk9iaihlKX1WaXNpdENvdW50QXRQYXRoU3RyaW5nKHQpe2xldCBuO2lmKG51bGwhPT10aGlzLl9wYXRjaCl7bGV0IGk9dGhpcy5zdG9yeS5Db250ZW50QXRQYXRoKG5ldyBlKHQpKS5jb250YWluZXI7aWYobnVsbD09PWkpdGhyb3cgbmV3IEVycm9yKFwiQ29udGVudCBhdCBwYXRoIG5vdCBmb3VuZDogXCIrdCk7aWYobj10aGlzLl9wYXRjaC5UcnlHZXRWaXNpdENvdW50KGksMCksbi5leGlzdHMpcmV0dXJuIG4ucmVzdWx0fXJldHVybiBuPXkodGhpcy5fdmlzaXRDb3VudHMsdCxudWxsKSxuLmV4aXN0cz9uLnJlc3VsdDowfVZpc2l0Q291bnRGb3JDb250YWluZXIodCl7aWYobnVsbD09PXQpcmV0dXJuIGQoXCJjb250YWluZXJcIik7aWYoIXQudmlzaXRzU2hvdWxkQmVDb3VudGVkKXJldHVybiB0aGlzLnN0b3J5LkVycm9yKFwiUmVhZCBjb3VudCBmb3IgdGFyZ2V0IChcIit0Lm5hbWUrXCIgLSBvbiBcIit0LmRlYnVnTWV0YWRhdGErXCIpIHVua25vd24uIFRoZSBzdG9yeSBtYXkgbmVlZCB0byBiZSBjb21waWxlZCB3aXRoIGNvdW50QWxsVmlzaXRzIGZsYWcgKC1jKS5cIiksMDtpZihudWxsIT09dGhpcy5fcGF0Y2gpe2xldCBlPXRoaXMuX3BhdGNoLlRyeUdldFZpc2l0Q291bnQodCwwKTtpZihlLmV4aXN0cylyZXR1cm4gZS5yZXN1bHR9bGV0IGU9dC5wYXRoLnRvU3RyaW5nKCksbj15KHRoaXMuX3Zpc2l0Q291bnRzLGUsbnVsbCk7cmV0dXJuIG4uZXhpc3RzP24ucmVzdWx0OjB9SW5jcmVtZW50VmlzaXRDb3VudEZvckNvbnRhaW5lcih0KXtpZihudWxsIT09dGhpcy5fcGF0Y2gpe2xldCBlPXRoaXMuVmlzaXRDb3VudEZvckNvbnRhaW5lcih0KTtyZXR1cm4gZSsrLHZvaWQgdGhpcy5fcGF0Y2guU2V0VmlzaXRDb3VudCh0LGUpfWxldCBlPXQucGF0aC50b1N0cmluZygpLG49eSh0aGlzLl92aXNpdENvdW50cyxlLG51bGwpO24uZXhpc3RzP3RoaXMuX3Zpc2l0Q291bnRzLnNldChlLG4ucmVzdWx0KzEpOnRoaXMuX3Zpc2l0Q291bnRzLnNldChlLDEpfVJlY29yZFR1cm5JbmRleFZpc2l0VG9Db250YWluZXIodCl7aWYobnVsbCE9PXRoaXMuX3BhdGNoKXJldHVybiB2b2lkIHRoaXMuX3BhdGNoLlNldFR1cm5JbmRleCh0LHRoaXMuY3VycmVudFR1cm5JbmRleCk7bGV0IGU9dC5wYXRoLnRvU3RyaW5nKCk7dGhpcy5fdHVybkluZGljZXMuc2V0KGUsdGhpcy5jdXJyZW50VHVybkluZGV4KX1UdXJuc1NpbmNlRm9yQ29udGFpbmVyKHQpe2lmKHQudHVybkluZGV4U2hvdWxkQmVDb3VudGVkfHx0aGlzLnN0b3J5LkVycm9yKFwiVFVSTlNfU0lOQ0UoKSBmb3IgdGFyZ2V0IChcIit0Lm5hbWUrXCIgLSBvbiBcIit0LmRlYnVnTWV0YWRhdGErXCIpIHVua25vd24uIFRoZSBzdG9yeSBtYXkgbmVlZCB0byBiZSBjb21waWxlZCB3aXRoIGNvdW50QWxsVmlzaXRzIGZsYWcgKC1jKS5cIiksbnVsbCE9PXRoaXMuX3BhdGNoKXtsZXQgZT10aGlzLl9wYXRjaC5UcnlHZXRUdXJuSW5kZXgodCwwKTtpZihlLmV4aXN0cylyZXR1cm4gdGhpcy5jdXJyZW50VHVybkluZGV4LWUucmVzdWx0fWxldCBlPXQucGF0aC50b1N0cmluZygpLG49eSh0aGlzLl90dXJuSW5kaWNlcyxlLDApO3JldHVybiBuLmV4aXN0cz90aGlzLmN1cnJlbnRUdXJuSW5kZXgtbi5yZXN1bHQ6LTF9Z2V0IGNhbGxzdGFja0RlcHRoKCl7cmV0dXJuIHRoaXMuY2FsbFN0YWNrLmRlcHRofWdldCBvdXRwdXRTdHJlYW0oKXtyZXR1cm4gdGhpcy5fb3V0cHV0U3RyZWFtfWdldCBjdXJyZW50Q2hvaWNlcygpe3JldHVybiB0aGlzLmNhbkNvbnRpbnVlP1tdOnRoaXMuX2N1cnJlbnRDaG9pY2VzfWdldCBnZW5lcmF0ZWRDaG9pY2VzKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRDaG9pY2VzfWdldCBjdXJyZW50RXJyb3JzKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRFcnJvcnN9Z2V0IGN1cnJlbnRXYXJuaW5ncygpe3JldHVybiB0aGlzLl9jdXJyZW50V2FybmluZ3N9Z2V0IHZhcmlhYmxlc1N0YXRlKCl7cmV0dXJuIHRoaXMuX3ZhcmlhYmxlc1N0YXRlfXNldCB2YXJpYWJsZXNTdGF0ZSh0KXt0aGlzLl92YXJpYWJsZXNTdGF0ZT10fWdldCBldmFsdWF0aW9uU3RhY2soKXtyZXR1cm4gdGhpcy5fZXZhbHVhdGlvblN0YWNrfWdldCB2aXNpdENvdW50cygpe3JldHVybiB0aGlzLl92aXNpdENvdW50c31nZXQgdHVybkluZGljZXMoKXtyZXR1cm4gdGhpcy5fdHVybkluZGljZXN9Z2V0IGN1cnJlbnRUdXJuSW5kZXgoKXtyZXR1cm4gdGhpcy5fY3VycmVudFR1cm5JbmRleH1zZXQgY3VycmVudFR1cm5JbmRleCh0KXt0aGlzLl9jdXJyZW50VHVybkluZGV4PXR9Z2V0IGN1cnJlbnRQYXRoU3RyaW5nKCl7bGV0IHQ9dGhpcy5jdXJyZW50UG9pbnRlcjtyZXR1cm4gdC5pc051bGw/bnVsbDpudWxsPT09dC5wYXRoP2QoXCJwb2ludGVyLnBhdGhcIik6dC5wYXRoLnRvU3RyaW5nKCl9Z2V0IGN1cnJlbnRQb2ludGVyKCl7cmV0dXJuIHRoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LmN1cnJlbnRQb2ludGVyLmNvcHkoKX1zZXQgY3VycmVudFBvaW50ZXIodCl7dGhpcy5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQuY3VycmVudFBvaW50ZXI9dC5jb3B5KCl9Z2V0IHByZXZpb3VzUG9pbnRlcigpe3JldHVybiB0aGlzLmNhbGxTdGFjay5jdXJyZW50VGhyZWFkLnByZXZpb3VzUG9pbnRlci5jb3B5KCl9c2V0IHByZXZpb3VzUG9pbnRlcih0KXt0aGlzLmNhbGxTdGFjay5jdXJyZW50VGhyZWFkLnByZXZpb3VzUG9pbnRlcj10LmNvcHkoKX1nZXQgY2FuQ29udGludWUoKXtyZXR1cm4hdGhpcy5jdXJyZW50UG9pbnRlci5pc051bGwmJiF0aGlzLmhhc0Vycm9yfWdldCBoYXNFcnJvcigpe3JldHVybiBudWxsIT10aGlzLmN1cnJlbnRFcnJvcnMmJnRoaXMuY3VycmVudEVycm9ycy5sZW5ndGg+MH1nZXQgaGFzV2FybmluZygpe3JldHVybiBudWxsIT10aGlzLmN1cnJlbnRXYXJuaW5ncyYmdGhpcy5jdXJyZW50V2FybmluZ3MubGVuZ3RoPjB9Z2V0IGN1cnJlbnRUZXh0KCl7aWYodGhpcy5fb3V0cHV0U3RyZWFtVGV4dERpcnR5KXtsZXQgdD1uZXcgbTtmb3IobGV0IGUgb2YgdGhpcy5fb3V0cHV0U3RyZWFtKXtsZXQgbj1hKGUsVCk7bnVsbCE9PW4mJnQuQXBwZW5kKG4udmFsdWUpfXRoaXMuX2N1cnJlbnRUZXh0PXRoaXMuQ2xlYW5PdXRwdXRXaGl0ZXNwYWNlKHQudG9TdHJpbmcoKSksdGhpcy5fb3V0cHV0U3RyZWFtVGV4dERpcnR5PSExfXJldHVybiB0aGlzLl9jdXJyZW50VGV4dH1DbGVhbk91dHB1dFdoaXRlc3BhY2UodCl7bGV0IGU9bmV3IG0sbj0tMSxpPTA7Zm9yKGxldCByPTA7cjx0Lmxlbmd0aDtyKyspe2xldCBhPXQuY2hhckF0KHIpLHM9XCIgXCI9PWF8fFwiXFx0XCI9PWE7cyYmLTE9PW4mJihuPXIpLHN8fChcIlxcblwiIT1hJiZuPjAmJm4hPWkmJmUuQXBwZW5kKFwiIFwiKSxuPS0xKSxcIlxcblwiPT1hJiYoaT1yKzEpLHN8fGUuQXBwZW5kKGEpfXJldHVybiBlLnRvU3RyaW5nKCl9Z2V0IGN1cnJlbnRUYWdzKCl7aWYodGhpcy5fb3V0cHV0U3RyZWFtVGFnc0RpcnR5KXt0aGlzLl9jdXJyZW50VGFncz1bXTtmb3IobGV0IHQgb2YgdGhpcy5fb3V0cHV0U3RyZWFtKXtsZXQgZT1hKHQsaik7bnVsbCE9PWUmJnRoaXMuX2N1cnJlbnRUYWdzLnB1c2goZS50ZXh0KX10aGlzLl9vdXRwdXRTdHJlYW1UYWdzRGlydHk9ITF9cmV0dXJuIHRoaXMuX2N1cnJlbnRUYWdzfWdldCBpbkV4cHJlc3Npb25FdmFsdWF0aW9uKCl7cmV0dXJuIHRoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LmluRXhwcmVzc2lvbkV2YWx1YXRpb259c2V0IGluRXhwcmVzc2lvbkV2YWx1YXRpb24odCl7dGhpcy5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQuaW5FeHByZXNzaW9uRXZhbHVhdGlvbj10fUdvVG9TdGFydCgpe3RoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LmN1cnJlbnRQb2ludGVyPUkuU3RhcnRPZih0aGlzLnN0b3J5Lm1haW5Db250ZW50Q29udGFpbmVyKX1Db3B5QW5kU3RhcnRQYXRjaGluZygpe2xldCB0PW5ldyBIKHRoaXMuc3RvcnkpO3JldHVybiB0Ll9wYXRjaD1uZXcgVSh0aGlzLl9wYXRjaCksdC5vdXRwdXRTdHJlYW0ucHVzaC5hcHBseSh0Lm91dHB1dFN0cmVhbSx0aGlzLl9vdXRwdXRTdHJlYW0pLHQuT3V0cHV0U3RyZWFtRGlydHkoKSx0Ll9jdXJyZW50Q2hvaWNlcy5wdXNoLmFwcGx5KHQuX2N1cnJlbnRDaG9pY2VzLHRoaXMuX2N1cnJlbnRDaG9pY2VzKSx0aGlzLmhhc0Vycm9yJiYodC5fY3VycmVudEVycm9ycz1bXSx0Ll9jdXJyZW50RXJyb3JzLnB1c2guYXBwbHkodC5fY3VycmVudEVycm9ycyx0aGlzLmN1cnJlbnRFcnJvcnN8fFtdKSksdGhpcy5oYXNXYXJuaW5nJiYodC5fY3VycmVudFdhcm5pbmdzPVtdLHQuX2N1cnJlbnRXYXJuaW5ncy5wdXNoLmFwcGx5KHQuX2N1cnJlbnRXYXJuaW5ncyx0aGlzLmN1cnJlbnRXYXJuaW5nc3x8W10pKSx0LmNhbGxTdGFjaz1uZXcgcSh0aGlzLmNhbGxTdGFjayksdC52YXJpYWJsZXNTdGF0ZT10aGlzLnZhcmlhYmxlc1N0YXRlLHQudmFyaWFibGVzU3RhdGUuY2FsbFN0YWNrPXQuY2FsbFN0YWNrLHQudmFyaWFibGVzU3RhdGUucGF0Y2g9dC5fcGF0Y2gsdC5ldmFsdWF0aW9uU3RhY2sucHVzaC5hcHBseSh0LmV2YWx1YXRpb25TdGFjayx0aGlzLmV2YWx1YXRpb25TdGFjayksdGhpcy5kaXZlcnRlZFBvaW50ZXIuaXNOdWxsfHwodC5kaXZlcnRlZFBvaW50ZXI9dGhpcy5kaXZlcnRlZFBvaW50ZXIuY29weSgpKSx0LnByZXZpb3VzUG9pbnRlcj10aGlzLnByZXZpb3VzUG9pbnRlci5jb3B5KCksdC5fdmlzaXRDb3VudHM9dGhpcy5fdmlzaXRDb3VudHMsdC5fdHVybkluZGljZXM9dGhpcy5fdHVybkluZGljZXMsdC5jdXJyZW50VHVybkluZGV4PXRoaXMuY3VycmVudFR1cm5JbmRleCx0LnN0b3J5U2VlZD10aGlzLnN0b3J5U2VlZCx0LnByZXZpb3VzUmFuZG9tPXRoaXMucHJldmlvdXNSYW5kb20sdC5kaWRTYWZlRXhpdD10aGlzLmRpZFNhZmVFeGl0LHR9UmVzdG9yZUFmdGVyUGF0Y2goKXt0aGlzLnZhcmlhYmxlc1N0YXRlLmNhbGxTdGFjaz10aGlzLmNhbGxTdGFjayx0aGlzLnZhcmlhYmxlc1N0YXRlLnBhdGNoPXRoaXMuX3BhdGNofUFwcGx5QW55UGF0Y2goKXtpZihudWxsIT09dGhpcy5fcGF0Y2gpe3RoaXMudmFyaWFibGVzU3RhdGUuQXBwbHlQYXRjaCgpO2ZvcihsZXRbdCxlXW9mIHRoaXMuX3BhdGNoLnZpc2l0Q291bnRzKXRoaXMuQXBwbHlDb3VudENoYW5nZXModCxlLCEwKTtmb3IobGV0W3QsZV1vZiB0aGlzLl9wYXRjaC50dXJuSW5kaWNlcyl0aGlzLkFwcGx5Q291bnRDaGFuZ2VzKHQsZSwhMSk7dGhpcy5fcGF0Y2g9bnVsbH19QXBwbHlDb3VudENoYW5nZXModCxlLG4peyhuP3RoaXMuX3Zpc2l0Q291bnRzOnRoaXMuX3R1cm5JbmRpY2VzKS5zZXQodC5wYXRoLnRvU3RyaW5nKCksZSl9V3JpdGVKc29uKHQpe3QuV3JpdGVPYmplY3RTdGFydCgpO2xldCBlPSExO2ZvcihsZXQgbiBvZiB0aGlzLl9jdXJyZW50Q2hvaWNlcyl7aWYobnVsbD09PW4udGhyZWFkQXRHZW5lcmF0aW9uKXJldHVybiBkKFwiYy50aHJlYWRBdEdlbmVyYXRpb25cIik7bi5vcmlnaW5hbFRocmVhZEluZGV4PW4udGhyZWFkQXRHZW5lcmF0aW9uLnRocmVhZEluZGV4LG51bGw9PT10aGlzLmNhbGxTdGFjay5UaHJlYWRXaXRoSW5kZXgobi5vcmlnaW5hbFRocmVhZEluZGV4KSYmKGV8fChlPSEwLHQuV3JpdGVQcm9wZXJ0eVN0YXJ0KFwiY2hvaWNlVGhyZWFkc1wiKSx0LldyaXRlT2JqZWN0U3RhcnQoKSksdC5Xcml0ZVByb3BlcnR5U3RhcnQobi5vcmlnaW5hbFRocmVhZEluZGV4KSxuLnRocmVhZEF0R2VuZXJhdGlvbi5Xcml0ZUpzb24odCksdC5Xcml0ZVByb3BlcnR5RW5kKCkpfWlmKGUmJih0LldyaXRlT2JqZWN0RW5kKCksdC5Xcml0ZVByb3BlcnR5RW5kKCkpLHQuV3JpdGVQcm9wZXJ0eShcImNhbGxzdGFja1RocmVhZHNcIix0PT50aGlzLmNhbGxTdGFjay5Xcml0ZUpzb24odCkpLHQuV3JpdGVQcm9wZXJ0eShcInZhcmlhYmxlc1N0YXRlXCIsdD0+dGhpcy52YXJpYWJsZXNTdGF0ZS5Xcml0ZUpzb24odCkpLHQuV3JpdGVQcm9wZXJ0eShcImV2YWxTdGFja1wiLHQ9Pk0uV3JpdGVMaXN0UnVudGltZU9ianModCx0aGlzLmV2YWx1YXRpb25TdGFjaykpLHQuV3JpdGVQcm9wZXJ0eShcIm91dHB1dFN0cmVhbVwiLHQ9Pk0uV3JpdGVMaXN0UnVudGltZU9ianModCx0aGlzLl9vdXRwdXRTdHJlYW0pKSx0LldyaXRlUHJvcGVydHkoXCJjdXJyZW50Q2hvaWNlc1wiLHQ9Pnt0LldyaXRlQXJyYXlTdGFydCgpO2ZvcihsZXQgZSBvZiB0aGlzLl9jdXJyZW50Q2hvaWNlcylNLldyaXRlQ2hvaWNlKHQsZSk7dC5Xcml0ZUFycmF5RW5kKCl9KSwhdGhpcy5kaXZlcnRlZFBvaW50ZXIuaXNOdWxsKXtpZihudWxsPT09dGhpcy5kaXZlcnRlZFBvaW50ZXIucGF0aClyZXR1cm4gZChcImRpdmVydGVkUG9pbnRlclwiKTt0LldyaXRlUHJvcGVydHkoXCJjdXJyZW50RGl2ZXJ0VGFyZ2V0XCIsdGhpcy5kaXZlcnRlZFBvaW50ZXIucGF0aC5jb21wb25lbnRzU3RyaW5nKX10LldyaXRlUHJvcGVydHkoXCJ2aXNpdENvdW50c1wiLHQ9Pk0uV3JpdGVJbnREaWN0aW9uYXJ5KHQsdGhpcy5fdmlzaXRDb3VudHMpKSx0LldyaXRlUHJvcGVydHkoXCJ0dXJuSW5kaWNlc1wiLHQ9Pk0uV3JpdGVJbnREaWN0aW9uYXJ5KHQsdGhpcy5fdHVybkluZGljZXMpKSx0LldyaXRlSW50UHJvcGVydHkoXCJ0dXJuSWR4XCIsdGhpcy5jdXJyZW50VHVybkluZGV4KSx0LldyaXRlSW50UHJvcGVydHkoXCJzdG9yeVNlZWRcIix0aGlzLnN0b3J5U2VlZCksdC5Xcml0ZUludFByb3BlcnR5KFwicHJldmlvdXNSYW5kb21cIix0aGlzLnByZXZpb3VzUmFuZG9tKSx0LldyaXRlSW50UHJvcGVydHkoXCJpbmtTYXZlVmVyc2lvblwiLHRoaXMua0lua1NhdmVTdGF0ZVZlcnNpb24pLHQuV3JpdGVJbnRQcm9wZXJ0eShcImlua0Zvcm1hdFZlcnNpb25cIixYLmlua1ZlcnNpb25DdXJyZW50KSx0LldyaXRlT2JqZWN0RW5kKCl9TG9hZEpzb25PYmoodCl7bGV0IG49dCxpPW4uaW5rU2F2ZVZlcnNpb247aWYobnVsbD09aSl0aHJvdyBuZXcgUyhcImluayBzYXZlIGZvcm1hdCBpbmNvcnJlY3QsIGNhbid0IGxvYWQuXCIpO2lmKHBhcnNlSW50KGkpPHRoaXMua01pbkNvbXBhdGlibGVMb2FkVmVyc2lvbil0aHJvdyBuZXcgUyhcIkluayBzYXZlIGZvcm1hdCBpc24ndCBjb21wYXRpYmxlIHdpdGggdGhlIGN1cnJlbnQgdmVyc2lvbiAoc2F3ICdcIitpK1wiJywgYnV0IG1pbmltdW0gaXMgXCIrdGhpcy5rTWluQ29tcGF0aWJsZUxvYWRWZXJzaW9uK1wiKSwgc28gY2FuJ3QgbG9hZC5cIik7dGhpcy5jYWxsU3RhY2suU2V0SnNvblRva2VuKG4uY2FsbHN0YWNrVGhyZWFkcyx0aGlzLnN0b3J5KSx0aGlzLnZhcmlhYmxlc1N0YXRlLlNldEpzb25Ub2tlbihuLnZhcmlhYmxlc1N0YXRlKSx0aGlzLl9ldmFsdWF0aW9uU3RhY2s9TS5KQXJyYXlUb1J1bnRpbWVPYmpMaXN0KG4uZXZhbFN0YWNrKSx0aGlzLl9vdXRwdXRTdHJlYW09TS5KQXJyYXlUb1J1bnRpbWVPYmpMaXN0KG4ub3V0cHV0U3RyZWFtKSx0aGlzLk91dHB1dFN0cmVhbURpcnR5KCksdGhpcy5fY3VycmVudENob2ljZXM9TS5KQXJyYXlUb1J1bnRpbWVPYmpMaXN0KG4uY3VycmVudENob2ljZXMpO2xldCByPW4uY3VycmVudERpdmVydFRhcmdldDtpZihudWxsIT1yKXtsZXQgdD1uZXcgZShyLnRvU3RyaW5nKCkpO3RoaXMuZGl2ZXJ0ZWRQb2ludGVyPXRoaXMuc3RvcnkuUG9pbnRlckF0UGF0aCh0KX10aGlzLl92aXNpdENvdW50cz1NLkpPYmplY3RUb0ludERpY3Rpb25hcnkobi52aXNpdENvdW50cyksdGhpcy5fdHVybkluZGljZXM9TS5KT2JqZWN0VG9JbnREaWN0aW9uYXJ5KG4udHVybkluZGljZXMpLHRoaXMuY3VycmVudFR1cm5JbmRleD1wYXJzZUludChuLnR1cm5JZHgpLHRoaXMuc3RvcnlTZWVkPXBhcnNlSW50KG4uc3RvcnlTZWVkKSx0aGlzLnByZXZpb3VzUmFuZG9tPXBhcnNlSW50KG4ucHJldmlvdXNSYW5kb20pO2xldCBhPW4uY2hvaWNlVGhyZWFkcztmb3IobGV0IHQgb2YgdGhpcy5fY3VycmVudENob2ljZXMpe2xldCBlPXRoaXMuY2FsbFN0YWNrLlRocmVhZFdpdGhJbmRleCh0Lm9yaWdpbmFsVGhyZWFkSW5kZXgpO2lmKG51bGwhPWUpdC50aHJlYWRBdEdlbmVyYXRpb249ZS5Db3B5KCk7ZWxzZXtsZXQgZT1hW3Qub3JpZ2luYWxUaHJlYWRJbmRleC50b1N0cmluZygpXTt0LnRocmVhZEF0R2VuZXJhdGlvbj1uZXcgcS5UaHJlYWQoZSx0aGlzLnN0b3J5KX19fVJlc2V0RXJyb3JzKCl7dGhpcy5fY3VycmVudEVycm9ycz1udWxsLHRoaXMuX2N1cnJlbnRXYXJuaW5ncz1udWxsfVJlc2V0T3V0cHV0KHQ9bnVsbCl7dGhpcy5fb3V0cHV0U3RyZWFtLmxlbmd0aD0wLG51bGwhPT10JiZ0aGlzLl9vdXRwdXRTdHJlYW0ucHVzaC5hcHBseSh0aGlzLl9vdXRwdXRTdHJlYW0sdCksdGhpcy5PdXRwdXRTdHJlYW1EaXJ0eSgpfVB1c2hUb091dHB1dFN0cmVhbSh0KXtsZXQgZT1hKHQsVCk7aWYobnVsbCE9PWUpe2xldCB0PXRoaXMuVHJ5U3BsaXR0aW5nSGVhZFRhaWxXaGl0ZXNwYWNlKGUpO2lmKG51bGwhPT10KXtmb3IobGV0IGUgb2YgdCl0aGlzLlB1c2hUb091dHB1dFN0cmVhbUluZGl2aWR1YWwoZSk7cmV0dXJuIHZvaWQgdGhpcy5PdXRwdXRTdHJlYW1EaXJ0eSgpfX10aGlzLlB1c2hUb091dHB1dFN0cmVhbUluZGl2aWR1YWwodCksdGhpcy5PdXRwdXRTdHJlYW1EaXJ0eSgpfVBvcEZyb21PdXRwdXRTdHJlYW0odCl7dGhpcy5vdXRwdXRTdHJlYW0uc3BsaWNlKHRoaXMub3V0cHV0U3RyZWFtLmxlbmd0aC10LHQpLHRoaXMuT3V0cHV0U3RyZWFtRGlydHkoKX1UcnlTcGxpdHRpbmdIZWFkVGFpbFdoaXRlc3BhY2UodCl7bGV0IGU9dC52YWx1ZTtpZihudWxsPT09ZSlyZXR1cm4gZChcInNpbmdsZS52YWx1ZVwiKTtsZXQgbj0tMSxpPS0xO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGg7Kyt0KXtsZXQgcj1lW3RdO2lmKFwiXFxuXCIhPXIpe2lmKFwiIFwiPT1yfHxcIlxcdFwiPT1yKWNvbnRpbnVlO2JyZWFrfS0xPT1uJiYobj10KSxpPXR9bGV0IHI9LTEsYT0tMTtmb3IobGV0IHQ9MDt0PGUubGVuZ3RoOysrdCl7bGV0IG49ZVt0XTtpZihcIlxcblwiIT1uKXtpZihcIiBcIj09bnx8XCJcXHRcIj09biljb250aW51ZTticmVha30tMT09ciYmKHI9dCksYT10fWlmKC0xPT1uJiYtMT09cilyZXR1cm4gbnVsbDtsZXQgcz1bXSxsPTAsbz1lLmxlbmd0aDtpZigtMSE9bil7aWYobj4wKXtsZXQgdD1uZXcgVChlLnN1YnN0cmluZygwLG4pKTtzLnB1c2godCl9cy5wdXNoKG5ldyBUKFwiXFxuXCIpKSxsPWkrMX1pZigtMSE9ciYmKG89YSksbz5sKXtsZXQgdD1lLnN1YnN0cmluZyhsLG8tbCk7cy5wdXNoKG5ldyBUKHQpKX1pZigtMSE9ciYmYT5pJiYocy5wdXNoKG5ldyBUKFwiXFxuXCIpKSxyPGUubGVuZ3RoLTEpKXtsZXQgdD1lLmxlbmd0aC1yLTEsbj1uZXcgVChlLnN1YnN0cmluZyhyKzEsdCkpO3MucHVzaChuKX1yZXR1cm4gc31QdXNoVG9PdXRwdXRTdHJlYW1JbmRpdmlkdWFsKHQpe2xldCBlPWEodCx4KSxuPWEodCxUKSxpPSEwO2lmKGUpdGhpcy5UcmltTmV3bGluZXNGcm9tT3V0cHV0U3RyZWFtKCksaT0hMDtlbHNlIGlmKG4pe2xldCB0PS0xLGU9dGhpcy5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQ7ZS50eXBlPT1yLkZ1bmN0aW9uJiYodD1lLmZ1bmN0aW9uU3RhcnRJbk91dHB1dFN0cmVhbSk7bGV0IGE9LTE7Zm9yKGxldCBlPXRoaXMuX291dHB1dFN0cmVhbS5sZW5ndGgtMTtlPj0wO2UtLSl7bGV0IG49dGhpcy5fb3V0cHV0U3RyZWFtW2VdLGk9biBpbnN0YW5jZW9mIEE/bjpudWxsO2lmKG51bGwhPShuIGluc3RhbmNlb2YgeD9uOm51bGwpKXthPWU7YnJlYWt9aWYobnVsbCE9aSYmaS5jb21tYW5kVHlwZT09QS5Db21tYW5kVHlwZS5CZWdpblN0cmluZyl7ZT49dCYmKHQ9LTEpO2JyZWFrfX1sZXQgcz0tMTtpZihzPS0xIT1hJiYtMSE9dD9NYXRoLm1pbih0LGEpOi0xIT1hP2E6dCwtMSE9cyl7aWYobi5pc05ld2xpbmUpaT0hMTtlbHNlIGlmKG4uaXNOb25XaGl0ZXNwYWNlJiYoYT4tMSYmdGhpcy5SZW1vdmVFeGlzdGluZ0dsdWUoKSx0Pi0xKSl7bGV0IHQ9dGhpcy5jYWxsU3RhY2suZWxlbWVudHM7Zm9yKGxldCBlPXQubGVuZ3RoLTE7ZT49MDtlLS0pe2xldCBuPXRbZV07aWYobi50eXBlIT1yLkZ1bmN0aW9uKWJyZWFrO24uZnVuY3Rpb25TdGFydEluT3V0cHV0U3RyZWFtPS0xfX19ZWxzZSBuLmlzTmV3bGluZSYmKCF0aGlzLm91dHB1dFN0cmVhbUVuZHNJbk5ld2xpbmUmJnRoaXMub3V0cHV0U3RyZWFtQ29udGFpbnNDb250ZW50fHwoaT0hMSkpfWlmKGkpe2lmKG51bGw9PT10KXJldHVybiBkKFwib2JqXCIpO3RoaXMuX291dHB1dFN0cmVhbS5wdXNoKHQpLHRoaXMuT3V0cHV0U3RyZWFtRGlydHkoKX19VHJpbU5ld2xpbmVzRnJvbU91dHB1dFN0cmVhbSgpe2xldCB0PS0xLGU9dGhpcy5fb3V0cHV0U3RyZWFtLmxlbmd0aC0xO2Zvcig7ZT49MDspe2xldCBuPXRoaXMuX291dHB1dFN0cmVhbVtlXSxpPWEobixBKSxyPWEobixUKTtpZihudWxsIT1pfHxudWxsIT1yJiZyLmlzTm9uV2hpdGVzcGFjZSlicmVhaztudWxsIT1yJiZyLmlzTmV3bGluZSYmKHQ9ZSksZS0tfWlmKHQ+PTApZm9yKGU9dDtlPHRoaXMuX291dHB1dFN0cmVhbS5sZW5ndGg7KXthKHRoaXMuX291dHB1dFN0cmVhbVtlXSxUKT90aGlzLl9vdXRwdXRTdHJlYW0uc3BsaWNlKGUsMSk6ZSsrfXRoaXMuT3V0cHV0U3RyZWFtRGlydHkoKX1SZW1vdmVFeGlzdGluZ0dsdWUoKXtmb3IobGV0IHQ9dGhpcy5fb3V0cHV0U3RyZWFtLmxlbmd0aC0xO3Q+PTA7dC0tKXtsZXQgZT10aGlzLl9vdXRwdXRTdHJlYW1bdF07aWYoZSBpbnN0YW5jZW9mIHgpdGhpcy5fb3V0cHV0U3RyZWFtLnNwbGljZSh0LDEpO2Vsc2UgaWYoZSBpbnN0YW5jZW9mIEEpYnJlYWt9dGhpcy5PdXRwdXRTdHJlYW1EaXJ0eSgpfWdldCBvdXRwdXRTdHJlYW1FbmRzSW5OZXdsaW5lKCl7aWYodGhpcy5fb3V0cHV0U3RyZWFtLmxlbmd0aD4wKWZvcihsZXQgdD10aGlzLl9vdXRwdXRTdHJlYW0ubGVuZ3RoLTE7dD49MDt0LS0pe2lmKHRoaXMuX291dHB1dFN0cmVhbVt0XWluc3RhbmNlb2YgQSlicmVhaztsZXQgZT10aGlzLl9vdXRwdXRTdHJlYW1bdF07aWYoZSBpbnN0YW5jZW9mIFQpe2lmKGUuaXNOZXdsaW5lKXJldHVybiEwO2lmKGUuaXNOb25XaGl0ZXNwYWNlKWJyZWFrfX1yZXR1cm4hMX1nZXQgb3V0cHV0U3RyZWFtQ29udGFpbnNDb250ZW50KCl7Zm9yKGxldCB0PTA7dDx0aGlzLl9vdXRwdXRTdHJlYW0ubGVuZ3RoO3QrKylpZih0aGlzLl9vdXRwdXRTdHJlYW1bdF1pbnN0YW5jZW9mIFQpcmV0dXJuITA7cmV0dXJuITF9Z2V0IGluU3RyaW5nRXZhbHVhdGlvbigpe2ZvcihsZXQgdD10aGlzLl9vdXRwdXRTdHJlYW0ubGVuZ3RoLTE7dD49MDt0LS0pe2xldCBlPWEodGhpcy5fb3V0cHV0U3RyZWFtW3RdLEEpO2lmKGUgaW5zdGFuY2VvZiBBJiZlLmNvbW1hbmRUeXBlPT1BLkNvbW1hbmRUeXBlLkJlZ2luU3RyaW5nKXJldHVybiEwfXJldHVybiExfVB1c2hFdmFsdWF0aW9uU3RhY2sodCl7bGV0IGU9YSh0LE8pO2lmKGUpe2xldCB0PWUudmFsdWU7aWYobnVsbD09PXQpcmV0dXJuIGQoXCJyYXdMaXN0XCIpO2lmKG51bGwhPXQub3JpZ2luTmFtZXMpe3Qub3JpZ2luc3x8KHQub3JpZ2lucz1bXSksdC5vcmlnaW5zLmxlbmd0aD0wO2ZvcihsZXQgZSBvZiB0Lm9yaWdpbk5hbWVzKXtpZihudWxsPT09dGhpcy5zdG9yeS5saXN0RGVmaW5pdGlvbnMpcmV0dXJuIGQoXCJTdG9yeVN0YXRlLnN0b3J5Lmxpc3REZWZpbml0aW9uc1wiKTtsZXQgbj10aGlzLnN0b3J5Lmxpc3REZWZpbml0aW9ucy5UcnlMaXN0R2V0RGVmaW5pdGlvbihlLG51bGwpO2lmKG51bGw9PT1uLnJlc3VsdClyZXR1cm4gZChcIlN0b3J5U3RhdGUgZGVmLnJlc3VsdFwiKTt0Lm9yaWdpbnMuaW5kZXhPZihuLnJlc3VsdCk8MCYmdC5vcmlnaW5zLnB1c2gobi5yZXN1bHQpfX19aWYobnVsbD09PXQpcmV0dXJuIGQoXCJvYmpcIik7dGhpcy5ldmFsdWF0aW9uU3RhY2sucHVzaCh0KX1Qb3BFdmFsdWF0aW9uU3RhY2sodCl7aWYodm9pZCAwPT09dCl7cmV0dXJuIG8odGhpcy5ldmFsdWF0aW9uU3RhY2sucG9wKCkpfWlmKHQ+dGhpcy5ldmFsdWF0aW9uU3RhY2subGVuZ3RoKXRocm93IG5ldyBFcnJvcihcInRyeWluZyB0byBwb3AgdG9vIG1hbnkgb2JqZWN0c1wiKTtyZXR1cm4gbyh0aGlzLmV2YWx1YXRpb25TdGFjay5zcGxpY2UodGhpcy5ldmFsdWF0aW9uU3RhY2subGVuZ3RoLXQsdCkpfVBlZWtFdmFsdWF0aW9uU3RhY2soKXtyZXR1cm4gdGhpcy5ldmFsdWF0aW9uU3RhY2tbdGhpcy5ldmFsdWF0aW9uU3RhY2subGVuZ3RoLTFdfUZvcmNlRW5kKCl7dGhpcy5jYWxsU3RhY2suUmVzZXQoKSx0aGlzLl9jdXJyZW50Q2hvaWNlcy5sZW5ndGg9MCx0aGlzLmN1cnJlbnRQb2ludGVyPUkuTnVsbCx0aGlzLnByZXZpb3VzUG9pbnRlcj1JLk51bGwsdGhpcy5kaWRTYWZlRXhpdD0hMH1UcmltV2hpdGVzcGFjZUZyb21GdW5jdGlvbkVuZCgpe24uQXNzZXJ0KHRoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LnR5cGU9PXIuRnVuY3Rpb24pO2xldCB0PXRoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LmZ1bmN0aW9uU3RhcnRJbk91dHB1dFN0cmVhbTstMT09dCYmKHQ9MCk7Zm9yKGxldCBlPXRoaXMuX291dHB1dFN0cmVhbS5sZW5ndGgtMTtlPj10O2UtLSl7bGV0IHQ9dGhpcy5fb3V0cHV0U3RyZWFtW2VdLG49YSh0LFQpLGk9YSh0LEEpO2lmKG51bGwhPW4pe2lmKGkpYnJlYWs7aWYoIW4uaXNOZXdsaW5lJiYhbi5pc0lubGluZVdoaXRlc3BhY2UpYnJlYWs7dGhpcy5fb3V0cHV0U3RyZWFtLnNwbGljZShlLDEpLHRoaXMuT3V0cHV0U3RyZWFtRGlydHkoKX19fVBvcENhbGxTdGFjayh0PW51bGwpe3RoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LnR5cGU9PXIuRnVuY3Rpb24mJnRoaXMuVHJpbVdoaXRlc3BhY2VGcm9tRnVuY3Rpb25FbmQoKSx0aGlzLmNhbGxTdGFjay5Qb3AodCl9U2V0Q2hvc2VuUGF0aCh0LGUpe3RoaXMuX2N1cnJlbnRDaG9pY2VzLmxlbmd0aD0wO2xldCBuPXRoaXMuc3RvcnkuUG9pbnRlckF0UGF0aCh0KTtuLmlzTnVsbHx8LTEhPW4uaW5kZXh8fChuLmluZGV4PTApLHRoaXMuY3VycmVudFBvaW50ZXI9bixlJiZ0aGlzLmN1cnJlbnRUdXJuSW5kZXgrK31TdGFydEZ1bmN0aW9uRXZhbHVhdGlvbkZyb21HYW1lKHQsZSl7dGhpcy5jYWxsU3RhY2suUHVzaChyLkZ1bmN0aW9uRXZhbHVhdGlvbkZyb21HYW1lLHRoaXMuZXZhbHVhdGlvblN0YWNrLmxlbmd0aCksdGhpcy5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQuY3VycmVudFBvaW50ZXI9SS5TdGFydE9mKHQpLHRoaXMuUGFzc0FyZ3VtZW50c1RvRXZhbHVhdGlvblN0YWNrKGUpfVBhc3NBcmd1bWVudHNUb0V2YWx1YXRpb25TdGFjayh0KXtpZihudWxsIT10KWZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKXtpZihcIm51bWJlclwiIT10eXBlb2YgdFtlXSYmXCJzdHJpbmdcIiE9dHlwZW9mIHRbZV0pdGhyb3cgbmV3IEVycm9yKFwiaW5rIGFyZ3VtZW50cyB3aGVuIGNhbGxpbmcgRXZhbHVhdGVGdW5jdGlvbiAvIENob29zZVBhdGhTdHJpbmdXaXRoUGFyYW1ldGVycyAgbXVzdCBiZSBpbnQsIGZsb2F0IG9yIHN0cmluZ1wiKTt0aGlzLlB1c2hFdmFsdWF0aW9uU3RhY2sodi5DcmVhdGUodFtlXSkpfX1UcnlFeGl0RnVuY3Rpb25FdmFsdWF0aW9uRnJvbUdhbWUoKXtyZXR1cm4gdGhpcy5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQudHlwZT09ci5GdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZSYmKHRoaXMuY3VycmVudFBvaW50ZXI9SS5OdWxsLHRoaXMuZGlkU2FmZUV4aXQ9ITAsITApfUNvbXBsZXRlRnVuY3Rpb25FdmFsdWF0aW9uRnJvbUdhbWUoKXtpZih0aGlzLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC50eXBlIT1yLkZ1bmN0aW9uRXZhbHVhdGlvbkZyb21HYW1lKXRocm93IG5ldyBTKFwiRXhwZWN0ZWQgZXh0ZXJuYWwgZnVuY3Rpb24gZXZhbHVhdGlvbiB0byBiZSBjb21wbGV0ZS4gU3RhY2sgdHJhY2U6IFwiK3RoaXMuY2FsbFN0YWNrLmNhbGxTdGFja1RyYWNlKTtsZXQgdD10aGlzLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC5ldmFsdWF0aW9uU3RhY2tIZWlnaHRXaGVuUHVzaGVkLGU9bnVsbDtmb3IoO3RoaXMuZXZhbHVhdGlvblN0YWNrLmxlbmd0aD50Oyl7bGV0IHQ9dGhpcy5Qb3BFdmFsdWF0aW9uU3RhY2soKTtudWxsPT09ZSYmKGU9dCl9aWYodGhpcy5Qb3BDYWxsU3RhY2soci5GdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZSksZSl7aWYoZSBpbnN0YW5jZW9mIEwpcmV0dXJuIG51bGw7bGV0IHQ9cyhlLHYpO3JldHVybiB0LnZhbHVlVHlwZT09aS5EaXZlcnRUYXJnZXQ/dC52YWx1ZU9iamVjdC50b1N0cmluZygpOnQudmFsdWVPYmplY3R9cmV0dXJuIG51bGx9QWRkRXJyb3IodCxlKXtlPyhudWxsPT10aGlzLl9jdXJyZW50V2FybmluZ3MmJih0aGlzLl9jdXJyZW50V2FybmluZ3M9W10pLHRoaXMuX2N1cnJlbnRXYXJuaW5ncy5wdXNoKHQpKToobnVsbD09dGhpcy5fY3VycmVudEVycm9ycyYmKHRoaXMuX2N1cnJlbnRFcnJvcnM9W10pLHRoaXMuX2N1cnJlbnRFcnJvcnMucHVzaCh0KSl9T3V0cHV0U3RyZWFtRGlydHkoKXt0aGlzLl9vdXRwdXRTdHJlYW1UZXh0RGlydHk9ITAsdGhpcy5fb3V0cHV0U3RyZWFtVGFnc0RpcnR5PSEwfX1jbGFzcyAke2NvbnN0cnVjdG9yKCl7dGhpcy5zdGFydFRpbWU9dm9pZCAwfWdldCBFbGFwc2VkTWlsbGlzZWNvbmRzKCl7cmV0dXJuIHZvaWQgMD09PXRoaXMuc3RhcnRUaW1lPzA6KG5ldyBEYXRlKS5nZXRUaW1lKCktdGhpcy5zdGFydFRpbWV9U3RhcnQoKXt0aGlzLnN0YXJ0VGltZT0obmV3IERhdGUpLmdldFRpbWUoKX1TdG9wKCl7dGhpcy5zdGFydFRpbWU9dm9pZCAwfX1OdW1iZXIuaXNJbnRlZ2VyfHwoTnVtYmVyLmlzSW50ZWdlcj1mdW5jdGlvbih0KXtyZXR1cm5cIm51bWJlclwiPT10eXBlb2YgdCYmaXNGaW5pdGUodCkmJnQ+LTkwMDcxOTkyNTQ3NDA5OTImJnQ8OTAwNzE5OTI1NDc0MDk5MiYmTWF0aC5mbG9vcih0KT09PXR9KTtjbGFzcyBYIGV4dGVuZHMgcHtjb25zdHJ1Y3Rvcigpe2xldCB0O3N1cGVyKCksdGhpcy5pbmtWZXJzaW9uTWluaW11bUNvbXBhdGlibGU9MTgsdGhpcy5fcHJldkNvbnRhaW5lcnM9W10sdGhpcy5hbGxvd0V4dGVybmFsRnVuY3Rpb25GYWxsYmFja3M9ITEsdGhpcy5fbGlzdERlZmluaXRpb25zPW51bGwsdGhpcy5fdmFyaWFibGVPYnNlcnZlcnM9bnVsbCx0aGlzLl9oYXNWYWxpZGF0ZWRFeHRlcm5hbHM9ITEsdGhpcy5fdGVtcG9yYXJ5RXZhbHVhdGlvbkNvbnRhaW5lcj1udWxsLHRoaXMuX2FzeW5jQ29udGludWVBY3RpdmU9ITEsdGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmU9bnVsbCx0aGlzLl9yZWN1cnNpdmVDb250aW51ZUNvdW50PTAsdGhpcy5fYXN5bmNTYXZpbmc9ITEsdGhpcy5fcHJvZmlsZXI9bnVsbDtsZXQgZT1udWxsLG49bnVsbDtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIE4pdD1hcmd1bWVudHNbMF0sdm9pZCAwIT09YXJndW1lbnRzWzFdJiYoZT1hcmd1bWVudHNbMV0pLHRoaXMuX21haW5Db250ZW50Q29udGFpbmVyPXQ7ZWxzZSBpZihcInN0cmluZ1wiPT10eXBlb2YgYXJndW1lbnRzWzBdKXtsZXQgdD1hcmd1bWVudHNbMF07bj16LlRleHRUb0RpY3Rpb25hcnkodCl9ZWxzZSBuPWFyZ3VtZW50c1swXTtpZihudWxsIT1lJiYodGhpcy5fbGlzdERlZmluaXRpb25zPW5ldyBCKGUpKSx0aGlzLl9leHRlcm5hbHM9bmV3IE1hcCxudWxsIT09bil7bGV0IHQ9bixlPXQuaW5rVmVyc2lvbjtpZihudWxsPT1lKXRocm93IG5ldyBFcnJvcihcImluayB2ZXJzaW9uIG51bWJlciBub3QgZm91bmQuIEFyZSB5b3Ugc3VyZSBpdCdzIGEgdmFsaWQgLmluay5qc29uIGZpbGU/XCIpO2xldCBpPXBhcnNlSW50KGUpO2lmKGk+WC5pbmtWZXJzaW9uQ3VycmVudCl0aHJvdyBuZXcgRXJyb3IoXCJWZXJzaW9uIG9mIGluayB1c2VkIHRvIGJ1aWxkIHN0b3J5IHdhcyBuZXdlciB0aGFuIHRoZSBjdXJyZW50IHZlcnNpb24gb2YgdGhlIGVuZ2luZVwiKTtpZihpPHRoaXMuaW5rVmVyc2lvbk1pbmltdW1Db21wYXRpYmxlKXRocm93IG5ldyBFcnJvcihcIlZlcnNpb24gb2YgaW5rIHVzZWQgdG8gYnVpbGQgc3RvcnkgaXMgdG9vIG9sZCB0byBiZSBsb2FkZWQgYnkgdGhpcyB2ZXJzaW9uIG9mIHRoZSBlbmdpbmVcIik7aSE9WC5pbmtWZXJzaW9uQ3VycmVudCYmY29uc29sZS53YXJuKFwiV0FSTklORzogVmVyc2lvbiBvZiBpbmsgdXNlZCB0byBidWlsZCBzdG9yeSBkb2Vzbid0IG1hdGNoIGN1cnJlbnQgdmVyc2lvbiBvZiBlbmdpbmUuIE5vbi1jcml0aWNhbCwgYnV0IHJlY29tbWVuZCBzeW5jaHJvbmlzaW5nLlwiKTtsZXQgcixhPXQucm9vdDtpZihudWxsPT1hKXRocm93IG5ldyBFcnJvcihcIlJvb3Qgbm9kZSBmb3IgaW5rIG5vdCBmb3VuZC4gQXJlIHlvdSBzdXJlIGl0J3MgYSB2YWxpZCAuaW5rLmpzb24gZmlsZT9cIik7KHI9dC5saXN0RGVmcykmJih0aGlzLl9saXN0RGVmaW5pdGlvbnM9TS5KVG9rZW5Ub0xpc3REZWZpbml0aW9ucyhyKSksdGhpcy5fbWFpbkNvbnRlbnRDb250YWluZXI9cyhNLkpUb2tlblRvUnVudGltZU9iamVjdChhKSxOKSx0aGlzLlJlc2V0U3RhdGUoKX19Z2V0IGN1cnJlbnRDaG9pY2VzKCl7bGV0IHQ9W107aWYobnVsbD09PXRoaXMuX3N0YXRlKXJldHVybiBkKFwidGhpcy5fc3RhdGVcIik7Zm9yKGxldCBlIG9mIHRoaXMuX3N0YXRlLmN1cnJlbnRDaG9pY2VzKWUuaXNJbnZpc2libGVEZWZhdWx0fHwoZS5pbmRleD10Lmxlbmd0aCx0LnB1c2goZSkpO3JldHVybiB0fWdldCBjdXJyZW50VGV4dCgpe3JldHVybiB0aGlzLklmQXN5bmNXZUNhbnQoXCJjYWxsIGN1cnJlbnRUZXh0IHNpbmNlIGl0J3MgYSB3b3JrIGluIHByb2dyZXNzXCIpLHRoaXMuc3RhdGUuY3VycmVudFRleHR9Z2V0IGN1cnJlbnRUYWdzKCl7cmV0dXJuIHRoaXMuSWZBc3luY1dlQ2FudChcImNhbGwgY3VycmVudFRhZ3Mgc2luY2UgaXQncyBhIHdvcmsgaW4gcHJvZ3Jlc3NcIiksdGhpcy5zdGF0ZS5jdXJyZW50VGFnc31nZXQgY3VycmVudEVycm9ycygpe3JldHVybiB0aGlzLnN0YXRlLmN1cnJlbnRFcnJvcnN9Z2V0IGN1cnJlbnRXYXJuaW5ncygpe3JldHVybiB0aGlzLnN0YXRlLmN1cnJlbnRXYXJuaW5nc31nZXQgaGFzRXJyb3IoKXtyZXR1cm4gdGhpcy5zdGF0ZS5oYXNFcnJvcn1nZXQgaGFzV2FybmluZygpe3JldHVybiB0aGlzLnN0YXRlLmhhc1dhcm5pbmd9Z2V0IHZhcmlhYmxlc1N0YXRlKCl7cmV0dXJuIHRoaXMuc3RhdGUudmFyaWFibGVzU3RhdGV9Z2V0IGxpc3REZWZpbml0aW9ucygpe3JldHVybiB0aGlzLl9saXN0RGVmaW5pdGlvbnN9Z2V0IHN0YXRlKCl7cmV0dXJuIHRoaXMuX3N0YXRlfVN0YXJ0UHJvZmlsaW5nKCl7fUVuZFByb2ZpbGluZygpe31Ub0pzb24odCl7bGV0IGU9ITE7aWYodHx8KGU9ITAsdD1uZXcgei5Xcml0ZXIpLHQuV3JpdGVPYmplY3RTdGFydCgpLHQuV3JpdGVJbnRQcm9wZXJ0eShcImlua1ZlcnNpb25cIixYLmlua1ZlcnNpb25DdXJyZW50KSx0LldyaXRlUHJvcGVydHkoXCJyb290XCIsdD0+TS5Xcml0ZVJ1bnRpbWVDb250YWluZXIodCx0aGlzLl9tYWluQ29udGVudENvbnRhaW5lcikpLG51bGwhPXRoaXMuX2xpc3REZWZpbml0aW9ucyl7dC5Xcml0ZVByb3BlcnR5U3RhcnQoXCJsaXN0RGVmc1wiKSx0LldyaXRlT2JqZWN0U3RhcnQoKTtmb3IobGV0IGUgb2YgdGhpcy5fbGlzdERlZmluaXRpb25zLmxpc3RzKXt0LldyaXRlUHJvcGVydHlTdGFydChlLm5hbWUpLHQuV3JpdGVPYmplY3RTdGFydCgpO2ZvcihsZXRbbixpXW9mIGUuaXRlbXMpe2xldCBlPWYuZnJvbVNlcmlhbGl6ZWRLZXkobikscj1pO3QuV3JpdGVJbnRQcm9wZXJ0eShlLml0ZW1OYW1lLHIpfXQuV3JpdGVPYmplY3RFbmQoKSx0LldyaXRlUHJvcGVydHlFbmQoKX10LldyaXRlT2JqZWN0RW5kKCksdC5Xcml0ZVByb3BlcnR5RW5kKCl9aWYodC5Xcml0ZU9iamVjdEVuZCgpLGUpcmV0dXJuIHQuVG9TdHJpbmcoKX1SZXNldFN0YXRlKCl7dGhpcy5JZkFzeW5jV2VDYW50KFwiUmVzZXRTdGF0ZVwiKSx0aGlzLl9zdGF0ZT1uZXcgSCh0aGlzKSx0aGlzLl9zdGF0ZS52YXJpYWJsZXNTdGF0ZS5PYnNlcnZlVmFyaWFibGVDaGFuZ2UodGhpcy5WYXJpYWJsZVN0YXRlRGlkQ2hhbmdlRXZlbnQuYmluZCh0aGlzKSksdGhpcy5SZXNldEdsb2JhbHMoKX1SZXNldEVycm9ycygpe2lmKG51bGw9PT10aGlzLl9zdGF0ZSlyZXR1cm4gZChcInRoaXMuX3N0YXRlXCIpO3RoaXMuX3N0YXRlLlJlc2V0RXJyb3JzKCl9UmVzZXRDYWxsc3RhY2soKXtpZih0aGlzLklmQXN5bmNXZUNhbnQoXCJSZXNldENhbGxzdGFja1wiKSxudWxsPT09dGhpcy5fc3RhdGUpcmV0dXJuIGQoXCJ0aGlzLl9zdGF0ZVwiKTt0aGlzLl9zdGF0ZS5Gb3JjZUVuZCgpfVJlc2V0R2xvYmFscygpe2lmKHRoaXMuX21haW5Db250ZW50Q29udGFpbmVyLm5hbWVkQ29udGVudC5nZXQoXCJnbG9iYWwgZGVjbFwiKSl7bGV0IHQ9dGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlci5jb3B5KCk7dGhpcy5DaG9vc2VQYXRoKG5ldyBlKFwiZ2xvYmFsIGRlY2xcIiksITEpLHRoaXMuQ29udGludWVJbnRlcm5hbCgpLHRoaXMuc3RhdGUuY3VycmVudFBvaW50ZXI9dH10aGlzLnN0YXRlLnZhcmlhYmxlc1N0YXRlLlNuYXBzaG90RGVmYXVsdEdsb2JhbHMoKX1Db250aW51ZSgpe3JldHVybiB0aGlzLkNvbnRpbnVlQXN5bmMoMCksdGhpcy5jdXJyZW50VGV4dH1nZXQgY2FuQ29udGludWUoKXtyZXR1cm4gdGhpcy5zdGF0ZS5jYW5Db250aW51ZX1nZXQgYXN5bmNDb250aW51ZUNvbXBsZXRlKCl7cmV0dXJuIXRoaXMuX2FzeW5jQ29udGludWVBY3RpdmV9Q29udGludWVBc3luYyh0KXt0aGlzLl9oYXNWYWxpZGF0ZWRFeHRlcm5hbHN8fHRoaXMuVmFsaWRhdGVFeHRlcm5hbEJpbmRpbmdzKCksdGhpcy5Db250aW51ZUludGVybmFsKHQpfUNvbnRpbnVlSW50ZXJuYWwodD0wKXtudWxsIT10aGlzLl9wcm9maWxlciYmdGhpcy5fcHJvZmlsZXIuUHJlQ29udGludWUoKTtsZXQgZT10PjA7aWYodGhpcy5fcmVjdXJzaXZlQ29udGludWVDb3VudCsrLCF0aGlzLl9hc3luY0NvbnRpbnVlQWN0aXZlKXtpZih0aGlzLl9hc3luY0NvbnRpbnVlQWN0aXZlPWUsIXRoaXMuY2FuQ29udGludWUpdGhyb3cgbmV3IFMoXCJDYW4ndCBjb250aW51ZSAtIHNob3VsZCBjaGVjayBjYW5Db250aW51ZSBiZWZvcmUgY2FsbGluZyBDb250aW51ZVwiKTt0aGlzLl9zdGF0ZS5kaWRTYWZlRXhpdD0hMSx0aGlzLl9zdGF0ZS5SZXNldE91dHB1dCgpLDE9PXRoaXMuX3JlY3Vyc2l2ZUNvbnRpbnVlQ291bnQmJih0aGlzLl9zdGF0ZS52YXJpYWJsZXNTdGF0ZS5iYXRjaE9ic2VydmluZ1ZhcmlhYmxlQ2hhbmdlcz0hMCl9bGV0IG49bmV3ICQ7bi5TdGFydCgpO2xldCBpPSExO2Rve3RyeXtpPXRoaXMuQ29udGludWVTaW5nbGVTdGVwKCl9Y2F0Y2godCl7aWYoISh0IGluc3RhbmNlb2YgUykpdGhyb3cgdDt0aGlzLkFkZEVycm9yKHQubWVzc2FnZSx2b2lkIDAsdC51c2VFbmRMaW5lTnVtYmVyKTticmVha31pZihpKWJyZWFrO2lmKHRoaXMuX2FzeW5jQ29udGludWVBY3RpdmUmJm4uRWxhcHNlZE1pbGxpc2Vjb25kcz50KWJyZWFrfXdoaWxlKHRoaXMuY2FuQ29udGludWUpO24uU3RvcCgpLCFpJiZ0aGlzLmNhbkNvbnRpbnVlfHwobnVsbCE9PXRoaXMuX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lJiZ0aGlzLlJlc3RvcmVTdGF0ZVNuYXBzaG90KCksdGhpcy5jYW5Db250aW51ZXx8KHRoaXMuc3RhdGUuY2FsbFN0YWNrLmNhblBvcFRocmVhZCYmdGhpcy5BZGRFcnJvcihcIlRocmVhZCBhdmFpbGFibGUgdG8gcG9wLCB0aHJlYWRzIHNob3VsZCBhbHdheXMgYmUgZmxhdCBieSB0aGUgZW5kIG9mIGV2YWx1YXRpb24/XCIpLDAhPXRoaXMuc3RhdGUuZ2VuZXJhdGVkQ2hvaWNlcy5sZW5ndGh8fHRoaXMuc3RhdGUuZGlkU2FmZUV4aXR8fG51bGwhPXRoaXMuX3RlbXBvcmFyeUV2YWx1YXRpb25Db250YWluZXJ8fCh0aGlzLnN0YXRlLmNhbGxTdGFjay5DYW5Qb3Aoci5UdW5uZWwpP3RoaXMuQWRkRXJyb3IoXCJ1bmV4cGVjdGVkbHkgcmVhY2hlZCBlbmQgb2YgY29udGVudC4gRG8geW91IG5lZWQgYSAnLT4tPicgdG8gcmV0dXJuIGZyb20gYSB0dW5uZWw/XCIpOnRoaXMuc3RhdGUuY2FsbFN0YWNrLkNhblBvcChyLkZ1bmN0aW9uKT90aGlzLkFkZEVycm9yKFwidW5leHBlY3RlZGx5IHJlYWNoZWQgZW5kIG9mIGNvbnRlbnQuIERvIHlvdSBuZWVkIGEgJ34gcmV0dXJuJz9cIik6dGhpcy5zdGF0ZS5jYWxsU3RhY2suY2FuUG9wP3RoaXMuQWRkRXJyb3IoXCJ1bmV4cGVjdGVkbHkgcmVhY2hlZCBlbmQgb2YgY29udGVudCBmb3IgdW5rbm93biByZWFzb24uIFBsZWFzZSBkZWJ1ZyBjb21waWxlciFcIik6dGhpcy5BZGRFcnJvcihcInJhbiBvdXQgb2YgY29udGVudC4gRG8geW91IG5lZWQgYSAnLT4gRE9ORScgb3IgJy0+IEVORCc/XCIpKSksdGhpcy5zdGF0ZS5kaWRTYWZlRXhpdD0hMSwxPT10aGlzLl9yZWN1cnNpdmVDb250aW51ZUNvdW50JiYodGhpcy5fc3RhdGUudmFyaWFibGVzU3RhdGUuYmF0Y2hPYnNlcnZpbmdWYXJpYWJsZUNoYW5nZXM9ITEpLHRoaXMuX2FzeW5jQ29udGludWVBY3RpdmU9ITEpLHRoaXMuX3JlY3Vyc2l2ZUNvbnRpbnVlQ291bnQtLSxudWxsIT10aGlzLl9wcm9maWxlciYmdGhpcy5fcHJvZmlsZXIuUG9zdENvbnRpbnVlKCl9Q29udGludWVTaW5nbGVTdGVwKCl7aWYobnVsbCE9dGhpcy5fcHJvZmlsZXImJnRoaXMuX3Byb2ZpbGVyLlByZVN0ZXAoKSx0aGlzLlN0ZXAoKSxudWxsIT10aGlzLl9wcm9maWxlciYmdGhpcy5fcHJvZmlsZXIuUG9zdFN0ZXAoKSx0aGlzLmNhbkNvbnRpbnVlfHx0aGlzLnN0YXRlLmNhbGxTdGFjay5lbGVtZW50SXNFdmFsdWF0ZUZyb21HYW1lfHx0aGlzLlRyeUZvbGxvd0RlZmF1bHRJbnZpc2libGVDaG9pY2UoKSxudWxsIT10aGlzLl9wcm9maWxlciYmdGhpcy5fcHJvZmlsZXIuUHJlU25hcHNob3QoKSwhdGhpcy5zdGF0ZS5pblN0cmluZ0V2YWx1YXRpb24pe2lmKG51bGwhPT10aGlzLl9zdGF0ZVNuYXBzaG90QXRMYXN0TmV3bGluZSl7aWYobnVsbD09PXRoaXMuX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lLmN1cnJlbnRUYWdzKXJldHVybiBkKFwidGhpcy5fc3RhdGVBdExhc3ROZXdsaW5lLmN1cnJlbnRUYWdzXCIpO2lmKG51bGw9PT10aGlzLnN0YXRlLmN1cnJlbnRUYWdzKXJldHVybiBkKFwidGhpcy5zdGF0ZS5jdXJyZW50VGFnc1wiKTtsZXQgdD10aGlzLkNhbGN1bGF0ZU5ld2xpbmVPdXRwdXRTdGF0ZUNoYW5nZSh0aGlzLl9zdGF0ZVNuYXBzaG90QXRMYXN0TmV3bGluZS5jdXJyZW50VGV4dCx0aGlzLnN0YXRlLmN1cnJlbnRUZXh0LHRoaXMuX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lLmN1cnJlbnRUYWdzLmxlbmd0aCx0aGlzLnN0YXRlLmN1cnJlbnRUYWdzLmxlbmd0aCk7aWYodD09WC5PdXRwdXRTdGF0ZUNoYW5nZS5FeHRlbmRlZEJleW9uZE5ld2xpbmUpcmV0dXJuIHRoaXMuUmVzdG9yZVN0YXRlU25hcHNob3QoKSwhMDt0PT1YLk91dHB1dFN0YXRlQ2hhbmdlLk5ld2xpbmVSZW1vdmVkJiZ0aGlzLkRpc2NhcmRTbmFwc2hvdCgpfXRoaXMuc3RhdGUub3V0cHV0U3RyZWFtRW5kc0luTmV3bGluZSYmKHRoaXMuY2FuQ29udGludWU/bnVsbD09dGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmUmJnRoaXMuU3RhdGVTbmFwc2hvdCgpOnRoaXMuRGlzY2FyZFNuYXBzaG90KCkpfXJldHVybiBudWxsIT10aGlzLl9wcm9maWxlciYmdGhpcy5fcHJvZmlsZXIuUG9zdFNuYXBzaG90KCksITF9Q2FsY3VsYXRlTmV3bGluZU91dHB1dFN0YXRlQ2hhbmdlKHQsZSxuLGkpe2lmKG51bGw9PT10KXJldHVybiBkKFwicHJldlRleHRcIik7aWYobnVsbD09PWUpcmV0dXJuIGQoXCJjdXJyVGV4dFwiKTtsZXQgcj1lLmxlbmd0aD49dC5sZW5ndGgmJlwiXFxuXCI9PWUuY2hhckF0KHQubGVuZ3RoLTEpO2lmKG49PWkmJnQubGVuZ3RoPT1lLmxlbmd0aCYmcilyZXR1cm4gWC5PdXRwdXRTdGF0ZUNoYW5nZS5Ob0NoYW5nZTtpZighcilyZXR1cm4gWC5PdXRwdXRTdGF0ZUNoYW5nZS5OZXdsaW5lUmVtb3ZlZDtpZihpPm4pcmV0dXJuIFguT3V0cHV0U3RhdGVDaGFuZ2UuRXh0ZW5kZWRCZXlvbmROZXdsaW5lO2ZvcihsZXQgbj10Lmxlbmd0aDtuPGUubGVuZ3RoO24rKyl7bGV0IHQ9ZS5jaGFyQXQobik7aWYoXCIgXCIhPXQmJlwiXFx0XCIhPXQpcmV0dXJuIFguT3V0cHV0U3RhdGVDaGFuZ2UuRXh0ZW5kZWRCZXlvbmROZXdsaW5lfXJldHVybiBYLk91dHB1dFN0YXRlQ2hhbmdlLk5vQ2hhbmdlfUNvbnRpbnVlTWF4aW1hbGx5KCl7dGhpcy5JZkFzeW5jV2VDYW50KFwiQ29udGludWVNYXhpbWFsbHlcIik7bGV0IHQ9bmV3IG07Zm9yKDt0aGlzLmNhbkNvbnRpbnVlOyl0LkFwcGVuZCh0aGlzLkNvbnRpbnVlKCkpO3JldHVybiB0LnRvU3RyaW5nKCl9Q29udGVudEF0UGF0aCh0KXtyZXR1cm4gdGhpcy5tYWluQ29udGVudENvbnRhaW5lci5Db250ZW50QXRQYXRoKHQpfUtub3RDb250YWluZXJXaXRoTmFtZSh0KXtsZXQgZT10aGlzLm1haW5Db250ZW50Q29udGFpbmVyLm5hbWVkQ29udGVudC5nZXQodCk7cmV0dXJuIGUgaW5zdGFuY2VvZiBOP2U6bnVsbH1Qb2ludGVyQXRQYXRoKHQpe2lmKDA9PXQubGVuZ3RoKXJldHVybiBJLk51bGw7bGV0IGU9bmV3IEksbj10Lmxlbmd0aCxpPW51bGw7cmV0dXJuIG51bGw9PT10Lmxhc3RDb21wb25lbnQ/ZChcInBhdGgubGFzdENvbXBvbmVudFwiKToodC5sYXN0Q29tcG9uZW50LmlzSW5kZXg/KG49dC5sZW5ndGgtMSxpPXRoaXMubWFpbkNvbnRlbnRDb250YWluZXIuQ29udGVudEF0UGF0aCh0LHZvaWQgMCxuKSxlLmNvbnRhaW5lcj1pLmNvbnRhaW5lcixlLmluZGV4PXQubGFzdENvbXBvbmVudC5pbmRleCk6KGk9dGhpcy5tYWluQ29udGVudENvbnRhaW5lci5Db250ZW50QXRQYXRoKHQpLGUuY29udGFpbmVyPWkuY29udGFpbmVyLGUuaW5kZXg9LTEpLG51bGw9PWkub2JqfHxpLm9iaj09dGhpcy5tYWluQ29udGVudENvbnRhaW5lciYmbj4wP3RoaXMuRXJyb3IoXCJGYWlsZWQgdG8gZmluZCBjb250ZW50IGF0IHBhdGggJ1wiK3QrXCInLCBhbmQgbm8gYXBwcm94aW1hdGlvbiBvZiBpdCB3YXMgcG9zc2libGUuXCIpOmkuYXBwcm94aW1hdGUmJnRoaXMuV2FybmluZyhcIkZhaWxlZCB0byBmaW5kIGNvbnRlbnQgYXQgcGF0aCAnXCIrdCtcIicsIHNvIGl0IHdhcyBhcHByb3hpbWF0ZWQgdG86ICdcIitpLm9iai5wYXRoK1wiJy5cIiksZSl9U3RhdGVTbmFwc2hvdCgpe3RoaXMuX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lPXRoaXMuX3N0YXRlLHRoaXMuX3N0YXRlPXRoaXMuX3N0YXRlLkNvcHlBbmRTdGFydFBhdGNoaW5nKCl9UmVzdG9yZVN0YXRlU25hcHNob3QoKXtudWxsPT09dGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmUmJmQoXCJfc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmVcIiksdGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmUuUmVzdG9yZUFmdGVyUGF0Y2goKSx0aGlzLl9zdGF0ZT10aGlzLl9zdGF0ZVNuYXBzaG90QXRMYXN0TmV3bGluZSx0aGlzLl9zdGF0ZVNuYXBzaG90QXRMYXN0TmV3bGluZT1udWxsLHRoaXMuX2FzeW5jU2F2aW5nfHx0aGlzLl9zdGF0ZS5BcHBseUFueVBhdGNoKCl9RGlzY2FyZFNuYXBzaG90KCl7dGhpcy5fYXN5bmNTYXZpbmd8fHRoaXMuX3N0YXRlLkFwcGx5QW55UGF0Y2goKSx0aGlzLl9zdGF0ZVNuYXBzaG90QXRMYXN0TmV3bGluZT1udWxsfUNvcHlTdGF0ZUZvckJhY2tncm91bmRUaHJlYWRTYXZlKCl7aWYodGhpcy5JZkFzeW5jV2VDYW50KFwic3RhcnQgc2F2aW5nIG9uIGEgYmFja2dyb3VuZCB0aHJlYWRcIiksdGhpcy5fYXN5bmNTYXZpbmcpdGhyb3cgbmV3IEVycm9yKFwiU3RvcnkgaXMgYWxyZWFkeSBpbiBiYWNrZ3JvdW5kIHNhdmluZyBtb2RlLCBjYW4ndCBjYWxsIENvcHlTdGF0ZUZvckJhY2tncm91bmRUaHJlYWRTYXZlIGFnYWluIVwiKTtsZXQgdD10aGlzLl9zdGF0ZTtyZXR1cm4gdGhpcy5fc3RhdGU9dGhpcy5fc3RhdGUuQ29weUFuZFN0YXJ0UGF0Y2hpbmcoKSx0aGlzLl9hc3luY1NhdmluZz0hMCx0fUJhY2tncm91bmRTYXZlQ29tcGxldGUoKXtudWxsPT09dGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmUmJnRoaXMuX3N0YXRlLkFwcGx5QW55UGF0Y2goKSx0aGlzLl9hc3luY1NhdmluZz0hMX1TdGVwKCl7bGV0IHQ9ITAsZT10aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLmNvcHkoKTtpZihlLmlzTnVsbClyZXR1cm47bGV0IG49YShlLlJlc29sdmUoKSxOKTtmb3IoO24mJih0aGlzLlZpc2l0Q29udGFpbmVyKG4sITApLDAhPW4uY29udGVudC5sZW5ndGgpOyllPUkuU3RhcnRPZihuKSxuPWEoZS5SZXNvbHZlKCksTik7dGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlcj1lLmNvcHkoKSxudWxsIT10aGlzLl9wcm9maWxlciYmdGhpcy5fcHJvZmlsZXIuU3RlcCh0aGlzLnN0YXRlLmNhbGxTdGFjayk7bGV0IGk9ZS5SZXNvbHZlKCkscj10aGlzLlBlcmZvcm1Mb2dpY0FuZEZsb3dDb250cm9sKGkpO2lmKHRoaXMuc3RhdGUuY3VycmVudFBvaW50ZXIuaXNOdWxsKXJldHVybjtyJiYodD0hMSk7bGV0IHM9YShpLFcpO2lmKHMpe2xldCBlPXRoaXMuUHJvY2Vzc0Nob2ljZShzKTtlJiZ0aGlzLnN0YXRlLmdlbmVyYXRlZENob2ljZXMucHVzaChlKSxpPW51bGwsdD0hMX1pZihpIGluc3RhbmNlb2YgTiYmKHQ9ITEpLHQpe2xldCB0PWEoaSx3KTtpZih0JiYtMT09dC5jb250ZXh0SW5kZXgpe2xldCBlPXRoaXMuc3RhdGUuY2FsbFN0YWNrLkNvbnRleHRGb3JWYXJpYWJsZU5hbWVkKHQudmFyaWFibGVOYW1lKTtpPW5ldyB3KHQudmFyaWFibGVOYW1lLGUpfXRoaXMuc3RhdGUuaW5FeHByZXNzaW9uRXZhbHVhdGlvbj90aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2soaSk6dGhpcy5zdGF0ZS5QdXNoVG9PdXRwdXRTdHJlYW0oaSl9dGhpcy5OZXh0Q29udGVudCgpO2xldCBsPWEoaSxBKTtsJiZsLmNvbW1hbmRUeXBlPT1BLkNvbW1hbmRUeXBlLlN0YXJ0VGhyZWFkJiZ0aGlzLnN0YXRlLmNhbGxTdGFjay5QdXNoVGhyZWFkKCl9VmlzaXRDb250YWluZXIodCxlKXt0LmNvdW50aW5nQXRTdGFydE9ubHkmJiFlfHwodC52aXNpdHNTaG91bGRCZUNvdW50ZWQmJnRoaXMuc3RhdGUuSW5jcmVtZW50VmlzaXRDb3VudEZvckNvbnRhaW5lcih0KSx0LnR1cm5JbmRleFNob3VsZEJlQ291bnRlZCYmdGhpcy5zdGF0ZS5SZWNvcmRUdXJuSW5kZXhWaXNpdFRvQ29udGFpbmVyKHQpKX1WaXNpdENoYW5nZWRDb250YWluZXJzRHVlVG9EaXZlcnQoKXtsZXQgdD10aGlzLnN0YXRlLnByZXZpb3VzUG9pbnRlci5jb3B5KCksZT10aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLmNvcHkoKTtpZihlLmlzTnVsbHx8LTE9PWUuaW5kZXgpcmV0dXJuO2lmKHRoaXMuX3ByZXZDb250YWluZXJzLmxlbmd0aD0wLCF0LmlzTnVsbCl7bGV0IGU9YSh0LlJlc29sdmUoKSxOKXx8YSh0LmNvbnRhaW5lcixOKTtmb3IoO2U7KXRoaXMuX3ByZXZDb250YWluZXJzLnB1c2goZSksZT1hKGUucGFyZW50LE4pfWxldCBuPWUuUmVzb2x2ZSgpO2lmKG51bGw9PW4pcmV0dXJuO2xldCBpPWEobi5wYXJlbnQsTik7Zm9yKDtpJiYodGhpcy5fcHJldkNvbnRhaW5lcnMuaW5kZXhPZihpKTwwfHxpLmNvdW50aW5nQXRTdGFydE9ubHkpOyl7bGV0IHQ9aS5jb250ZW50Lmxlbmd0aD4wJiZuPT1pLmNvbnRlbnRbMF07dGhpcy5WaXNpdENvbnRhaW5lcihpLHQpLG49aSxpPWEoaS5wYXJlbnQsTil9fVByb2Nlc3NDaG9pY2UodCl7bGV0IGU9ITA7aWYodC5oYXNDb25kaXRpb24pe2xldCB0PXRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCk7dGhpcy5Jc1RydXRoeSh0KXx8KGU9ITEpfWxldCBuPVwiXCIsaT1cIlwiO2lmKHQuaGFzQ2hvaWNlT25seUNvbnRlbnQpe2k9cyh0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpLFQpLnZhbHVlfHxcIlwifWlmKHQuaGFzU3RhcnRDb250ZW50KXtuPXModGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSxUKS52YWx1ZXx8XCJcIn1pZih0Lm9uY2VPbmx5KXt0aGlzLnN0YXRlLlZpc2l0Q291bnRGb3JDb250YWluZXIodC5jaG9pY2VUYXJnZXQpPjAmJihlPSExKX1pZighZSlyZXR1cm4gbnVsbDtsZXQgcj1uZXcgRDtyZXR1cm4gci50YXJnZXRQYXRoPXQucGF0aE9uQ2hvaWNlLHIuc291cmNlUGF0aD10LnBhdGgudG9TdHJpbmcoKSxyLmlzSW52aXNpYmxlRGVmYXVsdD10LmlzSW52aXNpYmxlRGVmYXVsdCxyLnRocmVhZEF0R2VuZXJhdGlvbj10aGlzLnN0YXRlLmNhbGxTdGFjay5Gb3JrVGhyZWFkKCksci50ZXh0PShuK2kpLnJlcGxhY2UoL15bIFxcdF0rfFsgXFx0XSskL2csXCJcIikscn1Jc1RydXRoeSh0KXtpZih0IGluc3RhbmNlb2Ygdil7bGV0IGU9dDtpZihlIGluc3RhbmNlb2YgUCl7bGV0IHQ9ZTtyZXR1cm4gdGhpcy5FcnJvcihcIlNob3VsZG4ndCB1c2UgYSBkaXZlcnQgdGFyZ2V0ICh0byBcIit0LnRhcmdldFBhdGgrXCIpIGFzIGEgY29uZGl0aW9uYWwgdmFsdWUuIERpZCB5b3UgaW50ZW5kIGEgZnVuY3Rpb24gY2FsbCAnbGlrZVRoaXMoKScgb3IgYSByZWFkIGNvdW50IGNoZWNrICdsaWtlVGhpcyc/IChubyBhcnJvd3MpXCIpLCExfXJldHVybiBlLmlzVHJ1dGh5fXJldHVybiExfVBlcmZvcm1Mb2dpY0FuZEZsb3dDb250cm9sKHQpe2lmKG51bGw9PXQpcmV0dXJuITE7aWYodCBpbnN0YW5jZW9mIGspe2xldCBlPXQ7aWYoZS5pc0NvbmRpdGlvbmFsKXtsZXQgdD10aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpO2lmKCF0aGlzLklzVHJ1dGh5KHQpKXJldHVybiEwfWlmKGUuaGFzVmFyaWFibGVUYXJnZXQpe2xldCB0PWUudmFyaWFibGVEaXZlcnROYW1lLG49dGhpcy5zdGF0ZS52YXJpYWJsZXNTdGF0ZS5HZXRWYXJpYWJsZVdpdGhOYW1lKHQpO2lmKG51bGw9PW4pdGhpcy5FcnJvcihcIlRyaWVkIHRvIGRpdmVydCB1c2luZyBhIHRhcmdldCBmcm9tIGEgdmFyaWFibGUgdGhhdCBjb3VsZCBub3QgYmUgZm91bmQgKFwiK3QrXCIpXCIpO2Vsc2UgaWYoIShuIGluc3RhbmNlb2YgUCkpe2xldCBlPWEobixiKSxpPVwiVHJpZWQgdG8gZGl2ZXJ0IHRvIGEgdGFyZ2V0IGZyb20gYSB2YXJpYWJsZSwgYnV0IHRoZSB2YXJpYWJsZSAoXCIrdCtcIikgZGlkbid0IGNvbnRhaW4gYSBkaXZlcnQgdGFyZ2V0LCBpdCBcIjtlIGluc3RhbmNlb2YgYiYmMD09ZS52YWx1ZT9pKz1cIndhcyBlbXB0eS9udWxsICh0aGUgdmFsdWUgMCkuXCI6aSs9XCJjb250YWluZWQgJ1wiK24rXCInLlwiLHRoaXMuRXJyb3IoaSl9bGV0IGk9cyhuLFApO3RoaXMuc3RhdGUuZGl2ZXJ0ZWRQb2ludGVyPXRoaXMuUG9pbnRlckF0UGF0aChpLnRhcmdldFBhdGgpfWVsc2V7aWYoZS5pc0V4dGVybmFsKXJldHVybiB0aGlzLkNhbGxFeHRlcm5hbEZ1bmN0aW9uKGUudGFyZ2V0UGF0aFN0cmluZyxlLmV4dGVybmFsQXJncyksITA7dGhpcy5zdGF0ZS5kaXZlcnRlZFBvaW50ZXI9ZS50YXJnZXRQb2ludGVyLmNvcHkoKX1yZXR1cm4gZS5wdXNoZXNUb1N0YWNrJiZ0aGlzLnN0YXRlLmNhbGxTdGFjay5QdXNoKGUuc3RhY2tQdXNoVHlwZSx2b2lkIDAsdGhpcy5zdGF0ZS5vdXRwdXRTdHJlYW0ubGVuZ3RoKSx0aGlzLnN0YXRlLmRpdmVydGVkUG9pbnRlci5pc051bGwmJiFlLmlzRXh0ZXJuYWwmJihlJiZlLmRlYnVnTWV0YWRhdGEmJm51bGwhPWUuZGVidWdNZXRhZGF0YS5zb3VyY2VOYW1lP3RoaXMuRXJyb3IoXCJEaXZlcnQgdGFyZ2V0IGRvZXNuJ3QgZXhpc3Q6IFwiK2UuZGVidWdNZXRhZGF0YS5zb3VyY2VOYW1lKTp0aGlzLkVycm9yKFwiRGl2ZXJ0IHJlc29sdXRpb24gZmFpbGVkOiBcIitlKSksITB9aWYodCBpbnN0YW5jZW9mIEEpe2xldCBlPXQ7c3dpdGNoKGUuY29tbWFuZFR5cGUpe2Nhc2UgQS5Db21tYW5kVHlwZS5FdmFsU3RhcnQ6dGhpcy5Bc3NlcnQoITE9PT10aGlzLnN0YXRlLmluRXhwcmVzc2lvbkV2YWx1YXRpb24sXCJBbHJlYWR5IGluIGV4cHJlc3Npb24gZXZhbHVhdGlvbj9cIiksdGhpcy5zdGF0ZS5pbkV4cHJlc3Npb25FdmFsdWF0aW9uPSEwO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5FdmFsRW5kOnRoaXMuQXNzZXJ0KCEwPT09dGhpcy5zdGF0ZS5pbkV4cHJlc3Npb25FdmFsdWF0aW9uLFwiTm90IGluIGV4cHJlc3Npb24gZXZhbHVhdGlvbiBtb2RlXCIpLHRoaXMuc3RhdGUuaW5FeHByZXNzaW9uRXZhbHVhdGlvbj0hMTticmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuRXZhbE91dHB1dDppZih0aGlzLnN0YXRlLmV2YWx1YXRpb25TdGFjay5sZW5ndGg+MCl7bGV0IHQ9dGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKTtpZighKHQgaW5zdGFuY2VvZiBMKSl7bGV0IGU9bmV3IFQodC50b1N0cmluZygpKTt0aGlzLnN0YXRlLlB1c2hUb091dHB1dFN0cmVhbShlKX19YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLk5vT3A6YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLkR1cGxpY2F0ZTp0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2sodGhpcy5zdGF0ZS5QZWVrRXZhbHVhdGlvblN0YWNrKCkpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5Qb3BFdmFsdWF0ZWRWYWx1ZTp0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5Qb3BGdW5jdGlvbjpjYXNlIEEuQ29tbWFuZFR5cGUuUG9wVHVubmVsOmxldCB0PWUuY29tbWFuZFR5cGU9PUEuQ29tbWFuZFR5cGUuUG9wRnVuY3Rpb24/ci5GdW5jdGlvbjpyLlR1bm5lbCxuPW51bGw7aWYodD09ci5UdW5uZWwpe2xldCB0PXRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCk7bj1hKHQsUCksbnVsbD09PW4mJnRoaXMuQXNzZXJ0KHQgaW5zdGFuY2VvZiBMLFwiRXhwZWN0ZWQgdm9pZCBpZiAtPi0+IGRvZXNuJ3Qgb3ZlcnJpZGUgdGFyZ2V0XCIpfWlmKHRoaXMuc3RhdGUuVHJ5RXhpdEZ1bmN0aW9uRXZhbHVhdGlvbkZyb21HYW1lKCkpYnJlYWs7aWYodGhpcy5zdGF0ZS5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQudHlwZT09dCYmdGhpcy5zdGF0ZS5jYWxsU3RhY2suY2FuUG9wKXRoaXMuc3RhdGUuUG9wQ2FsbFN0YWNrKCksbiYmKHRoaXMuc3RhdGUuZGl2ZXJ0ZWRQb2ludGVyPXRoaXMuUG9pbnRlckF0UGF0aChuLnRhcmdldFBhdGgpKTtlbHNle2xldCBlPW5ldyBNYXA7ZS5zZXQoci5GdW5jdGlvbixcImZ1bmN0aW9uIHJldHVybiBzdGF0ZW1lbnQgKH4gcmV0dXJuKVwiKSxlLnNldChyLlR1bm5lbCxcInR1bm5lbCBvbndhcmRzIHN0YXRlbWVudCAoLT4tPilcIik7bGV0IG49ZS5nZXQodGhpcy5zdGF0ZS5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQudHlwZSk7dGhpcy5zdGF0ZS5jYWxsU3RhY2suY2FuUG9wfHwobj1cImVuZCBvZiBmbG93ICgtPiBFTkQgb3IgY2hvaWNlKVwiKTtsZXQgaT1cIkZvdW5kIFwiK2UuZ2V0KHQpK1wiLCB3aGVuIGV4cGVjdGVkIFwiK247dGhpcy5FcnJvcihpKX1icmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuQmVnaW5TdHJpbmc6dGhpcy5zdGF0ZS5QdXNoVG9PdXRwdXRTdHJlYW0oZSksdGhpcy5Bc3NlcnQoITA9PT10aGlzLnN0YXRlLmluRXhwcmVzc2lvbkV2YWx1YXRpb24sXCJFeHBlY3RlZCB0byBiZSBpbiBhbiBleHByZXNzaW9uIHdoZW4gZXZhbHVhdGluZyBhIHN0cmluZ1wiKSx0aGlzLnN0YXRlLmluRXhwcmVzc2lvbkV2YWx1YXRpb249ITE7YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLkVuZFN0cmluZzpsZXQgaT1bXSxsPTA7Zm9yKGxldCB0PXRoaXMuc3RhdGUub3V0cHV0U3RyZWFtLmxlbmd0aC0xO3Q+PTA7LS10KXtsZXQgZT10aGlzLnN0YXRlLm91dHB1dFN0cmVhbVt0XTtsKys7bGV0IG49YShlLEEpO2lmKG4mJm4uY29tbWFuZFR5cGU9PUEuQ29tbWFuZFR5cGUuQmVnaW5TdHJpbmcpYnJlYWs7ZSBpbnN0YW5jZW9mIFQmJmkucHVzaChlKX10aGlzLnN0YXRlLlBvcEZyb21PdXRwdXRTdHJlYW0obCksaT1pLnJldmVyc2UoKTtsZXQgbz1uZXcgbTtmb3IobGV0IHQgb2YgaSlvLkFwcGVuZCh0LnRvU3RyaW5nKCkpO3RoaXMuc3RhdGUuaW5FeHByZXNzaW9uRXZhbHVhdGlvbj0hMCx0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2sobmV3IFQoby50b1N0cmluZygpKSk7YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLkNob2ljZUNvdW50OmxldCB1PXRoaXMuc3RhdGUuZ2VuZXJhdGVkQ2hvaWNlcy5sZW5ndGg7dGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKG5ldyBiKHUpKTticmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuVHVybnM6dGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKG5ldyBiKHRoaXMuc3RhdGUuY3VycmVudFR1cm5JbmRleCsxKSk7YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLlR1cm5zU2luY2U6Y2FzZSBBLkNvbW1hbmRUeXBlLlJlYWRDb3VudDpsZXQgaD10aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpO2lmKCEoaCBpbnN0YW5jZW9mIFApKXtsZXQgdD1cIlwiO2ggaW5zdGFuY2VvZiBiJiYodD1cIi4gRGlkIHlvdSBhY2NpZGVudGFsbHkgcGFzcyBhIHJlYWQgY291bnQgKCdrbm90X25hbWUnKSBpbnN0ZWFkIG9mIGEgdGFyZ2V0ICgnLT4ga25vdF9uYW1lJyk/XCIpLHRoaXMuRXJyb3IoXCJUVVJOU19TSU5DRSAvIFJFQURfQ09VTlQgZXhwZWN0ZWQgYSBkaXZlcnQgdGFyZ2V0IChrbm90LCBzdGl0Y2gsIGxhYmVsIG5hbWUpLCBidXQgc2F3IFwiK2grdCk7YnJlYWt9bGV0IGMscD1zKGgsUCkseT1hKHRoaXMuQ29udGVudEF0UGF0aChwLnRhcmdldFBhdGgpLmNvcnJlY3RPYmosTik7bnVsbCE9eT9jPWUuY29tbWFuZFR5cGU9PUEuQ29tbWFuZFR5cGUuVHVybnNTaW5jZT90aGlzLnN0YXRlLlR1cm5zU2luY2VGb3JDb250YWluZXIoeSk6dGhpcy5zdGF0ZS5WaXNpdENvdW50Rm9yQ29udGFpbmVyKHkpOihjPWUuY29tbWFuZFR5cGU9PUEuQ29tbWFuZFR5cGUuVHVybnNTaW5jZT8tMTowLHRoaXMuV2FybmluZyhcIkZhaWxlZCB0byBmaW5kIGNvbnRhaW5lciBmb3IgXCIrZS50b1N0cmluZygpK1wiIGxvb2t1cCBhdCBcIitwLnRhcmdldFBhdGgudG9TdHJpbmcoKSkpLHRoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhuZXcgYihjKSk7YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLlJhbmRvbTp7bGV0IHQ9YSh0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpLGIpLGU9YSh0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpLGIpO2lmKG51bGw9PWV8fGUgaW5zdGFuY2VvZiBiPT0hMSlyZXR1cm4gdGhpcy5FcnJvcihcIkludmFsaWQgdmFsdWUgZm9yIG1pbmltdW0gcGFyYW1ldGVyIG9mIFJBTkRPTShtaW4sIG1heClcIik7aWYobnVsbD09dHx8ZSBpbnN0YW5jZW9mIGI9PSExKXJldHVybiB0aGlzLkVycm9yKFwiSW52YWxpZCB2YWx1ZSBmb3IgbWF4aW11bSBwYXJhbWV0ZXIgb2YgUkFORE9NKG1pbiwgbWF4KVwiKTtpZihudWxsPT09dC52YWx1ZSlyZXR1cm4gZChcIm1heEludC52YWx1ZVwiKTtpZihudWxsPT09ZS52YWx1ZSlyZXR1cm4gZChcIm1pbkludC52YWx1ZVwiKTtsZXQgbj10LnZhbHVlLWUudmFsdWUrMTtuPD0wJiZ0aGlzLkVycm9yKFwiUkFORE9NIHdhcyBjYWxsZWQgd2l0aCBtaW5pbXVtIGFzIFwiK2UudmFsdWUrXCIgYW5kIG1heGltdW0gYXMgXCIrdC52YWx1ZStcIi4gVGhlIG1heGltdW0gbXVzdCBiZSBsYXJnZXJcIik7bGV0IGk9dGhpcy5zdGF0ZS5zdG9yeVNlZWQrdGhpcy5zdGF0ZS5wcmV2aW91c1JhbmRvbSxyPW5ldyBLKGkpLm5leHQoKSxzPXIlbitlLnZhbHVlO3RoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhuZXcgYihzKSksdGhpcy5zdGF0ZS5wcmV2aW91c1JhbmRvbT1yO2JyZWFrfWNhc2UgQS5Db21tYW5kVHlwZS5TZWVkUmFuZG9tOmxldCBDPWEodGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSxiKTtpZihudWxsPT1DfHxDIGluc3RhbmNlb2YgYj09ITEpcmV0dXJuIHRoaXMuRXJyb3IoXCJJbnZhbGlkIHZhbHVlIHBhc3NlZCB0byBTRUVEX1JBTkRPTVwiKTtpZihudWxsPT09Qy52YWx1ZSlyZXR1cm4gZChcIm1pbkludC52YWx1ZVwiKTt0aGlzLnN0YXRlLnN0b3J5U2VlZD1DLnZhbHVlLHRoaXMuc3RhdGUucHJldmlvdXNSYW5kb209MCx0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2sobmV3IEwpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5WaXNpdEluZGV4OmxldCBfPXRoaXMuc3RhdGUuVmlzaXRDb3VudEZvckNvbnRhaW5lcih0aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLmNvbnRhaW5lciktMTt0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2sobmV3IGIoXykpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5TZXF1ZW5jZVNodWZmbGVJbmRleDpsZXQgdz10aGlzLk5leHRTZXF1ZW5jZVNodWZmbGVJbmRleCgpO3RoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhuZXcgYih3KSk7YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLlN0YXJ0VGhyZWFkOmJyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5Eb25lOnRoaXMuc3RhdGUuY2FsbFN0YWNrLmNhblBvcFRocmVhZD90aGlzLnN0YXRlLmNhbGxTdGFjay5Qb3BUaHJlYWQoKToodGhpcy5zdGF0ZS5kaWRTYWZlRXhpdD0hMCx0aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyPUkuTnVsbCk7YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLkVuZDp0aGlzLnN0YXRlLkZvcmNlRW5kKCk7YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLkxpc3RGcm9tSW50OmxldCBFPWEodGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSxiKSx4PXModGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSxUKTtpZihudWxsPT09RSl0aHJvdyBuZXcgUyhcIlBhc3NlZCBub24taW50ZWdlciB3aGVuIGNyZWF0aW5nIGEgbGlzdCBlbGVtZW50IGZyb20gYSBudW1lcmljYWwgdmFsdWUuXCIpO2xldCBrPW51bGw7aWYobnVsbD09PXRoaXMubGlzdERlZmluaXRpb25zKXJldHVybiBkKFwidGhpcy5saXN0RGVmaW5pdGlvbnNcIik7bGV0IFc9dGhpcy5saXN0RGVmaW5pdGlvbnMuVHJ5TGlzdEdldERlZmluaXRpb24oeC52YWx1ZSxudWxsKTtpZighVy5leGlzdHMpdGhyb3cgbmV3IFMoXCJGYWlsZWQgdG8gZmluZCBMSVNUIGNhbGxlZCBcIit4LnZhbHVlKTt7aWYobnVsbD09PUUudmFsdWUpcmV0dXJuIGQoXCJtaW5JbnQudmFsdWVcIik7bGV0IHQ9Vy5yZXN1bHQuVHJ5R2V0SXRlbVdpdGhWYWx1ZShFLnZhbHVlLGYuTnVsbCk7dC5leGlzdHMmJihrPW5ldyBPKHQucmVzdWx0LEUudmFsdWUpKX1udWxsPT1rJiYoaz1uZXcgTyksdGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKGspO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5MaXN0UmFuZ2U6bGV0IEY9YSh0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpLHYpLFY9YSh0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpLHYpLFI9YSh0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpLE8pO2lmKG51bGw9PT1SfHxudWxsPT09Vnx8bnVsbD09PUYpdGhyb3cgbmV3IFMoXCJFeHBlY3RlZCBsaXN0LCBtaW5pbXVtIGFuZCBtYXhpbXVtIGZvciBMSVNUX1JBTkdFXCIpO2lmKG51bGw9PT1SLnZhbHVlKXJldHVybiBkKFwidGFyZ2V0TGlzdC52YWx1ZVwiKTtsZXQgaj1SLnZhbHVlLkxpc3RXaXRoU3ViUmFuZ2UoVi52YWx1ZU9iamVjdCxGLnZhbHVlT2JqZWN0KTt0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2sobmV3IE8oaikpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5MaXN0UmFuZG9tOntsZXQgdD10aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpO2lmKG51bGw9PT10KXRocm93IG5ldyBTKFwiRXhwZWN0ZWQgbGlzdCBmb3IgTElTVF9SQU5ET01cIik7bGV0IGU9dC52YWx1ZSxuPW51bGw7aWYobnVsbD09PWUpdGhyb3cgZChcImxpc3RcIik7aWYoMD09ZS5Db3VudCluPW5ldyBnO2Vsc2V7bGV0IHQ9dGhpcy5zdGF0ZS5zdG9yeVNlZWQrdGhpcy5zdGF0ZS5wcmV2aW91c1JhbmRvbSxpPW5ldyBLKHQpLm5leHQoKSxyPWklZS5Db3VudCxhPWUuZW50cmllcygpO2ZvcihsZXQgdD0wO3Q8PXItMTt0KyspYS5uZXh0KCk7bGV0IHM9YS5uZXh0KCkudmFsdWUsbD17S2V5OmYuZnJvbVNlcmlhbGl6ZWRLZXkoc1swXSksVmFsdWU6c1sxXX07aWYobnVsbD09PWwuS2V5Lm9yaWdpbk5hbWUpcmV0dXJuIGQoXCJyYW5kb21JdGVtLktleS5vcmlnaW5OYW1lXCIpO249bmV3IGcobC5LZXkub3JpZ2luTmFtZSx0aGlzKSxuLkFkZChsLktleSxsLlZhbHVlKSx0aGlzLnN0YXRlLnByZXZpb3VzUmFuZG9tPWl9dGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKG5ldyBPKG4pKTticmVha31kZWZhdWx0OnRoaXMuRXJyb3IoXCJ1bmhhbmRsZWQgQ29udHJvbENvbW1hbmQ6IFwiK2UpfXJldHVybiEwfWlmKHQgaW5zdGFuY2VvZiBWKXtsZXQgZT10LG49dGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKTtyZXR1cm4gdGhpcy5zdGF0ZS52YXJpYWJsZXNTdGF0ZS5Bc3NpZ24oZSxuKSwhMH1pZih0IGluc3RhbmNlb2YgRil7bGV0IGU9dCxuPW51bGw7aWYobnVsbCE9ZS5wYXRoRm9yQ291bnQpe2xldCB0PWUuY29udGFpbmVyRm9yQ291bnQsaT10aGlzLnN0YXRlLlZpc2l0Q291bnRGb3JDb250YWluZXIodCk7bj1uZXcgYihpKX1lbHNlIG49dGhpcy5zdGF0ZS52YXJpYWJsZXNTdGF0ZS5HZXRWYXJpYWJsZVdpdGhOYW1lKGUubmFtZSksbnVsbD09biYmKHRoaXMuV2FybmluZyhcIlZhcmlhYmxlIG5vdCBmb3VuZDogJ1wiK2UubmFtZStcIicuIFVzaW5nIGRlZmF1bHQgdmFsdWUgb2YgMCAoZmFsc2UpLiBUaGlzIGNhbiBoYXBwZW4gd2l0aCB0ZW1wb3JhcnkgdmFyaWFibGVzIGlmIHRoZSBkZWNsYXJhdGlvbiBoYXNuJ3QgeWV0IGJlZW4gaGl0LiBHbG9iYWxzIGFyZSBhbHdheXMgZ2l2ZW4gYSBkZWZhdWx0IHZhbHVlIG9uIGxvYWQgaWYgYSB2YWx1ZSBkb2Vzbid0IGV4aXN0IGluIHRoZSBzYXZlIHN0YXRlLlwiKSxuPW5ldyBiKDApKTtyZXR1cm4gdGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKG4pLCEwfWlmKHQgaW5zdGFuY2VvZiBSKXtsZXQgZT10LG49dGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soZS5udW1iZXJPZlBhcmFtZXRlcnMpLGk9ZS5DYWxsKG4pO3JldHVybiB0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2soaSksITB9cmV0dXJuITF9Q2hvb3NlUGF0aFN0cmluZyh0LG49ITAsaT1bXSl7aWYodGhpcy5JZkFzeW5jV2VDYW50KFwiY2FsbCBDaG9vc2VQYXRoU3RyaW5nIHJpZ2h0IG5vd1wiKSxuKXRoaXMuUmVzZXRDYWxsc3RhY2soKTtlbHNlIGlmKHRoaXMuc3RhdGUuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LnR5cGU9PXIuRnVuY3Rpb24pe2xldCBlPVwiXCIsbj10aGlzLnN0YXRlLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC5jdXJyZW50UG9pbnRlci5jb250YWluZXI7dGhyb3cgbnVsbCE9biYmKGU9XCIoXCIrbi5wYXRoLnRvU3RyaW5nKCkrXCIpIFwiKSxuZXcgRXJyb3IoXCJTdG9yeSB3YXMgcnVubmluZyBhIGZ1bmN0aW9uIFwiK2UrXCJ3aGVuIHlvdSBjYWxsZWQgQ2hvb3NlUGF0aFN0cmluZyhcIit0K1wiKSAtIHRoaXMgaXMgYWxtb3N0IGNlcnRhaW5seSBub3Qgbm90IHdoYXQgeW91IHdhbnQhIEZ1bGwgc3RhY2sgdHJhY2U6IFxcblwiK3RoaXMuc3RhdGUuY2FsbFN0YWNrLmNhbGxTdGFja1RyYWNlKX10aGlzLnN0YXRlLlBhc3NBcmd1bWVudHNUb0V2YWx1YXRpb25TdGFjayhpKSx0aGlzLkNob29zZVBhdGgobmV3IGUodCkpfUlmQXN5bmNXZUNhbnQodCl7aWYodGhpcy5fYXN5bmNDb250aW51ZUFjdGl2ZSl0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBcIit0K1wiLiBTdG9yeSBpcyBpbiB0aGUgbWlkZGxlIG9mIGEgQ29udGludWVBc3luYygpLiBNYWtlIG1vcmUgQ29udGludWVBc3luYygpIGNhbGxzIG9yIGEgc2luZ2xlIENvbnRpbnVlKCkgY2FsbCBiZWZvcmVoYW5kLlwiKX1DaG9vc2VQYXRoKHQsZT0hMCl7dGhpcy5zdGF0ZS5TZXRDaG9zZW5QYXRoKHQsZSksdGhpcy5WaXNpdENoYW5nZWRDb250YWluZXJzRHVlVG9EaXZlcnQoKX1DaG9vc2VDaG9pY2VJbmRleCh0KXt0PXQ7bGV0IGU9dGhpcy5jdXJyZW50Q2hvaWNlczt0aGlzLkFzc2VydCh0Pj0wJiZ0PGUubGVuZ3RoLFwiY2hvaWNlIG91dCBvZiByYW5nZVwiKTtsZXQgbj1lW3RdO3JldHVybiBudWxsPT09bi50aHJlYWRBdEdlbmVyYXRpb24/ZChcImNob2ljZVRvQ2hvb3NlLnRocmVhZEF0R2VuZXJhdGlvblwiKTpudWxsPT09bi50YXJnZXRQYXRoP2QoXCJjaG9pY2VUb0Nob29zZS50YXJnZXRQYXRoXCIpOih0aGlzLnN0YXRlLmNhbGxTdGFjay5jdXJyZW50VGhyZWFkPW4udGhyZWFkQXRHZW5lcmF0aW9uLHZvaWQgdGhpcy5DaG9vc2VQYXRoKG4udGFyZ2V0UGF0aCkpfUhhc0Z1bmN0aW9uKHQpe3RyeXtyZXR1cm4gbnVsbCE9dGhpcy5Lbm90Q29udGFpbmVyV2l0aE5hbWUodCl9Y2F0Y2godCl7cmV0dXJuITF9fUV2YWx1YXRlRnVuY3Rpb24odCxlPVtdLG49ITEpe2lmKHRoaXMuSWZBc3luY1dlQ2FudChcImV2YWx1YXRlIGEgZnVuY3Rpb25cIiksbnVsbD09dCl0aHJvdyBuZXcgRXJyb3IoXCJGdW5jdGlvbiBpcyBudWxsXCIpO2lmKFwiXCI9PXR8fFwiXCI9PXQudHJpbSgpKXRocm93IG5ldyBFcnJvcihcIkZ1bmN0aW9uIGlzIGVtcHR5IG9yIHdoaXRlIHNwYWNlLlwiKTtsZXQgaT10aGlzLktub3RDb250YWluZXJXaXRoTmFtZSh0KTtpZihudWxsPT1pKXRocm93IG5ldyBFcnJvcihcIkZ1bmN0aW9uIGRvZXNuJ3QgZXhpc3Q6ICdcIit0K1wiJ1wiKTtsZXQgcj1bXTtyLnB1c2guYXBwbHkocix0aGlzLnN0YXRlLm91dHB1dFN0cmVhbSksdGhpcy5fc3RhdGUuUmVzZXRPdXRwdXQoKSx0aGlzLnN0YXRlLlN0YXJ0RnVuY3Rpb25FdmFsdWF0aW9uRnJvbUdhbWUoaSxlKTtsZXQgYT1uZXcgbTtmb3IoO3RoaXMuY2FuQ29udGludWU7KWEuQXBwZW5kKHRoaXMuQ29udGludWUoKSk7bGV0IHM9YS50b1N0cmluZygpO3RoaXMuX3N0YXRlLlJlc2V0T3V0cHV0KHIpO2xldCBsPXRoaXMuc3RhdGUuQ29tcGxldGVGdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZSgpO3JldHVybiBuP3tyZXR1cm5lZDpsLG91dHB1dDpzfTpsfUV2YWx1YXRlRXhwcmVzc2lvbih0KXtsZXQgZT10aGlzLnN0YXRlLmNhbGxTdGFjay5lbGVtZW50cy5sZW5ndGg7dGhpcy5zdGF0ZS5jYWxsU3RhY2suUHVzaChyLlR1bm5lbCksdGhpcy5fdGVtcG9yYXJ5RXZhbHVhdGlvbkNvbnRhaW5lcj10LHRoaXMuc3RhdGUuR29Ub1N0YXJ0KCk7bGV0IG49dGhpcy5zdGF0ZS5ldmFsdWF0aW9uU3RhY2subGVuZ3RoO3JldHVybiB0aGlzLkNvbnRpbnVlKCksdGhpcy5fdGVtcG9yYXJ5RXZhbHVhdGlvbkNvbnRhaW5lcj1udWxsLHRoaXMuc3RhdGUuY2FsbFN0YWNrLmVsZW1lbnRzLmxlbmd0aD5lJiZ0aGlzLnN0YXRlLlBvcENhbGxTdGFjaygpLHRoaXMuc3RhdGUuZXZhbHVhdGlvblN0YWNrLmxlbmd0aD5uP3RoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCk6bnVsbH1DYWxsRXh0ZXJuYWxGdW5jdGlvbih0LGUpe2lmKG51bGw9PT10KXJldHVybiBkKFwiZnVuY05hbWVcIik7bGV0IG49dGhpcy5fZXh0ZXJuYWxzLmdldCh0KSxpPW51bGw7aWYoISh2b2lkIDAhPT1uKSl7aWYodGhpcy5hbGxvd0V4dGVybmFsRnVuY3Rpb25GYWxsYmFja3MpcmV0dXJuIGk9dGhpcy5Lbm90Q29udGFpbmVyV2l0aE5hbWUodCksdGhpcy5Bc3NlcnQobnVsbCE9PWksXCJUcnlpbmcgdG8gY2FsbCBFWFRFUk5BTCBmdW5jdGlvbiAnXCIrdCtcIicgd2hpY2ggaGFzIG5vdCBiZWVuIGJvdW5kLCBhbmQgZmFsbGJhY2sgaW5rIGZ1bmN0aW9uIGNvdWxkIG5vdCBiZSBmb3VuZC5cIiksdGhpcy5zdGF0ZS5jYWxsU3RhY2suUHVzaChyLkZ1bmN0aW9uLHZvaWQgMCx0aGlzLnN0YXRlLm91dHB1dFN0cmVhbS5sZW5ndGgpLHZvaWQodGhpcy5zdGF0ZS5kaXZlcnRlZFBvaW50ZXI9SS5TdGFydE9mKGkpKTt0aGlzLkFzc2VydCghMSxcIlRyeWluZyB0byBjYWxsIEVYVEVSTkFMIGZ1bmN0aW9uICdcIit0K1wiJyB3aGljaCBoYXMgbm90IGJlZW4gYm91bmQgKGFuZCBpbmsgZmFsbGJhY2tzIGRpc2FibGVkKS5cIil9bGV0IGE9W107Zm9yKGxldCB0PTA7dDxlOysrdCl7bGV0IHQ9cyh0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpLHYpLnZhbHVlT2JqZWN0O2EucHVzaCh0KX1hLnJldmVyc2UoKTtsZXQgbD1uKGEpLG89bnVsbDtudWxsIT1sPyhvPXYuQ3JlYXRlKGwpLHRoaXMuQXNzZXJ0KG51bGwhPT1vLFwiQ291bGQgbm90IGNyZWF0ZSBpbmsgdmFsdWUgZnJvbSByZXR1cm5lZCBvYmplY3Qgb2YgdHlwZSBcIit0eXBlb2YgbCkpOm89bmV3IEwsdGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKG8pfUJpbmRFeHRlcm5hbEZ1bmN0aW9uR2VuZXJhbCh0LGUpe3RoaXMuSWZBc3luY1dlQ2FudChcImJpbmQgYW4gZXh0ZXJuYWwgZnVuY3Rpb25cIiksdGhpcy5Bc3NlcnQoIXRoaXMuX2V4dGVybmFscy5oYXModCksXCJGdW5jdGlvbiAnXCIrdCtcIicgaGFzIGFscmVhZHkgYmVlbiBib3VuZC5cIiksdGhpcy5fZXh0ZXJuYWxzLnNldCh0LGUpfVRyeUNvZXJjZSh0KXtyZXR1cm4gdH1CaW5kRXh0ZXJuYWxGdW5jdGlvbih0LGUpe3RoaXMuQXNzZXJ0KG51bGwhPWUsXCJDYW4ndCBiaW5kIGEgbnVsbCBmdW5jdGlvblwiKSx0aGlzLkJpbmRFeHRlcm5hbEZ1bmN0aW9uR2VuZXJhbCh0LHQ9Pnt0aGlzLkFzc2VydCh0Lmxlbmd0aD49ZS5sZW5ndGgsXCJFeHRlcm5hbCBmdW5jdGlvbiBleHBlY3RlZCBcIitlLmxlbmd0aCtcIiBhcmd1bWVudHNcIik7bGV0IG49W107Zm9yKGxldCBlPTAsaT10Lmxlbmd0aDtlPGk7ZSsrKW5bZV09dGhpcy5UcnlDb2VyY2UodFtlXSk7cmV0dXJuIGUuYXBwbHkobnVsbCxuKX0pfVVuYmluZEV4dGVybmFsRnVuY3Rpb24odCl7dGhpcy5JZkFzeW5jV2VDYW50KFwidW5iaW5kIGFuIGV4dGVybmFsIGEgZnVuY3Rpb25cIiksdGhpcy5Bc3NlcnQodGhpcy5fZXh0ZXJuYWxzLmhhcyh0KSxcIkZ1bmN0aW9uICdcIit0K1wiJyBoYXMgbm90IGJlZW4gYm91bmQuXCIpLHRoaXMuX2V4dGVybmFscy5kZWxldGUodCl9VmFsaWRhdGVFeHRlcm5hbEJpbmRpbmdzKCl7bGV0IHQ9bnVsbCxlPW51bGwsbj1hcmd1bWVudHNbMV18fG5ldyBTZXQ7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBOJiYodD1hcmd1bWVudHNbMF0pLGFyZ3VtZW50c1swXWluc3RhbmNlb2YgcCYmKGU9YXJndW1lbnRzWzBdKSxudWxsPT09dCYmbnVsbD09PWUpaWYodGhpcy5WYWxpZGF0ZUV4dGVybmFsQmluZGluZ3ModGhpcy5fbWFpbkNvbnRlbnRDb250YWluZXIsbiksdGhpcy5faGFzVmFsaWRhdGVkRXh0ZXJuYWxzPSEwLDA9PW4uc2l6ZSl0aGlzLl9oYXNWYWxpZGF0ZWRFeHRlcm5hbHM9ITA7ZWxzZXtsZXQgdD1cIkVycm9yOiBNaXNzaW5nIGZ1bmN0aW9uIGJpbmRpbmcgZm9yIGV4dGVybmFsXCI7dCs9bi5zaXplPjE/XCJzXCI6XCJcIix0Kz1cIjogJ1wiLHQrPUFycmF5LmZyb20obikuam9pbihcIicsICdcIiksdCs9XCInIFwiLHQrPXRoaXMuYWxsb3dFeHRlcm5hbEZ1bmN0aW9uRmFsbGJhY2tzP1wiLCBhbmQgbm8gZmFsbGJhY2sgaW5rIGZ1bmN0aW9uIGZvdW5kLlwiOlwiIChpbmsgZmFsbGJhY2tzIGRpc2FibGVkKVwiLHRoaXMuRXJyb3IodCl9ZWxzZSBpZihudWxsIT10KXtmb3IobGV0IGUgb2YgdC5jb250ZW50KXtsZXQgdD1lO251bGwhPXQmJnQuaGFzVmFsaWROYW1lfHx0aGlzLlZhbGlkYXRlRXh0ZXJuYWxCaW5kaW5ncyhlLG4pfWZvcihsZXRbLGVdb2YgdC5uYW1lZENvbnRlbnQpdGhpcy5WYWxpZGF0ZUV4dGVybmFsQmluZGluZ3MoYShlLHApLG4pfWVsc2UgaWYobnVsbCE9ZSl7bGV0IHQ9YShlLGspO2lmKHQmJnQuaXNFeHRlcm5hbCl7bGV0IGU9dC50YXJnZXRQYXRoU3RyaW5nO2lmKG51bGw9PT1lKXJldHVybiBkKFwibmFtZVwiKTtpZighdGhpcy5fZXh0ZXJuYWxzLmhhcyhlKSlpZih0aGlzLmFsbG93RXh0ZXJuYWxGdW5jdGlvbkZhbGxiYWNrcyl7dGhpcy5tYWluQ29udGVudENvbnRhaW5lci5uYW1lZENvbnRlbnQuaGFzKGUpfHxuLmFkZChlKX1lbHNlIG4uYWRkKGUpfX19T2JzZXJ2ZVZhcmlhYmxlKHQsZSl7aWYodGhpcy5JZkFzeW5jV2VDYW50KFwib2JzZXJ2ZSBhIG5ldyB2YXJpYWJsZVwiKSxudWxsPT09dGhpcy5fdmFyaWFibGVPYnNlcnZlcnMmJih0aGlzLl92YXJpYWJsZU9ic2VydmVycz1uZXcgTWFwKSwhdGhpcy5zdGF0ZS52YXJpYWJsZXNTdGF0ZS5HbG9iYWxWYXJpYWJsZUV4aXN0c1dpdGhOYW1lKHQpKXRocm93IG5ldyBTKFwiQ2Fubm90IG9ic2VydmUgdmFyaWFibGUgJ1wiK3QrXCInIGJlY2F1c2UgaXQgd2Fzbid0IGRlY2xhcmVkIGluIHRoZSBpbmsgc3RvcnkuXCIpO3RoaXMuX3ZhcmlhYmxlT2JzZXJ2ZXJzLmhhcyh0KT90aGlzLl92YXJpYWJsZU9ic2VydmVycy5nZXQodCkucHVzaChlKTp0aGlzLl92YXJpYWJsZU9ic2VydmVycy5zZXQodCxbZV0pfU9ic2VydmVWYXJpYWJsZXModCxlKXtmb3IobGV0IG49MCxpPXQubGVuZ3RoO248aTtuKyspdGhpcy5PYnNlcnZlVmFyaWFibGUodFtuXSxlW25dKX1SZW1vdmVWYXJpYWJsZU9ic2VydmVyKHQsZSl7aWYodGhpcy5JZkFzeW5jV2VDYW50KFwicmVtb3ZlIGEgdmFyaWFibGUgb2JzZXJ2ZXJcIiksbnVsbCE9PXRoaXMuX3ZhcmlhYmxlT2JzZXJ2ZXJzKWlmKHZvaWQgMCE9PWUpe2lmKHRoaXMuX3ZhcmlhYmxlT2JzZXJ2ZXJzLmhhcyhlKSl7bGV0IG49dGhpcy5fdmFyaWFibGVPYnNlcnZlcnMuZ2V0KGUpO251bGwhPT10P24uc3BsaWNlKG4uaW5kZXhPZih0KSwxKTp0aGlzLl92YXJpYWJsZU9ic2VydmVycy5kZWxldGUoZSl9fWVsc2UgaWYobnVsbCE9PXQpe2xldCBlPXRoaXMuX3ZhcmlhYmxlT2JzZXJ2ZXJzLmtleXMoKTtmb3IobGV0IG4gb2YgZSl7bGV0IGU9dGhpcy5fdmFyaWFibGVPYnNlcnZlcnMuZ2V0KG4pO2Uuc3BsaWNlKGUuaW5kZXhPZih0KSwxKX19fVZhcmlhYmxlU3RhdGVEaWRDaGFuZ2VFdmVudCh0LGUpe2lmKG51bGw9PT10aGlzLl92YXJpYWJsZU9ic2VydmVycylyZXR1cm47bGV0IG49dGhpcy5fdmFyaWFibGVPYnNlcnZlcnMuZ2V0KHQpO2lmKHZvaWQgMCE9PW4pe2lmKCEoZSBpbnN0YW5jZW9mIHYpKXRocm93IG5ldyBFcnJvcihcIlRyaWVkIHRvIGdldCB0aGUgdmFsdWUgb2YgYSB2YXJpYWJsZSB0aGF0IGlzbid0IGEgc3RhbmRhcmQgdHlwZVwiKTtsZXQgaT1zKGUsdik7Zm9yKGxldCBlIG9mIG4pZSh0LGkudmFsdWVPYmplY3QpfX1nZXQgZ2xvYmFsVGFncygpe3JldHVybiB0aGlzLlRhZ3NBdFN0YXJ0T2ZGbG93Q29udGFpbmVyV2l0aFBhdGhTdHJpbmcoXCJcIil9VGFnc0ZvckNvbnRlbnRBdFBhdGgodCl7cmV0dXJuIHRoaXMuVGFnc0F0U3RhcnRPZkZsb3dDb250YWluZXJXaXRoUGF0aFN0cmluZyh0KX1UYWdzQXRTdGFydE9mRmxvd0NvbnRhaW5lcldpdGhQYXRoU3RyaW5nKHQpe2xldCBuPW5ldyBlKHQpLGk9dGhpcy5Db250ZW50QXRQYXRoKG4pLmNvbnRhaW5lcjtpZihudWxsPT09aSlyZXR1cm4gZChcImZsb3dDb250YWluZXJcIik7Zm9yKDs7KXtsZXQgdD1pLmNvbnRlbnRbMF07aWYoISh0IGluc3RhbmNlb2YgTikpYnJlYWs7aT10fWxldCByPW51bGw7Zm9yKGxldCB0IG9mIGkuY29udGVudCl7bGV0IGU9YSh0LGopO2lmKCFlKWJyZWFrO251bGw9PXImJihyPVtdKSxyLnB1c2goZS50ZXh0KX1yZXR1cm4gcn1CdWlsZFN0cmluZ09mSGllcmFyY2h5KCl7bGV0IHQ9bmV3IG07cmV0dXJuIHRoaXMubWFpbkNvbnRlbnRDb250YWluZXIuQnVpbGRTdHJpbmdPZkhpZXJhcmNoeSh0LDAsdGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlci5SZXNvbHZlKCkpLHQudG9TdHJpbmcoKX1CdWlsZFN0cmluZ09mQ29udGFpbmVyKHQpe2xldCBlPW5ldyBtO3JldHVybiB0LkJ1aWxkU3RyaW5nT2ZIaWVyYXJjaHkoZSwwLHRoaXMuc3RhdGUuY3VycmVudFBvaW50ZXIuUmVzb2x2ZSgpKSxlLnRvU3RyaW5nKCl9TmV4dENvbnRlbnQoKXtpZih0aGlzLnN0YXRlLnByZXZpb3VzUG9pbnRlcj10aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLmNvcHkoKSwhdGhpcy5zdGF0ZS5kaXZlcnRlZFBvaW50ZXIuaXNOdWxsJiYodGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlcj10aGlzLnN0YXRlLmRpdmVydGVkUG9pbnRlci5jb3B5KCksdGhpcy5zdGF0ZS5kaXZlcnRlZFBvaW50ZXI9SS5OdWxsLHRoaXMuVmlzaXRDaGFuZ2VkQ29udGFpbmVyc0R1ZVRvRGl2ZXJ0KCksIXRoaXMuc3RhdGUuY3VycmVudFBvaW50ZXIuaXNOdWxsKSlyZXR1cm47aWYoIXRoaXMuSW5jcmVtZW50Q29udGVudFBvaW50ZXIoKSl7bGV0IHQ9ITE7dGhpcy5zdGF0ZS5jYWxsU3RhY2suQ2FuUG9wKHIuRnVuY3Rpb24pPyh0aGlzLnN0YXRlLlBvcENhbGxTdGFjayhyLkZ1bmN0aW9uKSx0aGlzLnN0YXRlLmluRXhwcmVzc2lvbkV2YWx1YXRpb24mJnRoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhuZXcgTCksdD0hMCk6dGhpcy5zdGF0ZS5jYWxsU3RhY2suY2FuUG9wVGhyZWFkPyh0aGlzLnN0YXRlLmNhbGxTdGFjay5Qb3BUaHJlYWQoKSx0PSEwKTp0aGlzLnN0YXRlLlRyeUV4aXRGdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZSgpLHQmJiF0aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLmlzTnVsbCYmdGhpcy5OZXh0Q29udGVudCgpfX1JbmNyZW1lbnRDb250ZW50UG9pbnRlcigpe2xldCB0PSEwLGU9dGhpcy5zdGF0ZS5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQuY3VycmVudFBvaW50ZXIuY29weSgpO2lmKGUuaW5kZXgrKyxudWxsPT09ZS5jb250YWluZXIpcmV0dXJuIGQoXCJwb2ludGVyLmNvbnRhaW5lclwiKTtmb3IoO2UuaW5kZXg+PWUuY29udGFpbmVyLmNvbnRlbnQubGVuZ3RoOyl7dD0hMTtsZXQgbj1hKGUuY29udGFpbmVyLnBhcmVudCxOKTtpZihuIGluc3RhbmNlb2YgTj09ITEpYnJlYWs7bGV0IGk9bi5jb250ZW50LmluZGV4T2YoZS5jb250YWluZXIpO2lmKC0xPT1pKWJyZWFrO2lmKGU9bmV3IEkobixpKSxlLmluZGV4KyssdD0hMCxudWxsPT09ZS5jb250YWluZXIpcmV0dXJuIGQoXCJwb2ludGVyLmNvbnRhaW5lclwiKX1yZXR1cm4gdHx8KGU9SS5OdWxsKSx0aGlzLnN0YXRlLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC5jdXJyZW50UG9pbnRlcj1lLmNvcHkoKSx0fVRyeUZvbGxvd0RlZmF1bHRJbnZpc2libGVDaG9pY2UoKXtsZXQgdD10aGlzLl9zdGF0ZS5jdXJyZW50Q2hvaWNlcyxlPXQuZmlsdGVyKHQ9PnQuaXNJbnZpc2libGVEZWZhdWx0KTtpZigwPT1lLmxlbmd0aHx8dC5sZW5ndGg+ZS5sZW5ndGgpcmV0dXJuITE7bGV0IG49ZVswXTtyZXR1cm4gbnVsbD09PW4udGFyZ2V0UGF0aD9kKFwiY2hvaWNlLnRhcmdldFBhdGhcIik6bnVsbD09PW4udGhyZWFkQXRHZW5lcmF0aW9uP2QoXCJjaG9pY2UudGhyZWFkQXRHZW5lcmF0aW9uXCIpOih0aGlzLnN0YXRlLmNhbGxTdGFjay5jdXJyZW50VGhyZWFkPW4udGhyZWFkQXRHZW5lcmF0aW9uLHRoaXMuQ2hvb3NlUGF0aChuLnRhcmdldFBhdGgsITEpLCEwKX1OZXh0U2VxdWVuY2VTaHVmZmxlSW5kZXgoKXtsZXQgdD1hKHRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCksYik7aWYoISh0IGluc3RhbmNlb2YgYikpcmV0dXJuIHRoaXMuRXJyb3IoXCJleHBlY3RlZCBudW1iZXIgb2YgZWxlbWVudHMgaW4gc2VxdWVuY2UgZm9yIHNodWZmbGUgaW5kZXhcIiksMDtsZXQgZT10aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLmNvbnRhaW5lcjtpZihudWxsPT09ZSlyZXR1cm4gZChcInNlcUNvbnRhaW5lclwiKTtpZihudWxsPT09dC52YWx1ZSlyZXR1cm4gZChcIm51bUVsZW1lbnRzSW50VmFsLnZhbHVlXCIpO2xldCBuPXQudmFsdWUsaT1zKHRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCksYikudmFsdWU7aWYobnVsbD09PWkpcmV0dXJuIGQoXCJzZXFDb3VudFwiKTtsZXQgcj1pL24sbD1pJW4sbz1lLnBhdGgudG9TdHJpbmcoKSx1PTA7Zm9yKGxldCB0PTAsZT1vLmxlbmd0aDt0PGU7dCsrKXUrPW8uY2hhckNvZGVBdCh0KXx8MDtsZXQgaD11K3IrdGhpcy5zdGF0ZS5zdG9yeVNlZWQsYz1uZXcgSyhNYXRoLmZsb29yKGgpKSxwPVtdO2ZvcihsZXQgdD0wO3Q8bjsrK3QpcC5wdXNoKHQpO2ZvcihsZXQgdD0wO3Q8PWw7Kyt0KXtsZXQgZT1jLm5leHQoKSVwLmxlbmd0aCxuPXBbZV07aWYocC5zcGxpY2UoZSwxKSx0PT1sKXJldHVybiBufXRocm93IG5ldyBFcnJvcihcIlNob3VsZCBuZXZlciByZWFjaCBoZXJlXCIpfUVycm9yKHQsZT0hMSl7bGV0IG49bmV3IFModCk7dGhyb3cgbi51c2VFbmRMaW5lTnVtYmVyPWUsbn1XYXJuaW5nKHQpe3RoaXMuQWRkRXJyb3IodCwhMCl9QWRkRXJyb3IodCxlPSExLG49ITEpe2xldCBpPXRoaXMuY3VycmVudERlYnVnTWV0YWRhdGEscj1lP1wiV0FSTklOR1wiOlwiRVJST1JcIjtpZihudWxsIT1pKXtsZXQgZT1uP2kuZW5kTGluZU51bWJlcjppLnN0YXJ0TGluZU51bWJlcjt0PVwiUlVOVElNRSBcIityK1wiOiAnXCIraS5maWxlTmFtZStcIicgbGluZSBcIitlK1wiOiBcIit0fWVsc2UgdD10aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLmlzTnVsbD9cIlJVTlRJTUUgXCIrcitcIjogXCIrdDpcIlJVTlRJTUUgXCIrcitcIjogKFwiK3RoaXMuc3RhdGUuY3VycmVudFBvaW50ZXIrXCIpOiBcIit0O3RoaXMuc3RhdGUuQWRkRXJyb3IodCxlKSxlfHx0aGlzLnN0YXRlLkZvcmNlRW5kKCl9QXNzZXJ0KHQsZT1udWxsKXtpZigwPT10KXRocm93IG51bGw9PWUmJihlPVwiU3RvcnkgYXNzZXJ0XCIpLG5ldyBFcnJvcihlK1wiIFwiK3RoaXMuY3VycmVudERlYnVnTWV0YWRhdGEpfWdldCBjdXJyZW50RGVidWdNZXRhZGF0YSgpe2xldCB0LGU9dGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlcjtpZighZS5pc051bGwmJm51bGwhPT1lLlJlc29sdmUoKSYmKHQ9ZS5SZXNvbHZlKCkuZGVidWdNZXRhZGF0YSxudWxsIT09dCkpcmV0dXJuIHQ7Zm9yKGxldCBuPXRoaXMuc3RhdGUuY2FsbFN0YWNrLmVsZW1lbnRzLmxlbmd0aC0xO24+PTA7LS1uKWlmKGU9dGhpcy5zdGF0ZS5jYWxsU3RhY2suZWxlbWVudHNbbl0uY3VycmVudFBvaW50ZXIsIWUuaXNOdWxsJiZudWxsIT09ZS5SZXNvbHZlKCkmJih0PWUuUmVzb2x2ZSgpLmRlYnVnTWV0YWRhdGEsbnVsbCE9PXQpKXJldHVybiB0O2ZvcihsZXQgZT10aGlzLnN0YXRlLm91dHB1dFN0cmVhbS5sZW5ndGgtMTtlPj0wOy0tZSl7aWYodD10aGlzLnN0YXRlLm91dHB1dFN0cmVhbVtlXS5kZWJ1Z01ldGFkYXRhLG51bGwhPT10KXJldHVybiB0fXJldHVybiBudWxsfWdldCBtYWluQ29udGVudENvbnRhaW5lcigpe3JldHVybiB0aGlzLl90ZW1wb3JhcnlFdmFsdWF0aW9uQ29udGFpbmVyP3RoaXMuX3RlbXBvcmFyeUV2YWx1YXRpb25Db250YWluZXI6dGhpcy5fbWFpbkNvbnRlbnRDb250YWluZXJ9fVguaW5rVmVyc2lvbkN1cnJlbnQ9MTksZnVuY3Rpb24odCl7bGV0IGU7IWZ1bmN0aW9uKHQpe3RbdC5Ob0NoYW5nZT0wXT1cIk5vQ2hhbmdlXCIsdFt0LkV4dGVuZGVkQmV5b25kTmV3bGluZT0xXT1cIkV4dGVuZGVkQmV5b25kTmV3bGluZVwiLHRbdC5OZXdsaW5lUmVtb3ZlZD0yXT1cIk5ld2xpbmVSZW1vdmVkXCJ9KGU9dC5PdXRwdXRTdGF0ZUNoYW5nZXx8KHQuT3V0cHV0U3RhdGVDaGFuZ2U9e30pKX0oWHx8KFg9e30pKSx0Lklua0xpc3Q9Zyx0LlN0b3J5PVgsT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSl9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmstZXMyMDE1LmpzLm1hcFxuIiwiaW1wb3J0IEhlYWQgZnJvbSAnbmV4dC9oZWFkJ1xuaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnXG5cbmltcG9ydCBpbmtqcyBmcm9tICdpbmtqcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEhvbWUoKSB7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBmZXRjaChcInN0b3J5Lmpzb25cIilcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChzdG9yeUNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdG9yeUNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIHN0b3J5ID0gbmV3IGlua2pzLlN0b3J5KHN0b3J5Q29udGVudCk7XG4gICAgICAgICAgICAgICAgY29udGludWVTdG9yeSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSlcblxuICAgIHJldHVybiAoXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8SGVhZD5cbiAgICAgICAgICAgICAgICA8dGl0bGU+RGF0aW5nIFNpbTwvdGl0bGU+XG4gICAgICAgICAgICA8L0hlYWQ+XG5cbiAgICAgICAgICAgIDxtYWluPlxuICAgICAgICAgICAgICAgIDxoMT5EYXRpbmcgU2ltPC9oMT5cblxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgPC9tYWluPlxuICAgICAgICA8L2Rpdj5cbiAgICApXG59Il0sInNvdXJjZVJvb3QiOiIifQ==