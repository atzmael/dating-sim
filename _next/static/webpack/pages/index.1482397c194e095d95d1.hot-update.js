webpackHotUpdate_N_E("pages/index",{

/***/ "./node_modules/inkjs/dist/ink-es2015.js":
/*!***********************************************!*\
  !*** ./node_modules/inkjs/dist/ink-es2015.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

!function(t,e){ true?e(exports):undefined}(this,(function(t){"use strict";class e{constructor(){if(this._components=[],this._componentsString=null,this._isRelative=!1,"string"==typeof arguments[0]){let t=arguments[0];this.componentsString=t}else if(arguments[0]instanceof e.Component&&arguments[1]instanceof e){let t=arguments[0],e=arguments[1];this._components.push(t),this._components=this._components.concat(e._components)}else if(arguments[0]instanceof Array){let t=arguments[0],e=!!arguments[1];this._components=this._components.concat(t),this._isRelative=e}}get isRelative(){return this._isRelative}get componentCount(){return this._components.length}get head(){return this._components.length>0?this._components[0]:null}get tail(){if(this._components.length>=2){let t=this._components.slice(1,this._components.length);return new e(t)}return e.self}get length(){return this._components.length}get lastComponent(){let t=this._components.length-1;return t>=0?this._components[t]:null}get containsNamedComponent(){for(let t=0,e=this._components.length;t<e;t++)if(!this._components[t].isIndex)return!0;return!1}static get self(){let t=new e;return t._isRelative=!0,t}GetComponent(t){return this._components[t]}PathByAppendingPath(t){let n=new e,i=0;for(let e=0;e<t._components.length&&t._components[e].isParent;++e)i++;for(let t=0;t<this._components.length-i;++t)n._components.push(this._components[t]);for(let e=i;e<t._components.length;++e)n._components.push(t._components[e]);return n}get componentsString(){return null==this._componentsString&&(this._componentsString=this._components.join("."),this.isRelative&&(this._componentsString="."+this._componentsString)),this._componentsString}set componentsString(t){if(this._components.length=0,this._componentsString=t,null==this._componentsString||""==this._componentsString)return;"."==this._componentsString[0]&&(this._isRelative=!0,this._componentsString=this._componentsString.substring(1));let n=this._componentsString.split(".");for(let t of n)/^(\-|\+)?([0-9]+|Infinity)$/.test(t)?this._components.push(new e.Component(parseInt(t))):this._components.push(new e.Component(t))}toString(){return this.componentsString}Equals(t){if(null==t)return!1;if(t._components.length!=this._components.length)return!1;if(t.isRelative!=this.isRelative)return!1;for(let e=0,n=t._components.length;e<n;e++)if(!t._components[e].Equals(this._components[e]))return!1;return!0}PathByAppendingComponent(t){let n=new e;return n._components.push.apply(n._components,this._components),n._components.push(t),n}}var n,i,r;function a(t,e){return t instanceof e?h(t):null}function s(t,e){if(t instanceof e)return h(t);throw new Error(`${t} is not of type ${e}`)}function l(t){return t.hasValidName&&t.name?t:null}function o(t){return void 0===t?null:t}function u(t){return"object"==typeof t&&"function"==typeof t.Equals}function h(t,e){return t}e.parentId="^",function(t){class e{constructor(t){this.index=-1,this.name=null,"string"==typeof t?this.name=t:this.index=t}get isIndex(){return this.index>=0}get isParent(){return this.name==t.parentId}static ToParent(){return new e(t.parentId)}toString(){return this.isIndex?this.index.toString():this.name}Equals(t){return null!=t&&t.isIndex==this.isIndex&&(this.isIndex?this.index==t.index:this.name==t.name)}}t.Component=e}(e||(e={})),function(t){function e(t,e){if(!t)throw void 0!==e&&console.warn(e),console.trace&&console.trace(),new Error("")}t.AssertType=function(t,n,i){e(t instanceof n,i)},t.Assert=e}(n||(n={}));class c extends Error{}function d(t){throw new c(t+" is null or undefined")}class p{constructor(){this.parent=null,this._debugMetadata=null,this._path=null}get debugMetadata(){return null===this._debugMetadata&&this.parent?this.parent.debugMetadata:this._debugMetadata}set debugMetadata(t){this._debugMetadata=t}get ownDebugMetadata(){return this._debugMetadata}DebugLineNumberOfPath(t){if(null===t)return null;let e=this.rootContentContainer;if(e){let n=e.ContentAtPath(t).obj;if(n){let t=n.debugMetadata;if(null!==t)return t.startLineNumber}}return null}get path(){if(null==this._path)if(null==this.parent)this._path=new e;else{let t=[],n=this,i=a(n.parent,N);for(;null!==i;){let r=l(n);null!=r&&r.hasValidName?t.unshift(new e.Component(r.name)):t.unshift(new e.Component(i.content.indexOf(n))),n=i,i=a(i.parent,N)}this._path=new e(t)}return this._path}ResolvePath(t){if(null===t)return d("path");if(t.isRelative){let e=a(this,N);return null===e&&(n.Assert(null!==this.parent,"Can't resolve relative path because we don't have a parent"),e=a(this.parent,N),n.Assert(null!==e,"Expected parent to be a container"),n.Assert(t.GetComponent(0).isParent),t=t.tail),null===e?d("nearestContainer"):e.ContentAtPath(t)}{let e=this.rootContentContainer;return null===e?d("contentContainer"):e.ContentAtPath(t)}}ConvertPathToRelative(t){let n=this.path,i=Math.min(t.length,n.length),r=-1;for(let e=0;e<i;++e){let i=n.GetComponent(e),a=t.GetComponent(e);if(!i.Equals(a))break;r=e}if(-1==r)return t;let a=n.componentCount-1-r,s=[];for(let t=0;t<a;++t)s.push(e.Component.ToParent());for(let e=r+1;e<t.componentCount;++e)s.push(t.GetComponent(e));return new e(s,!0)}CompactPathString(t){let e=null,n=null;if(t.isRelative)n=t.componentsString,e=this.path.PathByAppendingPath(t).componentsString;else{n=this.ConvertPathToRelative(t).componentsString,e=t.componentsString}return n.length<e.length?n:e}get rootContentContainer(){let t=this;for(;t.parent;)t=t.parent;return a(t,N)}Copy(){throw Error("Not Implemented: Doesn't support copying")}SetChild(t,e,n){t[e]&&(t[e]=null),t[e]=n,t[e]&&(t[e].parent=this)}}class m{constructor(t){t=void 0!==t?t.toString():"",this.string=t}get Length(){return this.string.length}Append(t){null!==t&&(this.string+=t)}AppendLine(t){void 0!==t&&this.Append(t),this.string+="\n"}AppendFormat(t,...e){this.string+=t.replace(/{(\d+)}/g,(t,n)=>void 0!==e[n]?e[n]:t)}toString(){return this.string}}class f{constructor(){if(this.originName=null,this.itemName=null,void 0!==arguments[1]){let t=arguments[0],e=arguments[1];this.originName=t,this.itemName=e}else if(arguments[0]){let t=arguments[0].toString().split(".");this.originName=t[0],this.itemName=t[1]}}static get Null(){return new f(null,null)}get isNull(){return null==this.originName&&null==this.itemName}get fullName(){return(null!==this.originName?this.originName:"?")+"."+this.itemName}toString(){return this.fullName}Equals(t){if(t instanceof f){let e=t;return e.itemName==this.itemName&&e.originName==this.originName}return!1}copy(){return new f(this.originName,this.itemName)}serialized(){return JSON.stringify({originName:this.originName,itemName:this.itemName})}static fromSerializedKey(t){let e=JSON.parse(t);if(!f.isLikeInkListItem(e))return f.Null;let n=e;return new f(n.originName,n.itemName)}static isLikeInkListItem(t){return"object"==typeof t&&(!(!t.hasOwnProperty("originName")||!t.hasOwnProperty("itemName"))&&(("string"==typeof t.originName||null===typeof t.originName)&&("string"==typeof t.itemName||null===typeof t.itemName)))}}class g extends Map{constructor(){if(super(arguments[0]instanceof g?arguments[0]:[]),this.origins=null,this._originNames=[],arguments[0]instanceof g){let t=arguments[0];t._originNames&&(this._originNames=t._originNames.slice())}else if("string"==typeof arguments[0]){let t=arguments[0],e=arguments[1];this.SetInitialOriginName(t);let n=e.listDefinitions.TryListGetDefinition(t,null);if(!n.exists)throw new Error("InkList origin could not be found in story when constructing new list: "+t);this.origins=[n.result]}else if("object"==typeof arguments[0]&&arguments[0].hasOwnProperty("Key")&&arguments[0].hasOwnProperty("Value")){let t=arguments[0];this.Add(t.Key,t.Value)}}AddItem(t){if(t instanceof f){let e=t;if(null==e.originName)return void this.AddItem(e.itemName);if(null===this.origins)return d("this.origins");for(let t of this.origins)if(t.name==e.originName){let n=t.TryGetValueForItem(e,0);if(n.exists)return void this.Add(e,n.result);throw new Error("Could not add the item "+e+" to this list because it doesn't exist in the original list definition in ink.")}throw new Error("Failed to add item to list because the item was from a new list definition that wasn't previously known to this list. Only items from previously known lists can be used, so that the int value can be found.")}{let e=t,n=null;if(null===this.origins)return d("this.origins");for(let t of this.origins){if(null===e)return d("itemName");if(t.ContainsItemWithName(e)){if(null!=n)throw new Error("Could not add the item "+e+" to this list because it could come from either "+t.name+" or "+n.name);n=t}}if(null==n)throw new Error("Could not add the item "+e+" to this list because it isn't known to any list definitions previously associated with this list.");let i=new f(n.name,e),r=n.ValueForItem(i);this.Add(i,r)}}ContainsItemNamed(t){for(let[e]of this){if(f.fromSerializedKey(e).itemName==t)return!0}return!1}ContainsKey(t){return this.has(t.serialized())}Add(t,e){let n=t.serialized();if(this.has(n))throw new Error("The Map already contains an entry for "+t);this.set(n,e)}Remove(t){return this.delete(t.serialized())}get Count(){return this.size}get originOfMaxItem(){if(null==this.origins)return null;let t=this.maxItem.Key.originName,e=null;return this.origins.every(n=>n.name!=t||(e=n,!1)),e}get originNames(){if(this.Count>0){null==this._originNames&&this.Count>0?this._originNames=[]:(this._originNames||(this._originNames=[]),this._originNames.length=0);for(let[t]of this){let e=f.fromSerializedKey(t);if(null===e.originName)return d("item.originName");this._originNames.push(e.originName)}}return this._originNames}SetInitialOriginName(t){this._originNames=[t]}SetInitialOriginNames(t){this._originNames=null==t?null:t.slice()}get maxItem(){let t={Key:f.Null,Value:0};for(let[e,n]of this){let i=f.fromSerializedKey(e);(t.Key.isNull||n>t.Value)&&(t={Key:i,Value:n})}return t}get minItem(){let t={Key:f.Null,Value:0};for(let[e,n]of this){let i=f.fromSerializedKey(e);(t.Key.isNull||n<t.Value)&&(t={Key:i,Value:n})}return t}get inverse(){let t=new g;if(null!=this.origins)for(let e of this.origins)for(let[n,i]of e.items){let e=f.fromSerializedKey(n);this.ContainsKey(e)||t.Add(e,i)}return t}get all(){let t=new g;if(null!=this.origins)for(let e of this.origins)for(let[n,i]of e.items){let e=f.fromSerializedKey(n);t.set(e.serialized(),i)}return t}Union(t){let e=new g(this);for(let[n,i]of t)e.set(n,i);return e}Intersect(t){let e=new g;for(let[n,i]of this)t.has(n)&&e.set(n,i);return e}Without(t){let e=new g(this);for(let[n]of t)e.delete(n);return e}Contains(t){for(let[e]of t)if(!this.has(e))return!1;return!0}GreaterThan(t){return 0!=this.Count&&(0==t.Count||this.minItem.Value>t.maxItem.Value)}GreaterThanOrEquals(t){return 0!=this.Count&&(0==t.Count||this.minItem.Value>=t.minItem.Value&&this.maxItem.Value>=t.maxItem.Value)}LessThan(t){return 0!=t.Count&&(0==this.Count||this.maxItem.Value<t.minItem.Value)}LessThanOrEquals(t){return 0!=t.Count&&(0==this.Count||this.maxItem.Value<=t.maxItem.Value&&this.minItem.Value<=t.minItem.Value)}MaxAsList(){return this.Count>0?new g(this.maxItem):new g}MinAsList(){return this.Count>0?new g(this.minItem):new g}ListWithSubRange(t,e){if(0==this.Count)return new g;let n=this.orderedItems,i=0,r=Number.MAX_SAFE_INTEGER;Number.isInteger(t)?i=t:t instanceof g&&t.Count>0&&(i=t.minItem.Value),Number.isInteger(e)?r=e:t instanceof g&&t.Count>0&&(r=e.maxItem.Value);let a=new g;a.SetInitialOriginNames(this.originNames);for(let t of n)t.Value>=i&&t.Value<=r&&a.Add(t.Key,t.Value);return a}Equals(t){if(t instanceof g==!1)return!1;if(t.Count!=this.Count)return!1;for(let[e]of this)if(!t.has(e))return!1;return!0}get orderedItems(){let t=new Array;for(let[e,n]of this){let i=f.fromSerializedKey(e);t.push({Key:i,Value:n})}return t.sort((t,e)=>null===t.Key.originName?d("x.Key.originName"):null===e.Key.originName?d("y.Key.originName"):t.Value==e.Value?t.Key.originName.localeCompare(e.Key.originName):t.Value<e.Value?-1:t.Value>e.Value?1:0),t}toString(){let t=this.orderedItems,e=new m;for(let n=0;n<t.length;n++){n>0&&e.Append(", ");let i=t[n].Key;if(null===i.itemName)return d("item.itemName");e.Append(i.itemName)}return e.toString()}valueOf(){return NaN}}class S extends Error{constructor(t){super(t),this.useEndLineNumber=!1,this.message=t,this.name="StoryException"}}function y(t,e,n){if(null===t)return{result:n,exists:!1};let i=t.get(e);return void 0===i?{result:n,exists:!1}:{result:i,exists:!0}}class C extends p{static Create(t,n){if(n){if(n===i.Int&&Number.isInteger(Number(t)))return new b(Number(t));if(n===i.Float&&!isNaN(t))return new _(Number(t))}if("boolean"==typeof t){t=!!t?1:0}return"string"==typeof t?new T(String(t)):Number.isInteger(Number(t))?new b(Number(t)):isNaN(t)?t instanceof e?new P(s(t,e)):t instanceof g?new O(s(t,g)):null:new _(Number(t))}Copy(){return s(C.Create(this),p)}BadCastException(t){return new S("Can't cast "+this.valueObject+" from "+this.valueType+" to "+t)}}class v extends C{constructor(t){super(),this.value=t}get valueObject(){return this.value}toString(){return null===this.value?d("Value.value"):this.value.toString()}}class b extends v{constructor(t){super(t||0)}get isTruthy(){return 0!=this.value}get valueType(){return i.Int}Cast(t){if(null===this.value)return d("Value.value");if(t==this.valueType)return this;if(t==i.Float)return new _(this.value);if(t==i.String)return new T(""+this.value);throw this.BadCastException(t)}}class _ extends v{constructor(t){super(t||0)}get isTruthy(){return 0!=this.value}get valueType(){return i.Float}Cast(t){if(null===this.value)return d("Value.value");if(t==this.valueType)return this;if(t==i.Int)return new b(this.value);if(t==i.String)return new T(""+this.value);throw this.BadCastException(t)}}class T extends v{constructor(t){if(super(t||""),this._isNewline="\n"==this.value,this._isInlineWhitespace=!0,null===this.value)return d("Value.value");this.value.length>0&&this.value.split("").every(t=>" "==t||"\t"==t||(this._isInlineWhitespace=!1,!1))}get valueType(){return i.String}get isTruthy(){return null===this.value?d("Value.value"):this.value.length>0}get isNewline(){return this._isNewline}get isInlineWhitespace(){return this._isInlineWhitespace}get isNonWhitespace(){return!this.isNewline&&!this.isInlineWhitespace}Cast(t){if(t==this.valueType)return this;if(t==i.Int){let e=function(t,e=0){let n=parseInt(t);return Number.isNaN(n)?{result:e,exists:!1}:{result:n,exists:!0}}(this.value);if(e.exists)return new b(e.result);throw this.BadCastException(t)}if(t==i.Float){let e=function(t,e=0){let n=parseFloat(t);return Number.isNaN(n)?{result:e,exists:!1}:{result:n,exists:!0}}(this.value);if(e.exists)return new _(e.result);throw this.BadCastException(t)}throw this.BadCastException(t)}}class P extends v{constructor(t){super(t)}get valueType(){return i.DivertTarget}get targetPath(){return null===this.value?d("Value.value"):this.value}set targetPath(t){this.value=t}get isTruthy(){throw new Error("Shouldn't be checking the truthiness of a divert target")}Cast(t){if(t==this.valueType)return this;throw this.BadCastException(t)}toString(){return"DivertTargetValue("+this.targetPath+")"}}class w extends v{constructor(t,e=-1){super(t),this._contextIndex=e}get contextIndex(){return this._contextIndex}set contextIndex(t){this._contextIndex=t}get variableName(){return null===this.value?d("Value.value"):this.value}set variableName(t){this.value=t}get valueType(){return i.VariablePointer}get isTruthy(){throw new Error("Shouldn't be checking the truthiness of a variable pointer")}Cast(t){if(t==this.valueType)return this;throw this.BadCastException(t)}toString(){return"VariablePointerValue("+this.variableName+")"}Copy(){return new w(this.variableName,this.contextIndex)}}class O extends v{get isTruthy(){return null===this.value?d("this.value"):this.value.Count>0}get valueType(){return i.List}Cast(t){if(null===this.value)return d("Value.value");if(t==i.Int){let t=this.value.maxItem;return t.Key.isNull?new b(0):new b(t.Value)}if(t==i.Float){let t=this.value.maxItem;return t.Key.isNull?new _(0):new _(t.Value)}if(t==i.String){let t=this.value.maxItem;return t.Key.isNull?new T(""):new T(t.Key.toString())}if(t==this.valueType)return this;throw this.BadCastException(t)}constructor(t,e){super(null),t||e?t instanceof g?this.value=new g(t):t instanceof f&&"number"==typeof e&&(this.value=new g({Key:t,Value:e})):this.value=new g}static RetainListOriginsForAssignment(t,e){let n=a(t,O),i=a(e,O);return i&&null===i.value?d("newList.value"):n&&null===n.value?d("oldList.value"):void(n&&i&&0==i.value.Count&&i.value.SetInitialOriginNames(n.value.originNames))}}!function(t){t[t.Int=0]="Int",t[t.Float=1]="Float",t[t.List=2]="List",t[t.String=3]="String",t[t.DivertTarget=4]="DivertTarget",t[t.VariablePointer=5]="VariablePointer"}(i||(i={}));class E{constructor(){this.obj=null,this.approximate=!1}get correctObj(){return this.approximate?null:this.obj}get container(){return this.obj instanceof N?this.obj:null}copy(){let t=new E;return t.obj=this.obj,t.approximate=this.approximate,t}}class N extends p{constructor(){super(...arguments),this.name="",this._content=[],this.namedContent=new Map,this.visitsShouldBeCounted=!1,this.turnIndexShouldBeCounted=!1,this.countingAtStartOnly=!1,this._pathToFirstLeafContent=null}get hasValidName(){return null!=this.name&&this.name.length>0}get content(){return this._content}set content(t){this.AddContent(t)}get namedOnlyContent(){let t=new Map;for(let[e,n]of this.namedContent){let i=s(n,p);t.set(e,i)}for(let e of this.content){let n=l(e);null!=n&&n.hasValidName&&t.delete(n.name)}return 0==t.size&&(t=null),t}set namedOnlyContent(t){let e=this.namedOnlyContent;if(null!=e)for(let[t]of e)this.namedContent.delete(t);if(null!=t)for(let[,e]of t){let t=l(e);null!=t&&this.AddToNamedContentOnly(t)}}get countFlags(){let t=0;return this.visitsShouldBeCounted&&(t|=N.CountFlags.Visits),this.turnIndexShouldBeCounted&&(t|=N.CountFlags.Turns),this.countingAtStartOnly&&(t|=N.CountFlags.CountStartOnly),t==N.CountFlags.CountStartOnly&&(t=0),t}set countFlags(t){let e=t;(e&N.CountFlags.Visits)>0&&(this.visitsShouldBeCounted=!0),(e&N.CountFlags.Turns)>0&&(this.turnIndexShouldBeCounted=!0),(e&N.CountFlags.CountStartOnly)>0&&(this.countingAtStartOnly=!0)}get pathToFirstLeafContent(){return null==this._pathToFirstLeafContent&&(this._pathToFirstLeafContent=this.path.PathByAppendingPath(this.internalPathToFirstLeafContent)),this._pathToFirstLeafContent}get internalPathToFirstLeafContent(){let t=[],n=this;for(;n instanceof N;)n.content.length>0&&(t.push(new e.Component(0)),n=n.content[0]);return new e(t)}AddContent(t){if(t instanceof Array){let e=t;for(let t of e)this.AddContent(t)}else{let e=t;if(this._content.push(e),e.parent)throw new Error("content is already in "+e.parent);e.parent=this,this.TryAddNamedContent(e)}}TryAddNamedContent(t){let e=l(t);null!=e&&e.hasValidName&&this.AddToNamedContentOnly(e)}AddToNamedContentOnly(t){n.AssertType(t,p,"Can only add Runtime.Objects to a Runtime.Container"),s(t,p).parent=this,this.namedContent.set(t.name,t)}ContentAtPath(t,e=0,n=-1){-1==n&&(n=t.length);let i=new E;i.approximate=!1;let r=this,s=this;for(let l=e;l<n;++l){let e=t.GetComponent(l);if(null==r){i.approximate=!0;break}let n=r.ContentWithPathComponent(e);if(null==n){i.approximate=!0;break}s=n,r=a(n,N)}return i.obj=s,i}InsertContent(t,e){if(this.content[e]=t,t.parent)throw new Error("content is already in "+t.parent);t.parent=this,this.TryAddNamedContent(t)}AddContentsOfContainer(t){this.content=this.content.concat(t.content);for(let e of t.content)e.parent=this,this.TryAddNamedContent(e)}ContentWithPathComponent(t){if(t.isIndex)return t.index>=0&&t.index<this.content.length?this.content[t.index]:null;if(t.isParent)return this.parent;{if(null===t.name)return d("component.name");let e=y(this.namedContent,t.name,null);return e.exists?s(e.result,p):null}}BuildStringOfHierarchy(){let t;if(0==arguments.length)return t=new m,this.BuildStringOfHierarchy(t,0,null),t.toString();t=arguments[0];let e=arguments[1],i=arguments[2];function r(){for(let n=0;n<4*e;++n)t.Append(" ")}r(),t.Append("["),this.hasValidName&&t.AppendFormat(" ({0})",this.name),this==i&&t.Append("  <---"),t.AppendLine(),e++;for(let n=0;n<this.content.length;++n){let a=this.content[n];if(a instanceof N){a.BuildStringOfHierarchy(t,e,i)}else r(),a instanceof T?(t.Append('"'),t.Append(a.toString().replace("\n","\\n")),t.Append('"')):t.Append(a.toString());n!=this.content.length-1&&t.Append(","),a instanceof N||a!=i||t.Append("  <---"),t.AppendLine()}let a=new Map;for(let[t,e]of this.namedContent)this.content.indexOf(s(e,p))>=0||a.set(t,e);if(a.size>0){r(),t.AppendLine("-- named: --");for(let[,r]of a){n.AssertType(r,N,"Can only print out named Containers"),r.BuildStringOfHierarchy(t,e,i),t.AppendLine()}}e--,r(),t.Append("]")}}!function(t){let e;!function(t){t[t.Visits=1]="Visits",t[t.Turns=2]="Turns",t[t.CountStartOnly=4]="CountStartOnly"}(e=t.CountFlags||(t.CountFlags={}))}(N||(N={}));class x extends p{toString(){return"Glue"}}class A extends p{constructor(t=A.CommandType.NotSet){super(),this._commandType=t}get commandType(){return this._commandType}Copy(){return new A(this.commandType)}static EvalStart(){return new A(A.CommandType.EvalStart)}static EvalOutput(){return new A(A.CommandType.EvalOutput)}static EvalEnd(){return new A(A.CommandType.EvalEnd)}static Duplicate(){return new A(A.CommandType.Duplicate)}static PopEvaluatedValue(){return new A(A.CommandType.PopEvaluatedValue)}static PopFunction(){return new A(A.CommandType.PopFunction)}static PopTunnel(){return new A(A.CommandType.PopTunnel)}static BeginString(){return new A(A.CommandType.BeginString)}static EndString(){return new A(A.CommandType.EndString)}static NoOp(){return new A(A.CommandType.NoOp)}static ChoiceCount(){return new A(A.CommandType.ChoiceCount)}static Turns(){return new A(A.CommandType.Turns)}static TurnsSince(){return new A(A.CommandType.TurnsSince)}static ReadCount(){return new A(A.CommandType.ReadCount)}static Random(){return new A(A.CommandType.Random)}static SeedRandom(){return new A(A.CommandType.SeedRandom)}static VisitIndex(){return new A(A.CommandType.VisitIndex)}static SequenceShuffleIndex(){return new A(A.CommandType.SequenceShuffleIndex)}static StartThread(){return new A(A.CommandType.StartThread)}static Done(){return new A(A.CommandType.Done)}static End(){return new A(A.CommandType.End)}static ListFromInt(){return new A(A.CommandType.ListFromInt)}static ListRange(){return new A(A.CommandType.ListRange)}static ListRandom(){return new A(A.CommandType.ListRandom)}toString(){return this.commandType.toString()}}!function(t){let e;!function(t){t[t.NotSet=-1]="NotSet",t[t.EvalStart=0]="EvalStart",t[t.EvalOutput=1]="EvalOutput",t[t.EvalEnd=2]="EvalEnd",t[t.Duplicate=3]="Duplicate",t[t.PopEvaluatedValue=4]="PopEvaluatedValue",t[t.PopFunction=5]="PopFunction",t[t.PopTunnel=6]="PopTunnel",t[t.BeginString=7]="BeginString",t[t.EndString=8]="EndString",t[t.NoOp=9]="NoOp",t[t.ChoiceCount=10]="ChoiceCount",t[t.Turns=11]="Turns",t[t.TurnsSince=12]="TurnsSince",t[t.Random=13]="Random",t[t.SeedRandom=14]="SeedRandom",t[t.VisitIndex=15]="VisitIndex",t[t.SequenceShuffleIndex=16]="SequenceShuffleIndex",t[t.StartThread=17]="StartThread",t[t.Done=18]="Done",t[t.End=19]="End",t[t.ListFromInt=20]="ListFromInt",t[t.ListRange=21]="ListRange",t[t.ListRandom=22]="ListRandom",t[t.ReadCount=23]="ReadCount",t[t.TOTAL_VALUES=24]="TOTAL_VALUES"}(e=t.CommandType||(t.CommandType={}))}(A||(A={})),function(t){t[t.Tunnel=0]="Tunnel",t[t.Function=1]="Function",t[t.FunctionEvaluationFromGame=2]="FunctionEvaluationFromGame"}(r||(r={}));class I{constructor(){this.container=null,this.index=-1,2===arguments.length&&(this.container=arguments[0],this.index=arguments[1])}Resolve(){return this.index<0?this.container:null==this.container?null:0==this.container.content.length?this.container:this.index>=this.container.content.length?null:this.container.content[this.index]}get isNull(){return null==this.container}get path(){return this.isNull?null:this.index>=0?this.container.path.PathByAppendingComponent(new e.Component(this.index)):this.container.path}toString(){return this.container?"Ink Pointer -> "+this.container.path.toString()+" -- index "+this.index:"Ink Pointer (null)"}copy(){return new I(this.container,this.index)}static StartOf(t){return new I(t,0)}static get Null(){return new I(null,-1)}}class k extends p{constructor(t){super(),this._targetPath=null,this._targetPointer=I.Null,this.variableDivertName=null,this.pushesToStack=!1,this.stackPushType=0,this.isExternal=!1,this.externalArgs=0,this.isConditional=!1,this.pushesToStack=!1,void 0!==t&&(this.pushesToStack=!0,this.stackPushType=t)}get targetPath(){if(null!=this._targetPath&&this._targetPath.isRelative){let t=this.targetPointer.Resolve();t&&(this._targetPath=t.path)}return this._targetPath}set targetPath(t){this._targetPath=t,this._targetPointer=I.Null}get targetPointer(){if(this._targetPointer.isNull){let t=this.ResolvePath(this._targetPath).obj;if(null===this._targetPath)return d("this._targetPath");if(null===this._targetPath.lastComponent)return d("this._targetPath.lastComponent");if(this._targetPath.lastComponent.isIndex){if(null===t)return d("targetObj");this._targetPointer.container=t.parent instanceof N?t.parent:null,this._targetPointer.index=this._targetPath.lastComponent.index}else this._targetPointer=I.StartOf(t instanceof N?t:null)}return this._targetPointer.copy()}get targetPathString(){return null==this.targetPath?null:this.CompactPathString(this.targetPath)}set targetPathString(t){this.targetPath=null==t?null:new e(t)}get hasVariableTarget(){return null!=this.variableDivertName}Equals(t){let e=t;return e instanceof k&&this.hasVariableTarget==e.hasVariableTarget&&(this.hasVariableTarget?this.variableDivertName==e.variableDivertName:null===this.targetPath?d("this.targetPath"):this.targetPath.Equals(e.targetPath))}toString(){if(this.hasVariableTarget)return"Divert(variable: "+this.variableDivertName+")";if(null==this.targetPath)return"Divert(null)";{let t=new m,e=this.targetPath.toString();return t.Append("Divert"),this.isConditional&&t.Append("?"),this.pushesToStack&&(this.stackPushType==r.Function?t.Append(" function"):t.Append(" tunnel")),t.Append(" -> "),t.Append(this.targetPathString),t.Append(" ("),t.Append(e),t.Append(")"),t.toString()}}}class W extends p{constructor(t=!0){super(),this._pathOnChoice=null,this.hasCondition=!1,this.hasStartContent=!1,this.hasChoiceOnlyContent=!1,this.isInvisibleDefault=!1,this.onceOnly=!0,this.onceOnly=t}get pathOnChoice(){if(null!=this._pathOnChoice&&this._pathOnChoice.isRelative){let t=this.choiceTarget;t&&(this._pathOnChoice=t.path)}return this._pathOnChoice}set pathOnChoice(t){this._pathOnChoice=t}get choiceTarget(){return null===this._pathOnChoice?d("ChoicePoint._pathOnChoice"):this.ResolvePath(this._pathOnChoice).container}get pathStringOnChoice(){return null===this.pathOnChoice?d("ChoicePoint.pathOnChoice"):this.CompactPathString(this.pathOnChoice)}set pathStringOnChoice(t){this.pathOnChoice=new e(t)}get flags(){let t=0;return this.hasCondition&&(t|=1),this.hasStartContent&&(t|=2),this.hasChoiceOnlyContent&&(t|=4),this.isInvisibleDefault&&(t|=8),this.onceOnly&&(t|=16),t}set flags(t){this.hasCondition=(1&t)>0,this.hasStartContent=(2&t)>0,this.hasChoiceOnlyContent=(4&t)>0,this.isInvisibleDefault=(8&t)>0,this.onceOnly=(16&t)>0}toString(){if(null===this.pathOnChoice)return d("ChoicePoint.pathOnChoice");return"Choice: -> "+this.pathOnChoice.toString()}}class F extends p{constructor(t=null){super(),this.pathForCount=null,this.name=t}get containerForCount(){return null===this.pathForCount?null:this.ResolvePath(this.pathForCount).container}get pathStringForCount(){return null===this.pathForCount?null:this.CompactPathString(this.pathForCount)}set pathStringForCount(t){this.pathForCount=null===t?null:new e(t)}toString(){if(null!=this.name)return"var("+this.name+")";return"read_count("+this.pathStringForCount+")"}}class V extends p{constructor(t,e){super(),this.variableName=t||null,this.isNewDeclaration=!!e,this.isGlobal=!1}toString(){return"VarAssign to "+this.variableName}}class L extends p{}class R extends p{constructor(){if(super(),this._name=null,this._numberOfParameters=0,this._prototype=null,this._isPrototype=!1,this._operationFuncs=null,0===arguments.length)R.GenerateNativeFunctionsIfNecessary();else if(1===arguments.length){let t=arguments[0];R.GenerateNativeFunctionsIfNecessary(),this.name=t}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._isPrototype=!0,this.name=t,this.numberOfParameters=e}}static CallWithName(t){return new R(t)}static CallExistsWithName(t){return this.GenerateNativeFunctionsIfNecessary(),this._nativeFunctions.get(t)}get name(){return null===this._name?d("NativeFunctionCall._name"):this._name}set name(t){this._name=t,this._isPrototype||(null===R._nativeFunctions?d("NativeFunctionCall._nativeFunctions"):this._prototype=R._nativeFunctions.get(this._name)||null)}get numberOfParameters(){return this._prototype?this._prototype.numberOfParameters:this._numberOfParameters}set numberOfParameters(t){this._numberOfParameters=t}Call(t){if(this._prototype)return this._prototype.Call(t);if(this.numberOfParameters!=t.length)throw new Error("Unexpected number of parameters");let e=!1;for(let n of t){if(n instanceof L)throw new S('Attempting to perform operation on a void value. Did you forget to "return" a value from a function you called here?');n instanceof O&&(e=!0)}if(2==t.length&&e)return this.CallBinaryListOperation(t);let n=this.CoerceValuesToSingleType(t),r=n[0].valueType;return r==i.Int||r==i.Float||r==i.String||r==i.DivertTarget||r==i.List?this.CallType(n):null}CallType(t){let e=s(t[0],v),n=e.valueType,r=e,a=t.length;if(2==a||1==a){if(null===this._operationFuncs)return d("NativeFunctionCall._operationFuncs");let l=this._operationFuncs.get(n);if(!l){const t=i[n];throw new S("Cannot perform operation "+this.name+" on "+t)}if(2==a){let e=s(t[1],v),n=l;if(null===r.value||null===e.value)return d("NativeFunctionCall.Call BinaryOp values");let i=n(r.value,e.value);return v.Create(i)}{let t=l;if(null===r.value)return d("NativeFunctionCall.Call UnaryOp value");let n=t(r.value);return this.name===R.Int?v.Create(n,i.Int):this.name===R.Float?v.Create(n,i.Float):v.Create(n,e.valueType)}}throw new Error("Unexpected number of parameters to NativeFunctionCall: "+t.length)}CallBinaryListOperation(t){if(("+"==this.name||"-"==this.name)&&t[0]instanceof O&&t[1]instanceof b)return this.CallListIncrementOperation(t);let e=s(t[0],v),n=s(t[1],v);if(!("&&"!=this.name&&"||"!=this.name||e.valueType==i.List&&n.valueType==i.List)){if(null===this._operationFuncs)return d("NativeFunctionCall._operationFuncs");let t=this._operationFuncs.get(i.Int);if(null===t)return d("NativeFunctionCall.CallBinaryListOperation op");let r=t(e.isTruthy?1:0,n.isTruthy?1:0);return new b(r)}if(e.valueType==i.List&&n.valueType==i.List)return this.CallType([e,n]);throw new S("Can not call use "+this.name+" operation on "+i[e.valueType]+" and "+i[n.valueType])}CallListIncrementOperation(t){let e=s(t[0],O),n=s(t[1],b),r=new g;if(null===e.value)return d("NativeFunctionCall.CallListIncrementOperation listVal.value");for(let[t,a]of e.value){let s=f.fromSerializedKey(t);if(null===this._operationFuncs)return d("NativeFunctionCall._operationFuncs");let l=this._operationFuncs.get(i.Int);if(null===n.value)return d("NativeFunctionCall.CallListIncrementOperation intVal.value");let o=l(a,n.value),u=null;if(null===e.value.origins)return d("NativeFunctionCall.CallListIncrementOperation listVal.value.origins");for(let t of e.value.origins)if(t.name==s.originName){u=t;break}if(null!=u){let t=u.TryGetItemWithValue(o,f.Null);t.exists&&r.Add(t.result,o)}}return new O(r)}CoerceValuesToSingleType(t){let e=i.Int,n=null;for(let r of t){let t=s(r,v);t.valueType>e&&(e=t.valueType),t.valueType==i.List&&(n=a(t,O))}let r=[];if(i[e]==i[i.List])for(let e of t){let t=s(e,v);if(t.valueType==i.List)r.push(t);else{if(t.valueType!=i.Int){const e=i[t.valueType];throw new S("Cannot mix Lists and "+e+" values in this operation")}{let e=parseInt(t.valueObject);if(n=s(n,O),null===n.value)return d("NativeFunctionCall.CoerceValuesToSingleType specialCaseList.value");let i=n.value.originOfMaxItem;if(null===i)return d("NativeFunctionCall.CoerceValuesToSingleType list");let a=i.TryGetItemWithValue(e,f.Null);if(!a.exists)throw new S("Could not find List item with the value "+e+" in "+i.name);{let t=new O(a.result,e);r.push(t)}}}}else for(let n of t){let t=s(n,v).Cast(e);r.push(t)}return r}static Identity(t){return t}static GenerateNativeFunctionsIfNecessary(){if(null==this._nativeFunctions){this._nativeFunctions=new Map,this.AddIntBinaryOp(this.Add,(t,e)=>t+e),this.AddIntBinaryOp(this.Subtract,(t,e)=>t-e),this.AddIntBinaryOp(this.Multiply,(t,e)=>t*e),this.AddIntBinaryOp(this.Divide,(t,e)=>Math.floor(t/e)),this.AddIntBinaryOp(this.Mod,(t,e)=>t%e),this.AddIntUnaryOp(this.Negate,t=>-t),this.AddIntBinaryOp(this.Equal,(t,e)=>t==e?1:0),this.AddIntBinaryOp(this.Greater,(t,e)=>t>e?1:0),this.AddIntBinaryOp(this.Less,(t,e)=>t<e?1:0),this.AddIntBinaryOp(this.GreaterThanOrEquals,(t,e)=>t>=e?1:0),this.AddIntBinaryOp(this.LessThanOrEquals,(t,e)=>t<=e?1:0),this.AddIntBinaryOp(this.NotEquals,(t,e)=>t!=e?1:0),this.AddIntUnaryOp(this.Not,t=>0==t?1:0),this.AddIntBinaryOp(this.And,(t,e)=>0!=t&&0!=e?1:0),this.AddIntBinaryOp(this.Or,(t,e)=>0!=t||0!=e?1:0),this.AddIntBinaryOp(this.Max,(t,e)=>Math.max(t,e)),this.AddIntBinaryOp(this.Min,(t,e)=>Math.min(t,e)),this.AddIntBinaryOp(this.Pow,(t,e)=>Math.pow(t,e)),this.AddIntUnaryOp(this.Floor,R.Identity),this.AddIntUnaryOp(this.Ceiling,R.Identity),this.AddIntUnaryOp(this.Int,R.Identity),this.AddIntUnaryOp(this.Float,t=>t),this.AddFloatBinaryOp(this.Add,(t,e)=>t+e),this.AddFloatBinaryOp(this.Subtract,(t,e)=>t-e),this.AddFloatBinaryOp(this.Multiply,(t,e)=>t*e),this.AddFloatBinaryOp(this.Divide,(t,e)=>t/e),this.AddFloatBinaryOp(this.Mod,(t,e)=>t%e),this.AddFloatUnaryOp(this.Negate,t=>-t),this.AddFloatBinaryOp(this.Equal,(t,e)=>t==e?1:0),this.AddFloatBinaryOp(this.Greater,(t,e)=>t>e?1:0),this.AddFloatBinaryOp(this.Less,(t,e)=>t<e?1:0),this.AddFloatBinaryOp(this.GreaterThanOrEquals,(t,e)=>t>=e?1:0),this.AddFloatBinaryOp(this.LessThanOrEquals,(t,e)=>t<=e?1:0),this.AddFloatBinaryOp(this.NotEquals,(t,e)=>t!=e?1:0),this.AddFloatUnaryOp(this.Not,t=>0==t?1:0),this.AddFloatBinaryOp(this.And,(t,e)=>0!=t&&0!=e?1:0),this.AddFloatBinaryOp(this.Or,(t,e)=>0!=t||0!=e?1:0),this.AddFloatBinaryOp(this.Max,(t,e)=>Math.max(t,e)),this.AddFloatBinaryOp(this.Min,(t,e)=>Math.min(t,e)),this.AddFloatBinaryOp(this.Pow,(t,e)=>Math.pow(t,e)),this.AddFloatUnaryOp(this.Floor,t=>Math.floor(t)),this.AddFloatUnaryOp(this.Ceiling,t=>Math.ceil(t)),this.AddFloatUnaryOp(this.Int,t=>Math.floor(t)),this.AddFloatUnaryOp(this.Float,R.Identity),this.AddStringBinaryOp(this.Add,(t,e)=>t+e),this.AddStringBinaryOp(this.Equal,(t,e)=>t===e?1:0),this.AddStringBinaryOp(this.NotEquals,(t,e)=>t!==e?1:0),this.AddStringBinaryOp(this.Has,(t,e)=>t.includes(e)?1:0),this.AddStringBinaryOp(this.Hasnt,(t,e)=>t.includes(e)?0:1),this.AddListBinaryOp(this.Add,(t,e)=>t.Union(e)),this.AddListBinaryOp(this.Subtract,(t,e)=>t.Without(e)),this.AddListBinaryOp(this.Has,(t,e)=>t.Contains(e)?1:0),this.AddListBinaryOp(this.Hasnt,(t,e)=>t.Contains(e)?0:1),this.AddListBinaryOp(this.Intersect,(t,e)=>t.Intersect(e)),this.AddListBinaryOp(this.Equal,(t,e)=>t.Equals(e)?1:0),this.AddListBinaryOp(this.Greater,(t,e)=>t.GreaterThan(e)?1:0),this.AddListBinaryOp(this.Less,(t,e)=>t.LessThan(e)?1:0),this.AddListBinaryOp(this.GreaterThanOrEquals,(t,e)=>t.GreaterThanOrEquals(e)?1:0),this.AddListBinaryOp(this.LessThanOrEquals,(t,e)=>t.LessThanOrEquals(e)?1:0),this.AddListBinaryOp(this.NotEquals,(t,e)=>t.Equals(e)?0:1),this.AddListBinaryOp(this.And,(t,e)=>t.Count>0&&e.Count>0?1:0),this.AddListBinaryOp(this.Or,(t,e)=>t.Count>0||e.Count>0?1:0),this.AddListUnaryOp(this.Not,t=>0==t.Count?1:0),this.AddListUnaryOp(this.Invert,t=>t.inverse),this.AddListUnaryOp(this.All,t=>t.all),this.AddListUnaryOp(this.ListMin,t=>t.MinAsList()),this.AddListUnaryOp(this.ListMax,t=>t.MaxAsList()),this.AddListUnaryOp(this.Count,t=>t.Count),this.AddListUnaryOp(this.ValueOfList,t=>t.maxItem.Value);let t=(t,e)=>t.Equals(e)?1:0,e=(t,e)=>t.Equals(e)?0:1;this.AddOpToNativeFunc(this.Equal,2,i.DivertTarget,t),this.AddOpToNativeFunc(this.NotEquals,2,i.DivertTarget,e)}}AddOpFuncForType(t,e){null==this._operationFuncs&&(this._operationFuncs=new Map),this._operationFuncs.set(t,e)}static AddOpToNativeFunc(t,e,n,i){if(null===this._nativeFunctions)return d("NativeFunctionCall._nativeFunctions");let r=this._nativeFunctions.get(t);r||(r=new R(t,e),this._nativeFunctions.set(t,r)),r.AddOpFuncForType(n,i)}static AddIntBinaryOp(t,e){this.AddOpToNativeFunc(t,2,i.Int,e)}static AddIntUnaryOp(t,e){this.AddOpToNativeFunc(t,1,i.Int,e)}static AddFloatBinaryOp(t,e){this.AddOpToNativeFunc(t,2,i.Float,e)}static AddFloatUnaryOp(t,e){this.AddOpToNativeFunc(t,1,i.Float,e)}static AddStringBinaryOp(t,e){this.AddOpToNativeFunc(t,2,i.String,e)}static AddListBinaryOp(t,e){this.AddOpToNativeFunc(t,2,i.List,e)}static AddListUnaryOp(t,e){this.AddOpToNativeFunc(t,1,i.List,e)}toString(){return'Native "'+this.name+'"'}}R.Add="+",R.Subtract="-",R.Divide="/",R.Multiply="*",R.Mod="%",R.Negate="_",R.Equal="==",R.Greater=">",R.Less="<",R.GreaterThanOrEquals=">=",R.LessThanOrEquals="<=",R.NotEquals="!=",R.Not="!",R.And="&&",R.Or="||",R.Min="MIN",R.Max="MAX",R.Pow="POW",R.Floor="FLOOR",R.Ceiling="CEILING",R.Int="INT",R.Float="FLOAT",R.Has="?",R.Hasnt="!?",R.Intersect="^",R.ListMin="LIST_MIN",R.ListMax="LIST_MAX",R.All="LIST_ALL",R.Count="LIST_COUNT",R.ValueOfList="LIST_VALUE",R.Invert="LIST_INVERT",R._nativeFunctions=null;class j extends p{constructor(t){super(),this.text=t.toString()||""}toString(){return"# "+this.text}}class D extends p{constructor(){super(...arguments),this.text="",this.index=0,this.threadAtGeneration=null,this.sourcePath="",this.targetPath=null,this.isInvisibleDefault=!1,this.originalThreadIndex=0}get pathStringOnChoice(){return null===this.targetPath?d("Choice.targetPath"):this.targetPath.toString()}set pathStringOnChoice(t){this.targetPath=new e(t)}}class G{constructor(t,e){this._name=t||"",this._items=null,this._itemNameToValues=e||new Map}get name(){return this._name}get items(){if(null==this._items){this._items=new Map;for(let[t,e]of this._itemNameToValues){let n=new f(this.name,t);this._items.set(n.serialized(),e)}}return this._items}ValueForItem(t){if(!t.itemName)return 0;let e=this._itemNameToValues.get(t.itemName);return void 0!==e?e:0}ContainsItem(t){return!!t.itemName&&(t.originName==this.name&&this._itemNameToValues.has(t.itemName))}ContainsItemWithName(t){return this._itemNameToValues.has(t)}TryGetItemWithValue(t,e){for(let[e,n]of this._itemNameToValues)if(n==t)return{result:new f(this.name,e),exists:!0};return{result:f.Null,exists:!1}}TryGetValueForItem(t,e){if(!t.itemName)return{result:0,exists:!1};let n=this._itemNameToValues.get(t.itemName);return n?{result:n,exists:!0}:{result:0,exists:!1}}}class B{constructor(t){this._lists=new Map,this._allUnambiguousListValueCache=new Map;for(let e of t){this._lists.set(e.name,e);for(let[t,n]of e.items){let e=f.fromSerializedKey(t),i=new O(e,n);if(!e.itemName)throw new Error("item.itemName is null or undefined.");this._allUnambiguousListValueCache.set(e.itemName,i),this._allUnambiguousListValueCache.set(e.fullName,i)}}}get lists(){let t=[];for(let[,e]of this._lists)t.push(e);return t}TryListGetDefinition(t,e){if(null===t)return{result:e,exists:!1};let n=this._lists.get(t);return n?{result:n,exists:!0}:{result:e,exists:!1}}FindSingleItemListWithName(t){if(null===t)return d("name");let e=this._allUnambiguousListValueCache.get(t);return void 0!==e?e:null}}class M{static JArrayToRuntimeObjList(t,e=!1){let n=t.length;e&&n--;let i=[];for(let e=0;e<n;e++){let n=t[e],r=this.JTokenToRuntimeObject(n);if(null===r)return d("runtimeObj");i.push(r)}return i}static WriteDictionaryRuntimeObjs(t,e){t.WriteObjectStart();for(let[n,i]of e)t.WritePropertyStart(n),this.WriteRuntimeObject(t,i),t.WritePropertyEnd();t.WriteObjectEnd()}static WriteListRuntimeObjs(t,e){t.WriteArrayStart();for(let n of e)this.WriteRuntimeObject(t,n);t.WriteArrayEnd()}static WriteIntDictionary(t,e){t.WriteObjectStart();for(let[n,i]of e)t.WriteIntProperty(n,i);t.WriteObjectEnd()}static WriteRuntimeObject(t,e){let n=a(e,N);if(n)return void this.WriteRuntimeContainer(t,n);let i=a(e,k);if(i){let e,n="->";return i.isExternal?n="x()":i.pushesToStack&&(i.stackPushType==r.Function?n="f()":i.stackPushType==r.Tunnel&&(n="->t->")),e=i.hasVariableTarget?i.variableDivertName:i.targetPathString,t.WriteObjectStart(),t.WriteProperty(n,e),i.hasVariableTarget&&t.WriteProperty("var",!0),i.isConditional&&t.WriteProperty("c",!0),i.externalArgs>0&&t.WriteIntProperty("exArgs",i.externalArgs),void t.WriteObjectEnd()}let s=a(e,W);if(s)return t.WriteObjectStart(),t.WriteProperty("*",s.pathStringOnChoice),t.WriteIntProperty("flg",s.flags),void t.WriteObjectEnd();let l=a(e,b);if(l)return void t.WriteInt(l.value);let o=a(e,_);if(o)return void t.WriteFloat(o.value);let u=a(e,T);if(u)return void(u.isNewline?t.Write("\n",!1):(t.WriteStringStart(),t.WriteStringInner("^"),t.WriteStringInner(u.value),t.WriteStringEnd()));let h=a(e,O);if(h)return void this.WriteInkList(t,h);let c=a(e,P);if(c)return t.WriteObjectStart(),null===c.value?d("divTargetVal.value"):(t.WriteProperty("^->",c.value.componentsString),void t.WriteObjectEnd());let p=a(e,w);if(p)return t.WriteObjectStart(),t.WriteProperty("^var",p.value),t.WriteIntProperty("ci",p.contextIndex),void t.WriteObjectEnd();if(a(e,x))return void t.Write("<>");let m=a(e,A);if(m)return void t.Write(M._controlCommandNames[m.commandType]);let f=a(e,R);if(f){let e=f.name;return"^"==e&&(e="L^"),void t.Write(e)}let g=a(e,F);if(g){t.WriteObjectStart();let e=g.pathStringForCount;return null!=e?t.WriteProperty("CNT?",e):t.WriteProperty("VAR?",g.name),void t.WriteObjectEnd()}let S=a(e,V);if(S){t.WriteObjectStart();let e=S.isGlobal?"VAR=":"temp=";return t.WriteProperty(e,S.variableName),S.isNewDeclaration||t.WriteProperty("re",!0),void t.WriteObjectEnd()}if(a(e,L))return void t.Write("void");let y=a(e,j);if(y)return t.WriteObjectStart(),t.WriteProperty("#",y.text),void t.WriteObjectEnd();let C=a(e,D);if(!C)throw new Error("Failed to convert runtime object to Json token: "+e);this.WriteChoice(t,C)}static JObjectToDictionaryRuntimeObjs(t){let e=new Map;for(let n in t)if(t.hasOwnProperty(n)){let i=this.JTokenToRuntimeObject(t[n]);if(null===i)return d("inkObject");e.set(n,i)}return e}static JObjectToIntDictionary(t){let e=new Map;for(let n in t)t.hasOwnProperty(n)&&e.set(n,parseInt(t[n]));return e}static JTokenToRuntimeObject(t){if("number"==typeof t&&!isNaN(t))return v.Create(t);if("string"==typeof t){let e=t.toString(),n=e[0];if("^"==n)return new T(e.substring(1));if("\n"==n&&1==e.length)return new T("\n");if("<>"==e)return new x;for(let t=0;t<M._controlCommandNames.length;++t){if(e==M._controlCommandNames[t])return new A(t)}if("L^"==e&&(e="^"),R.CallExistsWithName(e))return R.CallWithName(e);if("->->"==e)return A.PopTunnel();if("~ret"==e)return A.PopFunction();if("void"==e)return new L}if("object"==typeof t&&!Array.isArray(t)){let n,i=t;if(i["^->"])return n=i["^->"],new P(new e(n.toString()));if(i["^var"]){n=i["^var"];let t=new w(n.toString());return"ci"in i&&(n=i.ci,t.contextIndex=parseInt(n)),t}let a=!1,s=!1,l=r.Function,o=!1;if((n=i["->"])?a=!0:(n=i["f()"])?(a=!0,s=!0,l=r.Function):(n=i["->t->"])?(a=!0,s=!0,l=r.Tunnel):(n=i["x()"])&&(a=!0,o=!0,s=!1,l=r.Function),a){let t=new k;t.pushesToStack=s,t.stackPushType=l,t.isExternal=o;let e=n.toString();return(n=i.var)?t.variableDivertName=e:t.targetPathString=e,t.isConditional=!!i.c,o&&(n=i.exArgs)&&(t.externalArgs=parseInt(n)),t}if(n=i["*"]){let t=new W;return t.pathStringOnChoice=n.toString(),(n=i.flg)&&(t.flags=parseInt(n)),t}if(n=i["VAR?"])return new F(n.toString());if(n=i["CNT?"]){let t=new F;return t.pathStringForCount=n.toString(),t}let u=!1,h=!1;if((n=i["VAR="])?(u=!0,h=!0):(n=i["temp="])&&(u=!0,h=!1),u){let t=n.toString(),e=!i.re,r=new V(t,e);return r.isGlobal=h,r}if(void 0!==i["#"])return n=i["#"],new j(n.toString());if(n=i.list){let t=n,e=new g;if(n=i.origins){let t=n;e.SetInitialOriginNames(t)}for(let n in t)if(t.hasOwnProperty(n)){let i=t[n],r=new f(n),a=parseInt(i);e.Add(r,a)}return new O(e)}if(null!=i.originalChoicePath)return this.JObjectToChoice(i)}if(Array.isArray(t))return this.JArrayToContainer(t);if(null==t)return null;throw new Error("Failed to convert token to runtime object: "+JSON.stringify(t))}static WriteRuntimeContainer(t,e,n=!1){if(t.WriteArrayStart(),null===e)return d("container");for(let n of e.content)this.WriteRuntimeObject(t,n);let i=e.namedOnlyContent,r=e.countFlags,s=null!=e.name&&!n,l=null!=i||r>0||s;if(l&&t.WriteObjectStart(),null!=i)for(let[e,n]of i){let i=e,r=a(n,N);t.WritePropertyStart(i),this.WriteRuntimeContainer(t,r,!0),t.WritePropertyEnd()}s&&t.WriteProperty("#n",e.name),l?t.WriteObjectEnd():t.WriteNull(),t.WriteArrayEnd()}static JArrayToContainer(t){let e=new N;e.content=this.JArrayToRuntimeObjList(t,!0);let n=t[t.length-1];if(null!=n){let t=new Map;for(let i in n)if("#f"==i)e.countFlags=parseInt(n[i]);else if("#n"==i)e.name=n[i].toString();else{let e=this.JTokenToRuntimeObject(n[i]),r=a(e,N);r&&(r.name=i),t.set(i,e)}e.namedOnlyContent=t}return e}static JObjectToChoice(t){let e=new D;return e.text=t.text.toString(),e.index=parseInt(t.index),e.sourcePath=t.originalChoicePath.toString(),e.originalThreadIndex=parseInt(t.originalThreadIndex),e.pathStringOnChoice=t.targetPath.toString(),e}static WriteChoice(t,e){t.WriteObjectStart(),t.WriteProperty("text",e.text),t.WriteIntProperty("index",e.index),t.WriteProperty("originalChoicePath",e.sourcePath),t.WriteIntProperty("originalThreadIndex",e.originalThreadIndex),t.WriteProperty("targetPath",e.pathStringOnChoice),t.WriteObjectEnd()}static WriteInkList(t,e){let n=e.value;if(null===n)return d("rawList");t.WriteObjectStart(),t.WritePropertyStart("list"),t.WriteObjectStart();for(let[e,i]of n){let n=f.fromSerializedKey(e),r=i;if(null===n.itemName)return d("item.itemName");t.WritePropertyNameStart(),t.WritePropertyNameInner(n.originName?n.originName:"?"),t.WritePropertyNameInner("."),t.WritePropertyNameInner(n.itemName),t.WritePropertyNameEnd(),t.Write(r),t.WritePropertyEnd()}if(t.WriteObjectEnd(),t.WritePropertyEnd(),0==n.Count&&null!=n.originNames&&n.originNames.length>0){t.WritePropertyStart("origins"),t.WriteArrayStart();for(let e of n.originNames)t.Write(e);t.WriteArrayEnd(),t.WritePropertyEnd()}t.WriteObjectEnd()}static ListDefinitionsToJToken(t){let e={};for(let n of t.lists){let t={};for(let[e,i]of n.items){let n=f.fromSerializedKey(e);if(null===n.itemName)return d("item.itemName");t[n.itemName]=i}e[n.name]=t}return e}static JTokenToListDefinitions(t){let e=t,n=[];for(let t in e)if(e.hasOwnProperty(t)){let i=t.toString(),r=e[t],a=new Map;for(let n in r)if(e.hasOwnProperty(t)){let t=r[n];a.set(n,parseInt(t))}let s=new G(i,a);n.push(s)}return new B(n)}}M._controlCommandNames=(()=>{let t=[];t[A.CommandType.EvalStart]="ev",t[A.CommandType.EvalOutput]="out",t[A.CommandType.EvalEnd]="/ev",t[A.CommandType.Duplicate]="du",t[A.CommandType.PopEvaluatedValue]="pop",t[A.CommandType.PopFunction]="~ret",t[A.CommandType.PopTunnel]="->->",t[A.CommandType.BeginString]="str",t[A.CommandType.EndString]="/str",t[A.CommandType.NoOp]="nop",t[A.CommandType.ChoiceCount]="choiceCnt",t[A.CommandType.Turns]="turn",t[A.CommandType.TurnsSince]="turns",t[A.CommandType.ReadCount]="readc",t[A.CommandType.Random]="rnd",t[A.CommandType.SeedRandom]="srnd",t[A.CommandType.VisitIndex]="visit",t[A.CommandType.SequenceShuffleIndex]="seq",t[A.CommandType.StartThread]="thread",t[A.CommandType.Done]="done",t[A.CommandType.End]="end",t[A.CommandType.ListFromInt]="listInt",t[A.CommandType.ListRange]="range",t[A.CommandType.ListRandom]="lrnd";for(let e=0;e<A.CommandType.TOTAL_VALUES;++e)if(null==t[e])throw new Error("Control command not accounted for in serialisation");return t})();class q{constructor(){if(this._threadCounter=0,this._startOfRoot=I.Null,arguments[0]instanceof X){let t=arguments[0];this._startOfRoot=I.StartOf(t.rootContentContainer),this.Reset()}else{let t=arguments[0];this._threads=[];for(let e of t._threads)this._threads.push(e.Copy());this._threadCounter=t._threadCounter,this._startOfRoot=t._startOfRoot}}get elements(){return this.callStack}get depth(){return this.elements.length}get currentElement(){let t=this._threads[this._threads.length-1].callstack;return t[t.length-1]}get currentElementIndex(){return this.callStack.length-1}get currentThread(){return this._threads[this._threads.length-1]}set currentThread(t){n.Assert(1==this._threads.length,"Shouldn't be directly setting the current thread when we have a stack of them"),this._threads.length=0,this._threads.push(t)}get canPop(){return this.callStack.length>1}Reset(){this._threads=[],this._threads.push(new q.Thread),this._threads[0].callstack.push(new q.Element(r.Tunnel,this._startOfRoot))}SetJsonToken(t,e){this._threads.length=0;let n=t.threads;for(let t of n){let n=t,i=new q.Thread(n,e);this._threads.push(i)}this._threadCounter=parseInt(t.threadCounter),this._startOfRoot=I.StartOf(e.rootContentContainer)}WriteJson(t){t.WriteObject(t=>{t.WritePropertyStart("threads"),t.WriteArrayStart();for(let e of this._threads)e.WriteJson(t);t.WriteArrayEnd(),t.WritePropertyEnd(),t.WritePropertyStart("threadCounter"),t.WriteInt(this._threadCounter),t.WritePropertyEnd()})}PushThread(){let t=this.currentThread.Copy();this._threadCounter++,t.threadIndex=this._threadCounter,this._threads.push(t)}ForkThread(){let t=this.currentThread.Copy();return this._threadCounter++,t.threadIndex=this._threadCounter,t}PopThread(){if(!this.canPopThread)throw new Error("Can't pop thread");this._threads.splice(this._threads.indexOf(this.currentThread),1)}get canPopThread(){return this._threads.length>1&&!this.elementIsEvaluateFromGame}get elementIsEvaluateFromGame(){return this.currentElement.type==r.FunctionEvaluationFromGame}Push(t,e=0,n=0){let i=new q.Element(t,this.currentElement.currentPointer,!1);i.evaluationStackHeightWhenPushed=e,i.functionStartInOutputStream=n,this.callStack.push(i)}CanPop(t=null){return!!this.canPop&&(null==t||this.currentElement.type==t)}Pop(t=null){if(!this.CanPop(t))throw new Error("Mismatched push/pop in Callstack");this.callStack.pop()}GetTemporaryVariableWithName(t,e=-1){-1==e&&(e=this.currentElementIndex+1);let n=y(this.callStack[e-1].temporaryVariables,t,null);return n.exists?n.result:null}SetTemporaryVariable(t,e,n,i=-1){-1==i&&(i=this.currentElementIndex+1);let r=this.callStack[i-1];if(!n&&!r.temporaryVariables.get(t))throw new S("Could not find temporary variable to set: "+t);let a=y(r.temporaryVariables,t,null);a.exists&&O.RetainListOriginsForAssignment(a.result,e),r.temporaryVariables.set(t,e)}ContextForVariableNamed(t){return this.currentElement.temporaryVariables.get(t)?this.currentElementIndex+1:0}ThreadWithIndex(t){let e=this._threads.filter(e=>{if(e.threadIndex==t)return e});return e.length>0?e[0]:null}get callStack(){return this.currentThread.callstack}get callStackTrace(){let t=new m;for(let e=0;e<this._threads.length;e++){let n=this._threads[e],i=e==this._threads.length-1;t.AppendFormat("=== THREAD {0}/{1} {2}===\n",e+1,this._threads.length,i?"(current) ":"");for(let e=0;e<n.callstack.length;e++){n.callstack[e].type==r.Function?t.Append("  [FUNCTION] "):t.Append("  [TUNNEL] ");let i=n.callstack[e].currentPointer;if(!i.isNull){if(t.Append("<SOMEWHERE IN "),null===i.container)return d("pointer.container");t.Append(i.container.path.toString()),t.AppendLine(">")}}}return t.toString()}}!function(t){class n{constructor(t,e,n=!1){this.evaluationStackHeightWhenPushed=0,this.functionStartInOutputStream=0,this.currentPointer=e.copy(),this.inExpressionEvaluation=n,this.temporaryVariables=new Map,this.type=t}Copy(){let t=new n(this.type,this.currentPointer,this.inExpressionEvaluation);return t.temporaryVariables=new Map(this.temporaryVariables),t.evaluationStackHeightWhenPushed=this.evaluationStackHeightWhenPushed,t.functionStartInOutputStream=this.functionStartInOutputStream,t}}t.Element=n;class i{constructor(){if(this.threadIndex=0,this.previousPointer=I.Null,this.callstack=[],arguments[0]&&arguments[1]){let t=arguments[0],i=arguments[1];this.threadIndex=parseInt(t.threadIndex);let r=t.callstack;for(let t of r){let r,a=t,s=parseInt(a.type),l=I.Null,o=a.cPath;if(void 0!==o){r=o.toString();let t=i.ContentAtPath(new e(r));if(l.container=t.container,l.index=parseInt(a.idx),null==t.obj)throw new Error("When loading state, internal story location couldn't be found: "+r+". Has the story changed since this save data was created?");if(t.approximate){if(null===l.container)return d("pointer.container");i.Warning("When loading state, exact internal story location couldn't be found: '"+r+"', so it was approximated to '"+l.container.path.toString()+"' to recover. Has the story changed since this save data was created?")}}let u=!!a.exp,h=new n(s,l,u),c=a.temp;void 0!==c?h.temporaryVariables=M.JObjectToDictionaryRuntimeObjs(c):h.temporaryVariables.clear(),this.callstack.push(h)}let a=t.previousContentObject;if(void 0!==a){let t=new e(a.toString());this.previousPointer=i.PointerAtPath(t)}}}Copy(){let t=new i;t.threadIndex=this.threadIndex;for(let e of this.callstack)t.callstack.push(e.Copy());return t.previousPointer=this.previousPointer.copy(),t}WriteJson(t){t.WriteObjectStart(),t.WritePropertyStart("callstack"),t.WriteArrayStart();for(let e of this.callstack){if(t.WriteObjectStart(),!e.currentPointer.isNull){if(null===e.currentPointer.container)return d("el.currentPointer.container");t.WriteProperty("cPath",e.currentPointer.container.path.componentsString),t.WriteIntProperty("idx",e.currentPointer.index)}t.WriteProperty("exp",e.inExpressionEvaluation),t.WriteIntProperty("type",e.type),e.temporaryVariables.size>0&&(t.WritePropertyStart("temp"),M.WriteDictionaryRuntimeObjs(t,e.temporaryVariables),t.WritePropertyEnd()),t.WriteObjectEnd()}if(t.WriteArrayEnd(),t.WritePropertyEnd(),t.WriteIntProperty("threadIndex",this.threadIndex),!this.previousPointer.isNull){let e=this.previousPointer.Resolve();if(null===e)return d("this.previousPointer.Resolve()");t.WriteProperty("previousContentObject",e.path.toString())}t.WriteObjectEnd()}}t.Thread=i}(q||(q={}));class J{constructor(t,e){this.variableChangedEventCallbacks=[],this.patch=null,this._batchObservingVariableChanges=!1,this._defaultGlobalVariables=new Map,this._changedVariablesForBatchObs=new Set,this._globalVariables=new Map,this._callStack=t,this._listDefsOrigin=e;try{return new Proxy(this,{get:(t,e)=>e in t?t[e]:t.$(e),set:(t,e,n)=>(e in t?t[e]=n:t.$(e,n),!0)})}catch(t){}}variableChangedEvent(t,e){for(let n of this.variableChangedEventCallbacks)n(t,e)}get batchObservingVariableChanges(){return this._batchObservingVariableChanges}set batchObservingVariableChanges(t){if(this._batchObservingVariableChanges=t,t)this._changedVariablesForBatchObs=new Set;else if(null!=this._changedVariablesForBatchObs){for(let t of this._changedVariablesForBatchObs){let e=this._globalVariables.get(t);e?this.variableChangedEvent(t,e):d("currentValue")}this._changedVariablesForBatchObs=null}}get callStack(){return this._callStack}set callStack(t){this._callStack=t}$(t,e){if(void 0===e){let e=null;return null!==this.patch&&(e=this.patch.TryGetGlobal(t,null),e.exists)?e.result.valueObject:(e=this._globalVariables.get(t),void 0===e&&(e=this._defaultGlobalVariables.get(t)),void 0!==e?e.valueObject:null)}{if(void 0===this._defaultGlobalVariables.get(t))throw new S("Cannot assign to a variable ("+t+") that hasn't been declared in the story");let n=v.Create(e);if(null==n)throw new S(null==e?"Cannot pass null to VariableState":"Invalid value passed to VariableState: "+e.toString());this.SetGlobal(t,n)}}ApplyPatch(){if(null===this.patch)return d("this.patch");for(let[t,e]of this.patch.globals)this._globalVariables.set(t,e);if(null!==this._changedVariablesForBatchObs)for(let t of this.patch.changedVariables)this._changedVariablesForBatchObs.add(t);this.patch=null}SetJsonToken(t){this._globalVariables.clear();for(let[e,n]of this._defaultGlobalVariables){let i=t[e];if(void 0!==i){let t=M.JTokenToRuntimeObject(i);if(null===t)return d("tokenInkObject");this._globalVariables.set(e,t)}else this._globalVariables.set(e,n)}}WriteJson(t){t.WriteObjectStart();for(let[e,n]of this._globalVariables){let i=e,r=n;if(J.dontSaveDefaultValues&&this._defaultGlobalVariables.has(i)){let t=this._defaultGlobalVariables.get(i);if(this.RuntimeObjectsEqual(r,t))continue}t.WritePropertyStart(i),M.WriteRuntimeObject(t,r),t.WritePropertyEnd()}t.WriteObjectEnd()}RuntimeObjectsEqual(t,e){if(null===t)return d("obj1");if(null===e)return d("obj2");if(t.constructor!==e.constructor)return!1;let n=a(t,b);if(null!==n)return n.value===s(e,b).value;let i=a(t,_);if(null!==i)return i.value===s(e,_).value;let r=a(t,v),l=a(e,v);if(null!==r&&null!==l)return u(r.valueObject)&&u(l.valueObject)?r.valueObject.Equals(l.valueObject):r.valueObject===l.valueObject;throw new Error("FastRoughDefinitelyEquals: Unsupported runtime object type: "+t.constructor.name)}GetVariableWithName(t,e=-1){let n=this.GetRawVariableWithName(t,e),i=a(n,w);return null!==i&&(n=this.ValueAtVariablePointer(i)),n}TryGetDefaultVariableValue(t){let e=y(this._defaultGlobalVariables,t,null);return e.exists?e.result:null}GlobalVariableExistsWithName(t){return this._globalVariables.has(t)||null!==this._defaultGlobalVariables&&this._defaultGlobalVariables.has(t)}GetRawVariableWithName(t,e){let n=null;if(0==e||-1==e){let e=null;if(null!==this.patch&&(e=this.patch.TryGetGlobal(t,null),e.exists))return e.result;if(e=y(this._globalVariables,t,null),e.exists)return e.result;if(null!==this._defaultGlobalVariables&&(e=y(this._defaultGlobalVariables,t,null),e.exists))return e.result;if(null===this._listDefsOrigin)return d("VariablesState._listDefsOrigin");let n=this._listDefsOrigin.FindSingleItemListWithName(t);if(n)return n}return n=this._callStack.GetTemporaryVariableWithName(t,e),n}ValueAtVariablePointer(t){return this.GetVariableWithName(t.variableName,t.contextIndex)}Assign(t,e){let n=t.variableName;if(null===n)return d("name");let i=-1,r=!1;if(r=t.isNewDeclaration?t.isGlobal:this.GlobalVariableExistsWithName(n),t.isNewDeclaration){let t=a(e,w);if(null!==t){e=this.ResolveVariablePointer(t)}}else{let t=null;do{t=a(this.GetRawVariableWithName(n,i),w),null!=t&&(n=t.variableName,i=t.contextIndex,r=0==i)}while(null!=t)}r?this.SetGlobal(n,e):this._callStack.SetTemporaryVariable(n,e,t.isNewDeclaration,i)}SnapshotDefaultGlobals(){this._defaultGlobalVariables=new Map(this._globalVariables)}RetainListOriginsForAssignment(t,e){let n=s(t,O),i=s(e,O);n.value&&i.value&&0==i.value.Count&&i.value.SetInitialOriginNames(n.value.originNames)}SetGlobal(t,e){let n=null;if(null===this.patch&&(n=y(this._globalVariables,t,null)),null!==this.patch&&(n=this.patch.TryGetGlobal(t,null),n.exists||(n=y(this._globalVariables,t,null))),O.RetainListOriginsForAssignment(n.result,e),null===t)return d("variableName");if(null!==this.patch?this.patch.SetGlobal(t,e):this._globalVariables.set(t,e),null!==this.variableChangedEvent&&null!==n&&e!==n.result)if(this.batchObservingVariableChanges){if(null===this._changedVariablesForBatchObs)return d("this._changedVariablesForBatchObs");null!==this.patch?this.patch.AddChangedVariable(t):null!==this._changedVariablesForBatchObs&&this._changedVariablesForBatchObs.add(t)}else this.variableChangedEvent(t,e)}ResolveVariablePointer(t){let e=t.contextIndex;-1==e&&(e=this.GetContextIndexOfVariableNamed(t.variableName));let n=a(this.GetRawVariableWithName(t.variableName,e),w);return null!=n?n:new w(t.variableName,e)}GetContextIndexOfVariableNamed(t){return this.GlobalVariableExistsWithName(t)?0:this._callStack.currentElementIndex}ObserveVariableChange(t){this.variableChangedEventCallbacks.push(t)}}J.dontSaveDefaultValues=!0;class K{constructor(t){this.seed=t%2147483647,this.seed<=0&&(this.seed+=2147483646)}next(){return this.seed=16807*this.seed%2147483647}nextFloat(){return(this.next()-1)/2147483646}}class U{constructor(){if(this._changedVariables=new Set,this._visitCounts=new Map,this._turnIndices=new Map,1===arguments.length&&null!==arguments[0]){let t=arguments[0];this._globals=new Map(t._globals),this._changedVariables=new Set(t._changedVariables),this._visitCounts=new Map(t._visitCounts),this._turnIndices=new Map(t._turnIndices)}else this._globals=new Map,this._changedVariables=new Set,this._visitCounts=new Map,this._turnIndices=new Map}get globals(){return this._globals}get changedVariables(){return this._changedVariables}get visitCounts(){return this._visitCounts}get turnIndices(){return this._turnIndices}TryGetGlobal(t,e){return null!==t&&this._globals.has(t)?{result:this._globals.get(t),exists:!0}:{result:e,exists:!1}}SetGlobal(t,e){this._globals.set(t,e)}AddChangedVariable(t){return this._changedVariables.add(t)}TryGetVisitCount(t,e){return this._visitCounts.has(t)?{result:this._visitCounts.get(t),exists:!0}:{result:e,exists:!1}}SetVisitCount(t,e){this._visitCounts.set(t,e)}SetTurnIndex(t,e){this._turnIndices.set(t,e)}TryGetTurnIndex(t,e){return this._turnIndices.has(t)?{result:this._turnIndices.get(t),exists:!0}:{result:e,exists:!1}}}class z{static TextToDictionary(t){return new z.Reader(t).ToDictionary()}static TextToArray(t){return new z.Reader(t).ToArray()}}!function(t){t.Reader=class{constructor(t){this._rootObject=JSON.parse(t)}ToDictionary(){return this._rootObject}ToArray(){return this._rootObject}};class e{constructor(){this._currentPropertyName=null,this._currentString=null,this._stateStack=[],this._collectionStack=[],this._propertyNameStack=[],this._jsonObject=null}WriteObject(t){this.WriteObjectStart(),t(this),this.WriteObjectEnd()}WriteObjectStart(){this.StartNewObject(!0);let e={};if(this.state===t.Writer.State.Property){this.Assert(null!==this.currentCollection),this.Assert(null!==this.currentPropertyName);let t=this._propertyNameStack.pop();this.currentCollection[t]=e,this._collectionStack.push(e)}else this.state===t.Writer.State.Array?(this.Assert(null!==this.currentCollection),this.currentCollection.push(e),this._collectionStack.push(e)):(this.Assert(this.state===t.Writer.State.None),this._jsonObject=e,this._collectionStack.push(e));this._stateStack.push(new t.Writer.StateElement(t.Writer.State.Object))}WriteObjectEnd(){this.Assert(this.state===t.Writer.State.Object),this._collectionStack.pop(),this._stateStack.pop()}WriteProperty(t,e){if(this.WritePropertyStart(t),arguments[1]instanceof Function){(0,arguments[1])(this)}else{let t=arguments[1];this.Write(t)}this.WritePropertyEnd()}WriteIntProperty(t,e){this.WritePropertyStart(t),this.WriteInt(e),this.WritePropertyEnd()}WriteFloatProperty(t,e){this.WritePropertyStart(t),this.WriteFloat(e),this.WritePropertyEnd()}WritePropertyStart(e){this.Assert(this.state===t.Writer.State.Object),this._propertyNameStack.push(e),this.IncrementChildCount(),this._stateStack.push(new t.Writer.StateElement(t.Writer.State.Property))}WritePropertyEnd(){this.Assert(this.state===t.Writer.State.Property),this.Assert(1===this.childCount),this._stateStack.pop()}WritePropertyNameStart(){this.Assert(this.state===t.Writer.State.Object),this.IncrementChildCount(),this._currentPropertyName="",this._stateStack.push(new t.Writer.StateElement(t.Writer.State.Property)),this._stateStack.push(new t.Writer.StateElement(t.Writer.State.PropertyName))}WritePropertyNameEnd(){this.Assert(this.state===t.Writer.State.PropertyName),this.Assert(null!==this._currentPropertyName),this._propertyNameStack.push(this._currentPropertyName),this._currentPropertyName=null,this._stateStack.pop()}WritePropertyNameInner(e){this.Assert(this.state===t.Writer.State.PropertyName),this.Assert(null!==this._currentPropertyName),this._currentPropertyName+=e}WriteArrayStart(){this.StartNewObject(!0);let e=[];if(this.state===t.Writer.State.Property){this.Assert(null!==this.currentCollection),this.Assert(null!==this.currentPropertyName);let t=this._propertyNameStack.pop();this.currentCollection[t]=e,this._collectionStack.push(e)}else this.state===t.Writer.State.Array?(this.Assert(null!==this.currentCollection),this.currentCollection.push(e),this._collectionStack.push(e)):(this.Assert(this.state===t.Writer.State.None),this._jsonObject=e,this._collectionStack.push(e));this._stateStack.push(new t.Writer.StateElement(t.Writer.State.Array))}WriteArrayEnd(){this.Assert(this.state===t.Writer.State.Array),this._collectionStack.pop(),this._stateStack.pop()}Write(t,e=!0){null!==t?(this.StartNewObject(!1),this._addToCurrentObject(t)):console.error("Warning: trying to write a null string")}WriteInt(t){null!==t&&(this.StartNewObject(!1),this._addToCurrentObject(Math.floor(t)))}WriteFloat(t){null!==t&&(this.StartNewObject(!1),t==Number.POSITIVE_INFINITY?this._addToCurrentObject(34e37):t==Number.NEGATIVE_INFINITY?this._addToCurrentObject(-34e37):isNaN(t)?this._addToCurrentObject(0):this._addToCurrentObject(t))}WriteNull(){this.StartNewObject(!1),this._addToCurrentObject(null)}WriteStringStart(){this.StartNewObject(!1),this._currentString="",this._stateStack.push(new t.Writer.StateElement(t.Writer.State.String))}WriteStringEnd(){this.Assert(this.state==t.Writer.State.String),this._stateStack.pop(),this._addToCurrentObject(this._currentString),this._currentString=null}WriteStringInner(e,n=!0){this.Assert(this.state===t.Writer.State.String),null!==e?this._currentString+=e:console.error("Warning: trying to write a null string")}ToString(){return null===this._jsonObject?"":JSON.stringify(this._jsonObject)}StartNewObject(e){e?this.Assert(this.state===t.Writer.State.None||this.state===t.Writer.State.Property||this.state===t.Writer.State.Array):this.Assert(this.state===t.Writer.State.Property||this.state===t.Writer.State.Array),this.state===t.Writer.State.Property&&this.Assert(0===this.childCount),this.state!==t.Writer.State.Array&&this.state!==t.Writer.State.Property||this.IncrementChildCount()}get state(){return this._stateStack.length>0?this._stateStack[this._stateStack.length-1].type:t.Writer.State.None}get childCount(){return this._stateStack.length>0?this._stateStack[this._stateStack.length-1].childCount:0}get currentCollection(){return this._collectionStack.length>0?this._collectionStack[this._collectionStack.length-1]:null}get currentPropertyName(){return this._propertyNameStack.length>0?this._propertyNameStack[this._propertyNameStack.length-1]:null}IncrementChildCount(){this.Assert(this._stateStack.length>0);let t=this._stateStack.pop();t.childCount++,this._stateStack.push(t)}Assert(t){if(!t)throw Error("Assert failed while writing JSON")}_addToCurrentObject(e){this.Assert(null!==this.currentCollection),this.state===t.Writer.State.Array?(this.Assert(Array.isArray(this.currentCollection)),this.currentCollection.push(e)):this.state===t.Writer.State.Property&&(this.Assert(!Array.isArray(this.currentCollection)),this.Assert(null!==this.currentPropertyName),this.currentCollection[this.currentPropertyName]=e,this._propertyNameStack.pop())}}t.Writer=e,function(e){let n;!function(t){t[t.None=0]="None",t[t.Object=1]="Object",t[t.Array=2]="Array",t[t.Property=3]="Property",t[t.PropertyName=4]="PropertyName",t[t.String=5]="String"}(n=e.State||(e.State={}));e.StateElement=class{constructor(e){this.type=t.Writer.State.None,this.childCount=0,this.type=e}}}(e=t.Writer||(t.Writer={}))}(z||(z={}));class H{constructor(t){this.kInkSaveStateVersion=8,this.kMinCompatibleLoadVersion=8,this._currentErrors=null,this._currentWarnings=null,this.divertedPointer=I.Null,this._currentTurnIndex=0,this.storySeed=0,this.previousRandom=0,this.didSafeExit=!1,this._currentText=null,this._currentTags=null,this._outputStreamTextDirty=!0,this._outputStreamTagsDirty=!0,this._patch=null,this.story=t,this._outputStream=[],this.OutputStreamDirty(),this._evaluationStack=[],this.callStack=new q(t),this._variablesState=new J(this.callStack,t.listDefinitions),this._visitCounts=new Map,this._turnIndices=new Map,this.currentTurnIndex=-1;let e=(new Date).getTime();this.storySeed=new K(e).next()%100,this.previousRandom=0,this._currentChoices=[],this.GoToStart()}ToJson(t=!1){let e=new z.Writer;return this.WriteJson(e),e.ToString()}toJson(t=!1){return this.ToJson(t)}LoadJson(t){let e=z.TextToDictionary(t);this.LoadJsonObj(e)}VisitCountAtPathString(t){let n;if(null!==this._patch){let i=this.story.ContentAtPath(new e(t)).container;if(null===i)throw new Error("Content at path not found: "+t);if(n=this._patch.TryGetVisitCount(i,0),n.exists)return n.result}return n=y(this._visitCounts,t,null),n.exists?n.result:0}VisitCountForContainer(t){if(null===t)return d("container");if(!t.visitsShouldBeCounted)return this.story.Error("Read count for target ("+t.name+" - on "+t.debugMetadata+") unknown. The story may need to be compiled with countAllVisits flag (-c)."),0;if(null!==this._patch){let e=this._patch.TryGetVisitCount(t,0);if(e.exists)return e.result}let e=t.path.toString(),n=y(this._visitCounts,e,null);return n.exists?n.result:0}IncrementVisitCountForContainer(t){if(null!==this._patch){let e=this.VisitCountForContainer(t);return e++,void this._patch.SetVisitCount(t,e)}let e=t.path.toString(),n=y(this._visitCounts,e,null);n.exists?this._visitCounts.set(e,n.result+1):this._visitCounts.set(e,1)}RecordTurnIndexVisitToContainer(t){if(null!==this._patch)return void this._patch.SetTurnIndex(t,this.currentTurnIndex);let e=t.path.toString();this._turnIndices.set(e,this.currentTurnIndex)}TurnsSinceForContainer(t){if(t.turnIndexShouldBeCounted||this.story.Error("TURNS_SINCE() for target ("+t.name+" - on "+t.debugMetadata+") unknown. The story may need to be compiled with countAllVisits flag (-c)."),null!==this._patch){let e=this._patch.TryGetTurnIndex(t,0);if(e.exists)return this.currentTurnIndex-e.result}let e=t.path.toString(),n=y(this._turnIndices,e,0);return n.exists?this.currentTurnIndex-n.result:-1}get callstackDepth(){return this.callStack.depth}get outputStream(){return this._outputStream}get currentChoices(){return this.canContinue?[]:this._currentChoices}get generatedChoices(){return this._currentChoices}get currentErrors(){return this._currentErrors}get currentWarnings(){return this._currentWarnings}get variablesState(){return this._variablesState}set variablesState(t){this._variablesState=t}get evaluationStack(){return this._evaluationStack}get visitCounts(){return this._visitCounts}get turnIndices(){return this._turnIndices}get currentTurnIndex(){return this._currentTurnIndex}set currentTurnIndex(t){this._currentTurnIndex=t}get currentPathString(){let t=this.currentPointer;return t.isNull?null:null===t.path?d("pointer.path"):t.path.toString()}get currentPointer(){return this.callStack.currentElement.currentPointer.copy()}set currentPointer(t){this.callStack.currentElement.currentPointer=t.copy()}get previousPointer(){return this.callStack.currentThread.previousPointer.copy()}set previousPointer(t){this.callStack.currentThread.previousPointer=t.copy()}get canContinue(){return!this.currentPointer.isNull&&!this.hasError}get hasError(){return null!=this.currentErrors&&this.currentErrors.length>0}get hasWarning(){return null!=this.currentWarnings&&this.currentWarnings.length>0}get currentText(){if(this._outputStreamTextDirty){let t=new m;for(let e of this._outputStream){let n=a(e,T);null!==n&&t.Append(n.value)}this._currentText=this.CleanOutputWhitespace(t.toString()),this._outputStreamTextDirty=!1}return this._currentText}CleanOutputWhitespace(t){let e=new m,n=-1,i=0;for(let r=0;r<t.length;r++){let a=t.charAt(r),s=" "==a||"\t"==a;s&&-1==n&&(n=r),s||("\n"!=a&&n>0&&n!=i&&e.Append(" "),n=-1),"\n"==a&&(i=r+1),s||e.Append(a)}return e.toString()}get currentTags(){if(this._outputStreamTagsDirty){this._currentTags=[];for(let t of this._outputStream){let e=a(t,j);null!==e&&this._currentTags.push(e.text)}this._outputStreamTagsDirty=!1}return this._currentTags}get inExpressionEvaluation(){return this.callStack.currentElement.inExpressionEvaluation}set inExpressionEvaluation(t){this.callStack.currentElement.inExpressionEvaluation=t}GoToStart(){this.callStack.currentElement.currentPointer=I.StartOf(this.story.mainContentContainer)}CopyAndStartPatching(){let t=new H(this.story);return t._patch=new U(this._patch),t.outputStream.push.apply(t.outputStream,this._outputStream),t.OutputStreamDirty(),t._currentChoices.push.apply(t._currentChoices,this._currentChoices),this.hasError&&(t._currentErrors=[],t._currentErrors.push.apply(t._currentErrors,this.currentErrors||[])),this.hasWarning&&(t._currentWarnings=[],t._currentWarnings.push.apply(t._currentWarnings,this.currentWarnings||[])),t.callStack=new q(this.callStack),t.variablesState=this.variablesState,t.variablesState.callStack=t.callStack,t.variablesState.patch=t._patch,t.evaluationStack.push.apply(t.evaluationStack,this.evaluationStack),this.divertedPointer.isNull||(t.divertedPointer=this.divertedPointer.copy()),t.previousPointer=this.previousPointer.copy(),t._visitCounts=this._visitCounts,t._turnIndices=this._turnIndices,t.currentTurnIndex=this.currentTurnIndex,t.storySeed=this.storySeed,t.previousRandom=this.previousRandom,t.didSafeExit=this.didSafeExit,t}RestoreAfterPatch(){this.variablesState.callStack=this.callStack,this.variablesState.patch=this._patch}ApplyAnyPatch(){if(null!==this._patch){this.variablesState.ApplyPatch();for(let[t,e]of this._patch.visitCounts)this.ApplyCountChanges(t,e,!0);for(let[t,e]of this._patch.turnIndices)this.ApplyCountChanges(t,e,!1);this._patch=null}}ApplyCountChanges(t,e,n){(n?this._visitCounts:this._turnIndices).set(t.path.toString(),e)}WriteJson(t){t.WriteObjectStart();let e=!1;for(let n of this._currentChoices){if(null===n.threadAtGeneration)return d("c.threadAtGeneration");n.originalThreadIndex=n.threadAtGeneration.threadIndex,null===this.callStack.ThreadWithIndex(n.originalThreadIndex)&&(e||(e=!0,t.WritePropertyStart("choiceThreads"),t.WriteObjectStart()),t.WritePropertyStart(n.originalThreadIndex),n.threadAtGeneration.WriteJson(t),t.WritePropertyEnd())}if(e&&(t.WriteObjectEnd(),t.WritePropertyEnd()),t.WriteProperty("callstackThreads",t=>this.callStack.WriteJson(t)),t.WriteProperty("variablesState",t=>this.variablesState.WriteJson(t)),t.WriteProperty("evalStack",t=>M.WriteListRuntimeObjs(t,this.evaluationStack)),t.WriteProperty("outputStream",t=>M.WriteListRuntimeObjs(t,this._outputStream)),t.WriteProperty("currentChoices",t=>{t.WriteArrayStart();for(let e of this._currentChoices)M.WriteChoice(t,e);t.WriteArrayEnd()}),!this.divertedPointer.isNull){if(null===this.divertedPointer.path)return d("divertedPointer");t.WriteProperty("currentDivertTarget",this.divertedPointer.path.componentsString)}t.WriteProperty("visitCounts",t=>M.WriteIntDictionary(t,this._visitCounts)),t.WriteProperty("turnIndices",t=>M.WriteIntDictionary(t,this._turnIndices)),t.WriteIntProperty("turnIdx",this.currentTurnIndex),t.WriteIntProperty("storySeed",this.storySeed),t.WriteIntProperty("previousRandom",this.previousRandom),t.WriteIntProperty("inkSaveVersion",this.kInkSaveStateVersion),t.WriteIntProperty("inkFormatVersion",X.inkVersionCurrent),t.WriteObjectEnd()}LoadJsonObj(t){let n=t,i=n.inkSaveVersion;if(null==i)throw new S("ink save format incorrect, can't load.");if(parseInt(i)<this.kMinCompatibleLoadVersion)throw new S("Ink save format isn't compatible with the current version (saw '"+i+"', but minimum is "+this.kMinCompatibleLoadVersion+"), so can't load.");this.callStack.SetJsonToken(n.callstackThreads,this.story),this.variablesState.SetJsonToken(n.variablesState),this._evaluationStack=M.JArrayToRuntimeObjList(n.evalStack),this._outputStream=M.JArrayToRuntimeObjList(n.outputStream),this.OutputStreamDirty(),this._currentChoices=M.JArrayToRuntimeObjList(n.currentChoices);let r=n.currentDivertTarget;if(null!=r){let t=new e(r.toString());this.divertedPointer=this.story.PointerAtPath(t)}this._visitCounts=M.JObjectToIntDictionary(n.visitCounts),this._turnIndices=M.JObjectToIntDictionary(n.turnIndices),this.currentTurnIndex=parseInt(n.turnIdx),this.storySeed=parseInt(n.storySeed),this.previousRandom=parseInt(n.previousRandom);let a=n.choiceThreads;for(let t of this._currentChoices){let e=this.callStack.ThreadWithIndex(t.originalThreadIndex);if(null!=e)t.threadAtGeneration=e.Copy();else{let e=a[t.originalThreadIndex.toString()];t.threadAtGeneration=new q.Thread(e,this.story)}}}ResetErrors(){this._currentErrors=null,this._currentWarnings=null}ResetOutput(t=null){this._outputStream.length=0,null!==t&&this._outputStream.push.apply(this._outputStream,t),this.OutputStreamDirty()}PushToOutputStream(t){let e=a(t,T);if(null!==e){let t=this.TrySplittingHeadTailWhitespace(e);if(null!==t){for(let e of t)this.PushToOutputStreamIndividual(e);return void this.OutputStreamDirty()}}this.PushToOutputStreamIndividual(t),this.OutputStreamDirty()}PopFromOutputStream(t){this.outputStream.splice(this.outputStream.length-t,t),this.OutputStreamDirty()}TrySplittingHeadTailWhitespace(t){let e=t.value;if(null===e)return d("single.value");let n=-1,i=-1;for(let t=0;t<e.length;++t){let r=e[t];if("\n"!=r){if(" "==r||"\t"==r)continue;break}-1==n&&(n=t),i=t}let r=-1,a=-1;for(let t=0;t<e.length;++t){let n=e[t];if("\n"!=n){if(" "==n||"\t"==n)continue;break}-1==r&&(r=t),a=t}if(-1==n&&-1==r)return null;let s=[],l=0,o=e.length;if(-1!=n){if(n>0){let t=new T(e.substring(0,n));s.push(t)}s.push(new T("\n")),l=i+1}if(-1!=r&&(o=a),o>l){let t=e.substring(l,o-l);s.push(new T(t))}if(-1!=r&&a>i&&(s.push(new T("\n")),r<e.length-1)){let t=e.length-r-1,n=new T(e.substring(r+1,t));s.push(n)}return s}PushToOutputStreamIndividual(t){let e=a(t,x),n=a(t,T),i=!0;if(e)this.TrimNewlinesFromOutputStream(),i=!0;else if(n){let t=-1,e=this.callStack.currentElement;e.type==r.Function&&(t=e.functionStartInOutputStream);let a=-1;for(let e=this._outputStream.length-1;e>=0;e--){let n=this._outputStream[e],i=n instanceof A?n:null;if(null!=(n instanceof x?n:null)){a=e;break}if(null!=i&&i.commandType==A.CommandType.BeginString){e>=t&&(t=-1);break}}let s=-1;if(s=-1!=a&&-1!=t?Math.min(t,a):-1!=a?a:t,-1!=s){if(n.isNewline)i=!1;else if(n.isNonWhitespace&&(a>-1&&this.RemoveExistingGlue(),t>-1)){let t=this.callStack.elements;for(let e=t.length-1;e>=0;e--){let n=t[e];if(n.type!=r.Function)break;n.functionStartInOutputStream=-1}}}else n.isNewline&&(!this.outputStreamEndsInNewline&&this.outputStreamContainsContent||(i=!1))}if(i){if(null===t)return d("obj");this._outputStream.push(t),this.OutputStreamDirty()}}TrimNewlinesFromOutputStream(){let t=-1,e=this._outputStream.length-1;for(;e>=0;){let n=this._outputStream[e],i=a(n,A),r=a(n,T);if(null!=i||null!=r&&r.isNonWhitespace)break;null!=r&&r.isNewline&&(t=e),e--}if(t>=0)for(e=t;e<this._outputStream.length;){a(this._outputStream[e],T)?this._outputStream.splice(e,1):e++}this.OutputStreamDirty()}RemoveExistingGlue(){for(let t=this._outputStream.length-1;t>=0;t--){let e=this._outputStream[t];if(e instanceof x)this._outputStream.splice(t,1);else if(e instanceof A)break}this.OutputStreamDirty()}get outputStreamEndsInNewline(){if(this._outputStream.length>0)for(let t=this._outputStream.length-1;t>=0;t--){if(this._outputStream[t]instanceof A)break;let e=this._outputStream[t];if(e instanceof T){if(e.isNewline)return!0;if(e.isNonWhitespace)break}}return!1}get outputStreamContainsContent(){for(let t=0;t<this._outputStream.length;t++)if(this._outputStream[t]instanceof T)return!0;return!1}get inStringEvaluation(){for(let t=this._outputStream.length-1;t>=0;t--){let e=a(this._outputStream[t],A);if(e instanceof A&&e.commandType==A.CommandType.BeginString)return!0}return!1}PushEvaluationStack(t){let e=a(t,O);if(e){let t=e.value;if(null===t)return d("rawList");if(null!=t.originNames){t.origins||(t.origins=[]),t.origins.length=0;for(let e of t.originNames){if(null===this.story.listDefinitions)return d("StoryState.story.listDefinitions");let n=this.story.listDefinitions.TryListGetDefinition(e,null);if(null===n.result)return d("StoryState def.result");t.origins.indexOf(n.result)<0&&t.origins.push(n.result)}}}if(null===t)return d("obj");this.evaluationStack.push(t)}PopEvaluationStack(t){if(void 0===t){return o(this.evaluationStack.pop())}if(t>this.evaluationStack.length)throw new Error("trying to pop too many objects");return o(this.evaluationStack.splice(this.evaluationStack.length-t,t))}PeekEvaluationStack(){return this.evaluationStack[this.evaluationStack.length-1]}ForceEnd(){this.callStack.Reset(),this._currentChoices.length=0,this.currentPointer=I.Null,this.previousPointer=I.Null,this.didSafeExit=!0}TrimWhitespaceFromFunctionEnd(){n.Assert(this.callStack.currentElement.type==r.Function);let t=this.callStack.currentElement.functionStartInOutputStream;-1==t&&(t=0);for(let e=this._outputStream.length-1;e>=t;e--){let t=this._outputStream[e],n=a(t,T),i=a(t,A);if(null!=n){if(i)break;if(!n.isNewline&&!n.isInlineWhitespace)break;this._outputStream.splice(e,1),this.OutputStreamDirty()}}}PopCallStack(t=null){this.callStack.currentElement.type==r.Function&&this.TrimWhitespaceFromFunctionEnd(),this.callStack.Pop(t)}SetChosenPath(t,e){this._currentChoices.length=0;let n=this.story.PointerAtPath(t);n.isNull||-1!=n.index||(n.index=0),this.currentPointer=n,e&&this.currentTurnIndex++}StartFunctionEvaluationFromGame(t,e){this.callStack.Push(r.FunctionEvaluationFromGame,this.evaluationStack.length),this.callStack.currentElement.currentPointer=I.StartOf(t),this.PassArgumentsToEvaluationStack(e)}PassArgumentsToEvaluationStack(t){if(null!=t)for(let e=0;e<t.length;e++){if("number"!=typeof t[e]&&"string"!=typeof t[e])throw new Error("ink arguments when calling EvaluateFunction / ChoosePathStringWithParameters  must be int, float or string");this.PushEvaluationStack(v.Create(t[e]))}}TryExitFunctionEvaluationFromGame(){return this.callStack.currentElement.type==r.FunctionEvaluationFromGame&&(this.currentPointer=I.Null,this.didSafeExit=!0,!0)}CompleteFunctionEvaluationFromGame(){if(this.callStack.currentElement.type!=r.FunctionEvaluationFromGame)throw new S("Expected external function evaluation to be complete. Stack trace: "+this.callStack.callStackTrace);let t=this.callStack.currentElement.evaluationStackHeightWhenPushed,e=null;for(;this.evaluationStack.length>t;){let t=this.PopEvaluationStack();null===e&&(e=t)}if(this.PopCallStack(r.FunctionEvaluationFromGame),e){if(e instanceof L)return null;let t=s(e,v);return t.valueType==i.DivertTarget?t.valueObject.toString():t.valueObject}return null}AddError(t,e){e?(null==this._currentWarnings&&(this._currentWarnings=[]),this._currentWarnings.push(t)):(null==this._currentErrors&&(this._currentErrors=[]),this._currentErrors.push(t))}OutputStreamDirty(){this._outputStreamTextDirty=!0,this._outputStreamTagsDirty=!0}}class ${constructor(){this.startTime=void 0}get ElapsedMilliseconds(){return void 0===this.startTime?0:(new Date).getTime()-this.startTime}Start(){this.startTime=(new Date).getTime()}Stop(){this.startTime=void 0}}Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&t>-9007199254740992&&t<9007199254740992&&Math.floor(t)===t});class X extends p{constructor(){let t;super(),this.inkVersionMinimumCompatible=18,this._prevContainers=[],this.allowExternalFunctionFallbacks=!1,this._listDefinitions=null,this._variableObservers=null,this._hasValidatedExternals=!1,this._temporaryEvaluationContainer=null,this._asyncContinueActive=!1,this._stateSnapshotAtLastNewline=null,this._recursiveContinueCount=0,this._asyncSaving=!1,this._profiler=null;let e=null,n=null;if(arguments[0]instanceof N)t=arguments[0],void 0!==arguments[1]&&(e=arguments[1]),this._mainContentContainer=t;else if("string"==typeof arguments[0]){let t=arguments[0];n=z.TextToDictionary(t)}else n=arguments[0];if(null!=e&&(this._listDefinitions=new B(e)),this._externals=new Map,null!==n){let t=n,e=t.inkVersion;if(null==e)throw new Error("ink version number not found. Are you sure it's a valid .ink.json file?");let i=parseInt(e);if(i>X.inkVersionCurrent)throw new Error("Version of ink used to build story was newer than the current version of the engine");if(i<this.inkVersionMinimumCompatible)throw new Error("Version of ink used to build story is too old to be loaded by this version of the engine");i!=X.inkVersionCurrent&&console.warn("WARNING: Version of ink used to build story doesn't match current version of engine. Non-critical, but recommend synchronising.");let r,a=t.root;if(null==a)throw new Error("Root node for ink not found. Are you sure it's a valid .ink.json file?");(r=t.listDefs)&&(this._listDefinitions=M.JTokenToListDefinitions(r)),this._mainContentContainer=s(M.JTokenToRuntimeObject(a),N),this.ResetState()}}get currentChoices(){let t=[];if(null===this._state)return d("this._state");for(let e of this._state.currentChoices)e.isInvisibleDefault||(e.index=t.length,t.push(e));return t}get currentText(){return this.IfAsyncWeCant("call currentText since it's a work in progress"),this.state.currentText}get currentTags(){return this.IfAsyncWeCant("call currentTags since it's a work in progress"),this.state.currentTags}get currentErrors(){return this.state.currentErrors}get currentWarnings(){return this.state.currentWarnings}get hasError(){return this.state.hasError}get hasWarning(){return this.state.hasWarning}get variablesState(){return this.state.variablesState}get listDefinitions(){return this._listDefinitions}get state(){return this._state}StartProfiling(){}EndProfiling(){}ToJson(t){let e=!1;if(t||(e=!0,t=new z.Writer),t.WriteObjectStart(),t.WriteIntProperty("inkVersion",X.inkVersionCurrent),t.WriteProperty("root",t=>M.WriteRuntimeContainer(t,this._mainContentContainer)),null!=this._listDefinitions){t.WritePropertyStart("listDefs"),t.WriteObjectStart();for(let e of this._listDefinitions.lists){t.WritePropertyStart(e.name),t.WriteObjectStart();for(let[n,i]of e.items){let e=f.fromSerializedKey(n),r=i;t.WriteIntProperty(e.itemName,r)}t.WriteObjectEnd(),t.WritePropertyEnd()}t.WriteObjectEnd(),t.WritePropertyEnd()}if(t.WriteObjectEnd(),e)return t.ToString()}ResetState(){this.IfAsyncWeCant("ResetState"),this._state=new H(this),this._state.variablesState.ObserveVariableChange(this.VariableStateDidChangeEvent.bind(this)),this.ResetGlobals()}ResetErrors(){if(null===this._state)return d("this._state");this._state.ResetErrors()}ResetCallstack(){if(this.IfAsyncWeCant("ResetCallstack"),null===this._state)return d("this._state");this._state.ForceEnd()}ResetGlobals(){if(this._mainContentContainer.namedContent.get("global decl")){let t=this.state.currentPointer.copy();this.ChoosePath(new e("global decl"),!1),this.ContinueInternal(),this.state.currentPointer=t}this.state.variablesState.SnapshotDefaultGlobals()}Continue(){return this.ContinueAsync(0),this.currentText}get canContinue(){return this.state.canContinue}get asyncContinueComplete(){return!this._asyncContinueActive}ContinueAsync(t){this._hasValidatedExternals||this.ValidateExternalBindings(),this.ContinueInternal(t)}ContinueInternal(t=0){null!=this._profiler&&this._profiler.PreContinue();let e=t>0;if(this._recursiveContinueCount++,!this._asyncContinueActive){if(this._asyncContinueActive=e,!this.canContinue)throw new S("Can't continue - should check canContinue before calling Continue");this._state.didSafeExit=!1,this._state.ResetOutput(),1==this._recursiveContinueCount&&(this._state.variablesState.batchObservingVariableChanges=!0)}let n=new $;n.Start();let i=!1;do{try{i=this.ContinueSingleStep()}catch(t){if(!(t instanceof S))throw t;this.AddError(t.message,void 0,t.useEndLineNumber);break}if(i)break;if(this._asyncContinueActive&&n.ElapsedMilliseconds>t)break}while(this.canContinue);n.Stop(),!i&&this.canContinue||(null!==this._stateSnapshotAtLastNewline&&this.RestoreStateSnapshot(),this.canContinue||(this.state.callStack.canPopThread&&this.AddError("Thread available to pop, threads should always be flat by the end of evaluation?"),0!=this.state.generatedChoices.length||this.state.didSafeExit||null!=this._temporaryEvaluationContainer||(this.state.callStack.CanPop(r.Tunnel)?this.AddError("unexpectedly reached end of content. Do you need a '->->' to return from a tunnel?"):this.state.callStack.CanPop(r.Function)?this.AddError("unexpectedly reached end of content. Do you need a '~ return'?"):this.state.callStack.canPop?this.AddError("unexpectedly reached end of content for unknown reason. Please debug compiler!"):this.AddError("ran out of content. Do you need a '-> DONE' or '-> END'?"))),this.state.didSafeExit=!1,1==this._recursiveContinueCount&&(this._state.variablesState.batchObservingVariableChanges=!1),this._asyncContinueActive=!1),this._recursiveContinueCount--,null!=this._profiler&&this._profiler.PostContinue()}ContinueSingleStep(){if(null!=this._profiler&&this._profiler.PreStep(),this.Step(),null!=this._profiler&&this._profiler.PostStep(),this.canContinue||this.state.callStack.elementIsEvaluateFromGame||this.TryFollowDefaultInvisibleChoice(),null!=this._profiler&&this._profiler.PreSnapshot(),!this.state.inStringEvaluation){if(null!==this._stateSnapshotAtLastNewline){if(null===this._stateSnapshotAtLastNewline.currentTags)return d("this._stateAtLastNewline.currentTags");if(null===this.state.currentTags)return d("this.state.currentTags");let t=this.CalculateNewlineOutputStateChange(this._stateSnapshotAtLastNewline.currentText,this.state.currentText,this._stateSnapshotAtLastNewline.currentTags.length,this.state.currentTags.length);if(t==X.OutputStateChange.ExtendedBeyondNewline)return this.RestoreStateSnapshot(),!0;t==X.OutputStateChange.NewlineRemoved&&this.DiscardSnapshot()}this.state.outputStreamEndsInNewline&&(this.canContinue?null==this._stateSnapshotAtLastNewline&&this.StateSnapshot():this.DiscardSnapshot())}return null!=this._profiler&&this._profiler.PostSnapshot(),!1}CalculateNewlineOutputStateChange(t,e,n,i){if(null===t)return d("prevText");if(null===e)return d("currText");let r=e.length>=t.length&&"\n"==e.charAt(t.length-1);if(n==i&&t.length==e.length&&r)return X.OutputStateChange.NoChange;if(!r)return X.OutputStateChange.NewlineRemoved;if(i>n)return X.OutputStateChange.ExtendedBeyondNewline;for(let n=t.length;n<e.length;n++){let t=e.charAt(n);if(" "!=t&&"\t"!=t)return X.OutputStateChange.ExtendedBeyondNewline}return X.OutputStateChange.NoChange}ContinueMaximally(){this.IfAsyncWeCant("ContinueMaximally");let t=new m;for(;this.canContinue;)t.Append(this.Continue());return t.toString()}ContentAtPath(t){return this.mainContentContainer.ContentAtPath(t)}KnotContainerWithName(t){let e=this.mainContentContainer.namedContent.get(t);return e instanceof N?e:null}PointerAtPath(t){if(0==t.length)return I.Null;let e=new I,n=t.length,i=null;return null===t.lastComponent?d("path.lastComponent"):(t.lastComponent.isIndex?(n=t.length-1,i=this.mainContentContainer.ContentAtPath(t,void 0,n),e.container=i.container,e.index=t.lastComponent.index):(i=this.mainContentContainer.ContentAtPath(t),e.container=i.container,e.index=-1),null==i.obj||i.obj==this.mainContentContainer&&n>0?this.Error("Failed to find content at path '"+t+"', and no approximation of it was possible."):i.approximate&&this.Warning("Failed to find content at path '"+t+"', so it was approximated to: '"+i.obj.path+"'."),e)}StateSnapshot(){this._stateSnapshotAtLastNewline=this._state,this._state=this._state.CopyAndStartPatching()}RestoreStateSnapshot(){null===this._stateSnapshotAtLastNewline&&d("_stateSnapshotAtLastNewline"),this._stateSnapshotAtLastNewline.RestoreAfterPatch(),this._state=this._stateSnapshotAtLastNewline,this._stateSnapshotAtLastNewline=null,this._asyncSaving||this._state.ApplyAnyPatch()}DiscardSnapshot(){this._asyncSaving||this._state.ApplyAnyPatch(),this._stateSnapshotAtLastNewline=null}CopyStateForBackgroundThreadSave(){if(this.IfAsyncWeCant("start saving on a background thread"),this._asyncSaving)throw new Error("Story is already in background saving mode, can't call CopyStateForBackgroundThreadSave again!");let t=this._state;return this._state=this._state.CopyAndStartPatching(),this._asyncSaving=!0,t}BackgroundSaveComplete(){null===this._stateSnapshotAtLastNewline&&this._state.ApplyAnyPatch(),this._asyncSaving=!1}Step(){let t=!0,e=this.state.currentPointer.copy();if(e.isNull)return;let n=a(e.Resolve(),N);for(;n&&(this.VisitContainer(n,!0),0!=n.content.length);)e=I.StartOf(n),n=a(e.Resolve(),N);this.state.currentPointer=e.copy(),null!=this._profiler&&this._profiler.Step(this.state.callStack);let i=e.Resolve(),r=this.PerformLogicAndFlowControl(i);if(this.state.currentPointer.isNull)return;r&&(t=!1);let s=a(i,W);if(s){let e=this.ProcessChoice(s);e&&this.state.generatedChoices.push(e),i=null,t=!1}if(i instanceof N&&(t=!1),t){let t=a(i,w);if(t&&-1==t.contextIndex){let e=this.state.callStack.ContextForVariableNamed(t.variableName);i=new w(t.variableName,e)}this.state.inExpressionEvaluation?this.state.PushEvaluationStack(i):this.state.PushToOutputStream(i)}this.NextContent();let l=a(i,A);l&&l.commandType==A.CommandType.StartThread&&this.state.callStack.PushThread()}VisitContainer(t,e){t.countingAtStartOnly&&!e||(t.visitsShouldBeCounted&&this.state.IncrementVisitCountForContainer(t),t.turnIndexShouldBeCounted&&this.state.RecordTurnIndexVisitToContainer(t))}VisitChangedContainersDueToDivert(){let t=this.state.previousPointer.copy(),e=this.state.currentPointer.copy();if(e.isNull||-1==e.index)return;if(this._prevContainers.length=0,!t.isNull){let e=a(t.Resolve(),N)||a(t.container,N);for(;e;)this._prevContainers.push(e),e=a(e.parent,N)}let n=e.Resolve();if(null==n)return;let i=a(n.parent,N);for(;i&&(this._prevContainers.indexOf(i)<0||i.countingAtStartOnly);){let t=i.content.length>0&&n==i.content[0];this.VisitContainer(i,t),n=i,i=a(i.parent,N)}}ProcessChoice(t){let e=!0;if(t.hasCondition){let t=this.state.PopEvaluationStack();this.IsTruthy(t)||(e=!1)}let n="",i="";if(t.hasChoiceOnlyContent){i=s(this.state.PopEvaluationStack(),T).value||""}if(t.hasStartContent){n=s(this.state.PopEvaluationStack(),T).value||""}if(t.onceOnly){this.state.VisitCountForContainer(t.choiceTarget)>0&&(e=!1)}if(!e)return null;let r=new D;return r.targetPath=t.pathOnChoice,r.sourcePath=t.path.toString(),r.isInvisibleDefault=t.isInvisibleDefault,r.threadAtGeneration=this.state.callStack.ForkThread(),r.text=(n+i).replace(/^[ \t]+|[ \t]+$/g,""),r}IsTruthy(t){if(t instanceof v){let e=t;if(e instanceof P){let t=e;return this.Error("Shouldn't use a divert target (to "+t.targetPath+") as a conditional value. Did you intend a function call 'likeThis()' or a read count check 'likeThis'? (no arrows)"),!1}return e.isTruthy}return!1}PerformLogicAndFlowControl(t){if(null==t)return!1;if(t instanceof k){let e=t;if(e.isConditional){let t=this.state.PopEvaluationStack();if(!this.IsTruthy(t))return!0}if(e.hasVariableTarget){let t=e.variableDivertName,n=this.state.variablesState.GetVariableWithName(t);if(null==n)this.Error("Tried to divert using a target from a variable that could not be found ("+t+")");else if(!(n instanceof P)){let e=a(n,b),i="Tried to divert to a target from a variable, but the variable ("+t+") didn't contain a divert target, it ";e instanceof b&&0==e.value?i+="was empty/null (the value 0).":i+="contained '"+n+"'.",this.Error(i)}let i=s(n,P);this.state.divertedPointer=this.PointerAtPath(i.targetPath)}else{if(e.isExternal)return this.CallExternalFunction(e.targetPathString,e.externalArgs),!0;this.state.divertedPointer=e.targetPointer.copy()}return e.pushesToStack&&this.state.callStack.Push(e.stackPushType,void 0,this.state.outputStream.length),this.state.divertedPointer.isNull&&!e.isExternal&&(e&&e.debugMetadata&&null!=e.debugMetadata.sourceName?this.Error("Divert target doesn't exist: "+e.debugMetadata.sourceName):this.Error("Divert resolution failed: "+e)),!0}if(t instanceof A){let e=t;switch(e.commandType){case A.CommandType.EvalStart:this.Assert(!1===this.state.inExpressionEvaluation,"Already in expression evaluation?"),this.state.inExpressionEvaluation=!0;break;case A.CommandType.EvalEnd:this.Assert(!0===this.state.inExpressionEvaluation,"Not in expression evaluation mode"),this.state.inExpressionEvaluation=!1;break;case A.CommandType.EvalOutput:if(this.state.evaluationStack.length>0){let t=this.state.PopEvaluationStack();if(!(t instanceof L)){let e=new T(t.toString());this.state.PushToOutputStream(e)}}break;case A.CommandType.NoOp:break;case A.CommandType.Duplicate:this.state.PushEvaluationStack(this.state.PeekEvaluationStack());break;case A.CommandType.PopEvaluatedValue:this.state.PopEvaluationStack();break;case A.CommandType.PopFunction:case A.CommandType.PopTunnel:let t=e.commandType==A.CommandType.PopFunction?r.Function:r.Tunnel,n=null;if(t==r.Tunnel){let t=this.state.PopEvaluationStack();n=a(t,P),null===n&&this.Assert(t instanceof L,"Expected void if ->-> doesn't override target")}if(this.state.TryExitFunctionEvaluationFromGame())break;if(this.state.callStack.currentElement.type==t&&this.state.callStack.canPop)this.state.PopCallStack(),n&&(this.state.divertedPointer=this.PointerAtPath(n.targetPath));else{let e=new Map;e.set(r.Function,"function return statement (~ return)"),e.set(r.Tunnel,"tunnel onwards statement (->->)");let n=e.get(this.state.callStack.currentElement.type);this.state.callStack.canPop||(n="end of flow (-> END or choice)");let i="Found "+e.get(t)+", when expected "+n;this.Error(i)}break;case A.CommandType.BeginString:this.state.PushToOutputStream(e),this.Assert(!0===this.state.inExpressionEvaluation,"Expected to be in an expression when evaluating a string"),this.state.inExpressionEvaluation=!1;break;case A.CommandType.EndString:let i=[],l=0;for(let t=this.state.outputStream.length-1;t>=0;--t){let e=this.state.outputStream[t];l++;let n=a(e,A);if(n&&n.commandType==A.CommandType.BeginString)break;e instanceof T&&i.push(e)}this.state.PopFromOutputStream(l),i=i.reverse();let o=new m;for(let t of i)o.Append(t.toString());this.state.inExpressionEvaluation=!0,this.state.PushEvaluationStack(new T(o.toString()));break;case A.CommandType.ChoiceCount:let u=this.state.generatedChoices.length;this.state.PushEvaluationStack(new b(u));break;case A.CommandType.Turns:this.state.PushEvaluationStack(new b(this.state.currentTurnIndex+1));break;case A.CommandType.TurnsSince:case A.CommandType.ReadCount:let h=this.state.PopEvaluationStack();if(!(h instanceof P)){let t="";h instanceof b&&(t=". Did you accidentally pass a read count ('knot_name') instead of a target ('-> knot_name')?"),this.Error("TURNS_SINCE / READ_COUNT expected a divert target (knot, stitch, label name), but saw "+h+t);break}let c,p=s(h,P),y=a(this.ContentAtPath(p.targetPath).correctObj,N);null!=y?c=e.commandType==A.CommandType.TurnsSince?this.state.TurnsSinceForContainer(y):this.state.VisitCountForContainer(y):(c=e.commandType==A.CommandType.TurnsSince?-1:0,this.Warning("Failed to find container for "+e.toString()+" lookup at "+p.targetPath.toString())),this.state.PushEvaluationStack(new b(c));break;case A.CommandType.Random:{let t=a(this.state.PopEvaluationStack(),b),e=a(this.state.PopEvaluationStack(),b);if(null==e||e instanceof b==!1)return this.Error("Invalid value for minimum parameter of RANDOM(min, max)");if(null==t||e instanceof b==!1)return this.Error("Invalid value for maximum parameter of RANDOM(min, max)");if(null===t.value)return d("maxInt.value");if(null===e.value)return d("minInt.value");let n=t.value-e.value+1;n<=0&&this.Error("RANDOM was called with minimum as "+e.value+" and maximum as "+t.value+". The maximum must be larger");let i=this.state.storySeed+this.state.previousRandom,r=new K(i).next(),s=r%n+e.value;this.state.PushEvaluationStack(new b(s)),this.state.previousRandom=r;break}case A.CommandType.SeedRandom:let C=a(this.state.PopEvaluationStack(),b);if(null==C||C instanceof b==!1)return this.Error("Invalid value passed to SEED_RANDOM");if(null===C.value)return d("minInt.value");this.state.storySeed=C.value,this.state.previousRandom=0,this.state.PushEvaluationStack(new L);break;case A.CommandType.VisitIndex:let _=this.state.VisitCountForContainer(this.state.currentPointer.container)-1;this.state.PushEvaluationStack(new b(_));break;case A.CommandType.SequenceShuffleIndex:let w=this.NextSequenceShuffleIndex();this.state.PushEvaluationStack(new b(w));break;case A.CommandType.StartThread:break;case A.CommandType.Done:this.state.callStack.canPopThread?this.state.callStack.PopThread():(this.state.didSafeExit=!0,this.state.currentPointer=I.Null);break;case A.CommandType.End:this.state.ForceEnd();break;case A.CommandType.ListFromInt:let E=a(this.state.PopEvaluationStack(),b),x=s(this.state.PopEvaluationStack(),T);if(null===E)throw new S("Passed non-integer when creating a list element from a numerical value.");let k=null;if(null===this.listDefinitions)return d("this.listDefinitions");let W=this.listDefinitions.TryListGetDefinition(x.value,null);if(!W.exists)throw new S("Failed to find LIST called "+x.value);{if(null===E.value)return d("minInt.value");let t=W.result.TryGetItemWithValue(E.value,f.Null);t.exists&&(k=new O(t.result,E.value))}null==k&&(k=new O),this.state.PushEvaluationStack(k);break;case A.CommandType.ListRange:let F=a(this.state.PopEvaluationStack(),v),V=a(this.state.PopEvaluationStack(),v),R=a(this.state.PopEvaluationStack(),O);if(null===R||null===V||null===F)throw new S("Expected list, minimum and maximum for LIST_RANGE");if(null===R.value)return d("targetList.value");let j=R.value.ListWithSubRange(V.valueObject,F.valueObject);this.state.PushEvaluationStack(new O(j));break;case A.CommandType.ListRandom:{let t=this.state.PopEvaluationStack();if(null===t)throw new S("Expected list for LIST_RANDOM");let e=t.value,n=null;if(null===e)throw d("list");if(0==e.Count)n=new g;else{let t=this.state.storySeed+this.state.previousRandom,i=new K(t).next(),r=i%e.Count,a=e.entries();for(let t=0;t<=r-1;t++)a.next();let s=a.next().value,l={Key:f.fromSerializedKey(s[0]),Value:s[1]};if(null===l.Key.originName)return d("randomItem.Key.originName");n=new g(l.Key.originName,this),n.Add(l.Key,l.Value),this.state.previousRandom=i}this.state.PushEvaluationStack(new O(n));break}default:this.Error("unhandled ControlCommand: "+e)}return!0}if(t instanceof V){let e=t,n=this.state.PopEvaluationStack();return this.state.variablesState.Assign(e,n),!0}if(t instanceof F){let e=t,n=null;if(null!=e.pathForCount){let t=e.containerForCount,i=this.state.VisitCountForContainer(t);n=new b(i)}else n=this.state.variablesState.GetVariableWithName(e.name),null==n&&(this.Warning("Variable not found: '"+e.name+"'. Using default value of 0 (false). This can happen with temporary variables if the declaration hasn't yet been hit. Globals are always given a default value on load if a value doesn't exist in the save state."),n=new b(0));return this.state.PushEvaluationStack(n),!0}if(t instanceof R){let e=t,n=this.state.PopEvaluationStack(e.numberOfParameters),i=e.Call(n);return this.state.PushEvaluationStack(i),!0}return!1}ChoosePathString(t,n=!0,i=[]){if(this.IfAsyncWeCant("call ChoosePathString right now"),n)this.ResetCallstack();else if(this.state.callStack.currentElement.type==r.Function){let e="",n=this.state.callStack.currentElement.currentPointer.container;throw null!=n&&(e="("+n.path.toString()+") "),new Error("Story was running a function "+e+"when you called ChoosePathString("+t+") - this is almost certainly not not what you want! Full stack trace: \n"+this.state.callStack.callStackTrace)}this.state.PassArgumentsToEvaluationStack(i),this.ChoosePath(new e(t))}IfAsyncWeCant(t){if(this._asyncContinueActive)throw new Error("Can't "+t+". Story is in the middle of a ContinueAsync(). Make more ContinueAsync() calls or a single Continue() call beforehand.")}ChoosePath(t,e=!0){this.state.SetChosenPath(t,e),this.VisitChangedContainersDueToDivert()}ChooseChoiceIndex(t){t=t;let e=this.currentChoices;this.Assert(t>=0&&t<e.length,"choice out of range");let n=e[t];return null===n.threadAtGeneration?d("choiceToChoose.threadAtGeneration"):null===n.targetPath?d("choiceToChoose.targetPath"):(this.state.callStack.currentThread=n.threadAtGeneration,void this.ChoosePath(n.targetPath))}HasFunction(t){try{return null!=this.KnotContainerWithName(t)}catch(t){return!1}}EvaluateFunction(t,e=[],n=!1){if(this.IfAsyncWeCant("evaluate a function"),null==t)throw new Error("Function is null");if(""==t||""==t.trim())throw new Error("Function is empty or white space.");let i=this.KnotContainerWithName(t);if(null==i)throw new Error("Function doesn't exist: '"+t+"'");let r=[];r.push.apply(r,this.state.outputStream),this._state.ResetOutput(),this.state.StartFunctionEvaluationFromGame(i,e);let a=new m;for(;this.canContinue;)a.Append(this.Continue());let s=a.toString();this._state.ResetOutput(r);let l=this.state.CompleteFunctionEvaluationFromGame();return n?{returned:l,output:s}:l}EvaluateExpression(t){let e=this.state.callStack.elements.length;this.state.callStack.Push(r.Tunnel),this._temporaryEvaluationContainer=t,this.state.GoToStart();let n=this.state.evaluationStack.length;return this.Continue(),this._temporaryEvaluationContainer=null,this.state.callStack.elements.length>e&&this.state.PopCallStack(),this.state.evaluationStack.length>n?this.state.PopEvaluationStack():null}CallExternalFunction(t,e){if(null===t)return d("funcName");let n=this._externals.get(t),i=null;if(!(void 0!==n)){if(this.allowExternalFunctionFallbacks)return i=this.KnotContainerWithName(t),this.Assert(null!==i,"Trying to call EXTERNAL function '"+t+"' which has not been bound, and fallback ink function could not be found."),this.state.callStack.Push(r.Function,void 0,this.state.outputStream.length),void(this.state.divertedPointer=I.StartOf(i));this.Assert(!1,"Trying to call EXTERNAL function '"+t+"' which has not been bound (and ink fallbacks disabled).")}let a=[];for(let t=0;t<e;++t){let t=s(this.state.PopEvaluationStack(),v).valueObject;a.push(t)}a.reverse();let l=n(a),o=null;null!=l?(o=v.Create(l),this.Assert(null!==o,"Could not create ink value from returned object of type "+typeof l)):o=new L,this.state.PushEvaluationStack(o)}BindExternalFunctionGeneral(t,e){this.IfAsyncWeCant("bind an external function"),this.Assert(!this._externals.has(t),"Function '"+t+"' has already been bound."),this._externals.set(t,e)}TryCoerce(t){return t}BindExternalFunction(t,e){this.Assert(null!=e,"Can't bind a null function"),this.BindExternalFunctionGeneral(t,t=>{this.Assert(t.length>=e.length,"External function expected "+e.length+" arguments");let n=[];for(let e=0,i=t.length;e<i;e++)n[e]=this.TryCoerce(t[e]);return e.apply(null,n)})}UnbindExternalFunction(t){this.IfAsyncWeCant("unbind an external a function"),this.Assert(this._externals.has(t),"Function '"+t+"' has not been bound."),this._externals.delete(t)}ValidateExternalBindings(){let t=null,e=null,n=arguments[1]||new Set;if(arguments[0]instanceof N&&(t=arguments[0]),arguments[0]instanceof p&&(e=arguments[0]),null===t&&null===e)if(this.ValidateExternalBindings(this._mainContentContainer,n),this._hasValidatedExternals=!0,0==n.size)this._hasValidatedExternals=!0;else{let t="Error: Missing function binding for external";t+=n.size>1?"s":"",t+=": '",t+=Array.from(n).join("', '"),t+="' ",t+=this.allowExternalFunctionFallbacks?", and no fallback ink function found.":" (ink fallbacks disabled)",this.Error(t)}else if(null!=t){for(let e of t.content){let t=e;null!=t&&t.hasValidName||this.ValidateExternalBindings(e,n)}for(let[,e]of t.namedContent)this.ValidateExternalBindings(a(e,p),n)}else if(null!=e){let t=a(e,k);if(t&&t.isExternal){let e=t.targetPathString;if(null===e)return d("name");if(!this._externals.has(e))if(this.allowExternalFunctionFallbacks){this.mainContentContainer.namedContent.has(e)||n.add(e)}else n.add(e)}}}ObserveVariable(t,e){if(this.IfAsyncWeCant("observe a new variable"),null===this._variableObservers&&(this._variableObservers=new Map),!this.state.variablesState.GlobalVariableExistsWithName(t))throw new S("Cannot observe variable '"+t+"' because it wasn't declared in the ink story.");this._variableObservers.has(t)?this._variableObservers.get(t).push(e):this._variableObservers.set(t,[e])}ObserveVariables(t,e){for(let n=0,i=t.length;n<i;n++)this.ObserveVariable(t[n],e[n])}RemoveVariableObserver(t,e){if(this.IfAsyncWeCant("remove a variable observer"),null!==this._variableObservers)if(void 0!==e){if(this._variableObservers.has(e)){let n=this._variableObservers.get(e);null!==t?n.splice(n.indexOf(t),1):this._variableObservers.delete(e)}}else if(null!==t){let e=this._variableObservers.keys();for(let n of e){let e=this._variableObservers.get(n);e.splice(e.indexOf(t),1)}}}VariableStateDidChangeEvent(t,e){if(null===this._variableObservers)return;let n=this._variableObservers.get(t);if(void 0!==n){if(!(e instanceof v))throw new Error("Tried to get the value of a variable that isn't a standard type");let i=s(e,v);for(let e of n)e(t,i.valueObject)}}get globalTags(){return this.TagsAtStartOfFlowContainerWithPathString("")}TagsForContentAtPath(t){return this.TagsAtStartOfFlowContainerWithPathString(t)}TagsAtStartOfFlowContainerWithPathString(t){let n=new e(t),i=this.ContentAtPath(n).container;if(null===i)return d("flowContainer");for(;;){let t=i.content[0];if(!(t instanceof N))break;i=t}let r=null;for(let t of i.content){let e=a(t,j);if(!e)break;null==r&&(r=[]),r.push(e.text)}return r}BuildStringOfHierarchy(){let t=new m;return this.mainContentContainer.BuildStringOfHierarchy(t,0,this.state.currentPointer.Resolve()),t.toString()}BuildStringOfContainer(t){let e=new m;return t.BuildStringOfHierarchy(e,0,this.state.currentPointer.Resolve()),e.toString()}NextContent(){if(this.state.previousPointer=this.state.currentPointer.copy(),!this.state.divertedPointer.isNull&&(this.state.currentPointer=this.state.divertedPointer.copy(),this.state.divertedPointer=I.Null,this.VisitChangedContainersDueToDivert(),!this.state.currentPointer.isNull))return;if(!this.IncrementContentPointer()){let t=!1;this.state.callStack.CanPop(r.Function)?(this.state.PopCallStack(r.Function),this.state.inExpressionEvaluation&&this.state.PushEvaluationStack(new L),t=!0):this.state.callStack.canPopThread?(this.state.callStack.PopThread(),t=!0):this.state.TryExitFunctionEvaluationFromGame(),t&&!this.state.currentPointer.isNull&&this.NextContent()}}IncrementContentPointer(){let t=!0,e=this.state.callStack.currentElement.currentPointer.copy();if(e.index++,null===e.container)return d("pointer.container");for(;e.index>=e.container.content.length;){t=!1;let n=a(e.container.parent,N);if(n instanceof N==!1)break;let i=n.content.indexOf(e.container);if(-1==i)break;if(e=new I(n,i),e.index++,t=!0,null===e.container)return d("pointer.container")}return t||(e=I.Null),this.state.callStack.currentElement.currentPointer=e.copy(),t}TryFollowDefaultInvisibleChoice(){let t=this._state.currentChoices,e=t.filter(t=>t.isInvisibleDefault);if(0==e.length||t.length>e.length)return!1;let n=e[0];return null===n.targetPath?d("choice.targetPath"):null===n.threadAtGeneration?d("choice.threadAtGeneration"):(this.state.callStack.currentThread=n.threadAtGeneration,this.ChoosePath(n.targetPath,!1),!0)}NextSequenceShuffleIndex(){let t=a(this.state.PopEvaluationStack(),b);if(!(t instanceof b))return this.Error("expected number of elements in sequence for shuffle index"),0;let e=this.state.currentPointer.container;if(null===e)return d("seqContainer");if(null===t.value)return d("numElementsIntVal.value");let n=t.value,i=s(this.state.PopEvaluationStack(),b).value;if(null===i)return d("seqCount");let r=i/n,l=i%n,o=e.path.toString(),u=0;for(let t=0,e=o.length;t<e;t++)u+=o.charCodeAt(t)||0;let h=u+r+this.state.storySeed,c=new K(Math.floor(h)),p=[];for(let t=0;t<n;++t)p.push(t);for(let t=0;t<=l;++t){let e=c.next()%p.length,n=p[e];if(p.splice(e,1),t==l)return n}throw new Error("Should never reach here")}Error(t,e=!1){let n=new S(t);throw n.useEndLineNumber=e,n}Warning(t){this.AddError(t,!0)}AddError(t,e=!1,n=!1){let i=this.currentDebugMetadata,r=e?"WARNING":"ERROR";if(null!=i){let e=n?i.endLineNumber:i.startLineNumber;t="RUNTIME "+r+": '"+i.fileName+"' line "+e+": "+t}else t=this.state.currentPointer.isNull?"RUNTIME "+r+": "+t:"RUNTIME "+r+": ("+this.state.currentPointer+"): "+t;this.state.AddError(t,e),e||this.state.ForceEnd()}Assert(t,e=null){if(0==t)throw null==e&&(e="Story assert"),new Error(e+" "+this.currentDebugMetadata)}get currentDebugMetadata(){let t,e=this.state.currentPointer;if(!e.isNull&&null!==e.Resolve()&&(t=e.Resolve().debugMetadata,null!==t))return t;for(let n=this.state.callStack.elements.length-1;n>=0;--n)if(e=this.state.callStack.elements[n].currentPointer,!e.isNull&&null!==e.Resolve()&&(t=e.Resolve().debugMetadata,null!==t))return t;for(let e=this.state.outputStream.length-1;e>=0;--e){if(t=this.state.outputStream[e].debugMetadata,null!==t)return t}return null}get mainContentContainer(){return this._temporaryEvaluationContainer?this._temporaryEvaluationContainer:this._mainContentContainer}}X.inkVersionCurrent=19,function(t){let e;!function(t){t[t.NoChange=0]="NoChange",t[t.ExtendedBeyondNewline=1]="ExtendedBeyondNewline",t[t.NewlineRemoved=2]="NewlineRemoved"}(e=t.OutputStateChange||(t.OutputStateChange={}))}(X||(X={})),t.InkList=g,t.Story=X,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ink-es2015.js.map


/***/ }),

/***/ "./node_modules/inkjs/dist/ink.js":
false,

/***/ "./pages/index.js":
/*!************************!*\
  !*** ./pages/index.js ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(module) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return Home; });
/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ "./node_modules/react/jsx-dev-runtime.js");
/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var next_head__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/head */ "./node_modules/next/dist/next-server/lib/head.js");
/* harmony import */ var next_head__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_head__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var inkjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! inkjs */ "./node_modules/inkjs/dist/ink-es2015.js");
/* harmony import */ var inkjs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(inkjs__WEBPACK_IMPORTED_MODULE_3__);


var _jsxFileName = "C:\\Users\\mael\\Documents\\Cours\\mini-projet-2\\app\\pages\\index.js",
    _s = $RefreshSig$();




function Home() {
  _s();

  Object(react__WEBPACK_IMPORTED_MODULE_2__["useEffect"])(function () {
    console.log(inkjs__WEBPACK_IMPORTED_MODULE_3__);
    /* fetch("story.json")
        .then(function (response) {
            console.log(response);
            return response.text();
        })
        .then(function (storyContent) {
            console.log(storyContent);
            story = new inkjs.Story(storyContent);
            continueStory();
        }); */
  });
  return /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])("div", {
    children: [/*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])(next_head__WEBPACK_IMPORTED_MODULE_1___default.a, {
      children: /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])("title", {
        children: "Dating Sim"
      }, void 0, false, {
        fileName: _jsxFileName,
        lineNumber: 25,
        columnNumber: 17
      }, this)
    }, void 0, false, {
      fileName: _jsxFileName,
      lineNumber: 24,
      columnNumber: 13
    }, this), /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])("main", {
      children: /*#__PURE__*/Object(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__["jsxDEV"])("h1", {
        children: "Dating Sim"
      }, void 0, false, {
        fileName: _jsxFileName,
        lineNumber: 29,
        columnNumber: 17
      }, this)
    }, void 0, false, {
      fileName: _jsxFileName,
      lineNumber: 28,
      columnNumber: 13
    }, this)]
  }, void 0, true, {
    fileName: _jsxFileName,
    lineNumber: 23,
    columnNumber: 9
  }, this);
}

_s(Home, "OD7bBpZva5O2jO+Puf00hKivP7c=");

_c = Home;

var _c;

$RefreshReg$(_c, "Home");

;
    var _a, _b;
    // Legacy CSS implementations will `eval` browser code in a Node.js context
    // to extract CSS. For backwards compatibility, we need to check we're in a
    // browser context before continuing.
    if (typeof self !== 'undefined' &&
        // AMP / No-JS mode does not inject these helpers:
        '$RefreshHelpers$' in self) {
        var currentExports = module.__proto__.exports;
        var prevExports = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevExports) !== null && _b !== void 0 ? _b : null;
        // This cannot happen in MainTemplate because the exports mismatch between
        // templating and execution.
        self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.i);
        // A module can be accepted automatically based on its exports, e.g. when
        // it is a Refresh Boundary.
        if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {
            // Save the previous exports on update so we can compare the boundary
            // signatures.
            module.hot.dispose(function (data) {
                data.prevExports = currentExports;
            });
            // Unconditionally accept an update to this module, we'll check if it's
            // still a Refresh Boundary later.
            module.hot.accept();
            // This field is set when the previous version of this module was a
            // Refresh Boundary, letting us know we need to check for invalidation or
            // enqueue an update.
            if (prevExports !== null) {
                // A boundary can become ineligible if its exports are incompatible
                // with the previous exports.
                //
                // For example, if you add/remove/change exports, we'll want to
                // re-execute the importing modules, and force those components to
                // re-render. Similarly, if you convert a class component to a
                // function, we want to invalidate the boundary.
                if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevExports, currentExports)) {
                    module.hot.invalidate();
                }
                else {
                    self.$RefreshHelpers$.scheduleUpdate();
                }
            }
        }
        else {
            // Since we just executed the code for the module, it's possible that the
            // new exports made it ineligible for being a boundary.
            // We only care about the case when we were _previously_ a boundary,
            // because we already accepted this update (accidental side effect).
            var isNoLongerABoundary = prevExports !== null;
            if (isNoLongerABoundary) {
                module.hot.invalidate();
            }
        }
    }

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../node_modules/webpack/buildin/harmony-module.js */ "./node_modules/webpack/buildin/harmony-module.js")(module)))

/***/ })

})
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL2lua2pzL2Rpc3QvaW5rLWVzMjAxNS5qcyIsIndlYnBhY2s6Ly9fTl9FLy4vcGFnZXMvaW5kZXguanMiXSwibmFtZXMiOlsiSG9tZSIsInVzZUVmZmVjdCIsImNvbnNvbGUiLCJsb2ciLCJpbmtqcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsZUFBZSxLQUFvRCxZQUFZLFNBQW1GLENBQUMsbUJBQW1CLGFBQWEsUUFBUSxjQUFjLHNHQUFzRyxtQkFBbUIsd0JBQXdCLHNFQUFzRSxrQ0FBa0MsaUZBQWlGLHNDQUFzQyxvQ0FBb0MsZ0VBQWdFLGlCQUFpQix3QkFBd0IscUJBQXFCLCtCQUErQixXQUFXLDBEQUEwRCxXQUFXLCtCQUErQix3REFBd0QsZ0JBQWdCLGNBQWMsYUFBYSwrQkFBK0Isb0JBQW9CLGdDQUFnQyxxQ0FBcUMsNkJBQTZCLHNDQUFzQyxJQUFJLDZDQUE2QyxTQUFTLGtCQUFrQixZQUFZLDBCQUEwQixnQkFBZ0IsMkJBQTJCLHVCQUF1QixnQkFBZ0IsWUFBWSxrREFBa0QsUUFBUSxZQUFZLDRCQUE0Qiw0Q0FBNEMsWUFBWSx1QkFBdUIseUNBQXlDLFNBQVMsdUJBQXVCLHFMQUFxTCx3QkFBd0Isc0hBQXNILGlIQUFpSCx3Q0FBd0MsbUpBQW1KLFdBQVcsNkJBQTZCLFVBQVUsb0JBQW9CLDBEQUEwRCwwQ0FBMEMsbUNBQW1DLElBQUksOERBQThELFNBQVMsNEJBQTRCLFlBQVkseUZBQXlGLFVBQVUsZ0JBQWdCLGdDQUFnQyxnQkFBZ0IsOEJBQThCLG1CQUFtQixFQUFFLGtCQUFrQixFQUFFLEdBQUcsY0FBYyxxQ0FBcUMsY0FBYyx5QkFBeUIsY0FBYyxzREFBc0QsZ0JBQWdCLFNBQVMsMkJBQTJCLFFBQVEsZUFBZSx5RUFBeUUsY0FBYyxxQkFBcUIsZUFBZSw2QkFBNkIsa0JBQWtCLHlCQUF5QixXQUFXLG9EQUFvRCxVQUFVLCtGQUErRixjQUFjLFNBQVMsZUFBZSxnQkFBZ0IscUZB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QWEsdUhBQXVILCtDQUErQyxHQUFHLFNBQVMsK0RBQStELFNBQVMsRUFBRTtBQUNoeDlHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDREE7QUFDQTtBQUVBO0FBRWUsU0FBU0EsSUFBVCxHQUFnQjtBQUFBOztBQUUzQkMseURBQVMsQ0FBQyxZQUFNO0FBQ1pDLFdBQU8sQ0FBQ0MsR0FBUixDQUFZQyxrQ0FBWjtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0ssR0FaUSxDQUFUO0FBY0Esc0JBQ0k7QUFBQSw0QkFDSSxxRUFBQyxnREFBRDtBQUFBLDZCQUNJO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBREo7QUFBQTtBQUFBO0FBQUE7QUFBQSxZQURKLGVBS0k7QUFBQSw2QkFDSTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQURKO0FBQUE7QUFBQTtBQUFBO0FBQUEsWUFMSjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsVUFESjtBQWFIOztHQTdCdUJKLEk7O0tBQUFBLEkiLCJmaWxlIjoic3RhdGljL3dlYnBhY2svcGFnZXMvaW5kZXguMTQ4MjM5N2MxOTRlMDk1ZDk1ZDEuaG90LXVwZGF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiFmdW5jdGlvbih0LGUpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlP2UoZXhwb3J0cyk6XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXCJleHBvcnRzXCJdLGUpOmUoKHQ9dHx8c2VsZikuaW5ranM9e30pfSh0aGlzLChmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjtjbGFzcyBle2NvbnN0cnVjdG9yKCl7aWYodGhpcy5fY29tcG9uZW50cz1bXSx0aGlzLl9jb21wb25lbnRzU3RyaW5nPW51bGwsdGhpcy5faXNSZWxhdGl2ZT0hMSxcInN0cmluZ1wiPT10eXBlb2YgYXJndW1lbnRzWzBdKXtsZXQgdD1hcmd1bWVudHNbMF07dGhpcy5jb21wb25lbnRzU3RyaW5nPXR9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGUuQ29tcG9uZW50JiZhcmd1bWVudHNbMV1pbnN0YW5jZW9mIGUpe2xldCB0PWFyZ3VtZW50c1swXSxlPWFyZ3VtZW50c1sxXTt0aGlzLl9jb21wb25lbnRzLnB1c2godCksdGhpcy5fY29tcG9uZW50cz10aGlzLl9jb21wb25lbnRzLmNvbmNhdChlLl9jb21wb25lbnRzKX1lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YgQXJyYXkpe2xldCB0PWFyZ3VtZW50c1swXSxlPSEhYXJndW1lbnRzWzFdO3RoaXMuX2NvbXBvbmVudHM9dGhpcy5fY29tcG9uZW50cy5jb25jYXQodCksdGhpcy5faXNSZWxhdGl2ZT1lfX1nZXQgaXNSZWxhdGl2ZSgpe3JldHVybiB0aGlzLl9pc1JlbGF0aXZlfWdldCBjb21wb25lbnRDb3VudCgpe3JldHVybiB0aGlzLl9jb21wb25lbnRzLmxlbmd0aH1nZXQgaGVhZCgpe3JldHVybiB0aGlzLl9jb21wb25lbnRzLmxlbmd0aD4wP3RoaXMuX2NvbXBvbmVudHNbMF06bnVsbH1nZXQgdGFpbCgpe2lmKHRoaXMuX2NvbXBvbmVudHMubGVuZ3RoPj0yKXtsZXQgdD10aGlzLl9jb21wb25lbnRzLnNsaWNlKDEsdGhpcy5fY29tcG9uZW50cy5sZW5ndGgpO3JldHVybiBuZXcgZSh0KX1yZXR1cm4gZS5zZWxmfWdldCBsZW5ndGgoKXtyZXR1cm4gdGhpcy5fY29tcG9uZW50cy5sZW5ndGh9Z2V0IGxhc3RDb21wb25lbnQoKXtsZXQgdD10aGlzLl9jb21wb25lbnRzLmxlbmd0aC0xO3JldHVybiB0Pj0wP3RoaXMuX2NvbXBvbmVudHNbdF06bnVsbH1nZXQgY29udGFpbnNOYW1lZENvbXBvbmVudCgpe2ZvcihsZXQgdD0wLGU9dGhpcy5fY29tcG9uZW50cy5sZW5ndGg7dDxlO3QrKylpZighdGhpcy5fY29tcG9uZW50c1t0XS5pc0luZGV4KXJldHVybiEwO3JldHVybiExfXN0YXRpYyBnZXQgc2VsZigpe2xldCB0PW5ldyBlO3JldHVybiB0Ll9pc1JlbGF0aXZlPSEwLHR9R2V0Q29tcG9uZW50KHQpe3JldHVybiB0aGlzLl9jb21wb25lbnRzW3RdfVBhdGhCeUFwcGVuZGluZ1BhdGgodCl7bGV0IG49bmV3IGUsaT0wO2ZvcihsZXQgZT0wO2U8dC5fY29tcG9uZW50cy5sZW5ndGgmJnQuX2NvbXBvbmVudHNbZV0uaXNQYXJlbnQ7KytlKWkrKztmb3IobGV0IHQ9MDt0PHRoaXMuX2NvbXBvbmVudHMubGVuZ3RoLWk7Kyt0KW4uX2NvbXBvbmVudHMucHVzaCh0aGlzLl9jb21wb25lbnRzW3RdKTtmb3IobGV0IGU9aTtlPHQuX2NvbXBvbmVudHMubGVuZ3RoOysrZSluLl9jb21wb25lbnRzLnB1c2godC5fY29tcG9uZW50c1tlXSk7cmV0dXJuIG59Z2V0IGNvbXBvbmVudHNTdHJpbmcoKXtyZXR1cm4gbnVsbD09dGhpcy5fY29tcG9uZW50c1N0cmluZyYmKHRoaXMuX2NvbXBvbmVudHNTdHJpbmc9dGhpcy5fY29tcG9uZW50cy5qb2luKFwiLlwiKSx0aGlzLmlzUmVsYXRpdmUmJih0aGlzLl9jb21wb25lbnRzU3RyaW5nPVwiLlwiK3RoaXMuX2NvbXBvbmVudHNTdHJpbmcpKSx0aGlzLl9jb21wb25lbnRzU3RyaW5nfXNldCBjb21wb25lbnRzU3RyaW5nKHQpe2lmKHRoaXMuX2NvbXBvbmVudHMubGVuZ3RoPTAsdGhpcy5fY29tcG9uZW50c1N0cmluZz10LG51bGw9PXRoaXMuX2NvbXBvbmVudHNTdHJpbmd8fFwiXCI9PXRoaXMuX2NvbXBvbmVudHNTdHJpbmcpcmV0dXJuO1wiLlwiPT10aGlzLl9jb21wb25lbnRzU3RyaW5nWzBdJiYodGhpcy5faXNSZWxhdGl2ZT0hMCx0aGlzLl9jb21wb25lbnRzU3RyaW5nPXRoaXMuX2NvbXBvbmVudHNTdHJpbmcuc3Vic3RyaW5nKDEpKTtsZXQgbj10aGlzLl9jb21wb25lbnRzU3RyaW5nLnNwbGl0KFwiLlwiKTtmb3IobGV0IHQgb2YgbikvXihcXC18XFwrKT8oWzAtOV0rfEluZmluaXR5KSQvLnRlc3QodCk/dGhpcy5fY29tcG9uZW50cy5wdXNoKG5ldyBlLkNvbXBvbmVudChwYXJzZUludCh0KSkpOnRoaXMuX2NvbXBvbmVudHMucHVzaChuZXcgZS5Db21wb25lbnQodCkpfXRvU3RyaW5nKCl7cmV0dXJuIHRoaXMuY29tcG9uZW50c1N0cmluZ31FcXVhbHModCl7aWYobnVsbD09dClyZXR1cm4hMTtpZih0Ll9jb21wb25lbnRzLmxlbmd0aCE9dGhpcy5fY29tcG9uZW50cy5sZW5ndGgpcmV0dXJuITE7aWYodC5pc1JlbGF0aXZlIT10aGlzLmlzUmVsYXRpdmUpcmV0dXJuITE7Zm9yKGxldCBlPTAsbj10Ll9jb21wb25lbnRzLmxlbmd0aDtlPG47ZSsrKWlmKCF0Ll9jb21wb25lbnRzW2VdLkVxdWFscyh0aGlzLl9jb21wb25lbnRzW2VdKSlyZXR1cm4hMTtyZXR1cm4hMH1QYXRoQnlBcHBlbmRpbmdDb21wb25lbnQodCl7bGV0IG49bmV3IGU7cmV0dXJuIG4uX2NvbXBvbmVudHMucHVzaC5hcHBseShuLl9jb21wb25lbnRzLHRoaXMuX2NvbXBvbmVudHMpLG4uX2NvbXBvbmVudHMucHVzaCh0KSxufX12YXIgbixpLHI7ZnVuY3Rpb24gYSh0LGUpe3JldHVybiB0IGluc3RhbmNlb2YgZT9oKHQpOm51bGx9ZnVuY3Rpb24gcyh0LGUpe2lmKHQgaW5zdGFuY2VvZiBlKXJldHVybiBoKHQpO3Rocm93IG5ldyBFcnJvcihgJHt0fSBpcyBub3Qgb2YgdHlwZSAke2V9YCl9ZnVuY3Rpb24gbCh0KXtyZXR1cm4gdC5oYXNWYWxpZE5hbWUmJnQubmFtZT90Om51bGx9ZnVuY3Rpb24gbyh0KXtyZXR1cm4gdm9pZCAwPT09dD9udWxsOnR9ZnVuY3Rpb24gdSh0KXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5FcXVhbHN9ZnVuY3Rpb24gaCh0LGUpe3JldHVybiB0fWUucGFyZW50SWQ9XCJeXCIsZnVuY3Rpb24odCl7Y2xhc3MgZXtjb25zdHJ1Y3Rvcih0KXt0aGlzLmluZGV4PS0xLHRoaXMubmFtZT1udWxsLFwic3RyaW5nXCI9PXR5cGVvZiB0P3RoaXMubmFtZT10OnRoaXMuaW5kZXg9dH1nZXQgaXNJbmRleCgpe3JldHVybiB0aGlzLmluZGV4Pj0wfWdldCBpc1BhcmVudCgpe3JldHVybiB0aGlzLm5hbWU9PXQucGFyZW50SWR9c3RhdGljIFRvUGFyZW50KCl7cmV0dXJuIG5ldyBlKHQucGFyZW50SWQpfXRvU3RyaW5nKCl7cmV0dXJuIHRoaXMuaXNJbmRleD90aGlzLmluZGV4LnRvU3RyaW5nKCk6dGhpcy5uYW1lfUVxdWFscyh0KXtyZXR1cm4gbnVsbCE9dCYmdC5pc0luZGV4PT10aGlzLmlzSW5kZXgmJih0aGlzLmlzSW5kZXg/dGhpcy5pbmRleD09dC5pbmRleDp0aGlzLm5hbWU9PXQubmFtZSl9fXQuQ29tcG9uZW50PWV9KGV8fChlPXt9KSksZnVuY3Rpb24odCl7ZnVuY3Rpb24gZSh0LGUpe2lmKCF0KXRocm93IHZvaWQgMCE9PWUmJmNvbnNvbGUud2FybihlKSxjb25zb2xlLnRyYWNlJiZjb25zb2xlLnRyYWNlKCksbmV3IEVycm9yKFwiXCIpfXQuQXNzZXJ0VHlwZT1mdW5jdGlvbih0LG4saSl7ZSh0IGluc3RhbmNlb2YgbixpKX0sdC5Bc3NlcnQ9ZX0obnx8KG49e30pKTtjbGFzcyBjIGV4dGVuZHMgRXJyb3J7fWZ1bmN0aW9uIGQodCl7dGhyb3cgbmV3IGModCtcIiBpcyBudWxsIG9yIHVuZGVmaW5lZFwiKX1jbGFzcyBwe2NvbnN0cnVjdG9yKCl7dGhpcy5wYXJlbnQ9bnVsbCx0aGlzLl9kZWJ1Z01ldGFkYXRhPW51bGwsdGhpcy5fcGF0aD1udWxsfWdldCBkZWJ1Z01ldGFkYXRhKCl7cmV0dXJuIG51bGw9PT10aGlzLl9kZWJ1Z01ldGFkYXRhJiZ0aGlzLnBhcmVudD90aGlzLnBhcmVudC5kZWJ1Z01ldGFkYXRhOnRoaXMuX2RlYnVnTWV0YWRhdGF9c2V0IGRlYnVnTWV0YWRhdGEodCl7dGhpcy5fZGVidWdNZXRhZGF0YT10fWdldCBvd25EZWJ1Z01ldGFkYXRhKCl7cmV0dXJuIHRoaXMuX2RlYnVnTWV0YWRhdGF9RGVidWdMaW5lTnVtYmVyT2ZQYXRoKHQpe2lmKG51bGw9PT10KXJldHVybiBudWxsO2xldCBlPXRoaXMucm9vdENvbnRlbnRDb250YWluZXI7aWYoZSl7bGV0IG49ZS5Db250ZW50QXRQYXRoKHQpLm9iajtpZihuKXtsZXQgdD1uLmRlYnVnTWV0YWRhdGE7aWYobnVsbCE9PXQpcmV0dXJuIHQuc3RhcnRMaW5lTnVtYmVyfX1yZXR1cm4gbnVsbH1nZXQgcGF0aCgpe2lmKG51bGw9PXRoaXMuX3BhdGgpaWYobnVsbD09dGhpcy5wYXJlbnQpdGhpcy5fcGF0aD1uZXcgZTtlbHNle2xldCB0PVtdLG49dGhpcyxpPWEobi5wYXJlbnQsTik7Zm9yKDtudWxsIT09aTspe2xldCByPWwobik7bnVsbCE9ciYmci5oYXNWYWxpZE5hbWU/dC51bnNoaWZ0KG5ldyBlLkNvbXBvbmVudChyLm5hbWUpKTp0LnVuc2hpZnQobmV3IGUuQ29tcG9uZW50KGkuY29udGVudC5pbmRleE9mKG4pKSksbj1pLGk9YShpLnBhcmVudCxOKX10aGlzLl9wYXRoPW5ldyBlKHQpfXJldHVybiB0aGlzLl9wYXRofVJlc29sdmVQYXRoKHQpe2lmKG51bGw9PT10KXJldHVybiBkKFwicGF0aFwiKTtpZih0LmlzUmVsYXRpdmUpe2xldCBlPWEodGhpcyxOKTtyZXR1cm4gbnVsbD09PWUmJihuLkFzc2VydChudWxsIT09dGhpcy5wYXJlbnQsXCJDYW4ndCByZXNvbHZlIHJlbGF0aXZlIHBhdGggYmVjYXVzZSB3ZSBkb24ndCBoYXZlIGEgcGFyZW50XCIpLGU9YSh0aGlzLnBhcmVudCxOKSxuLkFzc2VydChudWxsIT09ZSxcIkV4cGVjdGVkIHBhcmVudCB0byBiZSBhIGNvbnRhaW5lclwiKSxuLkFzc2VydCh0LkdldENvbXBvbmVudCgwKS5pc1BhcmVudCksdD10LnRhaWwpLG51bGw9PT1lP2QoXCJuZWFyZXN0Q29udGFpbmVyXCIpOmUuQ29udGVudEF0UGF0aCh0KX17bGV0IGU9dGhpcy5yb290Q29udGVudENvbnRhaW5lcjtyZXR1cm4gbnVsbD09PWU/ZChcImNvbnRlbnRDb250YWluZXJcIik6ZS5Db250ZW50QXRQYXRoKHQpfX1Db252ZXJ0UGF0aFRvUmVsYXRpdmUodCl7bGV0IG49dGhpcy5wYXRoLGk9TWF0aC5taW4odC5sZW5ndGgsbi5sZW5ndGgpLHI9LTE7Zm9yKGxldCBlPTA7ZTxpOysrZSl7bGV0IGk9bi5HZXRDb21wb25lbnQoZSksYT10LkdldENvbXBvbmVudChlKTtpZighaS5FcXVhbHMoYSkpYnJlYWs7cj1lfWlmKC0xPT1yKXJldHVybiB0O2xldCBhPW4uY29tcG9uZW50Q291bnQtMS1yLHM9W107Zm9yKGxldCB0PTA7dDxhOysrdClzLnB1c2goZS5Db21wb25lbnQuVG9QYXJlbnQoKSk7Zm9yKGxldCBlPXIrMTtlPHQuY29tcG9uZW50Q291bnQ7KytlKXMucHVzaCh0LkdldENvbXBvbmVudChlKSk7cmV0dXJuIG5ldyBlKHMsITApfUNvbXBhY3RQYXRoU3RyaW5nKHQpe2xldCBlPW51bGwsbj1udWxsO2lmKHQuaXNSZWxhdGl2ZSluPXQuY29tcG9uZW50c1N0cmluZyxlPXRoaXMucGF0aC5QYXRoQnlBcHBlbmRpbmdQYXRoKHQpLmNvbXBvbmVudHNTdHJpbmc7ZWxzZXtuPXRoaXMuQ29udmVydFBhdGhUb1JlbGF0aXZlKHQpLmNvbXBvbmVudHNTdHJpbmcsZT10LmNvbXBvbmVudHNTdHJpbmd9cmV0dXJuIG4ubGVuZ3RoPGUubGVuZ3RoP246ZX1nZXQgcm9vdENvbnRlbnRDb250YWluZXIoKXtsZXQgdD10aGlzO2Zvcig7dC5wYXJlbnQ7KXQ9dC5wYXJlbnQ7cmV0dXJuIGEodCxOKX1Db3B5KCl7dGhyb3cgRXJyb3IoXCJOb3QgSW1wbGVtZW50ZWQ6IERvZXNuJ3Qgc3VwcG9ydCBjb3B5aW5nXCIpfVNldENoaWxkKHQsZSxuKXt0W2VdJiYodFtlXT1udWxsKSx0W2VdPW4sdFtlXSYmKHRbZV0ucGFyZW50PXRoaXMpfX1jbGFzcyBte2NvbnN0cnVjdG9yKHQpe3Q9dm9pZCAwIT09dD90LnRvU3RyaW5nKCk6XCJcIix0aGlzLnN0cmluZz10fWdldCBMZW5ndGgoKXtyZXR1cm4gdGhpcy5zdHJpbmcubGVuZ3RofUFwcGVuZCh0KXtudWxsIT09dCYmKHRoaXMuc3RyaW5nKz10KX1BcHBlbmRMaW5lKHQpe3ZvaWQgMCE9PXQmJnRoaXMuQXBwZW5kKHQpLHRoaXMuc3RyaW5nKz1cIlxcblwifUFwcGVuZEZvcm1hdCh0LC4uLmUpe3RoaXMuc3RyaW5nKz10LnJlcGxhY2UoL3soXFxkKyl9L2csKHQsbik9PnZvaWQgMCE9PWVbbl0/ZVtuXTp0KX10b1N0cmluZygpe3JldHVybiB0aGlzLnN0cmluZ319Y2xhc3MgZntjb25zdHJ1Y3Rvcigpe2lmKHRoaXMub3JpZ2luTmFtZT1udWxsLHRoaXMuaXRlbU5hbWU9bnVsbCx2b2lkIDAhPT1hcmd1bWVudHNbMV0pe2xldCB0PWFyZ3VtZW50c1swXSxlPWFyZ3VtZW50c1sxXTt0aGlzLm9yaWdpbk5hbWU9dCx0aGlzLml0ZW1OYW1lPWV9ZWxzZSBpZihhcmd1bWVudHNbMF0pe2xldCB0PWFyZ3VtZW50c1swXS50b1N0cmluZygpLnNwbGl0KFwiLlwiKTt0aGlzLm9yaWdpbk5hbWU9dFswXSx0aGlzLml0ZW1OYW1lPXRbMV19fXN0YXRpYyBnZXQgTnVsbCgpe3JldHVybiBuZXcgZihudWxsLG51bGwpfWdldCBpc051bGwoKXtyZXR1cm4gbnVsbD09dGhpcy5vcmlnaW5OYW1lJiZudWxsPT10aGlzLml0ZW1OYW1lfWdldCBmdWxsTmFtZSgpe3JldHVybihudWxsIT09dGhpcy5vcmlnaW5OYW1lP3RoaXMub3JpZ2luTmFtZTpcIj9cIikrXCIuXCIrdGhpcy5pdGVtTmFtZX10b1N0cmluZygpe3JldHVybiB0aGlzLmZ1bGxOYW1lfUVxdWFscyh0KXtpZih0IGluc3RhbmNlb2YgZil7bGV0IGU9dDtyZXR1cm4gZS5pdGVtTmFtZT09dGhpcy5pdGVtTmFtZSYmZS5vcmlnaW5OYW1lPT10aGlzLm9yaWdpbk5hbWV9cmV0dXJuITF9Y29weSgpe3JldHVybiBuZXcgZih0aGlzLm9yaWdpbk5hbWUsdGhpcy5pdGVtTmFtZSl9c2VyaWFsaXplZCgpe3JldHVybiBKU09OLnN0cmluZ2lmeSh7b3JpZ2luTmFtZTp0aGlzLm9yaWdpbk5hbWUsaXRlbU5hbWU6dGhpcy5pdGVtTmFtZX0pfXN0YXRpYyBmcm9tU2VyaWFsaXplZEtleSh0KXtsZXQgZT1KU09OLnBhcnNlKHQpO2lmKCFmLmlzTGlrZUlua0xpc3RJdGVtKGUpKXJldHVybiBmLk51bGw7bGV0IG49ZTtyZXR1cm4gbmV3IGYobi5vcmlnaW5OYW1lLG4uaXRlbU5hbWUpfXN0YXRpYyBpc0xpa2VJbmtMaXN0SXRlbSh0KXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgdCYmKCEoIXQuaGFzT3duUHJvcGVydHkoXCJvcmlnaW5OYW1lXCIpfHwhdC5oYXNPd25Qcm9wZXJ0eShcIml0ZW1OYW1lXCIpKSYmKChcInN0cmluZ1wiPT10eXBlb2YgdC5vcmlnaW5OYW1lfHxudWxsPT09dHlwZW9mIHQub3JpZ2luTmFtZSkmJihcInN0cmluZ1wiPT10eXBlb2YgdC5pdGVtTmFtZXx8bnVsbD09PXR5cGVvZiB0Lml0ZW1OYW1lKSkpfX1jbGFzcyBnIGV4dGVuZHMgTWFwe2NvbnN0cnVjdG9yKCl7aWYoc3VwZXIoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBnP2FyZ3VtZW50c1swXTpbXSksdGhpcy5vcmlnaW5zPW51bGwsdGhpcy5fb3JpZ2luTmFtZXM9W10sYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBnKXtsZXQgdD1hcmd1bWVudHNbMF07dC5fb3JpZ2luTmFtZXMmJih0aGlzLl9vcmlnaW5OYW1lcz10Ll9vcmlnaW5OYW1lcy5zbGljZSgpKX1lbHNlIGlmKFwic3RyaW5nXCI9PXR5cGVvZiBhcmd1bWVudHNbMF0pe2xldCB0PWFyZ3VtZW50c1swXSxlPWFyZ3VtZW50c1sxXTt0aGlzLlNldEluaXRpYWxPcmlnaW5OYW1lKHQpO2xldCBuPWUubGlzdERlZmluaXRpb25zLlRyeUxpc3RHZXREZWZpbml0aW9uKHQsbnVsbCk7aWYoIW4uZXhpc3RzKXRocm93IG5ldyBFcnJvcihcIklua0xpc3Qgb3JpZ2luIGNvdWxkIG5vdCBiZSBmb3VuZCBpbiBzdG9yeSB3aGVuIGNvbnN0cnVjdGluZyBuZXcgbGlzdDogXCIrdCk7dGhpcy5vcmlnaW5zPVtuLnJlc3VsdF19ZWxzZSBpZihcIm9iamVjdFwiPT10eXBlb2YgYXJndW1lbnRzWzBdJiZhcmd1bWVudHNbMF0uaGFzT3duUHJvcGVydHkoXCJLZXlcIikmJmFyZ3VtZW50c1swXS5oYXNPd25Qcm9wZXJ0eShcIlZhbHVlXCIpKXtsZXQgdD1hcmd1bWVudHNbMF07dGhpcy5BZGQodC5LZXksdC5WYWx1ZSl9fUFkZEl0ZW0odCl7aWYodCBpbnN0YW5jZW9mIGYpe2xldCBlPXQ7aWYobnVsbD09ZS5vcmlnaW5OYW1lKXJldHVybiB2b2lkIHRoaXMuQWRkSXRlbShlLml0ZW1OYW1lKTtpZihudWxsPT09dGhpcy5vcmlnaW5zKXJldHVybiBkKFwidGhpcy5vcmlnaW5zXCIpO2ZvcihsZXQgdCBvZiB0aGlzLm9yaWdpbnMpaWYodC5uYW1lPT1lLm9yaWdpbk5hbWUpe2xldCBuPXQuVHJ5R2V0VmFsdWVGb3JJdGVtKGUsMCk7aWYobi5leGlzdHMpcmV0dXJuIHZvaWQgdGhpcy5BZGQoZSxuLnJlc3VsdCk7dGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGFkZCB0aGUgaXRlbSBcIitlK1wiIHRvIHRoaXMgbGlzdCBiZWNhdXNlIGl0IGRvZXNuJ3QgZXhpc3QgaW4gdGhlIG9yaWdpbmFsIGxpc3QgZGVmaW5pdGlvbiBpbiBpbmsuXCIpfXRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBhZGQgaXRlbSB0byBsaXN0IGJlY2F1c2UgdGhlIGl0ZW0gd2FzIGZyb20gYSBuZXcgbGlzdCBkZWZpbml0aW9uIHRoYXQgd2Fzbid0IHByZXZpb3VzbHkga25vd24gdG8gdGhpcyBsaXN0LiBPbmx5IGl0ZW1zIGZyb20gcHJldmlvdXNseSBrbm93biBsaXN0cyBjYW4gYmUgdXNlZCwgc28gdGhhdCB0aGUgaW50IHZhbHVlIGNhbiBiZSBmb3VuZC5cIil9e2xldCBlPXQsbj1udWxsO2lmKG51bGw9PT10aGlzLm9yaWdpbnMpcmV0dXJuIGQoXCJ0aGlzLm9yaWdpbnNcIik7Zm9yKGxldCB0IG9mIHRoaXMub3JpZ2lucyl7aWYobnVsbD09PWUpcmV0dXJuIGQoXCJpdGVtTmFtZVwiKTtpZih0LkNvbnRhaW5zSXRlbVdpdGhOYW1lKGUpKXtpZihudWxsIT1uKXRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBhZGQgdGhlIGl0ZW0gXCIrZStcIiB0byB0aGlzIGxpc3QgYmVjYXVzZSBpdCBjb3VsZCBjb21lIGZyb20gZWl0aGVyIFwiK3QubmFtZStcIiBvciBcIituLm5hbWUpO249dH19aWYobnVsbD09bil0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgYWRkIHRoZSBpdGVtIFwiK2UrXCIgdG8gdGhpcyBsaXN0IGJlY2F1c2UgaXQgaXNuJ3Qga25vd24gdG8gYW55IGxpc3QgZGVmaW5pdGlvbnMgcHJldmlvdXNseSBhc3NvY2lhdGVkIHdpdGggdGhpcyBsaXN0LlwiKTtsZXQgaT1uZXcgZihuLm5hbWUsZSkscj1uLlZhbHVlRm9ySXRlbShpKTt0aGlzLkFkZChpLHIpfX1Db250YWluc0l0ZW1OYW1lZCh0KXtmb3IobGV0W2Vdb2YgdGhpcyl7aWYoZi5mcm9tU2VyaWFsaXplZEtleShlKS5pdGVtTmFtZT09dClyZXR1cm4hMH1yZXR1cm4hMX1Db250YWluc0tleSh0KXtyZXR1cm4gdGhpcy5oYXModC5zZXJpYWxpemVkKCkpfUFkZCh0LGUpe2xldCBuPXQuc2VyaWFsaXplZCgpO2lmKHRoaXMuaGFzKG4pKXRocm93IG5ldyBFcnJvcihcIlRoZSBNYXAgYWxyZWFkeSBjb250YWlucyBhbiBlbnRyeSBmb3IgXCIrdCk7dGhpcy5zZXQobixlKX1SZW1vdmUodCl7cmV0dXJuIHRoaXMuZGVsZXRlKHQuc2VyaWFsaXplZCgpKX1nZXQgQ291bnQoKXtyZXR1cm4gdGhpcy5zaXplfWdldCBvcmlnaW5PZk1heEl0ZW0oKXtpZihudWxsPT10aGlzLm9yaWdpbnMpcmV0dXJuIG51bGw7bGV0IHQ9dGhpcy5tYXhJdGVtLktleS5vcmlnaW5OYW1lLGU9bnVsbDtyZXR1cm4gdGhpcy5vcmlnaW5zLmV2ZXJ5KG49Pm4ubmFtZSE9dHx8KGU9biwhMSkpLGV9Z2V0IG9yaWdpbk5hbWVzKCl7aWYodGhpcy5Db3VudD4wKXtudWxsPT10aGlzLl9vcmlnaW5OYW1lcyYmdGhpcy5Db3VudD4wP3RoaXMuX29yaWdpbk5hbWVzPVtdOih0aGlzLl9vcmlnaW5OYW1lc3x8KHRoaXMuX29yaWdpbk5hbWVzPVtdKSx0aGlzLl9vcmlnaW5OYW1lcy5sZW5ndGg9MCk7Zm9yKGxldFt0XW9mIHRoaXMpe2xldCBlPWYuZnJvbVNlcmlhbGl6ZWRLZXkodCk7aWYobnVsbD09PWUub3JpZ2luTmFtZSlyZXR1cm4gZChcIml0ZW0ub3JpZ2luTmFtZVwiKTt0aGlzLl9vcmlnaW5OYW1lcy5wdXNoKGUub3JpZ2luTmFtZSl9fXJldHVybiB0aGlzLl9vcmlnaW5OYW1lc31TZXRJbml0aWFsT3JpZ2luTmFtZSh0KXt0aGlzLl9vcmlnaW5OYW1lcz1bdF19U2V0SW5pdGlhbE9yaWdpbk5hbWVzKHQpe3RoaXMuX29yaWdpbk5hbWVzPW51bGw9PXQ/bnVsbDp0LnNsaWNlKCl9Z2V0IG1heEl0ZW0oKXtsZXQgdD17S2V5OmYuTnVsbCxWYWx1ZTowfTtmb3IobGV0W2Usbl1vZiB0aGlzKXtsZXQgaT1mLmZyb21TZXJpYWxpemVkS2V5KGUpOyh0LktleS5pc051bGx8fG4+dC5WYWx1ZSkmJih0PXtLZXk6aSxWYWx1ZTpufSl9cmV0dXJuIHR9Z2V0IG1pbkl0ZW0oKXtsZXQgdD17S2V5OmYuTnVsbCxWYWx1ZTowfTtmb3IobGV0W2Usbl1vZiB0aGlzKXtsZXQgaT1mLmZyb21TZXJpYWxpemVkS2V5KGUpOyh0LktleS5pc051bGx8fG48dC5WYWx1ZSkmJih0PXtLZXk6aSxWYWx1ZTpufSl9cmV0dXJuIHR9Z2V0IGludmVyc2UoKXtsZXQgdD1uZXcgZztpZihudWxsIT10aGlzLm9yaWdpbnMpZm9yKGxldCBlIG9mIHRoaXMub3JpZ2lucylmb3IobGV0W24saV1vZiBlLml0ZW1zKXtsZXQgZT1mLmZyb21TZXJpYWxpemVkS2V5KG4pO3RoaXMuQ29udGFpbnNLZXkoZSl8fHQuQWRkKGUsaSl9cmV0dXJuIHR9Z2V0IGFsbCgpe2xldCB0PW5ldyBnO2lmKG51bGwhPXRoaXMub3JpZ2lucylmb3IobGV0IGUgb2YgdGhpcy5vcmlnaW5zKWZvcihsZXRbbixpXW9mIGUuaXRlbXMpe2xldCBlPWYuZnJvbVNlcmlhbGl6ZWRLZXkobik7dC5zZXQoZS5zZXJpYWxpemVkKCksaSl9cmV0dXJuIHR9VW5pb24odCl7bGV0IGU9bmV3IGcodGhpcyk7Zm9yKGxldFtuLGldb2YgdCllLnNldChuLGkpO3JldHVybiBlfUludGVyc2VjdCh0KXtsZXQgZT1uZXcgZztmb3IobGV0W24saV1vZiB0aGlzKXQuaGFzKG4pJiZlLnNldChuLGkpO3JldHVybiBlfVdpdGhvdXQodCl7bGV0IGU9bmV3IGcodGhpcyk7Zm9yKGxldFtuXW9mIHQpZS5kZWxldGUobik7cmV0dXJuIGV9Q29udGFpbnModCl7Zm9yKGxldFtlXW9mIHQpaWYoIXRoaXMuaGFzKGUpKXJldHVybiExO3JldHVybiEwfUdyZWF0ZXJUaGFuKHQpe3JldHVybiAwIT10aGlzLkNvdW50JiYoMD09dC5Db3VudHx8dGhpcy5taW5JdGVtLlZhbHVlPnQubWF4SXRlbS5WYWx1ZSl9R3JlYXRlclRoYW5PckVxdWFscyh0KXtyZXR1cm4gMCE9dGhpcy5Db3VudCYmKDA9PXQuQ291bnR8fHRoaXMubWluSXRlbS5WYWx1ZT49dC5taW5JdGVtLlZhbHVlJiZ0aGlzLm1heEl0ZW0uVmFsdWU+PXQubWF4SXRlbS5WYWx1ZSl9TGVzc1RoYW4odCl7cmV0dXJuIDAhPXQuQ291bnQmJigwPT10aGlzLkNvdW50fHx0aGlzLm1heEl0ZW0uVmFsdWU8dC5taW5JdGVtLlZhbHVlKX1MZXNzVGhhbk9yRXF1YWxzKHQpe3JldHVybiAwIT10LkNvdW50JiYoMD09dGhpcy5Db3VudHx8dGhpcy5tYXhJdGVtLlZhbHVlPD10Lm1heEl0ZW0uVmFsdWUmJnRoaXMubWluSXRlbS5WYWx1ZTw9dC5taW5JdGVtLlZhbHVlKX1NYXhBc0xpc3QoKXtyZXR1cm4gdGhpcy5Db3VudD4wP25ldyBnKHRoaXMubWF4SXRlbSk6bmV3IGd9TWluQXNMaXN0KCl7cmV0dXJuIHRoaXMuQ291bnQ+MD9uZXcgZyh0aGlzLm1pbkl0ZW0pOm5ldyBnfUxpc3RXaXRoU3ViUmFuZ2UodCxlKXtpZigwPT10aGlzLkNvdW50KXJldHVybiBuZXcgZztsZXQgbj10aGlzLm9yZGVyZWRJdGVtcyxpPTAscj1OdW1iZXIuTUFYX1NBRkVfSU5URUdFUjtOdW1iZXIuaXNJbnRlZ2VyKHQpP2k9dDp0IGluc3RhbmNlb2YgZyYmdC5Db3VudD4wJiYoaT10Lm1pbkl0ZW0uVmFsdWUpLE51bWJlci5pc0ludGVnZXIoZSk/cj1lOnQgaW5zdGFuY2VvZiBnJiZ0LkNvdW50PjAmJihyPWUubWF4SXRlbS5WYWx1ZSk7bGV0IGE9bmV3IGc7YS5TZXRJbml0aWFsT3JpZ2luTmFtZXModGhpcy5vcmlnaW5OYW1lcyk7Zm9yKGxldCB0IG9mIG4pdC5WYWx1ZT49aSYmdC5WYWx1ZTw9ciYmYS5BZGQodC5LZXksdC5WYWx1ZSk7cmV0dXJuIGF9RXF1YWxzKHQpe2lmKHQgaW5zdGFuY2VvZiBnPT0hMSlyZXR1cm4hMTtpZih0LkNvdW50IT10aGlzLkNvdW50KXJldHVybiExO2ZvcihsZXRbZV1vZiB0aGlzKWlmKCF0LmhhcyhlKSlyZXR1cm4hMTtyZXR1cm4hMH1nZXQgb3JkZXJlZEl0ZW1zKCl7bGV0IHQ9bmV3IEFycmF5O2ZvcihsZXRbZSxuXW9mIHRoaXMpe2xldCBpPWYuZnJvbVNlcmlhbGl6ZWRLZXkoZSk7dC5wdXNoKHtLZXk6aSxWYWx1ZTpufSl9cmV0dXJuIHQuc29ydCgodCxlKT0+bnVsbD09PXQuS2V5Lm9yaWdpbk5hbWU/ZChcInguS2V5Lm9yaWdpbk5hbWVcIik6bnVsbD09PWUuS2V5Lm9yaWdpbk5hbWU/ZChcInkuS2V5Lm9yaWdpbk5hbWVcIik6dC5WYWx1ZT09ZS5WYWx1ZT90LktleS5vcmlnaW5OYW1lLmxvY2FsZUNvbXBhcmUoZS5LZXkub3JpZ2luTmFtZSk6dC5WYWx1ZTxlLlZhbHVlPy0xOnQuVmFsdWU+ZS5WYWx1ZT8xOjApLHR9dG9TdHJpbmcoKXtsZXQgdD10aGlzLm9yZGVyZWRJdGVtcyxlPW5ldyBtO2ZvcihsZXQgbj0wO248dC5sZW5ndGg7bisrKXtuPjAmJmUuQXBwZW5kKFwiLCBcIik7bGV0IGk9dFtuXS5LZXk7aWYobnVsbD09PWkuaXRlbU5hbWUpcmV0dXJuIGQoXCJpdGVtLml0ZW1OYW1lXCIpO2UuQXBwZW5kKGkuaXRlbU5hbWUpfXJldHVybiBlLnRvU3RyaW5nKCl9dmFsdWVPZigpe3JldHVybiBOYU59fWNsYXNzIFMgZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSx0aGlzLnVzZUVuZExpbmVOdW1iZXI9ITEsdGhpcy5tZXNzYWdlPXQsdGhpcy5uYW1lPVwiU3RvcnlFeGNlcHRpb25cIn19ZnVuY3Rpb24geSh0LGUsbil7aWYobnVsbD09PXQpcmV0dXJue3Jlc3VsdDpuLGV4aXN0czohMX07bGV0IGk9dC5nZXQoZSk7cmV0dXJuIHZvaWQgMD09PWk/e3Jlc3VsdDpuLGV4aXN0czohMX06e3Jlc3VsdDppLGV4aXN0czohMH19Y2xhc3MgQyBleHRlbmRzIHB7c3RhdGljIENyZWF0ZSh0LG4pe2lmKG4pe2lmKG49PT1pLkludCYmTnVtYmVyLmlzSW50ZWdlcihOdW1iZXIodCkpKXJldHVybiBuZXcgYihOdW1iZXIodCkpO2lmKG49PT1pLkZsb2F0JiYhaXNOYU4odCkpcmV0dXJuIG5ldyBfKE51bWJlcih0KSl9aWYoXCJib29sZWFuXCI9PXR5cGVvZiB0KXt0PSEhdD8xOjB9cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIHQ/bmV3IFQoU3RyaW5nKHQpKTpOdW1iZXIuaXNJbnRlZ2VyKE51bWJlcih0KSk/bmV3IGIoTnVtYmVyKHQpKTppc05hTih0KT90IGluc3RhbmNlb2YgZT9uZXcgUChzKHQsZSkpOnQgaW5zdGFuY2VvZiBnP25ldyBPKHModCxnKSk6bnVsbDpuZXcgXyhOdW1iZXIodCkpfUNvcHkoKXtyZXR1cm4gcyhDLkNyZWF0ZSh0aGlzKSxwKX1CYWRDYXN0RXhjZXB0aW9uKHQpe3JldHVybiBuZXcgUyhcIkNhbid0IGNhc3QgXCIrdGhpcy52YWx1ZU9iamVjdCtcIiBmcm9tIFwiK3RoaXMudmFsdWVUeXBlK1wiIHRvIFwiK3QpfX1jbGFzcyB2IGV4dGVuZHMgQ3tjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMudmFsdWU9dH1nZXQgdmFsdWVPYmplY3QoKXtyZXR1cm4gdGhpcy52YWx1ZX10b1N0cmluZygpe3JldHVybiBudWxsPT09dGhpcy52YWx1ZT9kKFwiVmFsdWUudmFsdWVcIik6dGhpcy52YWx1ZS50b1N0cmluZygpfX1jbGFzcyBiIGV4dGVuZHMgdntjb25zdHJ1Y3Rvcih0KXtzdXBlcih0fHwwKX1nZXQgaXNUcnV0aHkoKXtyZXR1cm4gMCE9dGhpcy52YWx1ZX1nZXQgdmFsdWVUeXBlKCl7cmV0dXJuIGkuSW50fUNhc3QodCl7aWYobnVsbD09PXRoaXMudmFsdWUpcmV0dXJuIGQoXCJWYWx1ZS52YWx1ZVwiKTtpZih0PT10aGlzLnZhbHVlVHlwZSlyZXR1cm4gdGhpcztpZih0PT1pLkZsb2F0KXJldHVybiBuZXcgXyh0aGlzLnZhbHVlKTtpZih0PT1pLlN0cmluZylyZXR1cm4gbmV3IFQoXCJcIit0aGlzLnZhbHVlKTt0aHJvdyB0aGlzLkJhZENhc3RFeGNlcHRpb24odCl9fWNsYXNzIF8gZXh0ZW5kcyB2e2NvbnN0cnVjdG9yKHQpe3N1cGVyKHR8fDApfWdldCBpc1RydXRoeSgpe3JldHVybiAwIT10aGlzLnZhbHVlfWdldCB2YWx1ZVR5cGUoKXtyZXR1cm4gaS5GbG9hdH1DYXN0KHQpe2lmKG51bGw9PT10aGlzLnZhbHVlKXJldHVybiBkKFwiVmFsdWUudmFsdWVcIik7aWYodD09dGhpcy52YWx1ZVR5cGUpcmV0dXJuIHRoaXM7aWYodD09aS5JbnQpcmV0dXJuIG5ldyBiKHRoaXMudmFsdWUpO2lmKHQ9PWkuU3RyaW5nKXJldHVybiBuZXcgVChcIlwiK3RoaXMudmFsdWUpO3Rocm93IHRoaXMuQmFkQ2FzdEV4Y2VwdGlvbih0KX19Y2xhc3MgVCBleHRlbmRzIHZ7Y29uc3RydWN0b3IodCl7aWYoc3VwZXIodHx8XCJcIiksdGhpcy5faXNOZXdsaW5lPVwiXFxuXCI9PXRoaXMudmFsdWUsdGhpcy5faXNJbmxpbmVXaGl0ZXNwYWNlPSEwLG51bGw9PT10aGlzLnZhbHVlKXJldHVybiBkKFwiVmFsdWUudmFsdWVcIik7dGhpcy52YWx1ZS5sZW5ndGg+MCYmdGhpcy52YWx1ZS5zcGxpdChcIlwiKS5ldmVyeSh0PT5cIiBcIj09dHx8XCJcXHRcIj09dHx8KHRoaXMuX2lzSW5saW5lV2hpdGVzcGFjZT0hMSwhMSkpfWdldCB2YWx1ZVR5cGUoKXtyZXR1cm4gaS5TdHJpbmd9Z2V0IGlzVHJ1dGh5KCl7cmV0dXJuIG51bGw9PT10aGlzLnZhbHVlP2QoXCJWYWx1ZS52YWx1ZVwiKTp0aGlzLnZhbHVlLmxlbmd0aD4wfWdldCBpc05ld2xpbmUoKXtyZXR1cm4gdGhpcy5faXNOZXdsaW5lfWdldCBpc0lubGluZVdoaXRlc3BhY2UoKXtyZXR1cm4gdGhpcy5faXNJbmxpbmVXaGl0ZXNwYWNlfWdldCBpc05vbldoaXRlc3BhY2UoKXtyZXR1cm4hdGhpcy5pc05ld2xpbmUmJiF0aGlzLmlzSW5saW5lV2hpdGVzcGFjZX1DYXN0KHQpe2lmKHQ9PXRoaXMudmFsdWVUeXBlKXJldHVybiB0aGlzO2lmKHQ9PWkuSW50KXtsZXQgZT1mdW5jdGlvbih0LGU9MCl7bGV0IG49cGFyc2VJbnQodCk7cmV0dXJuIE51bWJlci5pc05hTihuKT97cmVzdWx0OmUsZXhpc3RzOiExfTp7cmVzdWx0Om4sZXhpc3RzOiEwfX0odGhpcy52YWx1ZSk7aWYoZS5leGlzdHMpcmV0dXJuIG5ldyBiKGUucmVzdWx0KTt0aHJvdyB0aGlzLkJhZENhc3RFeGNlcHRpb24odCl9aWYodD09aS5GbG9hdCl7bGV0IGU9ZnVuY3Rpb24odCxlPTApe2xldCBuPXBhcnNlRmxvYXQodCk7cmV0dXJuIE51bWJlci5pc05hTihuKT97cmVzdWx0OmUsZXhpc3RzOiExfTp7cmVzdWx0Om4sZXhpc3RzOiEwfX0odGhpcy52YWx1ZSk7aWYoZS5leGlzdHMpcmV0dXJuIG5ldyBfKGUucmVzdWx0KTt0aHJvdyB0aGlzLkJhZENhc3RFeGNlcHRpb24odCl9dGhyb3cgdGhpcy5CYWRDYXN0RXhjZXB0aW9uKHQpfX1jbGFzcyBQIGV4dGVuZHMgdntjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KX1nZXQgdmFsdWVUeXBlKCl7cmV0dXJuIGkuRGl2ZXJ0VGFyZ2V0fWdldCB0YXJnZXRQYXRoKCl7cmV0dXJuIG51bGw9PT10aGlzLnZhbHVlP2QoXCJWYWx1ZS52YWx1ZVwiKTp0aGlzLnZhbHVlfXNldCB0YXJnZXRQYXRoKHQpe3RoaXMudmFsdWU9dH1nZXQgaXNUcnV0aHkoKXt0aHJvdyBuZXcgRXJyb3IoXCJTaG91bGRuJ3QgYmUgY2hlY2tpbmcgdGhlIHRydXRoaW5lc3Mgb2YgYSBkaXZlcnQgdGFyZ2V0XCIpfUNhc3QodCl7aWYodD09dGhpcy52YWx1ZVR5cGUpcmV0dXJuIHRoaXM7dGhyb3cgdGhpcy5CYWRDYXN0RXhjZXB0aW9uKHQpfXRvU3RyaW5nKCl7cmV0dXJuXCJEaXZlcnRUYXJnZXRWYWx1ZShcIit0aGlzLnRhcmdldFBhdGgrXCIpXCJ9fWNsYXNzIHcgZXh0ZW5kcyB2e2NvbnN0cnVjdG9yKHQsZT0tMSl7c3VwZXIodCksdGhpcy5fY29udGV4dEluZGV4PWV9Z2V0IGNvbnRleHRJbmRleCgpe3JldHVybiB0aGlzLl9jb250ZXh0SW5kZXh9c2V0IGNvbnRleHRJbmRleCh0KXt0aGlzLl9jb250ZXh0SW5kZXg9dH1nZXQgdmFyaWFibGVOYW1lKCl7cmV0dXJuIG51bGw9PT10aGlzLnZhbHVlP2QoXCJWYWx1ZS52YWx1ZVwiKTp0aGlzLnZhbHVlfXNldCB2YXJpYWJsZU5hbWUodCl7dGhpcy52YWx1ZT10fWdldCB2YWx1ZVR5cGUoKXtyZXR1cm4gaS5WYXJpYWJsZVBvaW50ZXJ9Z2V0IGlzVHJ1dGh5KCl7dGhyb3cgbmV3IEVycm9yKFwiU2hvdWxkbid0IGJlIGNoZWNraW5nIHRoZSB0cnV0aGluZXNzIG9mIGEgdmFyaWFibGUgcG9pbnRlclwiKX1DYXN0KHQpe2lmKHQ9PXRoaXMudmFsdWVUeXBlKXJldHVybiB0aGlzO3Rocm93IHRoaXMuQmFkQ2FzdEV4Y2VwdGlvbih0KX10b1N0cmluZygpe3JldHVyblwiVmFyaWFibGVQb2ludGVyVmFsdWUoXCIrdGhpcy52YXJpYWJsZU5hbWUrXCIpXCJ9Q29weSgpe3JldHVybiBuZXcgdyh0aGlzLnZhcmlhYmxlTmFtZSx0aGlzLmNvbnRleHRJbmRleCl9fWNsYXNzIE8gZXh0ZW5kcyB2e2dldCBpc1RydXRoeSgpe3JldHVybiBudWxsPT09dGhpcy52YWx1ZT9kKFwidGhpcy52YWx1ZVwiKTp0aGlzLnZhbHVlLkNvdW50PjB9Z2V0IHZhbHVlVHlwZSgpe3JldHVybiBpLkxpc3R9Q2FzdCh0KXtpZihudWxsPT09dGhpcy52YWx1ZSlyZXR1cm4gZChcIlZhbHVlLnZhbHVlXCIpO2lmKHQ9PWkuSW50KXtsZXQgdD10aGlzLnZhbHVlLm1heEl0ZW07cmV0dXJuIHQuS2V5LmlzTnVsbD9uZXcgYigwKTpuZXcgYih0LlZhbHVlKX1pZih0PT1pLkZsb2F0KXtsZXQgdD10aGlzLnZhbHVlLm1heEl0ZW07cmV0dXJuIHQuS2V5LmlzTnVsbD9uZXcgXygwKTpuZXcgXyh0LlZhbHVlKX1pZih0PT1pLlN0cmluZyl7bGV0IHQ9dGhpcy52YWx1ZS5tYXhJdGVtO3JldHVybiB0LktleS5pc051bGw/bmV3IFQoXCJcIik6bmV3IFQodC5LZXkudG9TdHJpbmcoKSl9aWYodD09dGhpcy52YWx1ZVR5cGUpcmV0dXJuIHRoaXM7dGhyb3cgdGhpcy5CYWRDYXN0RXhjZXB0aW9uKHQpfWNvbnN0cnVjdG9yKHQsZSl7c3VwZXIobnVsbCksdHx8ZT90IGluc3RhbmNlb2YgZz90aGlzLnZhbHVlPW5ldyBnKHQpOnQgaW5zdGFuY2VvZiBmJiZcIm51bWJlclwiPT10eXBlb2YgZSYmKHRoaXMudmFsdWU9bmV3IGcoe0tleTp0LFZhbHVlOmV9KSk6dGhpcy52YWx1ZT1uZXcgZ31zdGF0aWMgUmV0YWluTGlzdE9yaWdpbnNGb3JBc3NpZ25tZW50KHQsZSl7bGV0IG49YSh0LE8pLGk9YShlLE8pO3JldHVybiBpJiZudWxsPT09aS52YWx1ZT9kKFwibmV3TGlzdC52YWx1ZVwiKTpuJiZudWxsPT09bi52YWx1ZT9kKFwib2xkTGlzdC52YWx1ZVwiKTp2b2lkKG4mJmkmJjA9PWkudmFsdWUuQ291bnQmJmkudmFsdWUuU2V0SW5pdGlhbE9yaWdpbk5hbWVzKG4udmFsdWUub3JpZ2luTmFtZXMpKX19IWZ1bmN0aW9uKHQpe3RbdC5JbnQ9MF09XCJJbnRcIix0W3QuRmxvYXQ9MV09XCJGbG9hdFwiLHRbdC5MaXN0PTJdPVwiTGlzdFwiLHRbdC5TdHJpbmc9M109XCJTdHJpbmdcIix0W3QuRGl2ZXJ0VGFyZ2V0PTRdPVwiRGl2ZXJ0VGFyZ2V0XCIsdFt0LlZhcmlhYmxlUG9pbnRlcj01XT1cIlZhcmlhYmxlUG9pbnRlclwifShpfHwoaT17fSkpO2NsYXNzIEV7Y29uc3RydWN0b3IoKXt0aGlzLm9iaj1udWxsLHRoaXMuYXBwcm94aW1hdGU9ITF9Z2V0IGNvcnJlY3RPYmooKXtyZXR1cm4gdGhpcy5hcHByb3hpbWF0ZT9udWxsOnRoaXMub2JqfWdldCBjb250YWluZXIoKXtyZXR1cm4gdGhpcy5vYmogaW5zdGFuY2VvZiBOP3RoaXMub2JqOm51bGx9Y29weSgpe2xldCB0PW5ldyBFO3JldHVybiB0Lm9iaj10aGlzLm9iaix0LmFwcHJveGltYXRlPXRoaXMuYXBwcm94aW1hdGUsdH19Y2xhc3MgTiBleHRlbmRzIHB7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMubmFtZT1cIlwiLHRoaXMuX2NvbnRlbnQ9W10sdGhpcy5uYW1lZENvbnRlbnQ9bmV3IE1hcCx0aGlzLnZpc2l0c1Nob3VsZEJlQ291bnRlZD0hMSx0aGlzLnR1cm5JbmRleFNob3VsZEJlQ291bnRlZD0hMSx0aGlzLmNvdW50aW5nQXRTdGFydE9ubHk9ITEsdGhpcy5fcGF0aFRvRmlyc3RMZWFmQ29udGVudD1udWxsfWdldCBoYXNWYWxpZE5hbWUoKXtyZXR1cm4gbnVsbCE9dGhpcy5uYW1lJiZ0aGlzLm5hbWUubGVuZ3RoPjB9Z2V0IGNvbnRlbnQoKXtyZXR1cm4gdGhpcy5fY29udGVudH1zZXQgY29udGVudCh0KXt0aGlzLkFkZENvbnRlbnQodCl9Z2V0IG5hbWVkT25seUNvbnRlbnQoKXtsZXQgdD1uZXcgTWFwO2ZvcihsZXRbZSxuXW9mIHRoaXMubmFtZWRDb250ZW50KXtsZXQgaT1zKG4scCk7dC5zZXQoZSxpKX1mb3IobGV0IGUgb2YgdGhpcy5jb250ZW50KXtsZXQgbj1sKGUpO251bGwhPW4mJm4uaGFzVmFsaWROYW1lJiZ0LmRlbGV0ZShuLm5hbWUpfXJldHVybiAwPT10LnNpemUmJih0PW51bGwpLHR9c2V0IG5hbWVkT25seUNvbnRlbnQodCl7bGV0IGU9dGhpcy5uYW1lZE9ubHlDb250ZW50O2lmKG51bGwhPWUpZm9yKGxldFt0XW9mIGUpdGhpcy5uYW1lZENvbnRlbnQuZGVsZXRlKHQpO2lmKG51bGwhPXQpZm9yKGxldFssZV1vZiB0KXtsZXQgdD1sKGUpO251bGwhPXQmJnRoaXMuQWRkVG9OYW1lZENvbnRlbnRPbmx5KHQpfX1nZXQgY291bnRGbGFncygpe2xldCB0PTA7cmV0dXJuIHRoaXMudmlzaXRzU2hvdWxkQmVDb3VudGVkJiYodHw9Ti5Db3VudEZsYWdzLlZpc2l0cyksdGhpcy50dXJuSW5kZXhTaG91bGRCZUNvdW50ZWQmJih0fD1OLkNvdW50RmxhZ3MuVHVybnMpLHRoaXMuY291bnRpbmdBdFN0YXJ0T25seSYmKHR8PU4uQ291bnRGbGFncy5Db3VudFN0YXJ0T25seSksdD09Ti5Db3VudEZsYWdzLkNvdW50U3RhcnRPbmx5JiYodD0wKSx0fXNldCBjb3VudEZsYWdzKHQpe2xldCBlPXQ7KGUmTi5Db3VudEZsYWdzLlZpc2l0cyk+MCYmKHRoaXMudmlzaXRzU2hvdWxkQmVDb3VudGVkPSEwKSwoZSZOLkNvdW50RmxhZ3MuVHVybnMpPjAmJih0aGlzLnR1cm5JbmRleFNob3VsZEJlQ291bnRlZD0hMCksKGUmTi5Db3VudEZsYWdzLkNvdW50U3RhcnRPbmx5KT4wJiYodGhpcy5jb3VudGluZ0F0U3RhcnRPbmx5PSEwKX1nZXQgcGF0aFRvRmlyc3RMZWFmQ29udGVudCgpe3JldHVybiBudWxsPT10aGlzLl9wYXRoVG9GaXJzdExlYWZDb250ZW50JiYodGhpcy5fcGF0aFRvRmlyc3RMZWFmQ29udGVudD10aGlzLnBhdGguUGF0aEJ5QXBwZW5kaW5nUGF0aCh0aGlzLmludGVybmFsUGF0aFRvRmlyc3RMZWFmQ29udGVudCkpLHRoaXMuX3BhdGhUb0ZpcnN0TGVhZkNvbnRlbnR9Z2V0IGludGVybmFsUGF0aFRvRmlyc3RMZWFmQ29udGVudCgpe2xldCB0PVtdLG49dGhpcztmb3IoO24gaW5zdGFuY2VvZiBOOyluLmNvbnRlbnQubGVuZ3RoPjAmJih0LnB1c2gobmV3IGUuQ29tcG9uZW50KDApKSxuPW4uY29udGVudFswXSk7cmV0dXJuIG5ldyBlKHQpfUFkZENvbnRlbnQodCl7aWYodCBpbnN0YW5jZW9mIEFycmF5KXtsZXQgZT10O2ZvcihsZXQgdCBvZiBlKXRoaXMuQWRkQ29udGVudCh0KX1lbHNle2xldCBlPXQ7aWYodGhpcy5fY29udGVudC5wdXNoKGUpLGUucGFyZW50KXRocm93IG5ldyBFcnJvcihcImNvbnRlbnQgaXMgYWxyZWFkeSBpbiBcIitlLnBhcmVudCk7ZS5wYXJlbnQ9dGhpcyx0aGlzLlRyeUFkZE5hbWVkQ29udGVudChlKX19VHJ5QWRkTmFtZWRDb250ZW50KHQpe2xldCBlPWwodCk7bnVsbCE9ZSYmZS5oYXNWYWxpZE5hbWUmJnRoaXMuQWRkVG9OYW1lZENvbnRlbnRPbmx5KGUpfUFkZFRvTmFtZWRDb250ZW50T25seSh0KXtuLkFzc2VydFR5cGUodCxwLFwiQ2FuIG9ubHkgYWRkIFJ1bnRpbWUuT2JqZWN0cyB0byBhIFJ1bnRpbWUuQ29udGFpbmVyXCIpLHModCxwKS5wYXJlbnQ9dGhpcyx0aGlzLm5hbWVkQ29udGVudC5zZXQodC5uYW1lLHQpfUNvbnRlbnRBdFBhdGgodCxlPTAsbj0tMSl7LTE9PW4mJihuPXQubGVuZ3RoKTtsZXQgaT1uZXcgRTtpLmFwcHJveGltYXRlPSExO2xldCByPXRoaXMscz10aGlzO2ZvcihsZXQgbD1lO2w8bjsrK2wpe2xldCBlPXQuR2V0Q29tcG9uZW50KGwpO2lmKG51bGw9PXIpe2kuYXBwcm94aW1hdGU9ITA7YnJlYWt9bGV0IG49ci5Db250ZW50V2l0aFBhdGhDb21wb25lbnQoZSk7aWYobnVsbD09bil7aS5hcHByb3hpbWF0ZT0hMDticmVha31zPW4scj1hKG4sTil9cmV0dXJuIGkub2JqPXMsaX1JbnNlcnRDb250ZW50KHQsZSl7aWYodGhpcy5jb250ZW50W2VdPXQsdC5wYXJlbnQpdGhyb3cgbmV3IEVycm9yKFwiY29udGVudCBpcyBhbHJlYWR5IGluIFwiK3QucGFyZW50KTt0LnBhcmVudD10aGlzLHRoaXMuVHJ5QWRkTmFtZWRDb250ZW50KHQpfUFkZENvbnRlbnRzT2ZDb250YWluZXIodCl7dGhpcy5jb250ZW50PXRoaXMuY29udGVudC5jb25jYXQodC5jb250ZW50KTtmb3IobGV0IGUgb2YgdC5jb250ZW50KWUucGFyZW50PXRoaXMsdGhpcy5UcnlBZGROYW1lZENvbnRlbnQoZSl9Q29udGVudFdpdGhQYXRoQ29tcG9uZW50KHQpe2lmKHQuaXNJbmRleClyZXR1cm4gdC5pbmRleD49MCYmdC5pbmRleDx0aGlzLmNvbnRlbnQubGVuZ3RoP3RoaXMuY29udGVudFt0LmluZGV4XTpudWxsO2lmKHQuaXNQYXJlbnQpcmV0dXJuIHRoaXMucGFyZW50O3tpZihudWxsPT09dC5uYW1lKXJldHVybiBkKFwiY29tcG9uZW50Lm5hbWVcIik7bGV0IGU9eSh0aGlzLm5hbWVkQ29udGVudCx0Lm5hbWUsbnVsbCk7cmV0dXJuIGUuZXhpc3RzP3MoZS5yZXN1bHQscCk6bnVsbH19QnVpbGRTdHJpbmdPZkhpZXJhcmNoeSgpe2xldCB0O2lmKDA9PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHQ9bmV3IG0sdGhpcy5CdWlsZFN0cmluZ09mSGllcmFyY2h5KHQsMCxudWxsKSx0LnRvU3RyaW5nKCk7dD1hcmd1bWVudHNbMF07bGV0IGU9YXJndW1lbnRzWzFdLGk9YXJndW1lbnRzWzJdO2Z1bmN0aW9uIHIoKXtmb3IobGV0IG49MDtuPDQqZTsrK24pdC5BcHBlbmQoXCIgXCIpfXIoKSx0LkFwcGVuZChcIltcIiksdGhpcy5oYXNWYWxpZE5hbWUmJnQuQXBwZW5kRm9ybWF0KFwiICh7MH0pXCIsdGhpcy5uYW1lKSx0aGlzPT1pJiZ0LkFwcGVuZChcIiAgPC0tLVwiKSx0LkFwcGVuZExpbmUoKSxlKys7Zm9yKGxldCBuPTA7bjx0aGlzLmNvbnRlbnQubGVuZ3RoOysrbil7bGV0IGE9dGhpcy5jb250ZW50W25dO2lmKGEgaW5zdGFuY2VvZiBOKXthLkJ1aWxkU3RyaW5nT2ZIaWVyYXJjaHkodCxlLGkpfWVsc2UgcigpLGEgaW5zdGFuY2VvZiBUPyh0LkFwcGVuZCgnXCInKSx0LkFwcGVuZChhLnRvU3RyaW5nKCkucmVwbGFjZShcIlxcblwiLFwiXFxcXG5cIikpLHQuQXBwZW5kKCdcIicpKTp0LkFwcGVuZChhLnRvU3RyaW5nKCkpO24hPXRoaXMuY29udGVudC5sZW5ndGgtMSYmdC5BcHBlbmQoXCIsXCIpLGEgaW5zdGFuY2VvZiBOfHxhIT1pfHx0LkFwcGVuZChcIiAgPC0tLVwiKSx0LkFwcGVuZExpbmUoKX1sZXQgYT1uZXcgTWFwO2ZvcihsZXRbdCxlXW9mIHRoaXMubmFtZWRDb250ZW50KXRoaXMuY29udGVudC5pbmRleE9mKHMoZSxwKSk+PTB8fGEuc2V0KHQsZSk7aWYoYS5zaXplPjApe3IoKSx0LkFwcGVuZExpbmUoXCItLSBuYW1lZDogLS1cIik7Zm9yKGxldFsscl1vZiBhKXtuLkFzc2VydFR5cGUocixOLFwiQ2FuIG9ubHkgcHJpbnQgb3V0IG5hbWVkIENvbnRhaW5lcnNcIiksci5CdWlsZFN0cmluZ09mSGllcmFyY2h5KHQsZSxpKSx0LkFwcGVuZExpbmUoKX19ZS0tLHIoKSx0LkFwcGVuZChcIl1cIil9fSFmdW5jdGlvbih0KXtsZXQgZTshZnVuY3Rpb24odCl7dFt0LlZpc2l0cz0xXT1cIlZpc2l0c1wiLHRbdC5UdXJucz0yXT1cIlR1cm5zXCIsdFt0LkNvdW50U3RhcnRPbmx5PTRdPVwiQ291bnRTdGFydE9ubHlcIn0oZT10LkNvdW50RmxhZ3N8fCh0LkNvdW50RmxhZ3M9e30pKX0oTnx8KE49e30pKTtjbGFzcyB4IGV4dGVuZHMgcHt0b1N0cmluZygpe3JldHVyblwiR2x1ZVwifX1jbGFzcyBBIGV4dGVuZHMgcHtjb25zdHJ1Y3Rvcih0PUEuQ29tbWFuZFR5cGUuTm90U2V0KXtzdXBlcigpLHRoaXMuX2NvbW1hbmRUeXBlPXR9Z2V0IGNvbW1hbmRUeXBlKCl7cmV0dXJuIHRoaXMuX2NvbW1hbmRUeXBlfUNvcHkoKXtyZXR1cm4gbmV3IEEodGhpcy5jb21tYW5kVHlwZSl9c3RhdGljIEV2YWxTdGFydCgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLkV2YWxTdGFydCl9c3RhdGljIEV2YWxPdXRwdXQoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5FdmFsT3V0cHV0KX1zdGF0aWMgRXZhbEVuZCgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLkV2YWxFbmQpfXN0YXRpYyBEdXBsaWNhdGUoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5EdXBsaWNhdGUpfXN0YXRpYyBQb3BFdmFsdWF0ZWRWYWx1ZSgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLlBvcEV2YWx1YXRlZFZhbHVlKX1zdGF0aWMgUG9wRnVuY3Rpb24oKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5Qb3BGdW5jdGlvbil9c3RhdGljIFBvcFR1bm5lbCgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLlBvcFR1bm5lbCl9c3RhdGljIEJlZ2luU3RyaW5nKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuQmVnaW5TdHJpbmcpfXN0YXRpYyBFbmRTdHJpbmcoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5FbmRTdHJpbmcpfXN0YXRpYyBOb09wKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuTm9PcCl9c3RhdGljIENob2ljZUNvdW50KCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuQ2hvaWNlQ291bnQpfXN0YXRpYyBUdXJucygpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLlR1cm5zKX1zdGF0aWMgVHVybnNTaW5jZSgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLlR1cm5zU2luY2UpfXN0YXRpYyBSZWFkQ291bnQoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5SZWFkQ291bnQpfXN0YXRpYyBSYW5kb20oKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5SYW5kb20pfXN0YXRpYyBTZWVkUmFuZG9tKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuU2VlZFJhbmRvbSl9c3RhdGljIFZpc2l0SW5kZXgoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5WaXNpdEluZGV4KX1zdGF0aWMgU2VxdWVuY2VTaHVmZmxlSW5kZXgoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5TZXF1ZW5jZVNodWZmbGVJbmRleCl9c3RhdGljIFN0YXJ0VGhyZWFkKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuU3RhcnRUaHJlYWQpfXN0YXRpYyBEb25lKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuRG9uZSl9c3RhdGljIEVuZCgpe3JldHVybiBuZXcgQShBLkNvbW1hbmRUeXBlLkVuZCl9c3RhdGljIExpc3RGcm9tSW50KCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuTGlzdEZyb21JbnQpfXN0YXRpYyBMaXN0UmFuZ2UoKXtyZXR1cm4gbmV3IEEoQS5Db21tYW5kVHlwZS5MaXN0UmFuZ2UpfXN0YXRpYyBMaXN0UmFuZG9tKCl7cmV0dXJuIG5ldyBBKEEuQ29tbWFuZFR5cGUuTGlzdFJhbmRvbSl9dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy5jb21tYW5kVHlwZS50b1N0cmluZygpfX0hZnVuY3Rpb24odCl7bGV0IGU7IWZ1bmN0aW9uKHQpe3RbdC5Ob3RTZXQ9LTFdPVwiTm90U2V0XCIsdFt0LkV2YWxTdGFydD0wXT1cIkV2YWxTdGFydFwiLHRbdC5FdmFsT3V0cHV0PTFdPVwiRXZhbE91dHB1dFwiLHRbdC5FdmFsRW5kPTJdPVwiRXZhbEVuZFwiLHRbdC5EdXBsaWNhdGU9M109XCJEdXBsaWNhdGVcIix0W3QuUG9wRXZhbHVhdGVkVmFsdWU9NF09XCJQb3BFdmFsdWF0ZWRWYWx1ZVwiLHRbdC5Qb3BGdW5jdGlvbj01XT1cIlBvcEZ1bmN0aW9uXCIsdFt0LlBvcFR1bm5lbD02XT1cIlBvcFR1bm5lbFwiLHRbdC5CZWdpblN0cmluZz03XT1cIkJlZ2luU3RyaW5nXCIsdFt0LkVuZFN0cmluZz04XT1cIkVuZFN0cmluZ1wiLHRbdC5Ob09wPTldPVwiTm9PcFwiLHRbdC5DaG9pY2VDb3VudD0xMF09XCJDaG9pY2VDb3VudFwiLHRbdC5UdXJucz0xMV09XCJUdXJuc1wiLHRbdC5UdXJuc1NpbmNlPTEyXT1cIlR1cm5zU2luY2VcIix0W3QuUmFuZG9tPTEzXT1cIlJhbmRvbVwiLHRbdC5TZWVkUmFuZG9tPTE0XT1cIlNlZWRSYW5kb21cIix0W3QuVmlzaXRJbmRleD0xNV09XCJWaXNpdEluZGV4XCIsdFt0LlNlcXVlbmNlU2h1ZmZsZUluZGV4PTE2XT1cIlNlcXVlbmNlU2h1ZmZsZUluZGV4XCIsdFt0LlN0YXJ0VGhyZWFkPTE3XT1cIlN0YXJ0VGhyZWFkXCIsdFt0LkRvbmU9MThdPVwiRG9uZVwiLHRbdC5FbmQ9MTldPVwiRW5kXCIsdFt0Lkxpc3RGcm9tSW50PTIwXT1cIkxpc3RGcm9tSW50XCIsdFt0Lkxpc3RSYW5nZT0yMV09XCJMaXN0UmFuZ2VcIix0W3QuTGlzdFJhbmRvbT0yMl09XCJMaXN0UmFuZG9tXCIsdFt0LlJlYWRDb3VudD0yM109XCJSZWFkQ291bnRcIix0W3QuVE9UQUxfVkFMVUVTPTI0XT1cIlRPVEFMX1ZBTFVFU1wifShlPXQuQ29tbWFuZFR5cGV8fCh0LkNvbW1hbmRUeXBlPXt9KSl9KEF8fChBPXt9KSksZnVuY3Rpb24odCl7dFt0LlR1bm5lbD0wXT1cIlR1bm5lbFwiLHRbdC5GdW5jdGlvbj0xXT1cIkZ1bmN0aW9uXCIsdFt0LkZ1bmN0aW9uRXZhbHVhdGlvbkZyb21HYW1lPTJdPVwiRnVuY3Rpb25FdmFsdWF0aW9uRnJvbUdhbWVcIn0ocnx8KHI9e30pKTtjbGFzcyBJe2NvbnN0cnVjdG9yKCl7dGhpcy5jb250YWluZXI9bnVsbCx0aGlzLmluZGV4PS0xLDI9PT1hcmd1bWVudHMubGVuZ3RoJiYodGhpcy5jb250YWluZXI9YXJndW1lbnRzWzBdLHRoaXMuaW5kZXg9YXJndW1lbnRzWzFdKX1SZXNvbHZlKCl7cmV0dXJuIHRoaXMuaW5kZXg8MD90aGlzLmNvbnRhaW5lcjpudWxsPT10aGlzLmNvbnRhaW5lcj9udWxsOjA9PXRoaXMuY29udGFpbmVyLmNvbnRlbnQubGVuZ3RoP3RoaXMuY29udGFpbmVyOnRoaXMuaW5kZXg+PXRoaXMuY29udGFpbmVyLmNvbnRlbnQubGVuZ3RoP251bGw6dGhpcy5jb250YWluZXIuY29udGVudFt0aGlzLmluZGV4XX1nZXQgaXNOdWxsKCl7cmV0dXJuIG51bGw9PXRoaXMuY29udGFpbmVyfWdldCBwYXRoKCl7cmV0dXJuIHRoaXMuaXNOdWxsP251bGw6dGhpcy5pbmRleD49MD90aGlzLmNvbnRhaW5lci5wYXRoLlBhdGhCeUFwcGVuZGluZ0NvbXBvbmVudChuZXcgZS5Db21wb25lbnQodGhpcy5pbmRleCkpOnRoaXMuY29udGFpbmVyLnBhdGh9dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy5jb250YWluZXI/XCJJbmsgUG9pbnRlciAtPiBcIit0aGlzLmNvbnRhaW5lci5wYXRoLnRvU3RyaW5nKCkrXCIgLS0gaW5kZXggXCIrdGhpcy5pbmRleDpcIkluayBQb2ludGVyIChudWxsKVwifWNvcHkoKXtyZXR1cm4gbmV3IEkodGhpcy5jb250YWluZXIsdGhpcy5pbmRleCl9c3RhdGljIFN0YXJ0T2YodCl7cmV0dXJuIG5ldyBJKHQsMCl9c3RhdGljIGdldCBOdWxsKCl7cmV0dXJuIG5ldyBJKG51bGwsLTEpfX1jbGFzcyBrIGV4dGVuZHMgcHtjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMuX3RhcmdldFBhdGg9bnVsbCx0aGlzLl90YXJnZXRQb2ludGVyPUkuTnVsbCx0aGlzLnZhcmlhYmxlRGl2ZXJ0TmFtZT1udWxsLHRoaXMucHVzaGVzVG9TdGFjaz0hMSx0aGlzLnN0YWNrUHVzaFR5cGU9MCx0aGlzLmlzRXh0ZXJuYWw9ITEsdGhpcy5leHRlcm5hbEFyZ3M9MCx0aGlzLmlzQ29uZGl0aW9uYWw9ITEsdGhpcy5wdXNoZXNUb1N0YWNrPSExLHZvaWQgMCE9PXQmJih0aGlzLnB1c2hlc1RvU3RhY2s9ITAsdGhpcy5zdGFja1B1c2hUeXBlPXQpfWdldCB0YXJnZXRQYXRoKCl7aWYobnVsbCE9dGhpcy5fdGFyZ2V0UGF0aCYmdGhpcy5fdGFyZ2V0UGF0aC5pc1JlbGF0aXZlKXtsZXQgdD10aGlzLnRhcmdldFBvaW50ZXIuUmVzb2x2ZSgpO3QmJih0aGlzLl90YXJnZXRQYXRoPXQucGF0aCl9cmV0dXJuIHRoaXMuX3RhcmdldFBhdGh9c2V0IHRhcmdldFBhdGgodCl7dGhpcy5fdGFyZ2V0UGF0aD10LHRoaXMuX3RhcmdldFBvaW50ZXI9SS5OdWxsfWdldCB0YXJnZXRQb2ludGVyKCl7aWYodGhpcy5fdGFyZ2V0UG9pbnRlci5pc051bGwpe2xldCB0PXRoaXMuUmVzb2x2ZVBhdGgodGhpcy5fdGFyZ2V0UGF0aCkub2JqO2lmKG51bGw9PT10aGlzLl90YXJnZXRQYXRoKXJldHVybiBkKFwidGhpcy5fdGFyZ2V0UGF0aFwiKTtpZihudWxsPT09dGhpcy5fdGFyZ2V0UGF0aC5sYXN0Q29tcG9uZW50KXJldHVybiBkKFwidGhpcy5fdGFyZ2V0UGF0aC5sYXN0Q29tcG9uZW50XCIpO2lmKHRoaXMuX3RhcmdldFBhdGgubGFzdENvbXBvbmVudC5pc0luZGV4KXtpZihudWxsPT09dClyZXR1cm4gZChcInRhcmdldE9ialwiKTt0aGlzLl90YXJnZXRQb2ludGVyLmNvbnRhaW5lcj10LnBhcmVudCBpbnN0YW5jZW9mIE4/dC5wYXJlbnQ6bnVsbCx0aGlzLl90YXJnZXRQb2ludGVyLmluZGV4PXRoaXMuX3RhcmdldFBhdGgubGFzdENvbXBvbmVudC5pbmRleH1lbHNlIHRoaXMuX3RhcmdldFBvaW50ZXI9SS5TdGFydE9mKHQgaW5zdGFuY2VvZiBOP3Q6bnVsbCl9cmV0dXJuIHRoaXMuX3RhcmdldFBvaW50ZXIuY29weSgpfWdldCB0YXJnZXRQYXRoU3RyaW5nKCl7cmV0dXJuIG51bGw9PXRoaXMudGFyZ2V0UGF0aD9udWxsOnRoaXMuQ29tcGFjdFBhdGhTdHJpbmcodGhpcy50YXJnZXRQYXRoKX1zZXQgdGFyZ2V0UGF0aFN0cmluZyh0KXt0aGlzLnRhcmdldFBhdGg9bnVsbD09dD9udWxsOm5ldyBlKHQpfWdldCBoYXNWYXJpYWJsZVRhcmdldCgpe3JldHVybiBudWxsIT10aGlzLnZhcmlhYmxlRGl2ZXJ0TmFtZX1FcXVhbHModCl7bGV0IGU9dDtyZXR1cm4gZSBpbnN0YW5jZW9mIGsmJnRoaXMuaGFzVmFyaWFibGVUYXJnZXQ9PWUuaGFzVmFyaWFibGVUYXJnZXQmJih0aGlzLmhhc1ZhcmlhYmxlVGFyZ2V0P3RoaXMudmFyaWFibGVEaXZlcnROYW1lPT1lLnZhcmlhYmxlRGl2ZXJ0TmFtZTpudWxsPT09dGhpcy50YXJnZXRQYXRoP2QoXCJ0aGlzLnRhcmdldFBhdGhcIik6dGhpcy50YXJnZXRQYXRoLkVxdWFscyhlLnRhcmdldFBhdGgpKX10b1N0cmluZygpe2lmKHRoaXMuaGFzVmFyaWFibGVUYXJnZXQpcmV0dXJuXCJEaXZlcnQodmFyaWFibGU6IFwiK3RoaXMudmFyaWFibGVEaXZlcnROYW1lK1wiKVwiO2lmKG51bGw9PXRoaXMudGFyZ2V0UGF0aClyZXR1cm5cIkRpdmVydChudWxsKVwiO3tsZXQgdD1uZXcgbSxlPXRoaXMudGFyZ2V0UGF0aC50b1N0cmluZygpO3JldHVybiB0LkFwcGVuZChcIkRpdmVydFwiKSx0aGlzLmlzQ29uZGl0aW9uYWwmJnQuQXBwZW5kKFwiP1wiKSx0aGlzLnB1c2hlc1RvU3RhY2smJih0aGlzLnN0YWNrUHVzaFR5cGU9PXIuRnVuY3Rpb24/dC5BcHBlbmQoXCIgZnVuY3Rpb25cIik6dC5BcHBlbmQoXCIgdHVubmVsXCIpKSx0LkFwcGVuZChcIiAtPiBcIiksdC5BcHBlbmQodGhpcy50YXJnZXRQYXRoU3RyaW5nKSx0LkFwcGVuZChcIiAoXCIpLHQuQXBwZW5kKGUpLHQuQXBwZW5kKFwiKVwiKSx0LnRvU3RyaW5nKCl9fX1jbGFzcyBXIGV4dGVuZHMgcHtjb25zdHJ1Y3Rvcih0PSEwKXtzdXBlcigpLHRoaXMuX3BhdGhPbkNob2ljZT1udWxsLHRoaXMuaGFzQ29uZGl0aW9uPSExLHRoaXMuaGFzU3RhcnRDb250ZW50PSExLHRoaXMuaGFzQ2hvaWNlT25seUNvbnRlbnQ9ITEsdGhpcy5pc0ludmlzaWJsZURlZmF1bHQ9ITEsdGhpcy5vbmNlT25seT0hMCx0aGlzLm9uY2VPbmx5PXR9Z2V0IHBhdGhPbkNob2ljZSgpe2lmKG51bGwhPXRoaXMuX3BhdGhPbkNob2ljZSYmdGhpcy5fcGF0aE9uQ2hvaWNlLmlzUmVsYXRpdmUpe2xldCB0PXRoaXMuY2hvaWNlVGFyZ2V0O3QmJih0aGlzLl9wYXRoT25DaG9pY2U9dC5wYXRoKX1yZXR1cm4gdGhpcy5fcGF0aE9uQ2hvaWNlfXNldCBwYXRoT25DaG9pY2UodCl7dGhpcy5fcGF0aE9uQ2hvaWNlPXR9Z2V0IGNob2ljZVRhcmdldCgpe3JldHVybiBudWxsPT09dGhpcy5fcGF0aE9uQ2hvaWNlP2QoXCJDaG9pY2VQb2ludC5fcGF0aE9uQ2hvaWNlXCIpOnRoaXMuUmVzb2x2ZVBhdGgodGhpcy5fcGF0aE9uQ2hvaWNlKS5jb250YWluZXJ9Z2V0IHBhdGhTdHJpbmdPbkNob2ljZSgpe3JldHVybiBudWxsPT09dGhpcy5wYXRoT25DaG9pY2U/ZChcIkNob2ljZVBvaW50LnBhdGhPbkNob2ljZVwiKTp0aGlzLkNvbXBhY3RQYXRoU3RyaW5nKHRoaXMucGF0aE9uQ2hvaWNlKX1zZXQgcGF0aFN0cmluZ09uQ2hvaWNlKHQpe3RoaXMucGF0aE9uQ2hvaWNlPW5ldyBlKHQpfWdldCBmbGFncygpe2xldCB0PTA7cmV0dXJuIHRoaXMuaGFzQ29uZGl0aW9uJiYodHw9MSksdGhpcy5oYXNTdGFydENvbnRlbnQmJih0fD0yKSx0aGlzLmhhc0Nob2ljZU9ubHlDb250ZW50JiYodHw9NCksdGhpcy5pc0ludmlzaWJsZURlZmF1bHQmJih0fD04KSx0aGlzLm9uY2VPbmx5JiYodHw9MTYpLHR9c2V0IGZsYWdzKHQpe3RoaXMuaGFzQ29uZGl0aW9uPSgxJnQpPjAsdGhpcy5oYXNTdGFydENvbnRlbnQ9KDImdCk+MCx0aGlzLmhhc0Nob2ljZU9ubHlDb250ZW50PSg0JnQpPjAsdGhpcy5pc0ludmlzaWJsZURlZmF1bHQ9KDgmdCk+MCx0aGlzLm9uY2VPbmx5PSgxNiZ0KT4wfXRvU3RyaW5nKCl7aWYobnVsbD09PXRoaXMucGF0aE9uQ2hvaWNlKXJldHVybiBkKFwiQ2hvaWNlUG9pbnQucGF0aE9uQ2hvaWNlXCIpO3JldHVyblwiQ2hvaWNlOiAtPiBcIit0aGlzLnBhdGhPbkNob2ljZS50b1N0cmluZygpfX1jbGFzcyBGIGV4dGVuZHMgcHtjb25zdHJ1Y3Rvcih0PW51bGwpe3N1cGVyKCksdGhpcy5wYXRoRm9yQ291bnQ9bnVsbCx0aGlzLm5hbWU9dH1nZXQgY29udGFpbmVyRm9yQ291bnQoKXtyZXR1cm4gbnVsbD09PXRoaXMucGF0aEZvckNvdW50P251bGw6dGhpcy5SZXNvbHZlUGF0aCh0aGlzLnBhdGhGb3JDb3VudCkuY29udGFpbmVyfWdldCBwYXRoU3RyaW5nRm9yQ291bnQoKXtyZXR1cm4gbnVsbD09PXRoaXMucGF0aEZvckNvdW50P251bGw6dGhpcy5Db21wYWN0UGF0aFN0cmluZyh0aGlzLnBhdGhGb3JDb3VudCl9c2V0IHBhdGhTdHJpbmdGb3JDb3VudCh0KXt0aGlzLnBhdGhGb3JDb3VudD1udWxsPT09dD9udWxsOm5ldyBlKHQpfXRvU3RyaW5nKCl7aWYobnVsbCE9dGhpcy5uYW1lKXJldHVyblwidmFyKFwiK3RoaXMubmFtZStcIilcIjtyZXR1cm5cInJlYWRfY291bnQoXCIrdGhpcy5wYXRoU3RyaW5nRm9yQ291bnQrXCIpXCJ9fWNsYXNzIFYgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKHQsZSl7c3VwZXIoKSx0aGlzLnZhcmlhYmxlTmFtZT10fHxudWxsLHRoaXMuaXNOZXdEZWNsYXJhdGlvbj0hIWUsdGhpcy5pc0dsb2JhbD0hMX10b1N0cmluZygpe3JldHVyblwiVmFyQXNzaWduIHRvIFwiK3RoaXMudmFyaWFibGVOYW1lfX1jbGFzcyBMIGV4dGVuZHMgcHt9Y2xhc3MgUiBleHRlbmRzIHB7Y29uc3RydWN0b3IoKXtpZihzdXBlcigpLHRoaXMuX25hbWU9bnVsbCx0aGlzLl9udW1iZXJPZlBhcmFtZXRlcnM9MCx0aGlzLl9wcm90b3R5cGU9bnVsbCx0aGlzLl9pc1Byb3RvdHlwZT0hMSx0aGlzLl9vcGVyYXRpb25GdW5jcz1udWxsLDA9PT1hcmd1bWVudHMubGVuZ3RoKVIuR2VuZXJhdGVOYXRpdmVGdW5jdGlvbnNJZk5lY2Vzc2FyeSgpO2Vsc2UgaWYoMT09PWFyZ3VtZW50cy5sZW5ndGgpe2xldCB0PWFyZ3VtZW50c1swXTtSLkdlbmVyYXRlTmF0aXZlRnVuY3Rpb25zSWZOZWNlc3NhcnkoKSx0aGlzLm5hbWU9dH1lbHNlIGlmKDI9PT1hcmd1bWVudHMubGVuZ3RoKXtsZXQgdD1hcmd1bWVudHNbMF0sZT1hcmd1bWVudHNbMV07dGhpcy5faXNQcm90b3R5cGU9ITAsdGhpcy5uYW1lPXQsdGhpcy5udW1iZXJPZlBhcmFtZXRlcnM9ZX19c3RhdGljIENhbGxXaXRoTmFtZSh0KXtyZXR1cm4gbmV3IFIodCl9c3RhdGljIENhbGxFeGlzdHNXaXRoTmFtZSh0KXtyZXR1cm4gdGhpcy5HZW5lcmF0ZU5hdGl2ZUZ1bmN0aW9uc0lmTmVjZXNzYXJ5KCksdGhpcy5fbmF0aXZlRnVuY3Rpb25zLmdldCh0KX1nZXQgbmFtZSgpe3JldHVybiBudWxsPT09dGhpcy5fbmFtZT9kKFwiTmF0aXZlRnVuY3Rpb25DYWxsLl9uYW1lXCIpOnRoaXMuX25hbWV9c2V0IG5hbWUodCl7dGhpcy5fbmFtZT10LHRoaXMuX2lzUHJvdG90eXBlfHwobnVsbD09PVIuX25hdGl2ZUZ1bmN0aW9ucz9kKFwiTmF0aXZlRnVuY3Rpb25DYWxsLl9uYXRpdmVGdW5jdGlvbnNcIik6dGhpcy5fcHJvdG90eXBlPVIuX25hdGl2ZUZ1bmN0aW9ucy5nZXQodGhpcy5fbmFtZSl8fG51bGwpfWdldCBudW1iZXJPZlBhcmFtZXRlcnMoKXtyZXR1cm4gdGhpcy5fcHJvdG90eXBlP3RoaXMuX3Byb3RvdHlwZS5udW1iZXJPZlBhcmFtZXRlcnM6dGhpcy5fbnVtYmVyT2ZQYXJhbWV0ZXJzfXNldCBudW1iZXJPZlBhcmFtZXRlcnModCl7dGhpcy5fbnVtYmVyT2ZQYXJhbWV0ZXJzPXR9Q2FsbCh0KXtpZih0aGlzLl9wcm90b3R5cGUpcmV0dXJuIHRoaXMuX3Byb3RvdHlwZS5DYWxsKHQpO2lmKHRoaXMubnVtYmVyT2ZQYXJhbWV0ZXJzIT10Lmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIG51bWJlciBvZiBwYXJhbWV0ZXJzXCIpO2xldCBlPSExO2ZvcihsZXQgbiBvZiB0KXtpZihuIGluc3RhbmNlb2YgTCl0aHJvdyBuZXcgUygnQXR0ZW1wdGluZyB0byBwZXJmb3JtIG9wZXJhdGlvbiBvbiBhIHZvaWQgdmFsdWUuIERpZCB5b3UgZm9yZ2V0IHRvIFwicmV0dXJuXCIgYSB2YWx1ZSBmcm9tIGEgZnVuY3Rpb24geW91IGNhbGxlZCBoZXJlPycpO24gaW5zdGFuY2VvZiBPJiYoZT0hMCl9aWYoMj09dC5sZW5ndGgmJmUpcmV0dXJuIHRoaXMuQ2FsbEJpbmFyeUxpc3RPcGVyYXRpb24odCk7bGV0IG49dGhpcy5Db2VyY2VWYWx1ZXNUb1NpbmdsZVR5cGUodCkscj1uWzBdLnZhbHVlVHlwZTtyZXR1cm4gcj09aS5JbnR8fHI9PWkuRmxvYXR8fHI9PWkuU3RyaW5nfHxyPT1pLkRpdmVydFRhcmdldHx8cj09aS5MaXN0P3RoaXMuQ2FsbFR5cGUobik6bnVsbH1DYWxsVHlwZSh0KXtsZXQgZT1zKHRbMF0sdiksbj1lLnZhbHVlVHlwZSxyPWUsYT10Lmxlbmd0aDtpZigyPT1hfHwxPT1hKXtpZihudWxsPT09dGhpcy5fb3BlcmF0aW9uRnVuY3MpcmV0dXJuIGQoXCJOYXRpdmVGdW5jdGlvbkNhbGwuX29wZXJhdGlvbkZ1bmNzXCIpO2xldCBsPXRoaXMuX29wZXJhdGlvbkZ1bmNzLmdldChuKTtpZighbCl7Y29uc3QgdD1pW25dO3Rocm93IG5ldyBTKFwiQ2Fubm90IHBlcmZvcm0gb3BlcmF0aW9uIFwiK3RoaXMubmFtZStcIiBvbiBcIit0KX1pZigyPT1hKXtsZXQgZT1zKHRbMV0sdiksbj1sO2lmKG51bGw9PT1yLnZhbHVlfHxudWxsPT09ZS52YWx1ZSlyZXR1cm4gZChcIk5hdGl2ZUZ1bmN0aW9uQ2FsbC5DYWxsIEJpbmFyeU9wIHZhbHVlc1wiKTtsZXQgaT1uKHIudmFsdWUsZS52YWx1ZSk7cmV0dXJuIHYuQ3JlYXRlKGkpfXtsZXQgdD1sO2lmKG51bGw9PT1yLnZhbHVlKXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLkNhbGwgVW5hcnlPcCB2YWx1ZVwiKTtsZXQgbj10KHIudmFsdWUpO3JldHVybiB0aGlzLm5hbWU9PT1SLkludD92LkNyZWF0ZShuLGkuSW50KTp0aGlzLm5hbWU9PT1SLkZsb2F0P3YuQ3JlYXRlKG4saS5GbG9hdCk6di5DcmVhdGUobixlLnZhbHVlVHlwZSl9fXRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgbnVtYmVyIG9mIHBhcmFtZXRlcnMgdG8gTmF0aXZlRnVuY3Rpb25DYWxsOiBcIit0Lmxlbmd0aCl9Q2FsbEJpbmFyeUxpc3RPcGVyYXRpb24odCl7aWYoKFwiK1wiPT10aGlzLm5hbWV8fFwiLVwiPT10aGlzLm5hbWUpJiZ0WzBdaW5zdGFuY2VvZiBPJiZ0WzFdaW5zdGFuY2VvZiBiKXJldHVybiB0aGlzLkNhbGxMaXN0SW5jcmVtZW50T3BlcmF0aW9uKHQpO2xldCBlPXModFswXSx2KSxuPXModFsxXSx2KTtpZighKFwiJiZcIiE9dGhpcy5uYW1lJiZcInx8XCIhPXRoaXMubmFtZXx8ZS52YWx1ZVR5cGU9PWkuTGlzdCYmbi52YWx1ZVR5cGU9PWkuTGlzdCkpe2lmKG51bGw9PT10aGlzLl9vcGVyYXRpb25GdW5jcylyZXR1cm4gZChcIk5hdGl2ZUZ1bmN0aW9uQ2FsbC5fb3BlcmF0aW9uRnVuY3NcIik7bGV0IHQ9dGhpcy5fb3BlcmF0aW9uRnVuY3MuZ2V0KGkuSW50KTtpZihudWxsPT09dClyZXR1cm4gZChcIk5hdGl2ZUZ1bmN0aW9uQ2FsbC5DYWxsQmluYXJ5TGlzdE9wZXJhdGlvbiBvcFwiKTtsZXQgcj10KGUuaXNUcnV0aHk/MTowLG4uaXNUcnV0aHk/MTowKTtyZXR1cm4gbmV3IGIocil9aWYoZS52YWx1ZVR5cGU9PWkuTGlzdCYmbi52YWx1ZVR5cGU9PWkuTGlzdClyZXR1cm4gdGhpcy5DYWxsVHlwZShbZSxuXSk7dGhyb3cgbmV3IFMoXCJDYW4gbm90IGNhbGwgdXNlIFwiK3RoaXMubmFtZStcIiBvcGVyYXRpb24gb24gXCIraVtlLnZhbHVlVHlwZV0rXCIgYW5kIFwiK2lbbi52YWx1ZVR5cGVdKX1DYWxsTGlzdEluY3JlbWVudE9wZXJhdGlvbih0KXtsZXQgZT1zKHRbMF0sTyksbj1zKHRbMV0sYikscj1uZXcgZztpZihudWxsPT09ZS52YWx1ZSlyZXR1cm4gZChcIk5hdGl2ZUZ1bmN0aW9uQ2FsbC5DYWxsTGlzdEluY3JlbWVudE9wZXJhdGlvbiBsaXN0VmFsLnZhbHVlXCIpO2ZvcihsZXRbdCxhXW9mIGUudmFsdWUpe2xldCBzPWYuZnJvbVNlcmlhbGl6ZWRLZXkodCk7aWYobnVsbD09PXRoaXMuX29wZXJhdGlvbkZ1bmNzKXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLl9vcGVyYXRpb25GdW5jc1wiKTtsZXQgbD10aGlzLl9vcGVyYXRpb25GdW5jcy5nZXQoaS5JbnQpO2lmKG51bGw9PT1uLnZhbHVlKXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLkNhbGxMaXN0SW5jcmVtZW50T3BlcmF0aW9uIGludFZhbC52YWx1ZVwiKTtsZXQgbz1sKGEsbi52YWx1ZSksdT1udWxsO2lmKG51bGw9PT1lLnZhbHVlLm9yaWdpbnMpcmV0dXJuIGQoXCJOYXRpdmVGdW5jdGlvbkNhbGwuQ2FsbExpc3RJbmNyZW1lbnRPcGVyYXRpb24gbGlzdFZhbC52YWx1ZS5vcmlnaW5zXCIpO2ZvcihsZXQgdCBvZiBlLnZhbHVlLm9yaWdpbnMpaWYodC5uYW1lPT1zLm9yaWdpbk5hbWUpe3U9dDticmVha31pZihudWxsIT11KXtsZXQgdD11LlRyeUdldEl0ZW1XaXRoVmFsdWUobyxmLk51bGwpO3QuZXhpc3RzJiZyLkFkZCh0LnJlc3VsdCxvKX19cmV0dXJuIG5ldyBPKHIpfUNvZXJjZVZhbHVlc1RvU2luZ2xlVHlwZSh0KXtsZXQgZT1pLkludCxuPW51bGw7Zm9yKGxldCByIG9mIHQpe2xldCB0PXMocix2KTt0LnZhbHVlVHlwZT5lJiYoZT10LnZhbHVlVHlwZSksdC52YWx1ZVR5cGU9PWkuTGlzdCYmKG49YSh0LE8pKX1sZXQgcj1bXTtpZihpW2VdPT1pW2kuTGlzdF0pZm9yKGxldCBlIG9mIHQpe2xldCB0PXMoZSx2KTtpZih0LnZhbHVlVHlwZT09aS5MaXN0KXIucHVzaCh0KTtlbHNle2lmKHQudmFsdWVUeXBlIT1pLkludCl7Y29uc3QgZT1pW3QudmFsdWVUeXBlXTt0aHJvdyBuZXcgUyhcIkNhbm5vdCBtaXggTGlzdHMgYW5kIFwiK2UrXCIgdmFsdWVzIGluIHRoaXMgb3BlcmF0aW9uXCIpfXtsZXQgZT1wYXJzZUludCh0LnZhbHVlT2JqZWN0KTtpZihuPXMobixPKSxudWxsPT09bi52YWx1ZSlyZXR1cm4gZChcIk5hdGl2ZUZ1bmN0aW9uQ2FsbC5Db2VyY2VWYWx1ZXNUb1NpbmdsZVR5cGUgc3BlY2lhbENhc2VMaXN0LnZhbHVlXCIpO2xldCBpPW4udmFsdWUub3JpZ2luT2ZNYXhJdGVtO2lmKG51bGw9PT1pKXJldHVybiBkKFwiTmF0aXZlRnVuY3Rpb25DYWxsLkNvZXJjZVZhbHVlc1RvU2luZ2xlVHlwZSBsaXN0XCIpO2xldCBhPWkuVHJ5R2V0SXRlbVdpdGhWYWx1ZShlLGYuTnVsbCk7aWYoIWEuZXhpc3RzKXRocm93IG5ldyBTKFwiQ291bGQgbm90IGZpbmQgTGlzdCBpdGVtIHdpdGggdGhlIHZhbHVlIFwiK2UrXCIgaW4gXCIraS5uYW1lKTt7bGV0IHQ9bmV3IE8oYS5yZXN1bHQsZSk7ci5wdXNoKHQpfX19fWVsc2UgZm9yKGxldCBuIG9mIHQpe2xldCB0PXMobix2KS5DYXN0KGUpO3IucHVzaCh0KX1yZXR1cm4gcn1zdGF0aWMgSWRlbnRpdHkodCl7cmV0dXJuIHR9c3RhdGljIEdlbmVyYXRlTmF0aXZlRnVuY3Rpb25zSWZOZWNlc3NhcnkoKXtpZihudWxsPT10aGlzLl9uYXRpdmVGdW5jdGlvbnMpe3RoaXMuX25hdGl2ZUZ1bmN0aW9ucz1uZXcgTWFwLHRoaXMuQWRkSW50QmluYXJ5T3AodGhpcy5BZGQsKHQsZSk9PnQrZSksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLlN1YnRyYWN0LCh0LGUpPT50LWUpLHRoaXMuQWRkSW50QmluYXJ5T3AodGhpcy5NdWx0aXBseSwodCxlKT0+dCplKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuRGl2aWRlLCh0LGUpPT5NYXRoLmZsb29yKHQvZSkpLHRoaXMuQWRkSW50QmluYXJ5T3AodGhpcy5Nb2QsKHQsZSk9PnQlZSksdGhpcy5BZGRJbnRVbmFyeU9wKHRoaXMuTmVnYXRlLHQ9Pi10KSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuRXF1YWwsKHQsZSk9PnQ9PWU/MTowKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuR3JlYXRlciwodCxlKT0+dD5lPzE6MCksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLkxlc3MsKHQsZSk9PnQ8ZT8xOjApLHRoaXMuQWRkSW50QmluYXJ5T3AodGhpcy5HcmVhdGVyVGhhbk9yRXF1YWxzLCh0LGUpPT50Pj1lPzE6MCksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLkxlc3NUaGFuT3JFcXVhbHMsKHQsZSk9PnQ8PWU/MTowKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuTm90RXF1YWxzLCh0LGUpPT50IT1lPzE6MCksdGhpcy5BZGRJbnRVbmFyeU9wKHRoaXMuTm90LHQ9PjA9PXQ/MTowKSx0aGlzLkFkZEludEJpbmFyeU9wKHRoaXMuQW5kLCh0LGUpPT4wIT10JiYwIT1lPzE6MCksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLk9yLCh0LGUpPT4wIT10fHwwIT1lPzE6MCksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLk1heCwodCxlKT0+TWF0aC5tYXgodCxlKSksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLk1pbiwodCxlKT0+TWF0aC5taW4odCxlKSksdGhpcy5BZGRJbnRCaW5hcnlPcCh0aGlzLlBvdywodCxlKT0+TWF0aC5wb3codCxlKSksdGhpcy5BZGRJbnRVbmFyeU9wKHRoaXMuRmxvb3IsUi5JZGVudGl0eSksdGhpcy5BZGRJbnRVbmFyeU9wKHRoaXMuQ2VpbGluZyxSLklkZW50aXR5KSx0aGlzLkFkZEludFVuYXJ5T3AodGhpcy5JbnQsUi5JZGVudGl0eSksdGhpcy5BZGRJbnRVbmFyeU9wKHRoaXMuRmxvYXQsdD0+dCksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuQWRkLCh0LGUpPT50K2UpLHRoaXMuQWRkRmxvYXRCaW5hcnlPcCh0aGlzLlN1YnRyYWN0LCh0LGUpPT50LWUpLHRoaXMuQWRkRmxvYXRCaW5hcnlPcCh0aGlzLk11bHRpcGx5LCh0LGUpPT50KmUpLHRoaXMuQWRkRmxvYXRCaW5hcnlPcCh0aGlzLkRpdmlkZSwodCxlKT0+dC9lKSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5Nb2QsKHQsZSk9PnQlZSksdGhpcy5BZGRGbG9hdFVuYXJ5T3AodGhpcy5OZWdhdGUsdD0+LXQpLHRoaXMuQWRkRmxvYXRCaW5hcnlPcCh0aGlzLkVxdWFsLCh0LGUpPT50PT1lPzE6MCksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuR3JlYXRlciwodCxlKT0+dD5lPzE6MCksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuTGVzcywodCxlKT0+dDxlPzE6MCksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuR3JlYXRlclRoYW5PckVxdWFscywodCxlKT0+dD49ZT8xOjApLHRoaXMuQWRkRmxvYXRCaW5hcnlPcCh0aGlzLkxlc3NUaGFuT3JFcXVhbHMsKHQsZSk9PnQ8PWU/MTowKSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5Ob3RFcXVhbHMsKHQsZSk9PnQhPWU/MTowKSx0aGlzLkFkZEZsb2F0VW5hcnlPcCh0aGlzLk5vdCx0PT4wPT10PzE6MCksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuQW5kLCh0LGUpPT4wIT10JiYwIT1lPzE6MCksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuT3IsKHQsZSk9PjAhPXR8fDAhPWU/MTowKSx0aGlzLkFkZEZsb2F0QmluYXJ5T3AodGhpcy5NYXgsKHQsZSk9Pk1hdGgubWF4KHQsZSkpLHRoaXMuQWRkRmxvYXRCaW5hcnlPcCh0aGlzLk1pbiwodCxlKT0+TWF0aC5taW4odCxlKSksdGhpcy5BZGRGbG9hdEJpbmFyeU9wKHRoaXMuUG93LCh0LGUpPT5NYXRoLnBvdyh0LGUpKSx0aGlzLkFkZEZsb2F0VW5hcnlPcCh0aGlzLkZsb29yLHQ9Pk1hdGguZmxvb3IodCkpLHRoaXMuQWRkRmxvYXRVbmFyeU9wKHRoaXMuQ2VpbGluZyx0PT5NYXRoLmNlaWwodCkpLHRoaXMuQWRkRmxvYXRVbmFyeU9wKHRoaXMuSW50LHQ9Pk1hdGguZmxvb3IodCkpLHRoaXMuQWRkRmxvYXRVbmFyeU9wKHRoaXMuRmxvYXQsUi5JZGVudGl0eSksdGhpcy5BZGRTdHJpbmdCaW5hcnlPcCh0aGlzLkFkZCwodCxlKT0+dCtlKSx0aGlzLkFkZFN0cmluZ0JpbmFyeU9wKHRoaXMuRXF1YWwsKHQsZSk9PnQ9PT1lPzE6MCksdGhpcy5BZGRTdHJpbmdCaW5hcnlPcCh0aGlzLk5vdEVxdWFscywodCxlKT0+dCE9PWU/MTowKSx0aGlzLkFkZFN0cmluZ0JpbmFyeU9wKHRoaXMuSGFzLCh0LGUpPT50LmluY2x1ZGVzKGUpPzE6MCksdGhpcy5BZGRTdHJpbmdCaW5hcnlPcCh0aGlzLkhhc250LCh0LGUpPT50LmluY2x1ZGVzKGUpPzA6MSksdGhpcy5BZGRMaXN0QmluYXJ5T3AodGhpcy5BZGQsKHQsZSk9PnQuVW5pb24oZSkpLHRoaXMuQWRkTGlzdEJpbmFyeU9wKHRoaXMuU3VidHJhY3QsKHQsZSk9PnQuV2l0aG91dChlKSksdGhpcy5BZGRMaXN0QmluYXJ5T3AodGhpcy5IYXMsKHQsZSk9PnQuQ29udGFpbnMoZSk/MTowKSx0aGlzLkFkZExpc3RCaW5hcnlPcCh0aGlzLkhhc250LCh0LGUpPT50LkNvbnRhaW5zKGUpPzA6MSksdGhpcy5BZGRMaXN0QmluYXJ5T3AodGhpcy5JbnRlcnNlY3QsKHQsZSk9PnQuSW50ZXJzZWN0KGUpKSx0aGlzLkFkZExpc3RCaW5hcnlPcCh0aGlzLkVxdWFsLCh0LGUpPT50LkVxdWFscyhlKT8xOjApLHRoaXMuQWRkTGlzdEJpbmFyeU9wKHRoaXMuR3JlYXRlciwodCxlKT0+dC5HcmVhdGVyVGhhbihlKT8xOjApLHRoaXMuQWRkTGlzdEJpbmFyeU9wKHRoaXMuTGVzcywodCxlKT0+dC5MZXNzVGhhbihlKT8xOjApLHRoaXMuQWRkTGlzdEJpbmFyeU9wKHRoaXMuR3JlYXRlclRoYW5PckVxdWFscywodCxlKT0+dC5HcmVhdGVyVGhhbk9yRXF1YWxzKGUpPzE6MCksdGhpcy5BZGRMaXN0QmluYXJ5T3AodGhpcy5MZXNzVGhhbk9yRXF1YWxzLCh0LGUpPT50Lkxlc3NUaGFuT3JFcXVhbHMoZSk/MTowKSx0aGlzLkFkZExpc3RCaW5hcnlPcCh0aGlzLk5vdEVxdWFscywodCxlKT0+dC5FcXVhbHMoZSk/MDoxKSx0aGlzLkFkZExpc3RCaW5hcnlPcCh0aGlzLkFuZCwodCxlKT0+dC5Db3VudD4wJiZlLkNvdW50PjA/MTowKSx0aGlzLkFkZExpc3RCaW5hcnlPcCh0aGlzLk9yLCh0LGUpPT50LkNvdW50PjB8fGUuQ291bnQ+MD8xOjApLHRoaXMuQWRkTGlzdFVuYXJ5T3AodGhpcy5Ob3QsdD0+MD09dC5Db3VudD8xOjApLHRoaXMuQWRkTGlzdFVuYXJ5T3AodGhpcy5JbnZlcnQsdD0+dC5pbnZlcnNlKSx0aGlzLkFkZExpc3RVbmFyeU9wKHRoaXMuQWxsLHQ9PnQuYWxsKSx0aGlzLkFkZExpc3RVbmFyeU9wKHRoaXMuTGlzdE1pbix0PT50Lk1pbkFzTGlzdCgpKSx0aGlzLkFkZExpc3RVbmFyeU9wKHRoaXMuTGlzdE1heCx0PT50Lk1heEFzTGlzdCgpKSx0aGlzLkFkZExpc3RVbmFyeU9wKHRoaXMuQ291bnQsdD0+dC5Db3VudCksdGhpcy5BZGRMaXN0VW5hcnlPcCh0aGlzLlZhbHVlT2ZMaXN0LHQ9PnQubWF4SXRlbS5WYWx1ZSk7bGV0IHQ9KHQsZSk9PnQuRXF1YWxzKGUpPzE6MCxlPSh0LGUpPT50LkVxdWFscyhlKT8wOjE7dGhpcy5BZGRPcFRvTmF0aXZlRnVuYyh0aGlzLkVxdWFsLDIsaS5EaXZlcnRUYXJnZXQsdCksdGhpcy5BZGRPcFRvTmF0aXZlRnVuYyh0aGlzLk5vdEVxdWFscywyLGkuRGl2ZXJ0VGFyZ2V0LGUpfX1BZGRPcEZ1bmNGb3JUeXBlKHQsZSl7bnVsbD09dGhpcy5fb3BlcmF0aW9uRnVuY3MmJih0aGlzLl9vcGVyYXRpb25GdW5jcz1uZXcgTWFwKSx0aGlzLl9vcGVyYXRpb25GdW5jcy5zZXQodCxlKX1zdGF0aWMgQWRkT3BUb05hdGl2ZUZ1bmModCxlLG4saSl7aWYobnVsbD09PXRoaXMuX25hdGl2ZUZ1bmN0aW9ucylyZXR1cm4gZChcIk5hdGl2ZUZ1bmN0aW9uQ2FsbC5fbmF0aXZlRnVuY3Rpb25zXCIpO2xldCByPXRoaXMuX25hdGl2ZUZ1bmN0aW9ucy5nZXQodCk7cnx8KHI9bmV3IFIodCxlKSx0aGlzLl9uYXRpdmVGdW5jdGlvbnMuc2V0KHQscikpLHIuQWRkT3BGdW5jRm9yVHlwZShuLGkpfXN0YXRpYyBBZGRJbnRCaW5hcnlPcCh0LGUpe3RoaXMuQWRkT3BUb05hdGl2ZUZ1bmModCwyLGkuSW50LGUpfXN0YXRpYyBBZGRJbnRVbmFyeU9wKHQsZSl7dGhpcy5BZGRPcFRvTmF0aXZlRnVuYyh0LDEsaS5JbnQsZSl9c3RhdGljIEFkZEZsb2F0QmluYXJ5T3AodCxlKXt0aGlzLkFkZE9wVG9OYXRpdmVGdW5jKHQsMixpLkZsb2F0LGUpfXN0YXRpYyBBZGRGbG9hdFVuYXJ5T3AodCxlKXt0aGlzLkFkZE9wVG9OYXRpdmVGdW5jKHQsMSxpLkZsb2F0LGUpfXN0YXRpYyBBZGRTdHJpbmdCaW5hcnlPcCh0LGUpe3RoaXMuQWRkT3BUb05hdGl2ZUZ1bmModCwyLGkuU3RyaW5nLGUpfXN0YXRpYyBBZGRMaXN0QmluYXJ5T3AodCxlKXt0aGlzLkFkZE9wVG9OYXRpdmVGdW5jKHQsMixpLkxpc3QsZSl9c3RhdGljIEFkZExpc3RVbmFyeU9wKHQsZSl7dGhpcy5BZGRPcFRvTmF0aXZlRnVuYyh0LDEsaS5MaXN0LGUpfXRvU3RyaW5nKCl7cmV0dXJuJ05hdGl2ZSBcIicrdGhpcy5uYW1lKydcIid9fVIuQWRkPVwiK1wiLFIuU3VidHJhY3Q9XCItXCIsUi5EaXZpZGU9XCIvXCIsUi5NdWx0aXBseT1cIipcIixSLk1vZD1cIiVcIixSLk5lZ2F0ZT1cIl9cIixSLkVxdWFsPVwiPT1cIixSLkdyZWF0ZXI9XCI+XCIsUi5MZXNzPVwiPFwiLFIuR3JlYXRlclRoYW5PckVxdWFscz1cIj49XCIsUi5MZXNzVGhhbk9yRXF1YWxzPVwiPD1cIixSLk5vdEVxdWFscz1cIiE9XCIsUi5Ob3Q9XCIhXCIsUi5BbmQ9XCImJlwiLFIuT3I9XCJ8fFwiLFIuTWluPVwiTUlOXCIsUi5NYXg9XCJNQVhcIixSLlBvdz1cIlBPV1wiLFIuRmxvb3I9XCJGTE9PUlwiLFIuQ2VpbGluZz1cIkNFSUxJTkdcIixSLkludD1cIklOVFwiLFIuRmxvYXQ9XCJGTE9BVFwiLFIuSGFzPVwiP1wiLFIuSGFzbnQ9XCIhP1wiLFIuSW50ZXJzZWN0PVwiXlwiLFIuTGlzdE1pbj1cIkxJU1RfTUlOXCIsUi5MaXN0TWF4PVwiTElTVF9NQVhcIixSLkFsbD1cIkxJU1RfQUxMXCIsUi5Db3VudD1cIkxJU1RfQ09VTlRcIixSLlZhbHVlT2ZMaXN0PVwiTElTVF9WQUxVRVwiLFIuSW52ZXJ0PVwiTElTVF9JTlZFUlRcIixSLl9uYXRpdmVGdW5jdGlvbnM9bnVsbDtjbGFzcyBqIGV4dGVuZHMgcHtjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMudGV4dD10LnRvU3RyaW5nKCl8fFwiXCJ9dG9TdHJpbmcoKXtyZXR1cm5cIiMgXCIrdGhpcy50ZXh0fX1jbGFzcyBEIGV4dGVuZHMgcHtjb25zdHJ1Y3Rvcigpe3N1cGVyKC4uLmFyZ3VtZW50cyksdGhpcy50ZXh0PVwiXCIsdGhpcy5pbmRleD0wLHRoaXMudGhyZWFkQXRHZW5lcmF0aW9uPW51bGwsdGhpcy5zb3VyY2VQYXRoPVwiXCIsdGhpcy50YXJnZXRQYXRoPW51bGwsdGhpcy5pc0ludmlzaWJsZURlZmF1bHQ9ITEsdGhpcy5vcmlnaW5hbFRocmVhZEluZGV4PTB9Z2V0IHBhdGhTdHJpbmdPbkNob2ljZSgpe3JldHVybiBudWxsPT09dGhpcy50YXJnZXRQYXRoP2QoXCJDaG9pY2UudGFyZ2V0UGF0aFwiKTp0aGlzLnRhcmdldFBhdGgudG9TdHJpbmcoKX1zZXQgcGF0aFN0cmluZ09uQ2hvaWNlKHQpe3RoaXMudGFyZ2V0UGF0aD1uZXcgZSh0KX19Y2xhc3MgR3tjb25zdHJ1Y3Rvcih0LGUpe3RoaXMuX25hbWU9dHx8XCJcIix0aGlzLl9pdGVtcz1udWxsLHRoaXMuX2l0ZW1OYW1lVG9WYWx1ZXM9ZXx8bmV3IE1hcH1nZXQgbmFtZSgpe3JldHVybiB0aGlzLl9uYW1lfWdldCBpdGVtcygpe2lmKG51bGw9PXRoaXMuX2l0ZW1zKXt0aGlzLl9pdGVtcz1uZXcgTWFwO2ZvcihsZXRbdCxlXW9mIHRoaXMuX2l0ZW1OYW1lVG9WYWx1ZXMpe2xldCBuPW5ldyBmKHRoaXMubmFtZSx0KTt0aGlzLl9pdGVtcy5zZXQobi5zZXJpYWxpemVkKCksZSl9fXJldHVybiB0aGlzLl9pdGVtc31WYWx1ZUZvckl0ZW0odCl7aWYoIXQuaXRlbU5hbWUpcmV0dXJuIDA7bGV0IGU9dGhpcy5faXRlbU5hbWVUb1ZhbHVlcy5nZXQodC5pdGVtTmFtZSk7cmV0dXJuIHZvaWQgMCE9PWU/ZTowfUNvbnRhaW5zSXRlbSh0KXtyZXR1cm4hIXQuaXRlbU5hbWUmJih0Lm9yaWdpbk5hbWU9PXRoaXMubmFtZSYmdGhpcy5faXRlbU5hbWVUb1ZhbHVlcy5oYXModC5pdGVtTmFtZSkpfUNvbnRhaW5zSXRlbVdpdGhOYW1lKHQpe3JldHVybiB0aGlzLl9pdGVtTmFtZVRvVmFsdWVzLmhhcyh0KX1UcnlHZXRJdGVtV2l0aFZhbHVlKHQsZSl7Zm9yKGxldFtlLG5db2YgdGhpcy5faXRlbU5hbWVUb1ZhbHVlcylpZihuPT10KXJldHVybntyZXN1bHQ6bmV3IGYodGhpcy5uYW1lLGUpLGV4aXN0czohMH07cmV0dXJue3Jlc3VsdDpmLk51bGwsZXhpc3RzOiExfX1UcnlHZXRWYWx1ZUZvckl0ZW0odCxlKXtpZighdC5pdGVtTmFtZSlyZXR1cm57cmVzdWx0OjAsZXhpc3RzOiExfTtsZXQgbj10aGlzLl9pdGVtTmFtZVRvVmFsdWVzLmdldCh0Lml0ZW1OYW1lKTtyZXR1cm4gbj97cmVzdWx0Om4sZXhpc3RzOiEwfTp7cmVzdWx0OjAsZXhpc3RzOiExfX19Y2xhc3MgQntjb25zdHJ1Y3Rvcih0KXt0aGlzLl9saXN0cz1uZXcgTWFwLHRoaXMuX2FsbFVuYW1iaWd1b3VzTGlzdFZhbHVlQ2FjaGU9bmV3IE1hcDtmb3IobGV0IGUgb2YgdCl7dGhpcy5fbGlzdHMuc2V0KGUubmFtZSxlKTtmb3IobGV0W3Qsbl1vZiBlLml0ZW1zKXtsZXQgZT1mLmZyb21TZXJpYWxpemVkS2V5KHQpLGk9bmV3IE8oZSxuKTtpZighZS5pdGVtTmFtZSl0aHJvdyBuZXcgRXJyb3IoXCJpdGVtLml0ZW1OYW1lIGlzIG51bGwgb3IgdW5kZWZpbmVkLlwiKTt0aGlzLl9hbGxVbmFtYmlndW91c0xpc3RWYWx1ZUNhY2hlLnNldChlLml0ZW1OYW1lLGkpLHRoaXMuX2FsbFVuYW1iaWd1b3VzTGlzdFZhbHVlQ2FjaGUuc2V0KGUuZnVsbE5hbWUsaSl9fX1nZXQgbGlzdHMoKXtsZXQgdD1bXTtmb3IobGV0WyxlXW9mIHRoaXMuX2xpc3RzKXQucHVzaChlKTtyZXR1cm4gdH1UcnlMaXN0R2V0RGVmaW5pdGlvbih0LGUpe2lmKG51bGw9PT10KXJldHVybntyZXN1bHQ6ZSxleGlzdHM6ITF9O2xldCBuPXRoaXMuX2xpc3RzLmdldCh0KTtyZXR1cm4gbj97cmVzdWx0Om4sZXhpc3RzOiEwfTp7cmVzdWx0OmUsZXhpc3RzOiExfX1GaW5kU2luZ2xlSXRlbUxpc3RXaXRoTmFtZSh0KXtpZihudWxsPT09dClyZXR1cm4gZChcIm5hbWVcIik7bGV0IGU9dGhpcy5fYWxsVW5hbWJpZ3VvdXNMaXN0VmFsdWVDYWNoZS5nZXQodCk7cmV0dXJuIHZvaWQgMCE9PWU/ZTpudWxsfX1jbGFzcyBNe3N0YXRpYyBKQXJyYXlUb1J1bnRpbWVPYmpMaXN0KHQsZT0hMSl7bGV0IG49dC5sZW5ndGg7ZSYmbi0tO2xldCBpPVtdO2ZvcihsZXQgZT0wO2U8bjtlKyspe2xldCBuPXRbZV0scj10aGlzLkpUb2tlblRvUnVudGltZU9iamVjdChuKTtpZihudWxsPT09cilyZXR1cm4gZChcInJ1bnRpbWVPYmpcIik7aS5wdXNoKHIpfXJldHVybiBpfXN0YXRpYyBXcml0ZURpY3Rpb25hcnlSdW50aW1lT2Jqcyh0LGUpe3QuV3JpdGVPYmplY3RTdGFydCgpO2ZvcihsZXRbbixpXW9mIGUpdC5Xcml0ZVByb3BlcnR5U3RhcnQobiksdGhpcy5Xcml0ZVJ1bnRpbWVPYmplY3QodCxpKSx0LldyaXRlUHJvcGVydHlFbmQoKTt0LldyaXRlT2JqZWN0RW5kKCl9c3RhdGljIFdyaXRlTGlzdFJ1bnRpbWVPYmpzKHQsZSl7dC5Xcml0ZUFycmF5U3RhcnQoKTtmb3IobGV0IG4gb2YgZSl0aGlzLldyaXRlUnVudGltZU9iamVjdCh0LG4pO3QuV3JpdGVBcnJheUVuZCgpfXN0YXRpYyBXcml0ZUludERpY3Rpb25hcnkodCxlKXt0LldyaXRlT2JqZWN0U3RhcnQoKTtmb3IobGV0W24saV1vZiBlKXQuV3JpdGVJbnRQcm9wZXJ0eShuLGkpO3QuV3JpdGVPYmplY3RFbmQoKX1zdGF0aWMgV3JpdGVSdW50aW1lT2JqZWN0KHQsZSl7bGV0IG49YShlLE4pO2lmKG4pcmV0dXJuIHZvaWQgdGhpcy5Xcml0ZVJ1bnRpbWVDb250YWluZXIodCxuKTtsZXQgaT1hKGUsayk7aWYoaSl7bGV0IGUsbj1cIi0+XCI7cmV0dXJuIGkuaXNFeHRlcm5hbD9uPVwieCgpXCI6aS5wdXNoZXNUb1N0YWNrJiYoaS5zdGFja1B1c2hUeXBlPT1yLkZ1bmN0aW9uP249XCJmKClcIjppLnN0YWNrUHVzaFR5cGU9PXIuVHVubmVsJiYobj1cIi0+dC0+XCIpKSxlPWkuaGFzVmFyaWFibGVUYXJnZXQ/aS52YXJpYWJsZURpdmVydE5hbWU6aS50YXJnZXRQYXRoU3RyaW5nLHQuV3JpdGVPYmplY3RTdGFydCgpLHQuV3JpdGVQcm9wZXJ0eShuLGUpLGkuaGFzVmFyaWFibGVUYXJnZXQmJnQuV3JpdGVQcm9wZXJ0eShcInZhclwiLCEwKSxpLmlzQ29uZGl0aW9uYWwmJnQuV3JpdGVQcm9wZXJ0eShcImNcIiwhMCksaS5leHRlcm5hbEFyZ3M+MCYmdC5Xcml0ZUludFByb3BlcnR5KFwiZXhBcmdzXCIsaS5leHRlcm5hbEFyZ3MpLHZvaWQgdC5Xcml0ZU9iamVjdEVuZCgpfWxldCBzPWEoZSxXKTtpZihzKXJldHVybiB0LldyaXRlT2JqZWN0U3RhcnQoKSx0LldyaXRlUHJvcGVydHkoXCIqXCIscy5wYXRoU3RyaW5nT25DaG9pY2UpLHQuV3JpdGVJbnRQcm9wZXJ0eShcImZsZ1wiLHMuZmxhZ3MpLHZvaWQgdC5Xcml0ZU9iamVjdEVuZCgpO2xldCBsPWEoZSxiKTtpZihsKXJldHVybiB2b2lkIHQuV3JpdGVJbnQobC52YWx1ZSk7bGV0IG89YShlLF8pO2lmKG8pcmV0dXJuIHZvaWQgdC5Xcml0ZUZsb2F0KG8udmFsdWUpO2xldCB1PWEoZSxUKTtpZih1KXJldHVybiB2b2lkKHUuaXNOZXdsaW5lP3QuV3JpdGUoXCJcXG5cIiwhMSk6KHQuV3JpdGVTdHJpbmdTdGFydCgpLHQuV3JpdGVTdHJpbmdJbm5lcihcIl5cIiksdC5Xcml0ZVN0cmluZ0lubmVyKHUudmFsdWUpLHQuV3JpdGVTdHJpbmdFbmQoKSkpO2xldCBoPWEoZSxPKTtpZihoKXJldHVybiB2b2lkIHRoaXMuV3JpdGVJbmtMaXN0KHQsaCk7bGV0IGM9YShlLFApO2lmKGMpcmV0dXJuIHQuV3JpdGVPYmplY3RTdGFydCgpLG51bGw9PT1jLnZhbHVlP2QoXCJkaXZUYXJnZXRWYWwudmFsdWVcIik6KHQuV3JpdGVQcm9wZXJ0eShcIl4tPlwiLGMudmFsdWUuY29tcG9uZW50c1N0cmluZyksdm9pZCB0LldyaXRlT2JqZWN0RW5kKCkpO2xldCBwPWEoZSx3KTtpZihwKXJldHVybiB0LldyaXRlT2JqZWN0U3RhcnQoKSx0LldyaXRlUHJvcGVydHkoXCJedmFyXCIscC52YWx1ZSksdC5Xcml0ZUludFByb3BlcnR5KFwiY2lcIixwLmNvbnRleHRJbmRleCksdm9pZCB0LldyaXRlT2JqZWN0RW5kKCk7aWYoYShlLHgpKXJldHVybiB2b2lkIHQuV3JpdGUoXCI8PlwiKTtsZXQgbT1hKGUsQSk7aWYobSlyZXR1cm4gdm9pZCB0LldyaXRlKE0uX2NvbnRyb2xDb21tYW5kTmFtZXNbbS5jb21tYW5kVHlwZV0pO2xldCBmPWEoZSxSKTtpZihmKXtsZXQgZT1mLm5hbWU7cmV0dXJuXCJeXCI9PWUmJihlPVwiTF5cIiksdm9pZCB0LldyaXRlKGUpfWxldCBnPWEoZSxGKTtpZihnKXt0LldyaXRlT2JqZWN0U3RhcnQoKTtsZXQgZT1nLnBhdGhTdHJpbmdGb3JDb3VudDtyZXR1cm4gbnVsbCE9ZT90LldyaXRlUHJvcGVydHkoXCJDTlQ/XCIsZSk6dC5Xcml0ZVByb3BlcnR5KFwiVkFSP1wiLGcubmFtZSksdm9pZCB0LldyaXRlT2JqZWN0RW5kKCl9bGV0IFM9YShlLFYpO2lmKFMpe3QuV3JpdGVPYmplY3RTdGFydCgpO2xldCBlPVMuaXNHbG9iYWw/XCJWQVI9XCI6XCJ0ZW1wPVwiO3JldHVybiB0LldyaXRlUHJvcGVydHkoZSxTLnZhcmlhYmxlTmFtZSksUy5pc05ld0RlY2xhcmF0aW9ufHx0LldyaXRlUHJvcGVydHkoXCJyZVwiLCEwKSx2b2lkIHQuV3JpdGVPYmplY3RFbmQoKX1pZihhKGUsTCkpcmV0dXJuIHZvaWQgdC5Xcml0ZShcInZvaWRcIik7bGV0IHk9YShlLGopO2lmKHkpcmV0dXJuIHQuV3JpdGVPYmplY3RTdGFydCgpLHQuV3JpdGVQcm9wZXJ0eShcIiNcIix5LnRleHQpLHZvaWQgdC5Xcml0ZU9iamVjdEVuZCgpO2xldCBDPWEoZSxEKTtpZighQyl0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gY29udmVydCBydW50aW1lIG9iamVjdCB0byBKc29uIHRva2VuOiBcIitlKTt0aGlzLldyaXRlQ2hvaWNlKHQsQyl9c3RhdGljIEpPYmplY3RUb0RpY3Rpb25hcnlSdW50aW1lT2Jqcyh0KXtsZXQgZT1uZXcgTWFwO2ZvcihsZXQgbiBpbiB0KWlmKHQuaGFzT3duUHJvcGVydHkobikpe2xldCBpPXRoaXMuSlRva2VuVG9SdW50aW1lT2JqZWN0KHRbbl0pO2lmKG51bGw9PT1pKXJldHVybiBkKFwiaW5rT2JqZWN0XCIpO2Uuc2V0KG4saSl9cmV0dXJuIGV9c3RhdGljIEpPYmplY3RUb0ludERpY3Rpb25hcnkodCl7bGV0IGU9bmV3IE1hcDtmb3IobGV0IG4gaW4gdCl0Lmhhc093blByb3BlcnR5KG4pJiZlLnNldChuLHBhcnNlSW50KHRbbl0pKTtyZXR1cm4gZX1zdGF0aWMgSlRva2VuVG9SdW50aW1lT2JqZWN0KHQpe2lmKFwibnVtYmVyXCI9PXR5cGVvZiB0JiYhaXNOYU4odCkpcmV0dXJuIHYuQ3JlYXRlKHQpO2lmKFwic3RyaW5nXCI9PXR5cGVvZiB0KXtsZXQgZT10LnRvU3RyaW5nKCksbj1lWzBdO2lmKFwiXlwiPT1uKXJldHVybiBuZXcgVChlLnN1YnN0cmluZygxKSk7aWYoXCJcXG5cIj09biYmMT09ZS5sZW5ndGgpcmV0dXJuIG5ldyBUKFwiXFxuXCIpO2lmKFwiPD5cIj09ZSlyZXR1cm4gbmV3IHg7Zm9yKGxldCB0PTA7dDxNLl9jb250cm9sQ29tbWFuZE5hbWVzLmxlbmd0aDsrK3Qpe2lmKGU9PU0uX2NvbnRyb2xDb21tYW5kTmFtZXNbdF0pcmV0dXJuIG5ldyBBKHQpfWlmKFwiTF5cIj09ZSYmKGU9XCJeXCIpLFIuQ2FsbEV4aXN0c1dpdGhOYW1lKGUpKXJldHVybiBSLkNhbGxXaXRoTmFtZShlKTtpZihcIi0+LT5cIj09ZSlyZXR1cm4gQS5Qb3BUdW5uZWwoKTtpZihcIn5yZXRcIj09ZSlyZXR1cm4gQS5Qb3BGdW5jdGlvbigpO2lmKFwidm9pZFwiPT1lKXJldHVybiBuZXcgTH1pZihcIm9iamVjdFwiPT10eXBlb2YgdCYmIUFycmF5LmlzQXJyYXkodCkpe2xldCBuLGk9dDtpZihpW1wiXi0+XCJdKXJldHVybiBuPWlbXCJeLT5cIl0sbmV3IFAobmV3IGUobi50b1N0cmluZygpKSk7aWYoaVtcIl52YXJcIl0pe249aVtcIl52YXJcIl07bGV0IHQ9bmV3IHcobi50b1N0cmluZygpKTtyZXR1cm5cImNpXCJpbiBpJiYobj1pLmNpLHQuY29udGV4dEluZGV4PXBhcnNlSW50KG4pKSx0fWxldCBhPSExLHM9ITEsbD1yLkZ1bmN0aW9uLG89ITE7aWYoKG49aVtcIi0+XCJdKT9hPSEwOihuPWlbXCJmKClcIl0pPyhhPSEwLHM9ITAsbD1yLkZ1bmN0aW9uKToobj1pW1wiLT50LT5cIl0pPyhhPSEwLHM9ITAsbD1yLlR1bm5lbCk6KG49aVtcIngoKVwiXSkmJihhPSEwLG89ITAscz0hMSxsPXIuRnVuY3Rpb24pLGEpe2xldCB0PW5ldyBrO3QucHVzaGVzVG9TdGFjaz1zLHQuc3RhY2tQdXNoVHlwZT1sLHQuaXNFeHRlcm5hbD1vO2xldCBlPW4udG9TdHJpbmcoKTtyZXR1cm4obj1pLnZhcik/dC52YXJpYWJsZURpdmVydE5hbWU9ZTp0LnRhcmdldFBhdGhTdHJpbmc9ZSx0LmlzQ29uZGl0aW9uYWw9ISFpLmMsbyYmKG49aS5leEFyZ3MpJiYodC5leHRlcm5hbEFyZ3M9cGFyc2VJbnQobikpLHR9aWYobj1pW1wiKlwiXSl7bGV0IHQ9bmV3IFc7cmV0dXJuIHQucGF0aFN0cmluZ09uQ2hvaWNlPW4udG9TdHJpbmcoKSwobj1pLmZsZykmJih0LmZsYWdzPXBhcnNlSW50KG4pKSx0fWlmKG49aVtcIlZBUj9cIl0pcmV0dXJuIG5ldyBGKG4udG9TdHJpbmcoKSk7aWYobj1pW1wiQ05UP1wiXSl7bGV0IHQ9bmV3IEY7cmV0dXJuIHQucGF0aFN0cmluZ0ZvckNvdW50PW4udG9TdHJpbmcoKSx0fWxldCB1PSExLGg9ITE7aWYoKG49aVtcIlZBUj1cIl0pPyh1PSEwLGg9ITApOihuPWlbXCJ0ZW1wPVwiXSkmJih1PSEwLGg9ITEpLHUpe2xldCB0PW4udG9TdHJpbmcoKSxlPSFpLnJlLHI9bmV3IFYodCxlKTtyZXR1cm4gci5pc0dsb2JhbD1oLHJ9aWYodm9pZCAwIT09aVtcIiNcIl0pcmV0dXJuIG49aVtcIiNcIl0sbmV3IGoobi50b1N0cmluZygpKTtpZihuPWkubGlzdCl7bGV0IHQ9bixlPW5ldyBnO2lmKG49aS5vcmlnaW5zKXtsZXQgdD1uO2UuU2V0SW5pdGlhbE9yaWdpbk5hbWVzKHQpfWZvcihsZXQgbiBpbiB0KWlmKHQuaGFzT3duUHJvcGVydHkobikpe2xldCBpPXRbbl0scj1uZXcgZihuKSxhPXBhcnNlSW50KGkpO2UuQWRkKHIsYSl9cmV0dXJuIG5ldyBPKGUpfWlmKG51bGwhPWkub3JpZ2luYWxDaG9pY2VQYXRoKXJldHVybiB0aGlzLkpPYmplY3RUb0Nob2ljZShpKX1pZihBcnJheS5pc0FycmF5KHQpKXJldHVybiB0aGlzLkpBcnJheVRvQ29udGFpbmVyKHQpO2lmKG51bGw9PXQpcmV0dXJuIG51bGw7dGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGNvbnZlcnQgdG9rZW4gdG8gcnVudGltZSBvYmplY3Q6IFwiK0pTT04uc3RyaW5naWZ5KHQpKX1zdGF0aWMgV3JpdGVSdW50aW1lQ29udGFpbmVyKHQsZSxuPSExKXtpZih0LldyaXRlQXJyYXlTdGFydCgpLG51bGw9PT1lKXJldHVybiBkKFwiY29udGFpbmVyXCIpO2ZvcihsZXQgbiBvZiBlLmNvbnRlbnQpdGhpcy5Xcml0ZVJ1bnRpbWVPYmplY3QodCxuKTtsZXQgaT1lLm5hbWVkT25seUNvbnRlbnQscj1lLmNvdW50RmxhZ3Mscz1udWxsIT1lLm5hbWUmJiFuLGw9bnVsbCE9aXx8cj4wfHxzO2lmKGwmJnQuV3JpdGVPYmplY3RTdGFydCgpLG51bGwhPWkpZm9yKGxldFtlLG5db2YgaSl7bGV0IGk9ZSxyPWEobixOKTt0LldyaXRlUHJvcGVydHlTdGFydChpKSx0aGlzLldyaXRlUnVudGltZUNvbnRhaW5lcih0LHIsITApLHQuV3JpdGVQcm9wZXJ0eUVuZCgpfXMmJnQuV3JpdGVQcm9wZXJ0eShcIiNuXCIsZS5uYW1lKSxsP3QuV3JpdGVPYmplY3RFbmQoKTp0LldyaXRlTnVsbCgpLHQuV3JpdGVBcnJheUVuZCgpfXN0YXRpYyBKQXJyYXlUb0NvbnRhaW5lcih0KXtsZXQgZT1uZXcgTjtlLmNvbnRlbnQ9dGhpcy5KQXJyYXlUb1J1bnRpbWVPYmpMaXN0KHQsITApO2xldCBuPXRbdC5sZW5ndGgtMV07aWYobnVsbCE9bil7bGV0IHQ9bmV3IE1hcDtmb3IobGV0IGkgaW4gbilpZihcIiNmXCI9PWkpZS5jb3VudEZsYWdzPXBhcnNlSW50KG5baV0pO2Vsc2UgaWYoXCIjblwiPT1pKWUubmFtZT1uW2ldLnRvU3RyaW5nKCk7ZWxzZXtsZXQgZT10aGlzLkpUb2tlblRvUnVudGltZU9iamVjdChuW2ldKSxyPWEoZSxOKTtyJiYoci5uYW1lPWkpLHQuc2V0KGksZSl9ZS5uYW1lZE9ubHlDb250ZW50PXR9cmV0dXJuIGV9c3RhdGljIEpPYmplY3RUb0Nob2ljZSh0KXtsZXQgZT1uZXcgRDtyZXR1cm4gZS50ZXh0PXQudGV4dC50b1N0cmluZygpLGUuaW5kZXg9cGFyc2VJbnQodC5pbmRleCksZS5zb3VyY2VQYXRoPXQub3JpZ2luYWxDaG9pY2VQYXRoLnRvU3RyaW5nKCksZS5vcmlnaW5hbFRocmVhZEluZGV4PXBhcnNlSW50KHQub3JpZ2luYWxUaHJlYWRJbmRleCksZS5wYXRoU3RyaW5nT25DaG9pY2U9dC50YXJnZXRQYXRoLnRvU3RyaW5nKCksZX1zdGF0aWMgV3JpdGVDaG9pY2UodCxlKXt0LldyaXRlT2JqZWN0U3RhcnQoKSx0LldyaXRlUHJvcGVydHkoXCJ0ZXh0XCIsZS50ZXh0KSx0LldyaXRlSW50UHJvcGVydHkoXCJpbmRleFwiLGUuaW5kZXgpLHQuV3JpdGVQcm9wZXJ0eShcIm9yaWdpbmFsQ2hvaWNlUGF0aFwiLGUuc291cmNlUGF0aCksdC5Xcml0ZUludFByb3BlcnR5KFwib3JpZ2luYWxUaHJlYWRJbmRleFwiLGUub3JpZ2luYWxUaHJlYWRJbmRleCksdC5Xcml0ZVByb3BlcnR5KFwidGFyZ2V0UGF0aFwiLGUucGF0aFN0cmluZ09uQ2hvaWNlKSx0LldyaXRlT2JqZWN0RW5kKCl9c3RhdGljIFdyaXRlSW5rTGlzdCh0LGUpe2xldCBuPWUudmFsdWU7aWYobnVsbD09PW4pcmV0dXJuIGQoXCJyYXdMaXN0XCIpO3QuV3JpdGVPYmplY3RTdGFydCgpLHQuV3JpdGVQcm9wZXJ0eVN0YXJ0KFwibGlzdFwiKSx0LldyaXRlT2JqZWN0U3RhcnQoKTtmb3IobGV0W2UsaV1vZiBuKXtsZXQgbj1mLmZyb21TZXJpYWxpemVkS2V5KGUpLHI9aTtpZihudWxsPT09bi5pdGVtTmFtZSlyZXR1cm4gZChcIml0ZW0uaXRlbU5hbWVcIik7dC5Xcml0ZVByb3BlcnR5TmFtZVN0YXJ0KCksdC5Xcml0ZVByb3BlcnR5TmFtZUlubmVyKG4ub3JpZ2luTmFtZT9uLm9yaWdpbk5hbWU6XCI/XCIpLHQuV3JpdGVQcm9wZXJ0eU5hbWVJbm5lcihcIi5cIiksdC5Xcml0ZVByb3BlcnR5TmFtZUlubmVyKG4uaXRlbU5hbWUpLHQuV3JpdGVQcm9wZXJ0eU5hbWVFbmQoKSx0LldyaXRlKHIpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpfWlmKHQuV3JpdGVPYmplY3RFbmQoKSx0LldyaXRlUHJvcGVydHlFbmQoKSwwPT1uLkNvdW50JiZudWxsIT1uLm9yaWdpbk5hbWVzJiZuLm9yaWdpbk5hbWVzLmxlbmd0aD4wKXt0LldyaXRlUHJvcGVydHlTdGFydChcIm9yaWdpbnNcIiksdC5Xcml0ZUFycmF5U3RhcnQoKTtmb3IobGV0IGUgb2Ygbi5vcmlnaW5OYW1lcyl0LldyaXRlKGUpO3QuV3JpdGVBcnJheUVuZCgpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpfXQuV3JpdGVPYmplY3RFbmQoKX1zdGF0aWMgTGlzdERlZmluaXRpb25zVG9KVG9rZW4odCl7bGV0IGU9e307Zm9yKGxldCBuIG9mIHQubGlzdHMpe2xldCB0PXt9O2ZvcihsZXRbZSxpXW9mIG4uaXRlbXMpe2xldCBuPWYuZnJvbVNlcmlhbGl6ZWRLZXkoZSk7aWYobnVsbD09PW4uaXRlbU5hbWUpcmV0dXJuIGQoXCJpdGVtLml0ZW1OYW1lXCIpO3Rbbi5pdGVtTmFtZV09aX1lW24ubmFtZV09dH1yZXR1cm4gZX1zdGF0aWMgSlRva2VuVG9MaXN0RGVmaW5pdGlvbnModCl7bGV0IGU9dCxuPVtdO2ZvcihsZXQgdCBpbiBlKWlmKGUuaGFzT3duUHJvcGVydHkodCkpe2xldCBpPXQudG9TdHJpbmcoKSxyPWVbdF0sYT1uZXcgTWFwO2ZvcihsZXQgbiBpbiByKWlmKGUuaGFzT3duUHJvcGVydHkodCkpe2xldCB0PXJbbl07YS5zZXQobixwYXJzZUludCh0KSl9bGV0IHM9bmV3IEcoaSxhKTtuLnB1c2gocyl9cmV0dXJuIG5ldyBCKG4pfX1NLl9jb250cm9sQ29tbWFuZE5hbWVzPSgoKT0+e2xldCB0PVtdO3RbQS5Db21tYW5kVHlwZS5FdmFsU3RhcnRdPVwiZXZcIix0W0EuQ29tbWFuZFR5cGUuRXZhbE91dHB1dF09XCJvdXRcIix0W0EuQ29tbWFuZFR5cGUuRXZhbEVuZF09XCIvZXZcIix0W0EuQ29tbWFuZFR5cGUuRHVwbGljYXRlXT1cImR1XCIsdFtBLkNvbW1hbmRUeXBlLlBvcEV2YWx1YXRlZFZhbHVlXT1cInBvcFwiLHRbQS5Db21tYW5kVHlwZS5Qb3BGdW5jdGlvbl09XCJ+cmV0XCIsdFtBLkNvbW1hbmRUeXBlLlBvcFR1bm5lbF09XCItPi0+XCIsdFtBLkNvbW1hbmRUeXBlLkJlZ2luU3RyaW5nXT1cInN0clwiLHRbQS5Db21tYW5kVHlwZS5FbmRTdHJpbmddPVwiL3N0clwiLHRbQS5Db21tYW5kVHlwZS5Ob09wXT1cIm5vcFwiLHRbQS5Db21tYW5kVHlwZS5DaG9pY2VDb3VudF09XCJjaG9pY2VDbnRcIix0W0EuQ29tbWFuZFR5cGUuVHVybnNdPVwidHVyblwiLHRbQS5Db21tYW5kVHlwZS5UdXJuc1NpbmNlXT1cInR1cm5zXCIsdFtBLkNvbW1hbmRUeXBlLlJlYWRDb3VudF09XCJyZWFkY1wiLHRbQS5Db21tYW5kVHlwZS5SYW5kb21dPVwicm5kXCIsdFtBLkNvbW1hbmRUeXBlLlNlZWRSYW5kb21dPVwic3JuZFwiLHRbQS5Db21tYW5kVHlwZS5WaXNpdEluZGV4XT1cInZpc2l0XCIsdFtBLkNvbW1hbmRUeXBlLlNlcXVlbmNlU2h1ZmZsZUluZGV4XT1cInNlcVwiLHRbQS5Db21tYW5kVHlwZS5TdGFydFRocmVhZF09XCJ0aHJlYWRcIix0W0EuQ29tbWFuZFR5cGUuRG9uZV09XCJkb25lXCIsdFtBLkNvbW1hbmRUeXBlLkVuZF09XCJlbmRcIix0W0EuQ29tbWFuZFR5cGUuTGlzdEZyb21JbnRdPVwibGlzdEludFwiLHRbQS5Db21tYW5kVHlwZS5MaXN0UmFuZ2VdPVwicmFuZ2VcIix0W0EuQ29tbWFuZFR5cGUuTGlzdFJhbmRvbV09XCJscm5kXCI7Zm9yKGxldCBlPTA7ZTxBLkNvbW1hbmRUeXBlLlRPVEFMX1ZBTFVFUzsrK2UpaWYobnVsbD09dFtlXSl0aHJvdyBuZXcgRXJyb3IoXCJDb250cm9sIGNvbW1hbmQgbm90IGFjY291bnRlZCBmb3IgaW4gc2VyaWFsaXNhdGlvblwiKTtyZXR1cm4gdH0pKCk7Y2xhc3MgcXtjb25zdHJ1Y3Rvcigpe2lmKHRoaXMuX3RocmVhZENvdW50ZXI9MCx0aGlzLl9zdGFydE9mUm9vdD1JLk51bGwsYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBYKXtsZXQgdD1hcmd1bWVudHNbMF07dGhpcy5fc3RhcnRPZlJvb3Q9SS5TdGFydE9mKHQucm9vdENvbnRlbnRDb250YWluZXIpLHRoaXMuUmVzZXQoKX1lbHNle2xldCB0PWFyZ3VtZW50c1swXTt0aGlzLl90aHJlYWRzPVtdO2ZvcihsZXQgZSBvZiB0Ll90aHJlYWRzKXRoaXMuX3RocmVhZHMucHVzaChlLkNvcHkoKSk7dGhpcy5fdGhyZWFkQ291bnRlcj10Ll90aHJlYWRDb3VudGVyLHRoaXMuX3N0YXJ0T2ZSb290PXQuX3N0YXJ0T2ZSb290fX1nZXQgZWxlbWVudHMoKXtyZXR1cm4gdGhpcy5jYWxsU3RhY2t9Z2V0IGRlcHRoKCl7cmV0dXJuIHRoaXMuZWxlbWVudHMubGVuZ3RofWdldCBjdXJyZW50RWxlbWVudCgpe2xldCB0PXRoaXMuX3RocmVhZHNbdGhpcy5fdGhyZWFkcy5sZW5ndGgtMV0uY2FsbHN0YWNrO3JldHVybiB0W3QubGVuZ3RoLTFdfWdldCBjdXJyZW50RWxlbWVudEluZGV4KCl7cmV0dXJuIHRoaXMuY2FsbFN0YWNrLmxlbmd0aC0xfWdldCBjdXJyZW50VGhyZWFkKCl7cmV0dXJuIHRoaXMuX3RocmVhZHNbdGhpcy5fdGhyZWFkcy5sZW5ndGgtMV19c2V0IGN1cnJlbnRUaHJlYWQodCl7bi5Bc3NlcnQoMT09dGhpcy5fdGhyZWFkcy5sZW5ndGgsXCJTaG91bGRuJ3QgYmUgZGlyZWN0bHkgc2V0dGluZyB0aGUgY3VycmVudCB0aHJlYWQgd2hlbiB3ZSBoYXZlIGEgc3RhY2sgb2YgdGhlbVwiKSx0aGlzLl90aHJlYWRzLmxlbmd0aD0wLHRoaXMuX3RocmVhZHMucHVzaCh0KX1nZXQgY2FuUG9wKCl7cmV0dXJuIHRoaXMuY2FsbFN0YWNrLmxlbmd0aD4xfVJlc2V0KCl7dGhpcy5fdGhyZWFkcz1bXSx0aGlzLl90aHJlYWRzLnB1c2gobmV3IHEuVGhyZWFkKSx0aGlzLl90aHJlYWRzWzBdLmNhbGxzdGFjay5wdXNoKG5ldyBxLkVsZW1lbnQoci5UdW5uZWwsdGhpcy5fc3RhcnRPZlJvb3QpKX1TZXRKc29uVG9rZW4odCxlKXt0aGlzLl90aHJlYWRzLmxlbmd0aD0wO2xldCBuPXQudGhyZWFkcztmb3IobGV0IHQgb2Ygbil7bGV0IG49dCxpPW5ldyBxLlRocmVhZChuLGUpO3RoaXMuX3RocmVhZHMucHVzaChpKX10aGlzLl90aHJlYWRDb3VudGVyPXBhcnNlSW50KHQudGhyZWFkQ291bnRlciksdGhpcy5fc3RhcnRPZlJvb3Q9SS5TdGFydE9mKGUucm9vdENvbnRlbnRDb250YWluZXIpfVdyaXRlSnNvbih0KXt0LldyaXRlT2JqZWN0KHQ9Pnt0LldyaXRlUHJvcGVydHlTdGFydChcInRocmVhZHNcIiksdC5Xcml0ZUFycmF5U3RhcnQoKTtmb3IobGV0IGUgb2YgdGhpcy5fdGhyZWFkcyllLldyaXRlSnNvbih0KTt0LldyaXRlQXJyYXlFbmQoKSx0LldyaXRlUHJvcGVydHlFbmQoKSx0LldyaXRlUHJvcGVydHlTdGFydChcInRocmVhZENvdW50ZXJcIiksdC5Xcml0ZUludCh0aGlzLl90aHJlYWRDb3VudGVyKSx0LldyaXRlUHJvcGVydHlFbmQoKX0pfVB1c2hUaHJlYWQoKXtsZXQgdD10aGlzLmN1cnJlbnRUaHJlYWQuQ29weSgpO3RoaXMuX3RocmVhZENvdW50ZXIrKyx0LnRocmVhZEluZGV4PXRoaXMuX3RocmVhZENvdW50ZXIsdGhpcy5fdGhyZWFkcy5wdXNoKHQpfUZvcmtUaHJlYWQoKXtsZXQgdD10aGlzLmN1cnJlbnRUaHJlYWQuQ29weSgpO3JldHVybiB0aGlzLl90aHJlYWRDb3VudGVyKyssdC50aHJlYWRJbmRleD10aGlzLl90aHJlYWRDb3VudGVyLHR9UG9wVGhyZWFkKCl7aWYoIXRoaXMuY2FuUG9wVGhyZWFkKXRocm93IG5ldyBFcnJvcihcIkNhbid0IHBvcCB0aHJlYWRcIik7dGhpcy5fdGhyZWFkcy5zcGxpY2UodGhpcy5fdGhyZWFkcy5pbmRleE9mKHRoaXMuY3VycmVudFRocmVhZCksMSl9Z2V0IGNhblBvcFRocmVhZCgpe3JldHVybiB0aGlzLl90aHJlYWRzLmxlbmd0aD4xJiYhdGhpcy5lbGVtZW50SXNFdmFsdWF0ZUZyb21HYW1lfWdldCBlbGVtZW50SXNFdmFsdWF0ZUZyb21HYW1lKCl7cmV0dXJuIHRoaXMuY3VycmVudEVsZW1lbnQudHlwZT09ci5GdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZX1QdXNoKHQsZT0wLG49MCl7bGV0IGk9bmV3IHEuRWxlbWVudCh0LHRoaXMuY3VycmVudEVsZW1lbnQuY3VycmVudFBvaW50ZXIsITEpO2kuZXZhbHVhdGlvblN0YWNrSGVpZ2h0V2hlblB1c2hlZD1lLGkuZnVuY3Rpb25TdGFydEluT3V0cHV0U3RyZWFtPW4sdGhpcy5jYWxsU3RhY2sucHVzaChpKX1DYW5Qb3AodD1udWxsKXtyZXR1cm4hIXRoaXMuY2FuUG9wJiYobnVsbD09dHx8dGhpcy5jdXJyZW50RWxlbWVudC50eXBlPT10KX1Qb3AodD1udWxsKXtpZighdGhpcy5DYW5Qb3AodCkpdGhyb3cgbmV3IEVycm9yKFwiTWlzbWF0Y2hlZCBwdXNoL3BvcCBpbiBDYWxsc3RhY2tcIik7dGhpcy5jYWxsU3RhY2sucG9wKCl9R2V0VGVtcG9yYXJ5VmFyaWFibGVXaXRoTmFtZSh0LGU9LTEpey0xPT1lJiYoZT10aGlzLmN1cnJlbnRFbGVtZW50SW5kZXgrMSk7bGV0IG49eSh0aGlzLmNhbGxTdGFja1tlLTFdLnRlbXBvcmFyeVZhcmlhYmxlcyx0LG51bGwpO3JldHVybiBuLmV4aXN0cz9uLnJlc3VsdDpudWxsfVNldFRlbXBvcmFyeVZhcmlhYmxlKHQsZSxuLGk9LTEpey0xPT1pJiYoaT10aGlzLmN1cnJlbnRFbGVtZW50SW5kZXgrMSk7bGV0IHI9dGhpcy5jYWxsU3RhY2tbaS0xXTtpZighbiYmIXIudGVtcG9yYXJ5VmFyaWFibGVzLmdldCh0KSl0aHJvdyBuZXcgUyhcIkNvdWxkIG5vdCBmaW5kIHRlbXBvcmFyeSB2YXJpYWJsZSB0byBzZXQ6IFwiK3QpO2xldCBhPXkoci50ZW1wb3JhcnlWYXJpYWJsZXMsdCxudWxsKTthLmV4aXN0cyYmTy5SZXRhaW5MaXN0T3JpZ2luc0ZvckFzc2lnbm1lbnQoYS5yZXN1bHQsZSksci50ZW1wb3JhcnlWYXJpYWJsZXMuc2V0KHQsZSl9Q29udGV4dEZvclZhcmlhYmxlTmFtZWQodCl7cmV0dXJuIHRoaXMuY3VycmVudEVsZW1lbnQudGVtcG9yYXJ5VmFyaWFibGVzLmdldCh0KT90aGlzLmN1cnJlbnRFbGVtZW50SW5kZXgrMTowfVRocmVhZFdpdGhJbmRleCh0KXtsZXQgZT10aGlzLl90aHJlYWRzLmZpbHRlcihlPT57aWYoZS50aHJlYWRJbmRleD09dClyZXR1cm4gZX0pO3JldHVybiBlLmxlbmd0aD4wP2VbMF06bnVsbH1nZXQgY2FsbFN0YWNrKCl7cmV0dXJuIHRoaXMuY3VycmVudFRocmVhZC5jYWxsc3RhY2t9Z2V0IGNhbGxTdGFja1RyYWNlKCl7bGV0IHQ9bmV3IG07Zm9yKGxldCBlPTA7ZTx0aGlzLl90aHJlYWRzLmxlbmd0aDtlKyspe2xldCBuPXRoaXMuX3RocmVhZHNbZV0saT1lPT10aGlzLl90aHJlYWRzLmxlbmd0aC0xO3QuQXBwZW5kRm9ybWF0KFwiPT09IFRIUkVBRCB7MH0vezF9IHsyfT09PVxcblwiLGUrMSx0aGlzLl90aHJlYWRzLmxlbmd0aCxpP1wiKGN1cnJlbnQpIFwiOlwiXCIpO2ZvcihsZXQgZT0wO2U8bi5jYWxsc3RhY2subGVuZ3RoO2UrKyl7bi5jYWxsc3RhY2tbZV0udHlwZT09ci5GdW5jdGlvbj90LkFwcGVuZChcIiAgW0ZVTkNUSU9OXSBcIik6dC5BcHBlbmQoXCIgIFtUVU5ORUxdIFwiKTtsZXQgaT1uLmNhbGxzdGFja1tlXS5jdXJyZW50UG9pbnRlcjtpZighaS5pc051bGwpe2lmKHQuQXBwZW5kKFwiPFNPTUVXSEVSRSBJTiBcIiksbnVsbD09PWkuY29udGFpbmVyKXJldHVybiBkKFwicG9pbnRlci5jb250YWluZXJcIik7dC5BcHBlbmQoaS5jb250YWluZXIucGF0aC50b1N0cmluZygpKSx0LkFwcGVuZExpbmUoXCI+XCIpfX19cmV0dXJuIHQudG9TdHJpbmcoKX19IWZ1bmN0aW9uKHQpe2NsYXNzIG57Y29uc3RydWN0b3IodCxlLG49ITEpe3RoaXMuZXZhbHVhdGlvblN0YWNrSGVpZ2h0V2hlblB1c2hlZD0wLHRoaXMuZnVuY3Rpb25TdGFydEluT3V0cHV0U3RyZWFtPTAsdGhpcy5jdXJyZW50UG9pbnRlcj1lLmNvcHkoKSx0aGlzLmluRXhwcmVzc2lvbkV2YWx1YXRpb249bix0aGlzLnRlbXBvcmFyeVZhcmlhYmxlcz1uZXcgTWFwLHRoaXMudHlwZT10fUNvcHkoKXtsZXQgdD1uZXcgbih0aGlzLnR5cGUsdGhpcy5jdXJyZW50UG9pbnRlcix0aGlzLmluRXhwcmVzc2lvbkV2YWx1YXRpb24pO3JldHVybiB0LnRlbXBvcmFyeVZhcmlhYmxlcz1uZXcgTWFwKHRoaXMudGVtcG9yYXJ5VmFyaWFibGVzKSx0LmV2YWx1YXRpb25TdGFja0hlaWdodFdoZW5QdXNoZWQ9dGhpcy5ldmFsdWF0aW9uU3RhY2tIZWlnaHRXaGVuUHVzaGVkLHQuZnVuY3Rpb25TdGFydEluT3V0cHV0U3RyZWFtPXRoaXMuZnVuY3Rpb25TdGFydEluT3V0cHV0U3RyZWFtLHR9fXQuRWxlbWVudD1uO2NsYXNzIGl7Y29uc3RydWN0b3IoKXtpZih0aGlzLnRocmVhZEluZGV4PTAsdGhpcy5wcmV2aW91c1BvaW50ZXI9SS5OdWxsLHRoaXMuY2FsbHN0YWNrPVtdLGFyZ3VtZW50c1swXSYmYXJndW1lbnRzWzFdKXtsZXQgdD1hcmd1bWVudHNbMF0saT1hcmd1bWVudHNbMV07dGhpcy50aHJlYWRJbmRleD1wYXJzZUludCh0LnRocmVhZEluZGV4KTtsZXQgcj10LmNhbGxzdGFjaztmb3IobGV0IHQgb2Ygcil7bGV0IHIsYT10LHM9cGFyc2VJbnQoYS50eXBlKSxsPUkuTnVsbCxvPWEuY1BhdGg7aWYodm9pZCAwIT09byl7cj1vLnRvU3RyaW5nKCk7bGV0IHQ9aS5Db250ZW50QXRQYXRoKG5ldyBlKHIpKTtpZihsLmNvbnRhaW5lcj10LmNvbnRhaW5lcixsLmluZGV4PXBhcnNlSW50KGEuaWR4KSxudWxsPT10Lm9iail0aHJvdyBuZXcgRXJyb3IoXCJXaGVuIGxvYWRpbmcgc3RhdGUsIGludGVybmFsIHN0b3J5IGxvY2F0aW9uIGNvdWxkbid0IGJlIGZvdW5kOiBcIityK1wiLiBIYXMgdGhlIHN0b3J5IGNoYW5nZWQgc2luY2UgdGhpcyBzYXZlIGRhdGEgd2FzIGNyZWF0ZWQ/XCIpO2lmKHQuYXBwcm94aW1hdGUpe2lmKG51bGw9PT1sLmNvbnRhaW5lcilyZXR1cm4gZChcInBvaW50ZXIuY29udGFpbmVyXCIpO2kuV2FybmluZyhcIldoZW4gbG9hZGluZyBzdGF0ZSwgZXhhY3QgaW50ZXJuYWwgc3RvcnkgbG9jYXRpb24gY291bGRuJ3QgYmUgZm91bmQ6ICdcIityK1wiJywgc28gaXQgd2FzIGFwcHJveGltYXRlZCB0byAnXCIrbC5jb250YWluZXIucGF0aC50b1N0cmluZygpK1wiJyB0byByZWNvdmVyLiBIYXMgdGhlIHN0b3J5IGNoYW5nZWQgc2luY2UgdGhpcyBzYXZlIGRhdGEgd2FzIGNyZWF0ZWQ/XCIpfX1sZXQgdT0hIWEuZXhwLGg9bmV3IG4ocyxsLHUpLGM9YS50ZW1wO3ZvaWQgMCE9PWM/aC50ZW1wb3JhcnlWYXJpYWJsZXM9TS5KT2JqZWN0VG9EaWN0aW9uYXJ5UnVudGltZU9ianMoYyk6aC50ZW1wb3JhcnlWYXJpYWJsZXMuY2xlYXIoKSx0aGlzLmNhbGxzdGFjay5wdXNoKGgpfWxldCBhPXQucHJldmlvdXNDb250ZW50T2JqZWN0O2lmKHZvaWQgMCE9PWEpe2xldCB0PW5ldyBlKGEudG9TdHJpbmcoKSk7dGhpcy5wcmV2aW91c1BvaW50ZXI9aS5Qb2ludGVyQXRQYXRoKHQpfX19Q29weSgpe2xldCB0PW5ldyBpO3QudGhyZWFkSW5kZXg9dGhpcy50aHJlYWRJbmRleDtmb3IobGV0IGUgb2YgdGhpcy5jYWxsc3RhY2spdC5jYWxsc3RhY2sucHVzaChlLkNvcHkoKSk7cmV0dXJuIHQucHJldmlvdXNQb2ludGVyPXRoaXMucHJldmlvdXNQb2ludGVyLmNvcHkoKSx0fVdyaXRlSnNvbih0KXt0LldyaXRlT2JqZWN0U3RhcnQoKSx0LldyaXRlUHJvcGVydHlTdGFydChcImNhbGxzdGFja1wiKSx0LldyaXRlQXJyYXlTdGFydCgpO2ZvcihsZXQgZSBvZiB0aGlzLmNhbGxzdGFjayl7aWYodC5Xcml0ZU9iamVjdFN0YXJ0KCksIWUuY3VycmVudFBvaW50ZXIuaXNOdWxsKXtpZihudWxsPT09ZS5jdXJyZW50UG9pbnRlci5jb250YWluZXIpcmV0dXJuIGQoXCJlbC5jdXJyZW50UG9pbnRlci5jb250YWluZXJcIik7dC5Xcml0ZVByb3BlcnR5KFwiY1BhdGhcIixlLmN1cnJlbnRQb2ludGVyLmNvbnRhaW5lci5wYXRoLmNvbXBvbmVudHNTdHJpbmcpLHQuV3JpdGVJbnRQcm9wZXJ0eShcImlkeFwiLGUuY3VycmVudFBvaW50ZXIuaW5kZXgpfXQuV3JpdGVQcm9wZXJ0eShcImV4cFwiLGUuaW5FeHByZXNzaW9uRXZhbHVhdGlvbiksdC5Xcml0ZUludFByb3BlcnR5KFwidHlwZVwiLGUudHlwZSksZS50ZW1wb3JhcnlWYXJpYWJsZXMuc2l6ZT4wJiYodC5Xcml0ZVByb3BlcnR5U3RhcnQoXCJ0ZW1wXCIpLE0uV3JpdGVEaWN0aW9uYXJ5UnVudGltZU9ianModCxlLnRlbXBvcmFyeVZhcmlhYmxlcyksdC5Xcml0ZVByb3BlcnR5RW5kKCkpLHQuV3JpdGVPYmplY3RFbmQoKX1pZih0LldyaXRlQXJyYXlFbmQoKSx0LldyaXRlUHJvcGVydHlFbmQoKSx0LldyaXRlSW50UHJvcGVydHkoXCJ0aHJlYWRJbmRleFwiLHRoaXMudGhyZWFkSW5kZXgpLCF0aGlzLnByZXZpb3VzUG9pbnRlci5pc051bGwpe2xldCBlPXRoaXMucHJldmlvdXNQb2ludGVyLlJlc29sdmUoKTtpZihudWxsPT09ZSlyZXR1cm4gZChcInRoaXMucHJldmlvdXNQb2ludGVyLlJlc29sdmUoKVwiKTt0LldyaXRlUHJvcGVydHkoXCJwcmV2aW91c0NvbnRlbnRPYmplY3RcIixlLnBhdGgudG9TdHJpbmcoKSl9dC5Xcml0ZU9iamVjdEVuZCgpfX10LlRocmVhZD1pfShxfHwocT17fSkpO2NsYXNzIEp7Y29uc3RydWN0b3IodCxlKXt0aGlzLnZhcmlhYmxlQ2hhbmdlZEV2ZW50Q2FsbGJhY2tzPVtdLHRoaXMucGF0Y2g9bnVsbCx0aGlzLl9iYXRjaE9ic2VydmluZ1ZhcmlhYmxlQ2hhbmdlcz0hMSx0aGlzLl9kZWZhdWx0R2xvYmFsVmFyaWFibGVzPW5ldyBNYXAsdGhpcy5fY2hhbmdlZFZhcmlhYmxlc0ZvckJhdGNoT2JzPW5ldyBTZXQsdGhpcy5fZ2xvYmFsVmFyaWFibGVzPW5ldyBNYXAsdGhpcy5fY2FsbFN0YWNrPXQsdGhpcy5fbGlzdERlZnNPcmlnaW49ZTt0cnl7cmV0dXJuIG5ldyBQcm94eSh0aGlzLHtnZXQ6KHQsZSk9PmUgaW4gdD90W2VdOnQuJChlKSxzZXQ6KHQsZSxuKT0+KGUgaW4gdD90W2VdPW46dC4kKGUsbiksITApfSl9Y2F0Y2godCl7fX12YXJpYWJsZUNoYW5nZWRFdmVudCh0LGUpe2ZvcihsZXQgbiBvZiB0aGlzLnZhcmlhYmxlQ2hhbmdlZEV2ZW50Q2FsbGJhY2tzKW4odCxlKX1nZXQgYmF0Y2hPYnNlcnZpbmdWYXJpYWJsZUNoYW5nZXMoKXtyZXR1cm4gdGhpcy5fYmF0Y2hPYnNlcnZpbmdWYXJpYWJsZUNoYW5nZXN9c2V0IGJhdGNoT2JzZXJ2aW5nVmFyaWFibGVDaGFuZ2VzKHQpe2lmKHRoaXMuX2JhdGNoT2JzZXJ2aW5nVmFyaWFibGVDaGFuZ2VzPXQsdCl0aGlzLl9jaGFuZ2VkVmFyaWFibGVzRm9yQmF0Y2hPYnM9bmV3IFNldDtlbHNlIGlmKG51bGwhPXRoaXMuX2NoYW5nZWRWYXJpYWJsZXNGb3JCYXRjaE9icyl7Zm9yKGxldCB0IG9mIHRoaXMuX2NoYW5nZWRWYXJpYWJsZXNGb3JCYXRjaE9icyl7bGV0IGU9dGhpcy5fZ2xvYmFsVmFyaWFibGVzLmdldCh0KTtlP3RoaXMudmFyaWFibGVDaGFuZ2VkRXZlbnQodCxlKTpkKFwiY3VycmVudFZhbHVlXCIpfXRoaXMuX2NoYW5nZWRWYXJpYWJsZXNGb3JCYXRjaE9icz1udWxsfX1nZXQgY2FsbFN0YWNrKCl7cmV0dXJuIHRoaXMuX2NhbGxTdGFja31zZXQgY2FsbFN0YWNrKHQpe3RoaXMuX2NhbGxTdGFjaz10fSQodCxlKXtpZih2b2lkIDA9PT1lKXtsZXQgZT1udWxsO3JldHVybiBudWxsIT09dGhpcy5wYXRjaCYmKGU9dGhpcy5wYXRjaC5UcnlHZXRHbG9iYWwodCxudWxsKSxlLmV4aXN0cyk/ZS5yZXN1bHQudmFsdWVPYmplY3Q6KGU9dGhpcy5fZ2xvYmFsVmFyaWFibGVzLmdldCh0KSx2b2lkIDA9PT1lJiYoZT10aGlzLl9kZWZhdWx0R2xvYmFsVmFyaWFibGVzLmdldCh0KSksdm9pZCAwIT09ZT9lLnZhbHVlT2JqZWN0Om51bGwpfXtpZih2b2lkIDA9PT10aGlzLl9kZWZhdWx0R2xvYmFsVmFyaWFibGVzLmdldCh0KSl0aHJvdyBuZXcgUyhcIkNhbm5vdCBhc3NpZ24gdG8gYSB2YXJpYWJsZSAoXCIrdCtcIikgdGhhdCBoYXNuJ3QgYmVlbiBkZWNsYXJlZCBpbiB0aGUgc3RvcnlcIik7bGV0IG49di5DcmVhdGUoZSk7aWYobnVsbD09bil0aHJvdyBuZXcgUyhudWxsPT1lP1wiQ2Fubm90IHBhc3MgbnVsbCB0byBWYXJpYWJsZVN0YXRlXCI6XCJJbnZhbGlkIHZhbHVlIHBhc3NlZCB0byBWYXJpYWJsZVN0YXRlOiBcIitlLnRvU3RyaW5nKCkpO3RoaXMuU2V0R2xvYmFsKHQsbil9fUFwcGx5UGF0Y2goKXtpZihudWxsPT09dGhpcy5wYXRjaClyZXR1cm4gZChcInRoaXMucGF0Y2hcIik7Zm9yKGxldFt0LGVdb2YgdGhpcy5wYXRjaC5nbG9iYWxzKXRoaXMuX2dsb2JhbFZhcmlhYmxlcy5zZXQodCxlKTtpZihudWxsIT09dGhpcy5fY2hhbmdlZFZhcmlhYmxlc0ZvckJhdGNoT2JzKWZvcihsZXQgdCBvZiB0aGlzLnBhdGNoLmNoYW5nZWRWYXJpYWJsZXMpdGhpcy5fY2hhbmdlZFZhcmlhYmxlc0ZvckJhdGNoT2JzLmFkZCh0KTt0aGlzLnBhdGNoPW51bGx9U2V0SnNvblRva2VuKHQpe3RoaXMuX2dsb2JhbFZhcmlhYmxlcy5jbGVhcigpO2ZvcihsZXRbZSxuXW9mIHRoaXMuX2RlZmF1bHRHbG9iYWxWYXJpYWJsZXMpe2xldCBpPXRbZV07aWYodm9pZCAwIT09aSl7bGV0IHQ9TS5KVG9rZW5Ub1J1bnRpbWVPYmplY3QoaSk7aWYobnVsbD09PXQpcmV0dXJuIGQoXCJ0b2tlbklua09iamVjdFwiKTt0aGlzLl9nbG9iYWxWYXJpYWJsZXMuc2V0KGUsdCl9ZWxzZSB0aGlzLl9nbG9iYWxWYXJpYWJsZXMuc2V0KGUsbil9fVdyaXRlSnNvbih0KXt0LldyaXRlT2JqZWN0U3RhcnQoKTtmb3IobGV0W2Usbl1vZiB0aGlzLl9nbG9iYWxWYXJpYWJsZXMpe2xldCBpPWUscj1uO2lmKEouZG9udFNhdmVEZWZhdWx0VmFsdWVzJiZ0aGlzLl9kZWZhdWx0R2xvYmFsVmFyaWFibGVzLmhhcyhpKSl7bGV0IHQ9dGhpcy5fZGVmYXVsdEdsb2JhbFZhcmlhYmxlcy5nZXQoaSk7aWYodGhpcy5SdW50aW1lT2JqZWN0c0VxdWFsKHIsdCkpY29udGludWV9dC5Xcml0ZVByb3BlcnR5U3RhcnQoaSksTS5Xcml0ZVJ1bnRpbWVPYmplY3QodCxyKSx0LldyaXRlUHJvcGVydHlFbmQoKX10LldyaXRlT2JqZWN0RW5kKCl9UnVudGltZU9iamVjdHNFcXVhbCh0LGUpe2lmKG51bGw9PT10KXJldHVybiBkKFwib2JqMVwiKTtpZihudWxsPT09ZSlyZXR1cm4gZChcIm9iajJcIik7aWYodC5jb25zdHJ1Y3RvciE9PWUuY29uc3RydWN0b3IpcmV0dXJuITE7bGV0IG49YSh0LGIpO2lmKG51bGwhPT1uKXJldHVybiBuLnZhbHVlPT09cyhlLGIpLnZhbHVlO2xldCBpPWEodCxfKTtpZihudWxsIT09aSlyZXR1cm4gaS52YWx1ZT09PXMoZSxfKS52YWx1ZTtsZXQgcj1hKHQsdiksbD1hKGUsdik7aWYobnVsbCE9PXImJm51bGwhPT1sKXJldHVybiB1KHIudmFsdWVPYmplY3QpJiZ1KGwudmFsdWVPYmplY3QpP3IudmFsdWVPYmplY3QuRXF1YWxzKGwudmFsdWVPYmplY3QpOnIudmFsdWVPYmplY3Q9PT1sLnZhbHVlT2JqZWN0O3Rocm93IG5ldyBFcnJvcihcIkZhc3RSb3VnaERlZmluaXRlbHlFcXVhbHM6IFVuc3VwcG9ydGVkIHJ1bnRpbWUgb2JqZWN0IHR5cGU6IFwiK3QuY29uc3RydWN0b3IubmFtZSl9R2V0VmFyaWFibGVXaXRoTmFtZSh0LGU9LTEpe2xldCBuPXRoaXMuR2V0UmF3VmFyaWFibGVXaXRoTmFtZSh0LGUpLGk9YShuLHcpO3JldHVybiBudWxsIT09aSYmKG49dGhpcy5WYWx1ZUF0VmFyaWFibGVQb2ludGVyKGkpKSxufVRyeUdldERlZmF1bHRWYXJpYWJsZVZhbHVlKHQpe2xldCBlPXkodGhpcy5fZGVmYXVsdEdsb2JhbFZhcmlhYmxlcyx0LG51bGwpO3JldHVybiBlLmV4aXN0cz9lLnJlc3VsdDpudWxsfUdsb2JhbFZhcmlhYmxlRXhpc3RzV2l0aE5hbWUodCl7cmV0dXJuIHRoaXMuX2dsb2JhbFZhcmlhYmxlcy5oYXModCl8fG51bGwhPT10aGlzLl9kZWZhdWx0R2xvYmFsVmFyaWFibGVzJiZ0aGlzLl9kZWZhdWx0R2xvYmFsVmFyaWFibGVzLmhhcyh0KX1HZXRSYXdWYXJpYWJsZVdpdGhOYW1lKHQsZSl7bGV0IG49bnVsbDtpZigwPT1lfHwtMT09ZSl7bGV0IGU9bnVsbDtpZihudWxsIT09dGhpcy5wYXRjaCYmKGU9dGhpcy5wYXRjaC5UcnlHZXRHbG9iYWwodCxudWxsKSxlLmV4aXN0cykpcmV0dXJuIGUucmVzdWx0O2lmKGU9eSh0aGlzLl9nbG9iYWxWYXJpYWJsZXMsdCxudWxsKSxlLmV4aXN0cylyZXR1cm4gZS5yZXN1bHQ7aWYobnVsbCE9PXRoaXMuX2RlZmF1bHRHbG9iYWxWYXJpYWJsZXMmJihlPXkodGhpcy5fZGVmYXVsdEdsb2JhbFZhcmlhYmxlcyx0LG51bGwpLGUuZXhpc3RzKSlyZXR1cm4gZS5yZXN1bHQ7aWYobnVsbD09PXRoaXMuX2xpc3REZWZzT3JpZ2luKXJldHVybiBkKFwiVmFyaWFibGVzU3RhdGUuX2xpc3REZWZzT3JpZ2luXCIpO2xldCBuPXRoaXMuX2xpc3REZWZzT3JpZ2luLkZpbmRTaW5nbGVJdGVtTGlzdFdpdGhOYW1lKHQpO2lmKG4pcmV0dXJuIG59cmV0dXJuIG49dGhpcy5fY2FsbFN0YWNrLkdldFRlbXBvcmFyeVZhcmlhYmxlV2l0aE5hbWUodCxlKSxufVZhbHVlQXRWYXJpYWJsZVBvaW50ZXIodCl7cmV0dXJuIHRoaXMuR2V0VmFyaWFibGVXaXRoTmFtZSh0LnZhcmlhYmxlTmFtZSx0LmNvbnRleHRJbmRleCl9QXNzaWduKHQsZSl7bGV0IG49dC52YXJpYWJsZU5hbWU7aWYobnVsbD09PW4pcmV0dXJuIGQoXCJuYW1lXCIpO2xldCBpPS0xLHI9ITE7aWYocj10LmlzTmV3RGVjbGFyYXRpb24/dC5pc0dsb2JhbDp0aGlzLkdsb2JhbFZhcmlhYmxlRXhpc3RzV2l0aE5hbWUobiksdC5pc05ld0RlY2xhcmF0aW9uKXtsZXQgdD1hKGUsdyk7aWYobnVsbCE9PXQpe2U9dGhpcy5SZXNvbHZlVmFyaWFibGVQb2ludGVyKHQpfX1lbHNle2xldCB0PW51bGw7ZG97dD1hKHRoaXMuR2V0UmF3VmFyaWFibGVXaXRoTmFtZShuLGkpLHcpLG51bGwhPXQmJihuPXQudmFyaWFibGVOYW1lLGk9dC5jb250ZXh0SW5kZXgscj0wPT1pKX13aGlsZShudWxsIT10KX1yP3RoaXMuU2V0R2xvYmFsKG4sZSk6dGhpcy5fY2FsbFN0YWNrLlNldFRlbXBvcmFyeVZhcmlhYmxlKG4sZSx0LmlzTmV3RGVjbGFyYXRpb24saSl9U25hcHNob3REZWZhdWx0R2xvYmFscygpe3RoaXMuX2RlZmF1bHRHbG9iYWxWYXJpYWJsZXM9bmV3IE1hcCh0aGlzLl9nbG9iYWxWYXJpYWJsZXMpfVJldGFpbkxpc3RPcmlnaW5zRm9yQXNzaWdubWVudCh0LGUpe2xldCBuPXModCxPKSxpPXMoZSxPKTtuLnZhbHVlJiZpLnZhbHVlJiYwPT1pLnZhbHVlLkNvdW50JiZpLnZhbHVlLlNldEluaXRpYWxPcmlnaW5OYW1lcyhuLnZhbHVlLm9yaWdpbk5hbWVzKX1TZXRHbG9iYWwodCxlKXtsZXQgbj1udWxsO2lmKG51bGw9PT10aGlzLnBhdGNoJiYobj15KHRoaXMuX2dsb2JhbFZhcmlhYmxlcyx0LG51bGwpKSxudWxsIT09dGhpcy5wYXRjaCYmKG49dGhpcy5wYXRjaC5UcnlHZXRHbG9iYWwodCxudWxsKSxuLmV4aXN0c3x8KG49eSh0aGlzLl9nbG9iYWxWYXJpYWJsZXMsdCxudWxsKSkpLE8uUmV0YWluTGlzdE9yaWdpbnNGb3JBc3NpZ25tZW50KG4ucmVzdWx0LGUpLG51bGw9PT10KXJldHVybiBkKFwidmFyaWFibGVOYW1lXCIpO2lmKG51bGwhPT10aGlzLnBhdGNoP3RoaXMucGF0Y2guU2V0R2xvYmFsKHQsZSk6dGhpcy5fZ2xvYmFsVmFyaWFibGVzLnNldCh0LGUpLG51bGwhPT10aGlzLnZhcmlhYmxlQ2hhbmdlZEV2ZW50JiZudWxsIT09biYmZSE9PW4ucmVzdWx0KWlmKHRoaXMuYmF0Y2hPYnNlcnZpbmdWYXJpYWJsZUNoYW5nZXMpe2lmKG51bGw9PT10aGlzLl9jaGFuZ2VkVmFyaWFibGVzRm9yQmF0Y2hPYnMpcmV0dXJuIGQoXCJ0aGlzLl9jaGFuZ2VkVmFyaWFibGVzRm9yQmF0Y2hPYnNcIik7bnVsbCE9PXRoaXMucGF0Y2g/dGhpcy5wYXRjaC5BZGRDaGFuZ2VkVmFyaWFibGUodCk6bnVsbCE9PXRoaXMuX2NoYW5nZWRWYXJpYWJsZXNGb3JCYXRjaE9icyYmdGhpcy5fY2hhbmdlZFZhcmlhYmxlc0ZvckJhdGNoT2JzLmFkZCh0KX1lbHNlIHRoaXMudmFyaWFibGVDaGFuZ2VkRXZlbnQodCxlKX1SZXNvbHZlVmFyaWFibGVQb2ludGVyKHQpe2xldCBlPXQuY29udGV4dEluZGV4Oy0xPT1lJiYoZT10aGlzLkdldENvbnRleHRJbmRleE9mVmFyaWFibGVOYW1lZCh0LnZhcmlhYmxlTmFtZSkpO2xldCBuPWEodGhpcy5HZXRSYXdWYXJpYWJsZVdpdGhOYW1lKHQudmFyaWFibGVOYW1lLGUpLHcpO3JldHVybiBudWxsIT1uP246bmV3IHcodC52YXJpYWJsZU5hbWUsZSl9R2V0Q29udGV4dEluZGV4T2ZWYXJpYWJsZU5hbWVkKHQpe3JldHVybiB0aGlzLkdsb2JhbFZhcmlhYmxlRXhpc3RzV2l0aE5hbWUodCk/MDp0aGlzLl9jYWxsU3RhY2suY3VycmVudEVsZW1lbnRJbmRleH1PYnNlcnZlVmFyaWFibGVDaGFuZ2UodCl7dGhpcy52YXJpYWJsZUNoYW5nZWRFdmVudENhbGxiYWNrcy5wdXNoKHQpfX1KLmRvbnRTYXZlRGVmYXVsdFZhbHVlcz0hMDtjbGFzcyBLe2NvbnN0cnVjdG9yKHQpe3RoaXMuc2VlZD10JTIxNDc0ODM2NDcsdGhpcy5zZWVkPD0wJiYodGhpcy5zZWVkKz0yMTQ3NDgzNjQ2KX1uZXh0KCl7cmV0dXJuIHRoaXMuc2VlZD0xNjgwNyp0aGlzLnNlZWQlMjE0NzQ4MzY0N31uZXh0RmxvYXQoKXtyZXR1cm4odGhpcy5uZXh0KCktMSkvMjE0NzQ4MzY0Nn19Y2xhc3MgVXtjb25zdHJ1Y3Rvcigpe2lmKHRoaXMuX2NoYW5nZWRWYXJpYWJsZXM9bmV3IFNldCx0aGlzLl92aXNpdENvdW50cz1uZXcgTWFwLHRoaXMuX3R1cm5JbmRpY2VzPW5ldyBNYXAsMT09PWFyZ3VtZW50cy5sZW5ndGgmJm51bGwhPT1hcmd1bWVudHNbMF0pe2xldCB0PWFyZ3VtZW50c1swXTt0aGlzLl9nbG9iYWxzPW5ldyBNYXAodC5fZ2xvYmFscyksdGhpcy5fY2hhbmdlZFZhcmlhYmxlcz1uZXcgU2V0KHQuX2NoYW5nZWRWYXJpYWJsZXMpLHRoaXMuX3Zpc2l0Q291bnRzPW5ldyBNYXAodC5fdmlzaXRDb3VudHMpLHRoaXMuX3R1cm5JbmRpY2VzPW5ldyBNYXAodC5fdHVybkluZGljZXMpfWVsc2UgdGhpcy5fZ2xvYmFscz1uZXcgTWFwLHRoaXMuX2NoYW5nZWRWYXJpYWJsZXM9bmV3IFNldCx0aGlzLl92aXNpdENvdW50cz1uZXcgTWFwLHRoaXMuX3R1cm5JbmRpY2VzPW5ldyBNYXB9Z2V0IGdsb2JhbHMoKXtyZXR1cm4gdGhpcy5fZ2xvYmFsc31nZXQgY2hhbmdlZFZhcmlhYmxlcygpe3JldHVybiB0aGlzLl9jaGFuZ2VkVmFyaWFibGVzfWdldCB2aXNpdENvdW50cygpe3JldHVybiB0aGlzLl92aXNpdENvdW50c31nZXQgdHVybkluZGljZXMoKXtyZXR1cm4gdGhpcy5fdHVybkluZGljZXN9VHJ5R2V0R2xvYmFsKHQsZSl7cmV0dXJuIG51bGwhPT10JiZ0aGlzLl9nbG9iYWxzLmhhcyh0KT97cmVzdWx0OnRoaXMuX2dsb2JhbHMuZ2V0KHQpLGV4aXN0czohMH06e3Jlc3VsdDplLGV4aXN0czohMX19U2V0R2xvYmFsKHQsZSl7dGhpcy5fZ2xvYmFscy5zZXQodCxlKX1BZGRDaGFuZ2VkVmFyaWFibGUodCl7cmV0dXJuIHRoaXMuX2NoYW5nZWRWYXJpYWJsZXMuYWRkKHQpfVRyeUdldFZpc2l0Q291bnQodCxlKXtyZXR1cm4gdGhpcy5fdmlzaXRDb3VudHMuaGFzKHQpP3tyZXN1bHQ6dGhpcy5fdmlzaXRDb3VudHMuZ2V0KHQpLGV4aXN0czohMH06e3Jlc3VsdDplLGV4aXN0czohMX19U2V0VmlzaXRDb3VudCh0LGUpe3RoaXMuX3Zpc2l0Q291bnRzLnNldCh0LGUpfVNldFR1cm5JbmRleCh0LGUpe3RoaXMuX3R1cm5JbmRpY2VzLnNldCh0LGUpfVRyeUdldFR1cm5JbmRleCh0LGUpe3JldHVybiB0aGlzLl90dXJuSW5kaWNlcy5oYXModCk/e3Jlc3VsdDp0aGlzLl90dXJuSW5kaWNlcy5nZXQodCksZXhpc3RzOiEwfTp7cmVzdWx0OmUsZXhpc3RzOiExfX19Y2xhc3MgentzdGF0aWMgVGV4dFRvRGljdGlvbmFyeSh0KXtyZXR1cm4gbmV3IHouUmVhZGVyKHQpLlRvRGljdGlvbmFyeSgpfXN0YXRpYyBUZXh0VG9BcnJheSh0KXtyZXR1cm4gbmV3IHouUmVhZGVyKHQpLlRvQXJyYXkoKX19IWZ1bmN0aW9uKHQpe3QuUmVhZGVyPWNsYXNze2NvbnN0cnVjdG9yKHQpe3RoaXMuX3Jvb3RPYmplY3Q9SlNPTi5wYXJzZSh0KX1Ub0RpY3Rpb25hcnkoKXtyZXR1cm4gdGhpcy5fcm9vdE9iamVjdH1Ub0FycmF5KCl7cmV0dXJuIHRoaXMuX3Jvb3RPYmplY3R9fTtjbGFzcyBle2NvbnN0cnVjdG9yKCl7dGhpcy5fY3VycmVudFByb3BlcnR5TmFtZT1udWxsLHRoaXMuX2N1cnJlbnRTdHJpbmc9bnVsbCx0aGlzLl9zdGF0ZVN0YWNrPVtdLHRoaXMuX2NvbGxlY3Rpb25TdGFjaz1bXSx0aGlzLl9wcm9wZXJ0eU5hbWVTdGFjaz1bXSx0aGlzLl9qc29uT2JqZWN0PW51bGx9V3JpdGVPYmplY3QodCl7dGhpcy5Xcml0ZU9iamVjdFN0YXJ0KCksdCh0aGlzKSx0aGlzLldyaXRlT2JqZWN0RW5kKCl9V3JpdGVPYmplY3RTdGFydCgpe3RoaXMuU3RhcnROZXdPYmplY3QoITApO2xldCBlPXt9O2lmKHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5Qcm9wZXJ0eSl7dGhpcy5Bc3NlcnQobnVsbCE9PXRoaXMuY3VycmVudENvbGxlY3Rpb24pLHRoaXMuQXNzZXJ0KG51bGwhPT10aGlzLmN1cnJlbnRQcm9wZXJ0eU5hbWUpO2xldCB0PXRoaXMuX3Byb3BlcnR5TmFtZVN0YWNrLnBvcCgpO3RoaXMuY3VycmVudENvbGxlY3Rpb25bdF09ZSx0aGlzLl9jb2xsZWN0aW9uU3RhY2sucHVzaChlKX1lbHNlIHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5BcnJheT8odGhpcy5Bc3NlcnQobnVsbCE9PXRoaXMuY3VycmVudENvbGxlY3Rpb24pLHRoaXMuY3VycmVudENvbGxlY3Rpb24ucHVzaChlKSx0aGlzLl9jb2xsZWN0aW9uU3RhY2sucHVzaChlKSk6KHRoaXMuQXNzZXJ0KHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5Ob25lKSx0aGlzLl9qc29uT2JqZWN0PWUsdGhpcy5fY29sbGVjdGlvblN0YWNrLnB1c2goZSkpO3RoaXMuX3N0YXRlU3RhY2sucHVzaChuZXcgdC5Xcml0ZXIuU3RhdGVFbGVtZW50KHQuV3JpdGVyLlN0YXRlLk9iamVjdCkpfVdyaXRlT2JqZWN0RW5kKCl7dGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLk9iamVjdCksdGhpcy5fY29sbGVjdGlvblN0YWNrLnBvcCgpLHRoaXMuX3N0YXRlU3RhY2sucG9wKCl9V3JpdGVQcm9wZXJ0eSh0LGUpe2lmKHRoaXMuV3JpdGVQcm9wZXJ0eVN0YXJ0KHQpLGFyZ3VtZW50c1sxXWluc3RhbmNlb2YgRnVuY3Rpb24peygwLGFyZ3VtZW50c1sxXSkodGhpcyl9ZWxzZXtsZXQgdD1hcmd1bWVudHNbMV07dGhpcy5Xcml0ZSh0KX10aGlzLldyaXRlUHJvcGVydHlFbmQoKX1Xcml0ZUludFByb3BlcnR5KHQsZSl7dGhpcy5Xcml0ZVByb3BlcnR5U3RhcnQodCksdGhpcy5Xcml0ZUludChlKSx0aGlzLldyaXRlUHJvcGVydHlFbmQoKX1Xcml0ZUZsb2F0UHJvcGVydHkodCxlKXt0aGlzLldyaXRlUHJvcGVydHlTdGFydCh0KSx0aGlzLldyaXRlRmxvYXQoZSksdGhpcy5Xcml0ZVByb3BlcnR5RW5kKCl9V3JpdGVQcm9wZXJ0eVN0YXJ0KGUpe3RoaXMuQXNzZXJ0KHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5PYmplY3QpLHRoaXMuX3Byb3BlcnR5TmFtZVN0YWNrLnB1c2goZSksdGhpcy5JbmNyZW1lbnRDaGlsZENvdW50KCksdGhpcy5fc3RhdGVTdGFjay5wdXNoKG5ldyB0LldyaXRlci5TdGF0ZUVsZW1lbnQodC5Xcml0ZXIuU3RhdGUuUHJvcGVydHkpKX1Xcml0ZVByb3BlcnR5RW5kKCl7dGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLlByb3BlcnR5KSx0aGlzLkFzc2VydCgxPT09dGhpcy5jaGlsZENvdW50KSx0aGlzLl9zdGF0ZVN0YWNrLnBvcCgpfVdyaXRlUHJvcGVydHlOYW1lU3RhcnQoKXt0aGlzLkFzc2VydCh0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuT2JqZWN0KSx0aGlzLkluY3JlbWVudENoaWxkQ291bnQoKSx0aGlzLl9jdXJyZW50UHJvcGVydHlOYW1lPVwiXCIsdGhpcy5fc3RhdGVTdGFjay5wdXNoKG5ldyB0LldyaXRlci5TdGF0ZUVsZW1lbnQodC5Xcml0ZXIuU3RhdGUuUHJvcGVydHkpKSx0aGlzLl9zdGF0ZVN0YWNrLnB1c2gobmV3IHQuV3JpdGVyLlN0YXRlRWxlbWVudCh0LldyaXRlci5TdGF0ZS5Qcm9wZXJ0eU5hbWUpKX1Xcml0ZVByb3BlcnR5TmFtZUVuZCgpe3RoaXMuQXNzZXJ0KHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5Qcm9wZXJ0eU5hbWUpLHRoaXMuQXNzZXJ0KG51bGwhPT10aGlzLl9jdXJyZW50UHJvcGVydHlOYW1lKSx0aGlzLl9wcm9wZXJ0eU5hbWVTdGFjay5wdXNoKHRoaXMuX2N1cnJlbnRQcm9wZXJ0eU5hbWUpLHRoaXMuX2N1cnJlbnRQcm9wZXJ0eU5hbWU9bnVsbCx0aGlzLl9zdGF0ZVN0YWNrLnBvcCgpfVdyaXRlUHJvcGVydHlOYW1lSW5uZXIoZSl7dGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLlByb3BlcnR5TmFtZSksdGhpcy5Bc3NlcnQobnVsbCE9PXRoaXMuX2N1cnJlbnRQcm9wZXJ0eU5hbWUpLHRoaXMuX2N1cnJlbnRQcm9wZXJ0eU5hbWUrPWV9V3JpdGVBcnJheVN0YXJ0KCl7dGhpcy5TdGFydE5ld09iamVjdCghMCk7bGV0IGU9W107aWYodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLlByb3BlcnR5KXt0aGlzLkFzc2VydChudWxsIT09dGhpcy5jdXJyZW50Q29sbGVjdGlvbiksdGhpcy5Bc3NlcnQobnVsbCE9PXRoaXMuY3VycmVudFByb3BlcnR5TmFtZSk7bGV0IHQ9dGhpcy5fcHJvcGVydHlOYW1lU3RhY2sucG9wKCk7dGhpcy5jdXJyZW50Q29sbGVjdGlvblt0XT1lLHRoaXMuX2NvbGxlY3Rpb25TdGFjay5wdXNoKGUpfWVsc2UgdGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLkFycmF5Pyh0aGlzLkFzc2VydChudWxsIT09dGhpcy5jdXJyZW50Q29sbGVjdGlvbiksdGhpcy5jdXJyZW50Q29sbGVjdGlvbi5wdXNoKGUpLHRoaXMuX2NvbGxlY3Rpb25TdGFjay5wdXNoKGUpKToodGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLk5vbmUpLHRoaXMuX2pzb25PYmplY3Q9ZSx0aGlzLl9jb2xsZWN0aW9uU3RhY2sucHVzaChlKSk7dGhpcy5fc3RhdGVTdGFjay5wdXNoKG5ldyB0LldyaXRlci5TdGF0ZUVsZW1lbnQodC5Xcml0ZXIuU3RhdGUuQXJyYXkpKX1Xcml0ZUFycmF5RW5kKCl7dGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLkFycmF5KSx0aGlzLl9jb2xsZWN0aW9uU3RhY2sucG9wKCksdGhpcy5fc3RhdGVTdGFjay5wb3AoKX1Xcml0ZSh0LGU9ITApe251bGwhPT10Pyh0aGlzLlN0YXJ0TmV3T2JqZWN0KCExKSx0aGlzLl9hZGRUb0N1cnJlbnRPYmplY3QodCkpOmNvbnNvbGUuZXJyb3IoXCJXYXJuaW5nOiB0cnlpbmcgdG8gd3JpdGUgYSBudWxsIHN0cmluZ1wiKX1Xcml0ZUludCh0KXtudWxsIT09dCYmKHRoaXMuU3RhcnROZXdPYmplY3QoITEpLHRoaXMuX2FkZFRvQ3VycmVudE9iamVjdChNYXRoLmZsb29yKHQpKSl9V3JpdGVGbG9hdCh0KXtudWxsIT09dCYmKHRoaXMuU3RhcnROZXdPYmplY3QoITEpLHQ9PU51bWJlci5QT1NJVElWRV9JTkZJTklUWT90aGlzLl9hZGRUb0N1cnJlbnRPYmplY3QoMzRlMzcpOnQ9PU51bWJlci5ORUdBVElWRV9JTkZJTklUWT90aGlzLl9hZGRUb0N1cnJlbnRPYmplY3QoLTM0ZTM3KTppc05hTih0KT90aGlzLl9hZGRUb0N1cnJlbnRPYmplY3QoMCk6dGhpcy5fYWRkVG9DdXJyZW50T2JqZWN0KHQpKX1Xcml0ZU51bGwoKXt0aGlzLlN0YXJ0TmV3T2JqZWN0KCExKSx0aGlzLl9hZGRUb0N1cnJlbnRPYmplY3QobnVsbCl9V3JpdGVTdHJpbmdTdGFydCgpe3RoaXMuU3RhcnROZXdPYmplY3QoITEpLHRoaXMuX2N1cnJlbnRTdHJpbmc9XCJcIix0aGlzLl9zdGF0ZVN0YWNrLnB1c2gobmV3IHQuV3JpdGVyLlN0YXRlRWxlbWVudCh0LldyaXRlci5TdGF0ZS5TdHJpbmcpKX1Xcml0ZVN0cmluZ0VuZCgpe3RoaXMuQXNzZXJ0KHRoaXMuc3RhdGU9PXQuV3JpdGVyLlN0YXRlLlN0cmluZyksdGhpcy5fc3RhdGVTdGFjay5wb3AoKSx0aGlzLl9hZGRUb0N1cnJlbnRPYmplY3QodGhpcy5fY3VycmVudFN0cmluZyksdGhpcy5fY3VycmVudFN0cmluZz1udWxsfVdyaXRlU3RyaW5nSW5uZXIoZSxuPSEwKXt0aGlzLkFzc2VydCh0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuU3RyaW5nKSxudWxsIT09ZT90aGlzLl9jdXJyZW50U3RyaW5nKz1lOmNvbnNvbGUuZXJyb3IoXCJXYXJuaW5nOiB0cnlpbmcgdG8gd3JpdGUgYSBudWxsIHN0cmluZ1wiKX1Ub1N0cmluZygpe3JldHVybiBudWxsPT09dGhpcy5fanNvbk9iamVjdD9cIlwiOkpTT04uc3RyaW5naWZ5KHRoaXMuX2pzb25PYmplY3QpfVN0YXJ0TmV3T2JqZWN0KGUpe2U/dGhpcy5Bc3NlcnQodGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLk5vbmV8fHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5Qcm9wZXJ0eXx8dGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLkFycmF5KTp0aGlzLkFzc2VydCh0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuUHJvcGVydHl8fHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5BcnJheSksdGhpcy5zdGF0ZT09PXQuV3JpdGVyLlN0YXRlLlByb3BlcnR5JiZ0aGlzLkFzc2VydCgwPT09dGhpcy5jaGlsZENvdW50KSx0aGlzLnN0YXRlIT09dC5Xcml0ZXIuU3RhdGUuQXJyYXkmJnRoaXMuc3RhdGUhPT10LldyaXRlci5TdGF0ZS5Qcm9wZXJ0eXx8dGhpcy5JbmNyZW1lbnRDaGlsZENvdW50KCl9Z2V0IHN0YXRlKCl7cmV0dXJuIHRoaXMuX3N0YXRlU3RhY2subGVuZ3RoPjA/dGhpcy5fc3RhdGVTdGFja1t0aGlzLl9zdGF0ZVN0YWNrLmxlbmd0aC0xXS50eXBlOnQuV3JpdGVyLlN0YXRlLk5vbmV9Z2V0IGNoaWxkQ291bnQoKXtyZXR1cm4gdGhpcy5fc3RhdGVTdGFjay5sZW5ndGg+MD90aGlzLl9zdGF0ZVN0YWNrW3RoaXMuX3N0YXRlU3RhY2subGVuZ3RoLTFdLmNoaWxkQ291bnQ6MH1nZXQgY3VycmVudENvbGxlY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29sbGVjdGlvblN0YWNrLmxlbmd0aD4wP3RoaXMuX2NvbGxlY3Rpb25TdGFja1t0aGlzLl9jb2xsZWN0aW9uU3RhY2subGVuZ3RoLTFdOm51bGx9Z2V0IGN1cnJlbnRQcm9wZXJ0eU5hbWUoKXtyZXR1cm4gdGhpcy5fcHJvcGVydHlOYW1lU3RhY2subGVuZ3RoPjA/dGhpcy5fcHJvcGVydHlOYW1lU3RhY2tbdGhpcy5fcHJvcGVydHlOYW1lU3RhY2subGVuZ3RoLTFdOm51bGx9SW5jcmVtZW50Q2hpbGRDb3VudCgpe3RoaXMuQXNzZXJ0KHRoaXMuX3N0YXRlU3RhY2subGVuZ3RoPjApO2xldCB0PXRoaXMuX3N0YXRlU3RhY2sucG9wKCk7dC5jaGlsZENvdW50KyssdGhpcy5fc3RhdGVTdGFjay5wdXNoKHQpfUFzc2VydCh0KXtpZighdCl0aHJvdyBFcnJvcihcIkFzc2VydCBmYWlsZWQgd2hpbGUgd3JpdGluZyBKU09OXCIpfV9hZGRUb0N1cnJlbnRPYmplY3QoZSl7dGhpcy5Bc3NlcnQobnVsbCE9PXRoaXMuY3VycmVudENvbGxlY3Rpb24pLHRoaXMuc3RhdGU9PT10LldyaXRlci5TdGF0ZS5BcnJheT8odGhpcy5Bc3NlcnQoQXJyYXkuaXNBcnJheSh0aGlzLmN1cnJlbnRDb2xsZWN0aW9uKSksdGhpcy5jdXJyZW50Q29sbGVjdGlvbi5wdXNoKGUpKTp0aGlzLnN0YXRlPT09dC5Xcml0ZXIuU3RhdGUuUHJvcGVydHkmJih0aGlzLkFzc2VydCghQXJyYXkuaXNBcnJheSh0aGlzLmN1cnJlbnRDb2xsZWN0aW9uKSksdGhpcy5Bc3NlcnQobnVsbCE9PXRoaXMuY3VycmVudFByb3BlcnR5TmFtZSksdGhpcy5jdXJyZW50Q29sbGVjdGlvblt0aGlzLmN1cnJlbnRQcm9wZXJ0eU5hbWVdPWUsdGhpcy5fcHJvcGVydHlOYW1lU3RhY2sucG9wKCkpfX10LldyaXRlcj1lLGZ1bmN0aW9uKGUpe2xldCBuOyFmdW5jdGlvbih0KXt0W3QuTm9uZT0wXT1cIk5vbmVcIix0W3QuT2JqZWN0PTFdPVwiT2JqZWN0XCIsdFt0LkFycmF5PTJdPVwiQXJyYXlcIix0W3QuUHJvcGVydHk9M109XCJQcm9wZXJ0eVwiLHRbdC5Qcm9wZXJ0eU5hbWU9NF09XCJQcm9wZXJ0eU5hbWVcIix0W3QuU3RyaW5nPTVdPVwiU3RyaW5nXCJ9KG49ZS5TdGF0ZXx8KGUuU3RhdGU9e30pKTtlLlN0YXRlRWxlbWVudD1jbGFzc3tjb25zdHJ1Y3RvcihlKXt0aGlzLnR5cGU9dC5Xcml0ZXIuU3RhdGUuTm9uZSx0aGlzLmNoaWxkQ291bnQ9MCx0aGlzLnR5cGU9ZX19fShlPXQuV3JpdGVyfHwodC5Xcml0ZXI9e30pKX0oenx8KHo9e30pKTtjbGFzcyBIe2NvbnN0cnVjdG9yKHQpe3RoaXMua0lua1NhdmVTdGF0ZVZlcnNpb249OCx0aGlzLmtNaW5Db21wYXRpYmxlTG9hZFZlcnNpb249OCx0aGlzLl9jdXJyZW50RXJyb3JzPW51bGwsdGhpcy5fY3VycmVudFdhcm5pbmdzPW51bGwsdGhpcy5kaXZlcnRlZFBvaW50ZXI9SS5OdWxsLHRoaXMuX2N1cnJlbnRUdXJuSW5kZXg9MCx0aGlzLnN0b3J5U2VlZD0wLHRoaXMucHJldmlvdXNSYW5kb209MCx0aGlzLmRpZFNhZmVFeGl0PSExLHRoaXMuX2N1cnJlbnRUZXh0PW51bGwsdGhpcy5fY3VycmVudFRhZ3M9bnVsbCx0aGlzLl9vdXRwdXRTdHJlYW1UZXh0RGlydHk9ITAsdGhpcy5fb3V0cHV0U3RyZWFtVGFnc0RpcnR5PSEwLHRoaXMuX3BhdGNoPW51bGwsdGhpcy5zdG9yeT10LHRoaXMuX291dHB1dFN0cmVhbT1bXSx0aGlzLk91dHB1dFN0cmVhbURpcnR5KCksdGhpcy5fZXZhbHVhdGlvblN0YWNrPVtdLHRoaXMuY2FsbFN0YWNrPW5ldyBxKHQpLHRoaXMuX3ZhcmlhYmxlc1N0YXRlPW5ldyBKKHRoaXMuY2FsbFN0YWNrLHQubGlzdERlZmluaXRpb25zKSx0aGlzLl92aXNpdENvdW50cz1uZXcgTWFwLHRoaXMuX3R1cm5JbmRpY2VzPW5ldyBNYXAsdGhpcy5jdXJyZW50VHVybkluZGV4PS0xO2xldCBlPShuZXcgRGF0ZSkuZ2V0VGltZSgpO3RoaXMuc3RvcnlTZWVkPW5ldyBLKGUpLm5leHQoKSUxMDAsdGhpcy5wcmV2aW91c1JhbmRvbT0wLHRoaXMuX2N1cnJlbnRDaG9pY2VzPVtdLHRoaXMuR29Ub1N0YXJ0KCl9VG9Kc29uKHQ9ITEpe2xldCBlPW5ldyB6LldyaXRlcjtyZXR1cm4gdGhpcy5Xcml0ZUpzb24oZSksZS5Ub1N0cmluZygpfXRvSnNvbih0PSExKXtyZXR1cm4gdGhpcy5Ub0pzb24odCl9TG9hZEpzb24odCl7bGV0IGU9ei5UZXh0VG9EaWN0aW9uYXJ5KHQpO3RoaXMuTG9hZEpzb25PYmooZSl9VmlzaXRDb3VudEF0UGF0aFN0cmluZyh0KXtsZXQgbjtpZihudWxsIT09dGhpcy5fcGF0Y2gpe2xldCBpPXRoaXMuc3RvcnkuQ29udGVudEF0UGF0aChuZXcgZSh0KSkuY29udGFpbmVyO2lmKG51bGw9PT1pKXRocm93IG5ldyBFcnJvcihcIkNvbnRlbnQgYXQgcGF0aCBub3QgZm91bmQ6IFwiK3QpO2lmKG49dGhpcy5fcGF0Y2guVHJ5R2V0VmlzaXRDb3VudChpLDApLG4uZXhpc3RzKXJldHVybiBuLnJlc3VsdH1yZXR1cm4gbj15KHRoaXMuX3Zpc2l0Q291bnRzLHQsbnVsbCksbi5leGlzdHM/bi5yZXN1bHQ6MH1WaXNpdENvdW50Rm9yQ29udGFpbmVyKHQpe2lmKG51bGw9PT10KXJldHVybiBkKFwiY29udGFpbmVyXCIpO2lmKCF0LnZpc2l0c1Nob3VsZEJlQ291bnRlZClyZXR1cm4gdGhpcy5zdG9yeS5FcnJvcihcIlJlYWQgY291bnQgZm9yIHRhcmdldCAoXCIrdC5uYW1lK1wiIC0gb24gXCIrdC5kZWJ1Z01ldGFkYXRhK1wiKSB1bmtub3duLiBUaGUgc3RvcnkgbWF5IG5lZWQgdG8gYmUgY29tcGlsZWQgd2l0aCBjb3VudEFsbFZpc2l0cyBmbGFnICgtYykuXCIpLDA7aWYobnVsbCE9PXRoaXMuX3BhdGNoKXtsZXQgZT10aGlzLl9wYXRjaC5UcnlHZXRWaXNpdENvdW50KHQsMCk7aWYoZS5leGlzdHMpcmV0dXJuIGUucmVzdWx0fWxldCBlPXQucGF0aC50b1N0cmluZygpLG49eSh0aGlzLl92aXNpdENvdW50cyxlLG51bGwpO3JldHVybiBuLmV4aXN0cz9uLnJlc3VsdDowfUluY3JlbWVudFZpc2l0Q291bnRGb3JDb250YWluZXIodCl7aWYobnVsbCE9PXRoaXMuX3BhdGNoKXtsZXQgZT10aGlzLlZpc2l0Q291bnRGb3JDb250YWluZXIodCk7cmV0dXJuIGUrKyx2b2lkIHRoaXMuX3BhdGNoLlNldFZpc2l0Q291bnQodCxlKX1sZXQgZT10LnBhdGgudG9TdHJpbmcoKSxuPXkodGhpcy5fdmlzaXRDb3VudHMsZSxudWxsKTtuLmV4aXN0cz90aGlzLl92aXNpdENvdW50cy5zZXQoZSxuLnJlc3VsdCsxKTp0aGlzLl92aXNpdENvdW50cy5zZXQoZSwxKX1SZWNvcmRUdXJuSW5kZXhWaXNpdFRvQ29udGFpbmVyKHQpe2lmKG51bGwhPT10aGlzLl9wYXRjaClyZXR1cm4gdm9pZCB0aGlzLl9wYXRjaC5TZXRUdXJuSW5kZXgodCx0aGlzLmN1cnJlbnRUdXJuSW5kZXgpO2xldCBlPXQucGF0aC50b1N0cmluZygpO3RoaXMuX3R1cm5JbmRpY2VzLnNldChlLHRoaXMuY3VycmVudFR1cm5JbmRleCl9VHVybnNTaW5jZUZvckNvbnRhaW5lcih0KXtpZih0LnR1cm5JbmRleFNob3VsZEJlQ291bnRlZHx8dGhpcy5zdG9yeS5FcnJvcihcIlRVUk5TX1NJTkNFKCkgZm9yIHRhcmdldCAoXCIrdC5uYW1lK1wiIC0gb24gXCIrdC5kZWJ1Z01ldGFkYXRhK1wiKSB1bmtub3duLiBUaGUgc3RvcnkgbWF5IG5lZWQgdG8gYmUgY29tcGlsZWQgd2l0aCBjb3VudEFsbFZpc2l0cyBmbGFnICgtYykuXCIpLG51bGwhPT10aGlzLl9wYXRjaCl7bGV0IGU9dGhpcy5fcGF0Y2guVHJ5R2V0VHVybkluZGV4KHQsMCk7aWYoZS5leGlzdHMpcmV0dXJuIHRoaXMuY3VycmVudFR1cm5JbmRleC1lLnJlc3VsdH1sZXQgZT10LnBhdGgudG9TdHJpbmcoKSxuPXkodGhpcy5fdHVybkluZGljZXMsZSwwKTtyZXR1cm4gbi5leGlzdHM/dGhpcy5jdXJyZW50VHVybkluZGV4LW4ucmVzdWx0Oi0xfWdldCBjYWxsc3RhY2tEZXB0aCgpe3JldHVybiB0aGlzLmNhbGxTdGFjay5kZXB0aH1nZXQgb3V0cHV0U3RyZWFtKCl7cmV0dXJuIHRoaXMuX291dHB1dFN0cmVhbX1nZXQgY3VycmVudENob2ljZXMoKXtyZXR1cm4gdGhpcy5jYW5Db250aW51ZT9bXTp0aGlzLl9jdXJyZW50Q2hvaWNlc31nZXQgZ2VuZXJhdGVkQ2hvaWNlcygpe3JldHVybiB0aGlzLl9jdXJyZW50Q2hvaWNlc31nZXQgY3VycmVudEVycm9ycygpe3JldHVybiB0aGlzLl9jdXJyZW50RXJyb3JzfWdldCBjdXJyZW50V2FybmluZ3MoKXtyZXR1cm4gdGhpcy5fY3VycmVudFdhcm5pbmdzfWdldCB2YXJpYWJsZXNTdGF0ZSgpe3JldHVybiB0aGlzLl92YXJpYWJsZXNTdGF0ZX1zZXQgdmFyaWFibGVzU3RhdGUodCl7dGhpcy5fdmFyaWFibGVzU3RhdGU9dH1nZXQgZXZhbHVhdGlvblN0YWNrKCl7cmV0dXJuIHRoaXMuX2V2YWx1YXRpb25TdGFja31nZXQgdmlzaXRDb3VudHMoKXtyZXR1cm4gdGhpcy5fdmlzaXRDb3VudHN9Z2V0IHR1cm5JbmRpY2VzKCl7cmV0dXJuIHRoaXMuX3R1cm5JbmRpY2VzfWdldCBjdXJyZW50VHVybkluZGV4KCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRUdXJuSW5kZXh9c2V0IGN1cnJlbnRUdXJuSW5kZXgodCl7dGhpcy5fY3VycmVudFR1cm5JbmRleD10fWdldCBjdXJyZW50UGF0aFN0cmluZygpe2xldCB0PXRoaXMuY3VycmVudFBvaW50ZXI7cmV0dXJuIHQuaXNOdWxsP251bGw6bnVsbD09PXQucGF0aD9kKFwicG9pbnRlci5wYXRoXCIpOnQucGF0aC50b1N0cmluZygpfWdldCBjdXJyZW50UG9pbnRlcigpe3JldHVybiB0aGlzLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC5jdXJyZW50UG9pbnRlci5jb3B5KCl9c2V0IGN1cnJlbnRQb2ludGVyKHQpe3RoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LmN1cnJlbnRQb2ludGVyPXQuY29weSgpfWdldCBwcmV2aW91c1BvaW50ZXIoKXtyZXR1cm4gdGhpcy5jYWxsU3RhY2suY3VycmVudFRocmVhZC5wcmV2aW91c1BvaW50ZXIuY29weSgpfXNldCBwcmV2aW91c1BvaW50ZXIodCl7dGhpcy5jYWxsU3RhY2suY3VycmVudFRocmVhZC5wcmV2aW91c1BvaW50ZXI9dC5jb3B5KCl9Z2V0IGNhbkNvbnRpbnVlKCl7cmV0dXJuIXRoaXMuY3VycmVudFBvaW50ZXIuaXNOdWxsJiYhdGhpcy5oYXNFcnJvcn1nZXQgaGFzRXJyb3IoKXtyZXR1cm4gbnVsbCE9dGhpcy5jdXJyZW50RXJyb3JzJiZ0aGlzLmN1cnJlbnRFcnJvcnMubGVuZ3RoPjB9Z2V0IGhhc1dhcm5pbmcoKXtyZXR1cm4gbnVsbCE9dGhpcy5jdXJyZW50V2FybmluZ3MmJnRoaXMuY3VycmVudFdhcm5pbmdzLmxlbmd0aD4wfWdldCBjdXJyZW50VGV4dCgpe2lmKHRoaXMuX291dHB1dFN0cmVhbVRleHREaXJ0eSl7bGV0IHQ9bmV3IG07Zm9yKGxldCBlIG9mIHRoaXMuX291dHB1dFN0cmVhbSl7bGV0IG49YShlLFQpO251bGwhPT1uJiZ0LkFwcGVuZChuLnZhbHVlKX10aGlzLl9jdXJyZW50VGV4dD10aGlzLkNsZWFuT3V0cHV0V2hpdGVzcGFjZSh0LnRvU3RyaW5nKCkpLHRoaXMuX291dHB1dFN0cmVhbVRleHREaXJ0eT0hMX1yZXR1cm4gdGhpcy5fY3VycmVudFRleHR9Q2xlYW5PdXRwdXRXaGl0ZXNwYWNlKHQpe2xldCBlPW5ldyBtLG49LTEsaT0wO2ZvcihsZXQgcj0wO3I8dC5sZW5ndGg7cisrKXtsZXQgYT10LmNoYXJBdChyKSxzPVwiIFwiPT1hfHxcIlxcdFwiPT1hO3MmJi0xPT1uJiYobj1yKSxzfHwoXCJcXG5cIiE9YSYmbj4wJiZuIT1pJiZlLkFwcGVuZChcIiBcIiksbj0tMSksXCJcXG5cIj09YSYmKGk9cisxKSxzfHxlLkFwcGVuZChhKX1yZXR1cm4gZS50b1N0cmluZygpfWdldCBjdXJyZW50VGFncygpe2lmKHRoaXMuX291dHB1dFN0cmVhbVRhZ3NEaXJ0eSl7dGhpcy5fY3VycmVudFRhZ3M9W107Zm9yKGxldCB0IG9mIHRoaXMuX291dHB1dFN0cmVhbSl7bGV0IGU9YSh0LGopO251bGwhPT1lJiZ0aGlzLl9jdXJyZW50VGFncy5wdXNoKGUudGV4dCl9dGhpcy5fb3V0cHV0U3RyZWFtVGFnc0RpcnR5PSExfXJldHVybiB0aGlzLl9jdXJyZW50VGFnc31nZXQgaW5FeHByZXNzaW9uRXZhbHVhdGlvbigpe3JldHVybiB0aGlzLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC5pbkV4cHJlc3Npb25FdmFsdWF0aW9ufXNldCBpbkV4cHJlc3Npb25FdmFsdWF0aW9uKHQpe3RoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LmluRXhwcmVzc2lvbkV2YWx1YXRpb249dH1Hb1RvU3RhcnQoKXt0aGlzLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC5jdXJyZW50UG9pbnRlcj1JLlN0YXJ0T2YodGhpcy5zdG9yeS5tYWluQ29udGVudENvbnRhaW5lcil9Q29weUFuZFN0YXJ0UGF0Y2hpbmcoKXtsZXQgdD1uZXcgSCh0aGlzLnN0b3J5KTtyZXR1cm4gdC5fcGF0Y2g9bmV3IFUodGhpcy5fcGF0Y2gpLHQub3V0cHV0U3RyZWFtLnB1c2guYXBwbHkodC5vdXRwdXRTdHJlYW0sdGhpcy5fb3V0cHV0U3RyZWFtKSx0Lk91dHB1dFN0cmVhbURpcnR5KCksdC5fY3VycmVudENob2ljZXMucHVzaC5hcHBseSh0Ll9jdXJyZW50Q2hvaWNlcyx0aGlzLl9jdXJyZW50Q2hvaWNlcyksdGhpcy5oYXNFcnJvciYmKHQuX2N1cnJlbnRFcnJvcnM9W10sdC5fY3VycmVudEVycm9ycy5wdXNoLmFwcGx5KHQuX2N1cnJlbnRFcnJvcnMsdGhpcy5jdXJyZW50RXJyb3JzfHxbXSkpLHRoaXMuaGFzV2FybmluZyYmKHQuX2N1cnJlbnRXYXJuaW5ncz1bXSx0Ll9jdXJyZW50V2FybmluZ3MucHVzaC5hcHBseSh0Ll9jdXJyZW50V2FybmluZ3MsdGhpcy5jdXJyZW50V2FybmluZ3N8fFtdKSksdC5jYWxsU3RhY2s9bmV3IHEodGhpcy5jYWxsU3RhY2spLHQudmFyaWFibGVzU3RhdGU9dGhpcy52YXJpYWJsZXNTdGF0ZSx0LnZhcmlhYmxlc1N0YXRlLmNhbGxTdGFjaz10LmNhbGxTdGFjayx0LnZhcmlhYmxlc1N0YXRlLnBhdGNoPXQuX3BhdGNoLHQuZXZhbHVhdGlvblN0YWNrLnB1c2guYXBwbHkodC5ldmFsdWF0aW9uU3RhY2ssdGhpcy5ldmFsdWF0aW9uU3RhY2spLHRoaXMuZGl2ZXJ0ZWRQb2ludGVyLmlzTnVsbHx8KHQuZGl2ZXJ0ZWRQb2ludGVyPXRoaXMuZGl2ZXJ0ZWRQb2ludGVyLmNvcHkoKSksdC5wcmV2aW91c1BvaW50ZXI9dGhpcy5wcmV2aW91c1BvaW50ZXIuY29weSgpLHQuX3Zpc2l0Q291bnRzPXRoaXMuX3Zpc2l0Q291bnRzLHQuX3R1cm5JbmRpY2VzPXRoaXMuX3R1cm5JbmRpY2VzLHQuY3VycmVudFR1cm5JbmRleD10aGlzLmN1cnJlbnRUdXJuSW5kZXgsdC5zdG9yeVNlZWQ9dGhpcy5zdG9yeVNlZWQsdC5wcmV2aW91c1JhbmRvbT10aGlzLnByZXZpb3VzUmFuZG9tLHQuZGlkU2FmZUV4aXQ9dGhpcy5kaWRTYWZlRXhpdCx0fVJlc3RvcmVBZnRlclBhdGNoKCl7dGhpcy52YXJpYWJsZXNTdGF0ZS5jYWxsU3RhY2s9dGhpcy5jYWxsU3RhY2ssdGhpcy52YXJpYWJsZXNTdGF0ZS5wYXRjaD10aGlzLl9wYXRjaH1BcHBseUFueVBhdGNoKCl7aWYobnVsbCE9PXRoaXMuX3BhdGNoKXt0aGlzLnZhcmlhYmxlc1N0YXRlLkFwcGx5UGF0Y2goKTtmb3IobGV0W3QsZV1vZiB0aGlzLl9wYXRjaC52aXNpdENvdW50cyl0aGlzLkFwcGx5Q291bnRDaGFuZ2VzKHQsZSwhMCk7Zm9yKGxldFt0LGVdb2YgdGhpcy5fcGF0Y2gudHVybkluZGljZXMpdGhpcy5BcHBseUNvdW50Q2hhbmdlcyh0LGUsITEpO3RoaXMuX3BhdGNoPW51bGx9fUFwcGx5Q291bnRDaGFuZ2VzKHQsZSxuKXsobj90aGlzLl92aXNpdENvdW50czp0aGlzLl90dXJuSW5kaWNlcykuc2V0KHQucGF0aC50b1N0cmluZygpLGUpfVdyaXRlSnNvbih0KXt0LldyaXRlT2JqZWN0U3RhcnQoKTtsZXQgZT0hMTtmb3IobGV0IG4gb2YgdGhpcy5fY3VycmVudENob2ljZXMpe2lmKG51bGw9PT1uLnRocmVhZEF0R2VuZXJhdGlvbilyZXR1cm4gZChcImMudGhyZWFkQXRHZW5lcmF0aW9uXCIpO24ub3JpZ2luYWxUaHJlYWRJbmRleD1uLnRocmVhZEF0R2VuZXJhdGlvbi50aHJlYWRJbmRleCxudWxsPT09dGhpcy5jYWxsU3RhY2suVGhyZWFkV2l0aEluZGV4KG4ub3JpZ2luYWxUaHJlYWRJbmRleCkmJihlfHwoZT0hMCx0LldyaXRlUHJvcGVydHlTdGFydChcImNob2ljZVRocmVhZHNcIiksdC5Xcml0ZU9iamVjdFN0YXJ0KCkpLHQuV3JpdGVQcm9wZXJ0eVN0YXJ0KG4ub3JpZ2luYWxUaHJlYWRJbmRleCksbi50aHJlYWRBdEdlbmVyYXRpb24uV3JpdGVKc29uKHQpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpKX1pZihlJiYodC5Xcml0ZU9iamVjdEVuZCgpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpKSx0LldyaXRlUHJvcGVydHkoXCJjYWxsc3RhY2tUaHJlYWRzXCIsdD0+dGhpcy5jYWxsU3RhY2suV3JpdGVKc29uKHQpKSx0LldyaXRlUHJvcGVydHkoXCJ2YXJpYWJsZXNTdGF0ZVwiLHQ9PnRoaXMudmFyaWFibGVzU3RhdGUuV3JpdGVKc29uKHQpKSx0LldyaXRlUHJvcGVydHkoXCJldmFsU3RhY2tcIix0PT5NLldyaXRlTGlzdFJ1bnRpbWVPYmpzKHQsdGhpcy5ldmFsdWF0aW9uU3RhY2spKSx0LldyaXRlUHJvcGVydHkoXCJvdXRwdXRTdHJlYW1cIix0PT5NLldyaXRlTGlzdFJ1bnRpbWVPYmpzKHQsdGhpcy5fb3V0cHV0U3RyZWFtKSksdC5Xcml0ZVByb3BlcnR5KFwiY3VycmVudENob2ljZXNcIix0PT57dC5Xcml0ZUFycmF5U3RhcnQoKTtmb3IobGV0IGUgb2YgdGhpcy5fY3VycmVudENob2ljZXMpTS5Xcml0ZUNob2ljZSh0LGUpO3QuV3JpdGVBcnJheUVuZCgpfSksIXRoaXMuZGl2ZXJ0ZWRQb2ludGVyLmlzTnVsbCl7aWYobnVsbD09PXRoaXMuZGl2ZXJ0ZWRQb2ludGVyLnBhdGgpcmV0dXJuIGQoXCJkaXZlcnRlZFBvaW50ZXJcIik7dC5Xcml0ZVByb3BlcnR5KFwiY3VycmVudERpdmVydFRhcmdldFwiLHRoaXMuZGl2ZXJ0ZWRQb2ludGVyLnBhdGguY29tcG9uZW50c1N0cmluZyl9dC5Xcml0ZVByb3BlcnR5KFwidmlzaXRDb3VudHNcIix0PT5NLldyaXRlSW50RGljdGlvbmFyeSh0LHRoaXMuX3Zpc2l0Q291bnRzKSksdC5Xcml0ZVByb3BlcnR5KFwidHVybkluZGljZXNcIix0PT5NLldyaXRlSW50RGljdGlvbmFyeSh0LHRoaXMuX3R1cm5JbmRpY2VzKSksdC5Xcml0ZUludFByb3BlcnR5KFwidHVybklkeFwiLHRoaXMuY3VycmVudFR1cm5JbmRleCksdC5Xcml0ZUludFByb3BlcnR5KFwic3RvcnlTZWVkXCIsdGhpcy5zdG9yeVNlZWQpLHQuV3JpdGVJbnRQcm9wZXJ0eShcInByZXZpb3VzUmFuZG9tXCIsdGhpcy5wcmV2aW91c1JhbmRvbSksdC5Xcml0ZUludFByb3BlcnR5KFwiaW5rU2F2ZVZlcnNpb25cIix0aGlzLmtJbmtTYXZlU3RhdGVWZXJzaW9uKSx0LldyaXRlSW50UHJvcGVydHkoXCJpbmtGb3JtYXRWZXJzaW9uXCIsWC5pbmtWZXJzaW9uQ3VycmVudCksdC5Xcml0ZU9iamVjdEVuZCgpfUxvYWRKc29uT2JqKHQpe2xldCBuPXQsaT1uLmlua1NhdmVWZXJzaW9uO2lmKG51bGw9PWkpdGhyb3cgbmV3IFMoXCJpbmsgc2F2ZSBmb3JtYXQgaW5jb3JyZWN0LCBjYW4ndCBsb2FkLlwiKTtpZihwYXJzZUludChpKTx0aGlzLmtNaW5Db21wYXRpYmxlTG9hZFZlcnNpb24pdGhyb3cgbmV3IFMoXCJJbmsgc2F2ZSBmb3JtYXQgaXNuJ3QgY29tcGF0aWJsZSB3aXRoIHRoZSBjdXJyZW50IHZlcnNpb24gKHNhdyAnXCIraStcIicsIGJ1dCBtaW5pbXVtIGlzIFwiK3RoaXMua01pbkNvbXBhdGlibGVMb2FkVmVyc2lvbitcIiksIHNvIGNhbid0IGxvYWQuXCIpO3RoaXMuY2FsbFN0YWNrLlNldEpzb25Ub2tlbihuLmNhbGxzdGFja1RocmVhZHMsdGhpcy5zdG9yeSksdGhpcy52YXJpYWJsZXNTdGF0ZS5TZXRKc29uVG9rZW4obi52YXJpYWJsZXNTdGF0ZSksdGhpcy5fZXZhbHVhdGlvblN0YWNrPU0uSkFycmF5VG9SdW50aW1lT2JqTGlzdChuLmV2YWxTdGFjayksdGhpcy5fb3V0cHV0U3RyZWFtPU0uSkFycmF5VG9SdW50aW1lT2JqTGlzdChuLm91dHB1dFN0cmVhbSksdGhpcy5PdXRwdXRTdHJlYW1EaXJ0eSgpLHRoaXMuX2N1cnJlbnRDaG9pY2VzPU0uSkFycmF5VG9SdW50aW1lT2JqTGlzdChuLmN1cnJlbnRDaG9pY2VzKTtsZXQgcj1uLmN1cnJlbnREaXZlcnRUYXJnZXQ7aWYobnVsbCE9cil7bGV0IHQ9bmV3IGUoci50b1N0cmluZygpKTt0aGlzLmRpdmVydGVkUG9pbnRlcj10aGlzLnN0b3J5LlBvaW50ZXJBdFBhdGgodCl9dGhpcy5fdmlzaXRDb3VudHM9TS5KT2JqZWN0VG9JbnREaWN0aW9uYXJ5KG4udmlzaXRDb3VudHMpLHRoaXMuX3R1cm5JbmRpY2VzPU0uSk9iamVjdFRvSW50RGljdGlvbmFyeShuLnR1cm5JbmRpY2VzKSx0aGlzLmN1cnJlbnRUdXJuSW5kZXg9cGFyc2VJbnQobi50dXJuSWR4KSx0aGlzLnN0b3J5U2VlZD1wYXJzZUludChuLnN0b3J5U2VlZCksdGhpcy5wcmV2aW91c1JhbmRvbT1wYXJzZUludChuLnByZXZpb3VzUmFuZG9tKTtsZXQgYT1uLmNob2ljZVRocmVhZHM7Zm9yKGxldCB0IG9mIHRoaXMuX2N1cnJlbnRDaG9pY2VzKXtsZXQgZT10aGlzLmNhbGxTdGFjay5UaHJlYWRXaXRoSW5kZXgodC5vcmlnaW5hbFRocmVhZEluZGV4KTtpZihudWxsIT1lKXQudGhyZWFkQXRHZW5lcmF0aW9uPWUuQ29weSgpO2Vsc2V7bGV0IGU9YVt0Lm9yaWdpbmFsVGhyZWFkSW5kZXgudG9TdHJpbmcoKV07dC50aHJlYWRBdEdlbmVyYXRpb249bmV3IHEuVGhyZWFkKGUsdGhpcy5zdG9yeSl9fX1SZXNldEVycm9ycygpe3RoaXMuX2N1cnJlbnRFcnJvcnM9bnVsbCx0aGlzLl9jdXJyZW50V2FybmluZ3M9bnVsbH1SZXNldE91dHB1dCh0PW51bGwpe3RoaXMuX291dHB1dFN0cmVhbS5sZW5ndGg9MCxudWxsIT09dCYmdGhpcy5fb3V0cHV0U3RyZWFtLnB1c2guYXBwbHkodGhpcy5fb3V0cHV0U3RyZWFtLHQpLHRoaXMuT3V0cHV0U3RyZWFtRGlydHkoKX1QdXNoVG9PdXRwdXRTdHJlYW0odCl7bGV0IGU9YSh0LFQpO2lmKG51bGwhPT1lKXtsZXQgdD10aGlzLlRyeVNwbGl0dGluZ0hlYWRUYWlsV2hpdGVzcGFjZShlKTtpZihudWxsIT09dCl7Zm9yKGxldCBlIG9mIHQpdGhpcy5QdXNoVG9PdXRwdXRTdHJlYW1JbmRpdmlkdWFsKGUpO3JldHVybiB2b2lkIHRoaXMuT3V0cHV0U3RyZWFtRGlydHkoKX19dGhpcy5QdXNoVG9PdXRwdXRTdHJlYW1JbmRpdmlkdWFsKHQpLHRoaXMuT3V0cHV0U3RyZWFtRGlydHkoKX1Qb3BGcm9tT3V0cHV0U3RyZWFtKHQpe3RoaXMub3V0cHV0U3RyZWFtLnNwbGljZSh0aGlzLm91dHB1dFN0cmVhbS5sZW5ndGgtdCx0KSx0aGlzLk91dHB1dFN0cmVhbURpcnR5KCl9VHJ5U3BsaXR0aW5nSGVhZFRhaWxXaGl0ZXNwYWNlKHQpe2xldCBlPXQudmFsdWU7aWYobnVsbD09PWUpcmV0dXJuIGQoXCJzaW5nbGUudmFsdWVcIik7bGV0IG49LTEsaT0tMTtmb3IobGV0IHQ9MDt0PGUubGVuZ3RoOysrdCl7bGV0IHI9ZVt0XTtpZihcIlxcblwiIT1yKXtpZihcIiBcIj09cnx8XCJcXHRcIj09ciljb250aW51ZTticmVha30tMT09biYmKG49dCksaT10fWxldCByPS0xLGE9LTE7Zm9yKGxldCB0PTA7dDxlLmxlbmd0aDsrK3Qpe2xldCBuPWVbdF07aWYoXCJcXG5cIiE9bil7aWYoXCIgXCI9PW58fFwiXFx0XCI9PW4pY29udGludWU7YnJlYWt9LTE9PXImJihyPXQpLGE9dH1pZigtMT09biYmLTE9PXIpcmV0dXJuIG51bGw7bGV0IHM9W10sbD0wLG89ZS5sZW5ndGg7aWYoLTEhPW4pe2lmKG4+MCl7bGV0IHQ9bmV3IFQoZS5zdWJzdHJpbmcoMCxuKSk7cy5wdXNoKHQpfXMucHVzaChuZXcgVChcIlxcblwiKSksbD1pKzF9aWYoLTEhPXImJihvPWEpLG8+bCl7bGV0IHQ9ZS5zdWJzdHJpbmcobCxvLWwpO3MucHVzaChuZXcgVCh0KSl9aWYoLTEhPXImJmE+aSYmKHMucHVzaChuZXcgVChcIlxcblwiKSkscjxlLmxlbmd0aC0xKSl7bGV0IHQ9ZS5sZW5ndGgtci0xLG49bmV3IFQoZS5zdWJzdHJpbmcocisxLHQpKTtzLnB1c2gobil9cmV0dXJuIHN9UHVzaFRvT3V0cHV0U3RyZWFtSW5kaXZpZHVhbCh0KXtsZXQgZT1hKHQseCksbj1hKHQsVCksaT0hMDtpZihlKXRoaXMuVHJpbU5ld2xpbmVzRnJvbU91dHB1dFN0cmVhbSgpLGk9ITA7ZWxzZSBpZihuKXtsZXQgdD0tMSxlPXRoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50O2UudHlwZT09ci5GdW5jdGlvbiYmKHQ9ZS5mdW5jdGlvblN0YXJ0SW5PdXRwdXRTdHJlYW0pO2xldCBhPS0xO2ZvcihsZXQgZT10aGlzLl9vdXRwdXRTdHJlYW0ubGVuZ3RoLTE7ZT49MDtlLS0pe2xldCBuPXRoaXMuX291dHB1dFN0cmVhbVtlXSxpPW4gaW5zdGFuY2VvZiBBP246bnVsbDtpZihudWxsIT0obiBpbnN0YW5jZW9mIHg/bjpudWxsKSl7YT1lO2JyZWFrfWlmKG51bGwhPWkmJmkuY29tbWFuZFR5cGU9PUEuQ29tbWFuZFR5cGUuQmVnaW5TdHJpbmcpe2U+PXQmJih0PS0xKTticmVha319bGV0IHM9LTE7aWYocz0tMSE9YSYmLTEhPXQ/TWF0aC5taW4odCxhKTotMSE9YT9hOnQsLTEhPXMpe2lmKG4uaXNOZXdsaW5lKWk9ITE7ZWxzZSBpZihuLmlzTm9uV2hpdGVzcGFjZSYmKGE+LTEmJnRoaXMuUmVtb3ZlRXhpc3RpbmdHbHVlKCksdD4tMSkpe2xldCB0PXRoaXMuY2FsbFN0YWNrLmVsZW1lbnRzO2ZvcihsZXQgZT10Lmxlbmd0aC0xO2U+PTA7ZS0tKXtsZXQgbj10W2VdO2lmKG4udHlwZSE9ci5GdW5jdGlvbilicmVhaztuLmZ1bmN0aW9uU3RhcnRJbk91dHB1dFN0cmVhbT0tMX19fWVsc2Ugbi5pc05ld2xpbmUmJighdGhpcy5vdXRwdXRTdHJlYW1FbmRzSW5OZXdsaW5lJiZ0aGlzLm91dHB1dFN0cmVhbUNvbnRhaW5zQ29udGVudHx8KGk9ITEpKX1pZihpKXtpZihudWxsPT09dClyZXR1cm4gZChcIm9ialwiKTt0aGlzLl9vdXRwdXRTdHJlYW0ucHVzaCh0KSx0aGlzLk91dHB1dFN0cmVhbURpcnR5KCl9fVRyaW1OZXdsaW5lc0Zyb21PdXRwdXRTdHJlYW0oKXtsZXQgdD0tMSxlPXRoaXMuX291dHB1dFN0cmVhbS5sZW5ndGgtMTtmb3IoO2U+PTA7KXtsZXQgbj10aGlzLl9vdXRwdXRTdHJlYW1bZV0saT1hKG4sQSkscj1hKG4sVCk7aWYobnVsbCE9aXx8bnVsbCE9ciYmci5pc05vbldoaXRlc3BhY2UpYnJlYWs7bnVsbCE9ciYmci5pc05ld2xpbmUmJih0PWUpLGUtLX1pZih0Pj0wKWZvcihlPXQ7ZTx0aGlzLl9vdXRwdXRTdHJlYW0ubGVuZ3RoOyl7YSh0aGlzLl9vdXRwdXRTdHJlYW1bZV0sVCk/dGhpcy5fb3V0cHV0U3RyZWFtLnNwbGljZShlLDEpOmUrK310aGlzLk91dHB1dFN0cmVhbURpcnR5KCl9UmVtb3ZlRXhpc3RpbmdHbHVlKCl7Zm9yKGxldCB0PXRoaXMuX291dHB1dFN0cmVhbS5sZW5ndGgtMTt0Pj0wO3QtLSl7bGV0IGU9dGhpcy5fb3V0cHV0U3RyZWFtW3RdO2lmKGUgaW5zdGFuY2VvZiB4KXRoaXMuX291dHB1dFN0cmVhbS5zcGxpY2UodCwxKTtlbHNlIGlmKGUgaW5zdGFuY2VvZiBBKWJyZWFrfXRoaXMuT3V0cHV0U3RyZWFtRGlydHkoKX1nZXQgb3V0cHV0U3RyZWFtRW5kc0luTmV3bGluZSgpe2lmKHRoaXMuX291dHB1dFN0cmVhbS5sZW5ndGg+MClmb3IobGV0IHQ9dGhpcy5fb3V0cHV0U3RyZWFtLmxlbmd0aC0xO3Q+PTA7dC0tKXtpZih0aGlzLl9vdXRwdXRTdHJlYW1bdF1pbnN0YW5jZW9mIEEpYnJlYWs7bGV0IGU9dGhpcy5fb3V0cHV0U3RyZWFtW3RdO2lmKGUgaW5zdGFuY2VvZiBUKXtpZihlLmlzTmV3bGluZSlyZXR1cm4hMDtpZihlLmlzTm9uV2hpdGVzcGFjZSlicmVha319cmV0dXJuITF9Z2V0IG91dHB1dFN0cmVhbUNvbnRhaW5zQ29udGVudCgpe2ZvcihsZXQgdD0wO3Q8dGhpcy5fb3V0cHV0U3RyZWFtLmxlbmd0aDt0KyspaWYodGhpcy5fb3V0cHV0U3RyZWFtW3RdaW5zdGFuY2VvZiBUKXJldHVybiEwO3JldHVybiExfWdldCBpblN0cmluZ0V2YWx1YXRpb24oKXtmb3IobGV0IHQ9dGhpcy5fb3V0cHV0U3RyZWFtLmxlbmd0aC0xO3Q+PTA7dC0tKXtsZXQgZT1hKHRoaXMuX291dHB1dFN0cmVhbVt0XSxBKTtpZihlIGluc3RhbmNlb2YgQSYmZS5jb21tYW5kVHlwZT09QS5Db21tYW5kVHlwZS5CZWdpblN0cmluZylyZXR1cm4hMH1yZXR1cm4hMX1QdXNoRXZhbHVhdGlvblN0YWNrKHQpe2xldCBlPWEodCxPKTtpZihlKXtsZXQgdD1lLnZhbHVlO2lmKG51bGw9PT10KXJldHVybiBkKFwicmF3TGlzdFwiKTtpZihudWxsIT10Lm9yaWdpbk5hbWVzKXt0Lm9yaWdpbnN8fCh0Lm9yaWdpbnM9W10pLHQub3JpZ2lucy5sZW5ndGg9MDtmb3IobGV0IGUgb2YgdC5vcmlnaW5OYW1lcyl7aWYobnVsbD09PXRoaXMuc3RvcnkubGlzdERlZmluaXRpb25zKXJldHVybiBkKFwiU3RvcnlTdGF0ZS5zdG9yeS5saXN0RGVmaW5pdGlvbnNcIik7bGV0IG49dGhpcy5zdG9yeS5saXN0RGVmaW5pdGlvbnMuVHJ5TGlzdEdldERlZmluaXRpb24oZSxudWxsKTtpZihudWxsPT09bi5yZXN1bHQpcmV0dXJuIGQoXCJTdG9yeVN0YXRlIGRlZi5yZXN1bHRcIik7dC5vcmlnaW5zLmluZGV4T2Yobi5yZXN1bHQpPDAmJnQub3JpZ2lucy5wdXNoKG4ucmVzdWx0KX19fWlmKG51bGw9PT10KXJldHVybiBkKFwib2JqXCIpO3RoaXMuZXZhbHVhdGlvblN0YWNrLnB1c2godCl9UG9wRXZhbHVhdGlvblN0YWNrKHQpe2lmKHZvaWQgMD09PXQpe3JldHVybiBvKHRoaXMuZXZhbHVhdGlvblN0YWNrLnBvcCgpKX1pZih0PnRoaXMuZXZhbHVhdGlvblN0YWNrLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoXCJ0cnlpbmcgdG8gcG9wIHRvbyBtYW55IG9iamVjdHNcIik7cmV0dXJuIG8odGhpcy5ldmFsdWF0aW9uU3RhY2suc3BsaWNlKHRoaXMuZXZhbHVhdGlvblN0YWNrLmxlbmd0aC10LHQpKX1QZWVrRXZhbHVhdGlvblN0YWNrKCl7cmV0dXJuIHRoaXMuZXZhbHVhdGlvblN0YWNrW3RoaXMuZXZhbHVhdGlvblN0YWNrLmxlbmd0aC0xXX1Gb3JjZUVuZCgpe3RoaXMuY2FsbFN0YWNrLlJlc2V0KCksdGhpcy5fY3VycmVudENob2ljZXMubGVuZ3RoPTAsdGhpcy5jdXJyZW50UG9pbnRlcj1JLk51bGwsdGhpcy5wcmV2aW91c1BvaW50ZXI9SS5OdWxsLHRoaXMuZGlkU2FmZUV4aXQ9ITB9VHJpbVdoaXRlc3BhY2VGcm9tRnVuY3Rpb25FbmQoKXtuLkFzc2VydCh0aGlzLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC50eXBlPT1yLkZ1bmN0aW9uKTtsZXQgdD10aGlzLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC5mdW5jdGlvblN0YXJ0SW5PdXRwdXRTdHJlYW07LTE9PXQmJih0PTApO2ZvcihsZXQgZT10aGlzLl9vdXRwdXRTdHJlYW0ubGVuZ3RoLTE7ZT49dDtlLS0pe2xldCB0PXRoaXMuX291dHB1dFN0cmVhbVtlXSxuPWEodCxUKSxpPWEodCxBKTtpZihudWxsIT1uKXtpZihpKWJyZWFrO2lmKCFuLmlzTmV3bGluZSYmIW4uaXNJbmxpbmVXaGl0ZXNwYWNlKWJyZWFrO3RoaXMuX291dHB1dFN0cmVhbS5zcGxpY2UoZSwxKSx0aGlzLk91dHB1dFN0cmVhbURpcnR5KCl9fX1Qb3BDYWxsU3RhY2sodD1udWxsKXt0aGlzLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC50eXBlPT1yLkZ1bmN0aW9uJiZ0aGlzLlRyaW1XaGl0ZXNwYWNlRnJvbUZ1bmN0aW9uRW5kKCksdGhpcy5jYWxsU3RhY2suUG9wKHQpfVNldENob3NlblBhdGgodCxlKXt0aGlzLl9jdXJyZW50Q2hvaWNlcy5sZW5ndGg9MDtsZXQgbj10aGlzLnN0b3J5LlBvaW50ZXJBdFBhdGgodCk7bi5pc051bGx8fC0xIT1uLmluZGV4fHwobi5pbmRleD0wKSx0aGlzLmN1cnJlbnRQb2ludGVyPW4sZSYmdGhpcy5jdXJyZW50VHVybkluZGV4Kyt9U3RhcnRGdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZSh0LGUpe3RoaXMuY2FsbFN0YWNrLlB1c2goci5GdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZSx0aGlzLmV2YWx1YXRpb25TdGFjay5sZW5ndGgpLHRoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LmN1cnJlbnRQb2ludGVyPUkuU3RhcnRPZih0KSx0aGlzLlBhc3NBcmd1bWVudHNUb0V2YWx1YXRpb25TdGFjayhlKX1QYXNzQXJndW1lbnRzVG9FdmFsdWF0aW9uU3RhY2sodCl7aWYobnVsbCE9dClmb3IobGV0IGU9MDtlPHQubGVuZ3RoO2UrKyl7aWYoXCJudW1iZXJcIiE9dHlwZW9mIHRbZV0mJlwic3RyaW5nXCIhPXR5cGVvZiB0W2VdKXRocm93IG5ldyBFcnJvcihcImluayBhcmd1bWVudHMgd2hlbiBjYWxsaW5nIEV2YWx1YXRlRnVuY3Rpb24gLyBDaG9vc2VQYXRoU3RyaW5nV2l0aFBhcmFtZXRlcnMgIG11c3QgYmUgaW50LCBmbG9hdCBvciBzdHJpbmdcIik7dGhpcy5QdXNoRXZhbHVhdGlvblN0YWNrKHYuQ3JlYXRlKHRbZV0pKX19VHJ5RXhpdEZ1bmN0aW9uRXZhbHVhdGlvbkZyb21HYW1lKCl7cmV0dXJuIHRoaXMuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LnR5cGU9PXIuRnVuY3Rpb25FdmFsdWF0aW9uRnJvbUdhbWUmJih0aGlzLmN1cnJlbnRQb2ludGVyPUkuTnVsbCx0aGlzLmRpZFNhZmVFeGl0PSEwLCEwKX1Db21wbGV0ZUZ1bmN0aW9uRXZhbHVhdGlvbkZyb21HYW1lKCl7aWYodGhpcy5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQudHlwZSE9ci5GdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZSl0aHJvdyBuZXcgUyhcIkV4cGVjdGVkIGV4dGVybmFsIGZ1bmN0aW9uIGV2YWx1YXRpb24gdG8gYmUgY29tcGxldGUuIFN0YWNrIHRyYWNlOiBcIit0aGlzLmNhbGxTdGFjay5jYWxsU3RhY2tUcmFjZSk7bGV0IHQ9dGhpcy5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQuZXZhbHVhdGlvblN0YWNrSGVpZ2h0V2hlblB1c2hlZCxlPW51bGw7Zm9yKDt0aGlzLmV2YWx1YXRpb25TdGFjay5sZW5ndGg+dDspe2xldCB0PXRoaXMuUG9wRXZhbHVhdGlvblN0YWNrKCk7bnVsbD09PWUmJihlPXQpfWlmKHRoaXMuUG9wQ2FsbFN0YWNrKHIuRnVuY3Rpb25FdmFsdWF0aW9uRnJvbUdhbWUpLGUpe2lmKGUgaW5zdGFuY2VvZiBMKXJldHVybiBudWxsO2xldCB0PXMoZSx2KTtyZXR1cm4gdC52YWx1ZVR5cGU9PWkuRGl2ZXJ0VGFyZ2V0P3QudmFsdWVPYmplY3QudG9TdHJpbmcoKTp0LnZhbHVlT2JqZWN0fXJldHVybiBudWxsfUFkZEVycm9yKHQsZSl7ZT8obnVsbD09dGhpcy5fY3VycmVudFdhcm5pbmdzJiYodGhpcy5fY3VycmVudFdhcm5pbmdzPVtdKSx0aGlzLl9jdXJyZW50V2FybmluZ3MucHVzaCh0KSk6KG51bGw9PXRoaXMuX2N1cnJlbnRFcnJvcnMmJih0aGlzLl9jdXJyZW50RXJyb3JzPVtdKSx0aGlzLl9jdXJyZW50RXJyb3JzLnB1c2godCkpfU91dHB1dFN0cmVhbURpcnR5KCl7dGhpcy5fb3V0cHV0U3RyZWFtVGV4dERpcnR5PSEwLHRoaXMuX291dHB1dFN0cmVhbVRhZ3NEaXJ0eT0hMH19Y2xhc3MgJHtjb25zdHJ1Y3Rvcigpe3RoaXMuc3RhcnRUaW1lPXZvaWQgMH1nZXQgRWxhcHNlZE1pbGxpc2Vjb25kcygpe3JldHVybiB2b2lkIDA9PT10aGlzLnN0YXJ0VGltZT8wOihuZXcgRGF0ZSkuZ2V0VGltZSgpLXRoaXMuc3RhcnRUaW1lfVN0YXJ0KCl7dGhpcy5zdGFydFRpbWU9KG5ldyBEYXRlKS5nZXRUaW1lKCl9U3RvcCgpe3RoaXMuc3RhcnRUaW1lPXZvaWQgMH19TnVtYmVyLmlzSW50ZWdlcnx8KE51bWJlci5pc0ludGVnZXI9ZnVuY3Rpb24odCl7cmV0dXJuXCJudW1iZXJcIj09dHlwZW9mIHQmJmlzRmluaXRlKHQpJiZ0Pi05MDA3MTk5MjU0NzQwOTkyJiZ0PDkwMDcxOTkyNTQ3NDA5OTImJk1hdGguZmxvb3IodCk9PT10fSk7Y2xhc3MgWCBleHRlbmRzIHB7Y29uc3RydWN0b3IoKXtsZXQgdDtzdXBlcigpLHRoaXMuaW5rVmVyc2lvbk1pbmltdW1Db21wYXRpYmxlPTE4LHRoaXMuX3ByZXZDb250YWluZXJzPVtdLHRoaXMuYWxsb3dFeHRlcm5hbEZ1bmN0aW9uRmFsbGJhY2tzPSExLHRoaXMuX2xpc3REZWZpbml0aW9ucz1udWxsLHRoaXMuX3ZhcmlhYmxlT2JzZXJ2ZXJzPW51bGwsdGhpcy5faGFzVmFsaWRhdGVkRXh0ZXJuYWxzPSExLHRoaXMuX3RlbXBvcmFyeUV2YWx1YXRpb25Db250YWluZXI9bnVsbCx0aGlzLl9hc3luY0NvbnRpbnVlQWN0aXZlPSExLHRoaXMuX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lPW51bGwsdGhpcy5fcmVjdXJzaXZlQ29udGludWVDb3VudD0wLHRoaXMuX2FzeW5jU2F2aW5nPSExLHRoaXMuX3Byb2ZpbGVyPW51bGw7bGV0IGU9bnVsbCxuPW51bGw7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBOKXQ9YXJndW1lbnRzWzBdLHZvaWQgMCE9PWFyZ3VtZW50c1sxXSYmKGU9YXJndW1lbnRzWzFdKSx0aGlzLl9tYWluQ29udGVudENvbnRhaW5lcj10O2Vsc2UgaWYoXCJzdHJpbmdcIj09dHlwZW9mIGFyZ3VtZW50c1swXSl7bGV0IHQ9YXJndW1lbnRzWzBdO249ei5UZXh0VG9EaWN0aW9uYXJ5KHQpfWVsc2Ugbj1hcmd1bWVudHNbMF07aWYobnVsbCE9ZSYmKHRoaXMuX2xpc3REZWZpbml0aW9ucz1uZXcgQihlKSksdGhpcy5fZXh0ZXJuYWxzPW5ldyBNYXAsbnVsbCE9PW4pe2xldCB0PW4sZT10Lmlua1ZlcnNpb247aWYobnVsbD09ZSl0aHJvdyBuZXcgRXJyb3IoXCJpbmsgdmVyc2lvbiBudW1iZXIgbm90IGZvdW5kLiBBcmUgeW91IHN1cmUgaXQncyBhIHZhbGlkIC5pbmsuanNvbiBmaWxlP1wiKTtsZXQgaT1wYXJzZUludChlKTtpZihpPlguaW5rVmVyc2lvbkN1cnJlbnQpdGhyb3cgbmV3IEVycm9yKFwiVmVyc2lvbiBvZiBpbmsgdXNlZCB0byBidWlsZCBzdG9yeSB3YXMgbmV3ZXIgdGhhbiB0aGUgY3VycmVudCB2ZXJzaW9uIG9mIHRoZSBlbmdpbmVcIik7aWYoaTx0aGlzLmlua1ZlcnNpb25NaW5pbXVtQ29tcGF0aWJsZSl0aHJvdyBuZXcgRXJyb3IoXCJWZXJzaW9uIG9mIGluayB1c2VkIHRvIGJ1aWxkIHN0b3J5IGlzIHRvbyBvbGQgdG8gYmUgbG9hZGVkIGJ5IHRoaXMgdmVyc2lvbiBvZiB0aGUgZW5naW5lXCIpO2khPVguaW5rVmVyc2lvbkN1cnJlbnQmJmNvbnNvbGUud2FybihcIldBUk5JTkc6IFZlcnNpb24gb2YgaW5rIHVzZWQgdG8gYnVpbGQgc3RvcnkgZG9lc24ndCBtYXRjaCBjdXJyZW50IHZlcnNpb24gb2YgZW5naW5lLiBOb24tY3JpdGljYWwsIGJ1dCByZWNvbW1lbmQgc3luY2hyb25pc2luZy5cIik7bGV0IHIsYT10LnJvb3Q7aWYobnVsbD09YSl0aHJvdyBuZXcgRXJyb3IoXCJSb290IG5vZGUgZm9yIGluayBub3QgZm91bmQuIEFyZSB5b3Ugc3VyZSBpdCdzIGEgdmFsaWQgLmluay5qc29uIGZpbGU/XCIpOyhyPXQubGlzdERlZnMpJiYodGhpcy5fbGlzdERlZmluaXRpb25zPU0uSlRva2VuVG9MaXN0RGVmaW5pdGlvbnMocikpLHRoaXMuX21haW5Db250ZW50Q29udGFpbmVyPXMoTS5KVG9rZW5Ub1J1bnRpbWVPYmplY3QoYSksTiksdGhpcy5SZXNldFN0YXRlKCl9fWdldCBjdXJyZW50Q2hvaWNlcygpe2xldCB0PVtdO2lmKG51bGw9PT10aGlzLl9zdGF0ZSlyZXR1cm4gZChcInRoaXMuX3N0YXRlXCIpO2ZvcihsZXQgZSBvZiB0aGlzLl9zdGF0ZS5jdXJyZW50Q2hvaWNlcyllLmlzSW52aXNpYmxlRGVmYXVsdHx8KGUuaW5kZXg9dC5sZW5ndGgsdC5wdXNoKGUpKTtyZXR1cm4gdH1nZXQgY3VycmVudFRleHQoKXtyZXR1cm4gdGhpcy5JZkFzeW5jV2VDYW50KFwiY2FsbCBjdXJyZW50VGV4dCBzaW5jZSBpdCdzIGEgd29yayBpbiBwcm9ncmVzc1wiKSx0aGlzLnN0YXRlLmN1cnJlbnRUZXh0fWdldCBjdXJyZW50VGFncygpe3JldHVybiB0aGlzLklmQXN5bmNXZUNhbnQoXCJjYWxsIGN1cnJlbnRUYWdzIHNpbmNlIGl0J3MgYSB3b3JrIGluIHByb2dyZXNzXCIpLHRoaXMuc3RhdGUuY3VycmVudFRhZ3N9Z2V0IGN1cnJlbnRFcnJvcnMoKXtyZXR1cm4gdGhpcy5zdGF0ZS5jdXJyZW50RXJyb3JzfWdldCBjdXJyZW50V2FybmluZ3MoKXtyZXR1cm4gdGhpcy5zdGF0ZS5jdXJyZW50V2FybmluZ3N9Z2V0IGhhc0Vycm9yKCl7cmV0dXJuIHRoaXMuc3RhdGUuaGFzRXJyb3J9Z2V0IGhhc1dhcm5pbmcoKXtyZXR1cm4gdGhpcy5zdGF0ZS5oYXNXYXJuaW5nfWdldCB2YXJpYWJsZXNTdGF0ZSgpe3JldHVybiB0aGlzLnN0YXRlLnZhcmlhYmxlc1N0YXRlfWdldCBsaXN0RGVmaW5pdGlvbnMoKXtyZXR1cm4gdGhpcy5fbGlzdERlZmluaXRpb25zfWdldCBzdGF0ZSgpe3JldHVybiB0aGlzLl9zdGF0ZX1TdGFydFByb2ZpbGluZygpe31FbmRQcm9maWxpbmcoKXt9VG9Kc29uKHQpe2xldCBlPSExO2lmKHR8fChlPSEwLHQ9bmV3IHouV3JpdGVyKSx0LldyaXRlT2JqZWN0U3RhcnQoKSx0LldyaXRlSW50UHJvcGVydHkoXCJpbmtWZXJzaW9uXCIsWC5pbmtWZXJzaW9uQ3VycmVudCksdC5Xcml0ZVByb3BlcnR5KFwicm9vdFwiLHQ9Pk0uV3JpdGVSdW50aW1lQ29udGFpbmVyKHQsdGhpcy5fbWFpbkNvbnRlbnRDb250YWluZXIpKSxudWxsIT10aGlzLl9saXN0RGVmaW5pdGlvbnMpe3QuV3JpdGVQcm9wZXJ0eVN0YXJ0KFwibGlzdERlZnNcIiksdC5Xcml0ZU9iamVjdFN0YXJ0KCk7Zm9yKGxldCBlIG9mIHRoaXMuX2xpc3REZWZpbml0aW9ucy5saXN0cyl7dC5Xcml0ZVByb3BlcnR5U3RhcnQoZS5uYW1lKSx0LldyaXRlT2JqZWN0U3RhcnQoKTtmb3IobGV0W24saV1vZiBlLml0ZW1zKXtsZXQgZT1mLmZyb21TZXJpYWxpemVkS2V5KG4pLHI9aTt0LldyaXRlSW50UHJvcGVydHkoZS5pdGVtTmFtZSxyKX10LldyaXRlT2JqZWN0RW5kKCksdC5Xcml0ZVByb3BlcnR5RW5kKCl9dC5Xcml0ZU9iamVjdEVuZCgpLHQuV3JpdGVQcm9wZXJ0eUVuZCgpfWlmKHQuV3JpdGVPYmplY3RFbmQoKSxlKXJldHVybiB0LlRvU3RyaW5nKCl9UmVzZXRTdGF0ZSgpe3RoaXMuSWZBc3luY1dlQ2FudChcIlJlc2V0U3RhdGVcIiksdGhpcy5fc3RhdGU9bmV3IEgodGhpcyksdGhpcy5fc3RhdGUudmFyaWFibGVzU3RhdGUuT2JzZXJ2ZVZhcmlhYmxlQ2hhbmdlKHRoaXMuVmFyaWFibGVTdGF0ZURpZENoYW5nZUV2ZW50LmJpbmQodGhpcykpLHRoaXMuUmVzZXRHbG9iYWxzKCl9UmVzZXRFcnJvcnMoKXtpZihudWxsPT09dGhpcy5fc3RhdGUpcmV0dXJuIGQoXCJ0aGlzLl9zdGF0ZVwiKTt0aGlzLl9zdGF0ZS5SZXNldEVycm9ycygpfVJlc2V0Q2FsbHN0YWNrKCl7aWYodGhpcy5JZkFzeW5jV2VDYW50KFwiUmVzZXRDYWxsc3RhY2tcIiksbnVsbD09PXRoaXMuX3N0YXRlKXJldHVybiBkKFwidGhpcy5fc3RhdGVcIik7dGhpcy5fc3RhdGUuRm9yY2VFbmQoKX1SZXNldEdsb2JhbHMoKXtpZih0aGlzLl9tYWluQ29udGVudENvbnRhaW5lci5uYW1lZENvbnRlbnQuZ2V0KFwiZ2xvYmFsIGRlY2xcIikpe2xldCB0PXRoaXMuc3RhdGUuY3VycmVudFBvaW50ZXIuY29weSgpO3RoaXMuQ2hvb3NlUGF0aChuZXcgZShcImdsb2JhbCBkZWNsXCIpLCExKSx0aGlzLkNvbnRpbnVlSW50ZXJuYWwoKSx0aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyPXR9dGhpcy5zdGF0ZS52YXJpYWJsZXNTdGF0ZS5TbmFwc2hvdERlZmF1bHRHbG9iYWxzKCl9Q29udGludWUoKXtyZXR1cm4gdGhpcy5Db250aW51ZUFzeW5jKDApLHRoaXMuY3VycmVudFRleHR9Z2V0IGNhbkNvbnRpbnVlKCl7cmV0dXJuIHRoaXMuc3RhdGUuY2FuQ29udGludWV9Z2V0IGFzeW5jQ29udGludWVDb21wbGV0ZSgpe3JldHVybiF0aGlzLl9hc3luY0NvbnRpbnVlQWN0aXZlfUNvbnRpbnVlQXN5bmModCl7dGhpcy5faGFzVmFsaWRhdGVkRXh0ZXJuYWxzfHx0aGlzLlZhbGlkYXRlRXh0ZXJuYWxCaW5kaW5ncygpLHRoaXMuQ29udGludWVJbnRlcm5hbCh0KX1Db250aW51ZUludGVybmFsKHQ9MCl7bnVsbCE9dGhpcy5fcHJvZmlsZXImJnRoaXMuX3Byb2ZpbGVyLlByZUNvbnRpbnVlKCk7bGV0IGU9dD4wO2lmKHRoaXMuX3JlY3Vyc2l2ZUNvbnRpbnVlQ291bnQrKywhdGhpcy5fYXN5bmNDb250aW51ZUFjdGl2ZSl7aWYodGhpcy5fYXN5bmNDb250aW51ZUFjdGl2ZT1lLCF0aGlzLmNhbkNvbnRpbnVlKXRocm93IG5ldyBTKFwiQ2FuJ3QgY29udGludWUgLSBzaG91bGQgY2hlY2sgY2FuQ29udGludWUgYmVmb3JlIGNhbGxpbmcgQ29udGludWVcIik7dGhpcy5fc3RhdGUuZGlkU2FmZUV4aXQ9ITEsdGhpcy5fc3RhdGUuUmVzZXRPdXRwdXQoKSwxPT10aGlzLl9yZWN1cnNpdmVDb250aW51ZUNvdW50JiYodGhpcy5fc3RhdGUudmFyaWFibGVzU3RhdGUuYmF0Y2hPYnNlcnZpbmdWYXJpYWJsZUNoYW5nZXM9ITApfWxldCBuPW5ldyAkO24uU3RhcnQoKTtsZXQgaT0hMTtkb3t0cnl7aT10aGlzLkNvbnRpbnVlU2luZ2xlU3RlcCgpfWNhdGNoKHQpe2lmKCEodCBpbnN0YW5jZW9mIFMpKXRocm93IHQ7dGhpcy5BZGRFcnJvcih0Lm1lc3NhZ2Usdm9pZCAwLHQudXNlRW5kTGluZU51bWJlcik7YnJlYWt9aWYoaSlicmVhaztpZih0aGlzLl9hc3luY0NvbnRpbnVlQWN0aXZlJiZuLkVsYXBzZWRNaWxsaXNlY29uZHM+dClicmVha313aGlsZSh0aGlzLmNhbkNvbnRpbnVlKTtuLlN0b3AoKSwhaSYmdGhpcy5jYW5Db250aW51ZXx8KG51bGwhPT10aGlzLl9zdGF0ZVNuYXBzaG90QXRMYXN0TmV3bGluZSYmdGhpcy5SZXN0b3JlU3RhdGVTbmFwc2hvdCgpLHRoaXMuY2FuQ29udGludWV8fCh0aGlzLnN0YXRlLmNhbGxTdGFjay5jYW5Qb3BUaHJlYWQmJnRoaXMuQWRkRXJyb3IoXCJUaHJlYWQgYXZhaWxhYmxlIHRvIHBvcCwgdGhyZWFkcyBzaG91bGQgYWx3YXlzIGJlIGZsYXQgYnkgdGhlIGVuZCBvZiBldmFsdWF0aW9uP1wiKSwwIT10aGlzLnN0YXRlLmdlbmVyYXRlZENob2ljZXMubGVuZ3RofHx0aGlzLnN0YXRlLmRpZFNhZmVFeGl0fHxudWxsIT10aGlzLl90ZW1wb3JhcnlFdmFsdWF0aW9uQ29udGFpbmVyfHwodGhpcy5zdGF0ZS5jYWxsU3RhY2suQ2FuUG9wKHIuVHVubmVsKT90aGlzLkFkZEVycm9yKFwidW5leHBlY3RlZGx5IHJlYWNoZWQgZW5kIG9mIGNvbnRlbnQuIERvIHlvdSBuZWVkIGEgJy0+LT4nIHRvIHJldHVybiBmcm9tIGEgdHVubmVsP1wiKTp0aGlzLnN0YXRlLmNhbGxTdGFjay5DYW5Qb3Aoci5GdW5jdGlvbik/dGhpcy5BZGRFcnJvcihcInVuZXhwZWN0ZWRseSByZWFjaGVkIGVuZCBvZiBjb250ZW50LiBEbyB5b3UgbmVlZCBhICd+IHJldHVybic/XCIpOnRoaXMuc3RhdGUuY2FsbFN0YWNrLmNhblBvcD90aGlzLkFkZEVycm9yKFwidW5leHBlY3RlZGx5IHJlYWNoZWQgZW5kIG9mIGNvbnRlbnQgZm9yIHVua25vd24gcmVhc29uLiBQbGVhc2UgZGVidWcgY29tcGlsZXIhXCIpOnRoaXMuQWRkRXJyb3IoXCJyYW4gb3V0IG9mIGNvbnRlbnQuIERvIHlvdSBuZWVkIGEgJy0+IERPTkUnIG9yICctPiBFTkQnP1wiKSkpLHRoaXMuc3RhdGUuZGlkU2FmZUV4aXQ9ITEsMT09dGhpcy5fcmVjdXJzaXZlQ29udGludWVDb3VudCYmKHRoaXMuX3N0YXRlLnZhcmlhYmxlc1N0YXRlLmJhdGNoT2JzZXJ2aW5nVmFyaWFibGVDaGFuZ2VzPSExKSx0aGlzLl9hc3luY0NvbnRpbnVlQWN0aXZlPSExKSx0aGlzLl9yZWN1cnNpdmVDb250aW51ZUNvdW50LS0sbnVsbCE9dGhpcy5fcHJvZmlsZXImJnRoaXMuX3Byb2ZpbGVyLlBvc3RDb250aW51ZSgpfUNvbnRpbnVlU2luZ2xlU3RlcCgpe2lmKG51bGwhPXRoaXMuX3Byb2ZpbGVyJiZ0aGlzLl9wcm9maWxlci5QcmVTdGVwKCksdGhpcy5TdGVwKCksbnVsbCE9dGhpcy5fcHJvZmlsZXImJnRoaXMuX3Byb2ZpbGVyLlBvc3RTdGVwKCksdGhpcy5jYW5Db250aW51ZXx8dGhpcy5zdGF0ZS5jYWxsU3RhY2suZWxlbWVudElzRXZhbHVhdGVGcm9tR2FtZXx8dGhpcy5UcnlGb2xsb3dEZWZhdWx0SW52aXNpYmxlQ2hvaWNlKCksbnVsbCE9dGhpcy5fcHJvZmlsZXImJnRoaXMuX3Byb2ZpbGVyLlByZVNuYXBzaG90KCksIXRoaXMuc3RhdGUuaW5TdHJpbmdFdmFsdWF0aW9uKXtpZihudWxsIT09dGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmUpe2lmKG51bGw9PT10aGlzLl9zdGF0ZVNuYXBzaG90QXRMYXN0TmV3bGluZS5jdXJyZW50VGFncylyZXR1cm4gZChcInRoaXMuX3N0YXRlQXRMYXN0TmV3bGluZS5jdXJyZW50VGFnc1wiKTtpZihudWxsPT09dGhpcy5zdGF0ZS5jdXJyZW50VGFncylyZXR1cm4gZChcInRoaXMuc3RhdGUuY3VycmVudFRhZ3NcIik7bGV0IHQ9dGhpcy5DYWxjdWxhdGVOZXdsaW5lT3V0cHV0U3RhdGVDaGFuZ2UodGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmUuY3VycmVudFRleHQsdGhpcy5zdGF0ZS5jdXJyZW50VGV4dCx0aGlzLl9zdGF0ZVNuYXBzaG90QXRMYXN0TmV3bGluZS5jdXJyZW50VGFncy5sZW5ndGgsdGhpcy5zdGF0ZS5jdXJyZW50VGFncy5sZW5ndGgpO2lmKHQ9PVguT3V0cHV0U3RhdGVDaGFuZ2UuRXh0ZW5kZWRCZXlvbmROZXdsaW5lKXJldHVybiB0aGlzLlJlc3RvcmVTdGF0ZVNuYXBzaG90KCksITA7dD09WC5PdXRwdXRTdGF0ZUNoYW5nZS5OZXdsaW5lUmVtb3ZlZCYmdGhpcy5EaXNjYXJkU25hcHNob3QoKX10aGlzLnN0YXRlLm91dHB1dFN0cmVhbUVuZHNJbk5ld2xpbmUmJih0aGlzLmNhbkNvbnRpbnVlP251bGw9PXRoaXMuX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lJiZ0aGlzLlN0YXRlU25hcHNob3QoKTp0aGlzLkRpc2NhcmRTbmFwc2hvdCgpKX1yZXR1cm4gbnVsbCE9dGhpcy5fcHJvZmlsZXImJnRoaXMuX3Byb2ZpbGVyLlBvc3RTbmFwc2hvdCgpLCExfUNhbGN1bGF0ZU5ld2xpbmVPdXRwdXRTdGF0ZUNoYW5nZSh0LGUsbixpKXtpZihudWxsPT09dClyZXR1cm4gZChcInByZXZUZXh0XCIpO2lmKG51bGw9PT1lKXJldHVybiBkKFwiY3VyclRleHRcIik7bGV0IHI9ZS5sZW5ndGg+PXQubGVuZ3RoJiZcIlxcblwiPT1lLmNoYXJBdCh0Lmxlbmd0aC0xKTtpZihuPT1pJiZ0Lmxlbmd0aD09ZS5sZW5ndGgmJnIpcmV0dXJuIFguT3V0cHV0U3RhdGVDaGFuZ2UuTm9DaGFuZ2U7aWYoIXIpcmV0dXJuIFguT3V0cHV0U3RhdGVDaGFuZ2UuTmV3bGluZVJlbW92ZWQ7aWYoaT5uKXJldHVybiBYLk91dHB1dFN0YXRlQ2hhbmdlLkV4dGVuZGVkQmV5b25kTmV3bGluZTtmb3IobGV0IG49dC5sZW5ndGg7bjxlLmxlbmd0aDtuKyspe2xldCB0PWUuY2hhckF0KG4pO2lmKFwiIFwiIT10JiZcIlxcdFwiIT10KXJldHVybiBYLk91dHB1dFN0YXRlQ2hhbmdlLkV4dGVuZGVkQmV5b25kTmV3bGluZX1yZXR1cm4gWC5PdXRwdXRTdGF0ZUNoYW5nZS5Ob0NoYW5nZX1Db250aW51ZU1heGltYWxseSgpe3RoaXMuSWZBc3luY1dlQ2FudChcIkNvbnRpbnVlTWF4aW1hbGx5XCIpO2xldCB0PW5ldyBtO2Zvcig7dGhpcy5jYW5Db250aW51ZTspdC5BcHBlbmQodGhpcy5Db250aW51ZSgpKTtyZXR1cm4gdC50b1N0cmluZygpfUNvbnRlbnRBdFBhdGgodCl7cmV0dXJuIHRoaXMubWFpbkNvbnRlbnRDb250YWluZXIuQ29udGVudEF0UGF0aCh0KX1Lbm90Q29udGFpbmVyV2l0aE5hbWUodCl7bGV0IGU9dGhpcy5tYWluQ29udGVudENvbnRhaW5lci5uYW1lZENvbnRlbnQuZ2V0KHQpO3JldHVybiBlIGluc3RhbmNlb2YgTj9lOm51bGx9UG9pbnRlckF0UGF0aCh0KXtpZigwPT10Lmxlbmd0aClyZXR1cm4gSS5OdWxsO2xldCBlPW5ldyBJLG49dC5sZW5ndGgsaT1udWxsO3JldHVybiBudWxsPT09dC5sYXN0Q29tcG9uZW50P2QoXCJwYXRoLmxhc3RDb21wb25lbnRcIik6KHQubGFzdENvbXBvbmVudC5pc0luZGV4PyhuPXQubGVuZ3RoLTEsaT10aGlzLm1haW5Db250ZW50Q29udGFpbmVyLkNvbnRlbnRBdFBhdGgodCx2b2lkIDAsbiksZS5jb250YWluZXI9aS5jb250YWluZXIsZS5pbmRleD10Lmxhc3RDb21wb25lbnQuaW5kZXgpOihpPXRoaXMubWFpbkNvbnRlbnRDb250YWluZXIuQ29udGVudEF0UGF0aCh0KSxlLmNvbnRhaW5lcj1pLmNvbnRhaW5lcixlLmluZGV4PS0xKSxudWxsPT1pLm9ianx8aS5vYmo9PXRoaXMubWFpbkNvbnRlbnRDb250YWluZXImJm4+MD90aGlzLkVycm9yKFwiRmFpbGVkIHRvIGZpbmQgY29udGVudCBhdCBwYXRoICdcIit0K1wiJywgYW5kIG5vIGFwcHJveGltYXRpb24gb2YgaXQgd2FzIHBvc3NpYmxlLlwiKTppLmFwcHJveGltYXRlJiZ0aGlzLldhcm5pbmcoXCJGYWlsZWQgdG8gZmluZCBjb250ZW50IGF0IHBhdGggJ1wiK3QrXCInLCBzbyBpdCB3YXMgYXBwcm94aW1hdGVkIHRvOiAnXCIraS5vYmoucGF0aCtcIicuXCIpLGUpfVN0YXRlU25hcHNob3QoKXt0aGlzLl9zdGF0ZVNuYXBzaG90QXRMYXN0TmV3bGluZT10aGlzLl9zdGF0ZSx0aGlzLl9zdGF0ZT10aGlzLl9zdGF0ZS5Db3B5QW5kU3RhcnRQYXRjaGluZygpfVJlc3RvcmVTdGF0ZVNuYXBzaG90KCl7bnVsbD09PXRoaXMuX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lJiZkKFwiX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lXCIpLHRoaXMuX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lLlJlc3RvcmVBZnRlclBhdGNoKCksdGhpcy5fc3RhdGU9dGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmUsdGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmU9bnVsbCx0aGlzLl9hc3luY1NhdmluZ3x8dGhpcy5fc3RhdGUuQXBwbHlBbnlQYXRjaCgpfURpc2NhcmRTbmFwc2hvdCgpe3RoaXMuX2FzeW5jU2F2aW5nfHx0aGlzLl9zdGF0ZS5BcHBseUFueVBhdGNoKCksdGhpcy5fc3RhdGVTbmFwc2hvdEF0TGFzdE5ld2xpbmU9bnVsbH1Db3B5U3RhdGVGb3JCYWNrZ3JvdW5kVGhyZWFkU2F2ZSgpe2lmKHRoaXMuSWZBc3luY1dlQ2FudChcInN0YXJ0IHNhdmluZyBvbiBhIGJhY2tncm91bmQgdGhyZWFkXCIpLHRoaXMuX2FzeW5jU2F2aW5nKXRocm93IG5ldyBFcnJvcihcIlN0b3J5IGlzIGFscmVhZHkgaW4gYmFja2dyb3VuZCBzYXZpbmcgbW9kZSwgY2FuJ3QgY2FsbCBDb3B5U3RhdGVGb3JCYWNrZ3JvdW5kVGhyZWFkU2F2ZSBhZ2FpbiFcIik7bGV0IHQ9dGhpcy5fc3RhdGU7cmV0dXJuIHRoaXMuX3N0YXRlPXRoaXMuX3N0YXRlLkNvcHlBbmRTdGFydFBhdGNoaW5nKCksdGhpcy5fYXN5bmNTYXZpbmc9ITAsdH1CYWNrZ3JvdW5kU2F2ZUNvbXBsZXRlKCl7bnVsbD09PXRoaXMuX3N0YXRlU25hcHNob3RBdExhc3ROZXdsaW5lJiZ0aGlzLl9zdGF0ZS5BcHBseUFueVBhdGNoKCksdGhpcy5fYXN5bmNTYXZpbmc9ITF9U3RlcCgpe2xldCB0PSEwLGU9dGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlci5jb3B5KCk7aWYoZS5pc051bGwpcmV0dXJuO2xldCBuPWEoZS5SZXNvbHZlKCksTik7Zm9yKDtuJiYodGhpcy5WaXNpdENvbnRhaW5lcihuLCEwKSwwIT1uLmNvbnRlbnQubGVuZ3RoKTspZT1JLlN0YXJ0T2Yobiksbj1hKGUuUmVzb2x2ZSgpLE4pO3RoaXMuc3RhdGUuY3VycmVudFBvaW50ZXI9ZS5jb3B5KCksbnVsbCE9dGhpcy5fcHJvZmlsZXImJnRoaXMuX3Byb2ZpbGVyLlN0ZXAodGhpcy5zdGF0ZS5jYWxsU3RhY2spO2xldCBpPWUuUmVzb2x2ZSgpLHI9dGhpcy5QZXJmb3JtTG9naWNBbmRGbG93Q29udHJvbChpKTtpZih0aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLmlzTnVsbClyZXR1cm47ciYmKHQ9ITEpO2xldCBzPWEoaSxXKTtpZihzKXtsZXQgZT10aGlzLlByb2Nlc3NDaG9pY2Uocyk7ZSYmdGhpcy5zdGF0ZS5nZW5lcmF0ZWRDaG9pY2VzLnB1c2goZSksaT1udWxsLHQ9ITF9aWYoaSBpbnN0YW5jZW9mIE4mJih0PSExKSx0KXtsZXQgdD1hKGksdyk7aWYodCYmLTE9PXQuY29udGV4dEluZGV4KXtsZXQgZT10aGlzLnN0YXRlLmNhbGxTdGFjay5Db250ZXh0Rm9yVmFyaWFibGVOYW1lZCh0LnZhcmlhYmxlTmFtZSk7aT1uZXcgdyh0LnZhcmlhYmxlTmFtZSxlKX10aGlzLnN0YXRlLmluRXhwcmVzc2lvbkV2YWx1YXRpb24/dGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKGkpOnRoaXMuc3RhdGUuUHVzaFRvT3V0cHV0U3RyZWFtKGkpfXRoaXMuTmV4dENvbnRlbnQoKTtsZXQgbD1hKGksQSk7bCYmbC5jb21tYW5kVHlwZT09QS5Db21tYW5kVHlwZS5TdGFydFRocmVhZCYmdGhpcy5zdGF0ZS5jYWxsU3RhY2suUHVzaFRocmVhZCgpfVZpc2l0Q29udGFpbmVyKHQsZSl7dC5jb3VudGluZ0F0U3RhcnRPbmx5JiYhZXx8KHQudmlzaXRzU2hvdWxkQmVDb3VudGVkJiZ0aGlzLnN0YXRlLkluY3JlbWVudFZpc2l0Q291bnRGb3JDb250YWluZXIodCksdC50dXJuSW5kZXhTaG91bGRCZUNvdW50ZWQmJnRoaXMuc3RhdGUuUmVjb3JkVHVybkluZGV4VmlzaXRUb0NvbnRhaW5lcih0KSl9VmlzaXRDaGFuZ2VkQ29udGFpbmVyc0R1ZVRvRGl2ZXJ0KCl7bGV0IHQ9dGhpcy5zdGF0ZS5wcmV2aW91c1BvaW50ZXIuY29weSgpLGU9dGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlci5jb3B5KCk7aWYoZS5pc051bGx8fC0xPT1lLmluZGV4KXJldHVybjtpZih0aGlzLl9wcmV2Q29udGFpbmVycy5sZW5ndGg9MCwhdC5pc051bGwpe2xldCBlPWEodC5SZXNvbHZlKCksTil8fGEodC5jb250YWluZXIsTik7Zm9yKDtlOyl0aGlzLl9wcmV2Q29udGFpbmVycy5wdXNoKGUpLGU9YShlLnBhcmVudCxOKX1sZXQgbj1lLlJlc29sdmUoKTtpZihudWxsPT1uKXJldHVybjtsZXQgaT1hKG4ucGFyZW50LE4pO2Zvcig7aSYmKHRoaXMuX3ByZXZDb250YWluZXJzLmluZGV4T2YoaSk8MHx8aS5jb3VudGluZ0F0U3RhcnRPbmx5KTspe2xldCB0PWkuY29udGVudC5sZW5ndGg+MCYmbj09aS5jb250ZW50WzBdO3RoaXMuVmlzaXRDb250YWluZXIoaSx0KSxuPWksaT1hKGkucGFyZW50LE4pfX1Qcm9jZXNzQ2hvaWNlKHQpe2xldCBlPSEwO2lmKHQuaGFzQ29uZGl0aW9uKXtsZXQgdD10aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpO3RoaXMuSXNUcnV0aHkodCl8fChlPSExKX1sZXQgbj1cIlwiLGk9XCJcIjtpZih0Lmhhc0Nob2ljZU9ubHlDb250ZW50KXtpPXModGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSxUKS52YWx1ZXx8XCJcIn1pZih0Lmhhc1N0YXJ0Q29udGVudCl7bj1zKHRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCksVCkudmFsdWV8fFwiXCJ9aWYodC5vbmNlT25seSl7dGhpcy5zdGF0ZS5WaXNpdENvdW50Rm9yQ29udGFpbmVyKHQuY2hvaWNlVGFyZ2V0KT4wJiYoZT0hMSl9aWYoIWUpcmV0dXJuIG51bGw7bGV0IHI9bmV3IEQ7cmV0dXJuIHIudGFyZ2V0UGF0aD10LnBhdGhPbkNob2ljZSxyLnNvdXJjZVBhdGg9dC5wYXRoLnRvU3RyaW5nKCksci5pc0ludmlzaWJsZURlZmF1bHQ9dC5pc0ludmlzaWJsZURlZmF1bHQsci50aHJlYWRBdEdlbmVyYXRpb249dGhpcy5zdGF0ZS5jYWxsU3RhY2suRm9ya1RocmVhZCgpLHIudGV4dD0obitpKS5yZXBsYWNlKC9eWyBcXHRdK3xbIFxcdF0rJC9nLFwiXCIpLHJ9SXNUcnV0aHkodCl7aWYodCBpbnN0YW5jZW9mIHYpe2xldCBlPXQ7aWYoZSBpbnN0YW5jZW9mIFApe2xldCB0PWU7cmV0dXJuIHRoaXMuRXJyb3IoXCJTaG91bGRuJ3QgdXNlIGEgZGl2ZXJ0IHRhcmdldCAodG8gXCIrdC50YXJnZXRQYXRoK1wiKSBhcyBhIGNvbmRpdGlvbmFsIHZhbHVlLiBEaWQgeW91IGludGVuZCBhIGZ1bmN0aW9uIGNhbGwgJ2xpa2VUaGlzKCknIG9yIGEgcmVhZCBjb3VudCBjaGVjayAnbGlrZVRoaXMnPyAobm8gYXJyb3dzKVwiKSwhMX1yZXR1cm4gZS5pc1RydXRoeX1yZXR1cm4hMX1QZXJmb3JtTG9naWNBbmRGbG93Q29udHJvbCh0KXtpZihudWxsPT10KXJldHVybiExO2lmKHQgaW5zdGFuY2VvZiBrKXtsZXQgZT10O2lmKGUuaXNDb25kaXRpb25hbCl7bGV0IHQ9dGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKTtpZighdGhpcy5Jc1RydXRoeSh0KSlyZXR1cm4hMH1pZihlLmhhc1ZhcmlhYmxlVGFyZ2V0KXtsZXQgdD1lLnZhcmlhYmxlRGl2ZXJ0TmFtZSxuPXRoaXMuc3RhdGUudmFyaWFibGVzU3RhdGUuR2V0VmFyaWFibGVXaXRoTmFtZSh0KTtpZihudWxsPT1uKXRoaXMuRXJyb3IoXCJUcmllZCB0byBkaXZlcnQgdXNpbmcgYSB0YXJnZXQgZnJvbSBhIHZhcmlhYmxlIHRoYXQgY291bGQgbm90IGJlIGZvdW5kIChcIit0K1wiKVwiKTtlbHNlIGlmKCEobiBpbnN0YW5jZW9mIFApKXtsZXQgZT1hKG4sYiksaT1cIlRyaWVkIHRvIGRpdmVydCB0byBhIHRhcmdldCBmcm9tIGEgdmFyaWFibGUsIGJ1dCB0aGUgdmFyaWFibGUgKFwiK3QrXCIpIGRpZG4ndCBjb250YWluIGEgZGl2ZXJ0IHRhcmdldCwgaXQgXCI7ZSBpbnN0YW5jZW9mIGImJjA9PWUudmFsdWU/aSs9XCJ3YXMgZW1wdHkvbnVsbCAodGhlIHZhbHVlIDApLlwiOmkrPVwiY29udGFpbmVkICdcIituK1wiJy5cIix0aGlzLkVycm9yKGkpfWxldCBpPXMobixQKTt0aGlzLnN0YXRlLmRpdmVydGVkUG9pbnRlcj10aGlzLlBvaW50ZXJBdFBhdGgoaS50YXJnZXRQYXRoKX1lbHNle2lmKGUuaXNFeHRlcm5hbClyZXR1cm4gdGhpcy5DYWxsRXh0ZXJuYWxGdW5jdGlvbihlLnRhcmdldFBhdGhTdHJpbmcsZS5leHRlcm5hbEFyZ3MpLCEwO3RoaXMuc3RhdGUuZGl2ZXJ0ZWRQb2ludGVyPWUudGFyZ2V0UG9pbnRlci5jb3B5KCl9cmV0dXJuIGUucHVzaGVzVG9TdGFjayYmdGhpcy5zdGF0ZS5jYWxsU3RhY2suUHVzaChlLnN0YWNrUHVzaFR5cGUsdm9pZCAwLHRoaXMuc3RhdGUub3V0cHV0U3RyZWFtLmxlbmd0aCksdGhpcy5zdGF0ZS5kaXZlcnRlZFBvaW50ZXIuaXNOdWxsJiYhZS5pc0V4dGVybmFsJiYoZSYmZS5kZWJ1Z01ldGFkYXRhJiZudWxsIT1lLmRlYnVnTWV0YWRhdGEuc291cmNlTmFtZT90aGlzLkVycm9yKFwiRGl2ZXJ0IHRhcmdldCBkb2Vzbid0IGV4aXN0OiBcIitlLmRlYnVnTWV0YWRhdGEuc291cmNlTmFtZSk6dGhpcy5FcnJvcihcIkRpdmVydCByZXNvbHV0aW9uIGZhaWxlZDogXCIrZSkpLCEwfWlmKHQgaW5zdGFuY2VvZiBBKXtsZXQgZT10O3N3aXRjaChlLmNvbW1hbmRUeXBlKXtjYXNlIEEuQ29tbWFuZFR5cGUuRXZhbFN0YXJ0OnRoaXMuQXNzZXJ0KCExPT09dGhpcy5zdGF0ZS5pbkV4cHJlc3Npb25FdmFsdWF0aW9uLFwiQWxyZWFkeSBpbiBleHByZXNzaW9uIGV2YWx1YXRpb24/XCIpLHRoaXMuc3RhdGUuaW5FeHByZXNzaW9uRXZhbHVhdGlvbj0hMDticmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuRXZhbEVuZDp0aGlzLkFzc2VydCghMD09PXRoaXMuc3RhdGUuaW5FeHByZXNzaW9uRXZhbHVhdGlvbixcIk5vdCBpbiBleHByZXNzaW9uIGV2YWx1YXRpb24gbW9kZVwiKSx0aGlzLnN0YXRlLmluRXhwcmVzc2lvbkV2YWx1YXRpb249ITE7YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLkV2YWxPdXRwdXQ6aWYodGhpcy5zdGF0ZS5ldmFsdWF0aW9uU3RhY2subGVuZ3RoPjApe2xldCB0PXRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCk7aWYoISh0IGluc3RhbmNlb2YgTCkpe2xldCBlPW5ldyBUKHQudG9TdHJpbmcoKSk7dGhpcy5zdGF0ZS5QdXNoVG9PdXRwdXRTdHJlYW0oZSl9fWJyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5Ob09wOmJyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5EdXBsaWNhdGU6dGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKHRoaXMuc3RhdGUuUGVla0V2YWx1YXRpb25TdGFjaygpKTticmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuUG9wRXZhbHVhdGVkVmFsdWU6dGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKTticmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuUG9wRnVuY3Rpb246Y2FzZSBBLkNvbW1hbmRUeXBlLlBvcFR1bm5lbDpsZXQgdD1lLmNvbW1hbmRUeXBlPT1BLkNvbW1hbmRUeXBlLlBvcEZ1bmN0aW9uP3IuRnVuY3Rpb246ci5UdW5uZWwsbj1udWxsO2lmKHQ9PXIuVHVubmVsKXtsZXQgdD10aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpO249YSh0LFApLG51bGw9PT1uJiZ0aGlzLkFzc2VydCh0IGluc3RhbmNlb2YgTCxcIkV4cGVjdGVkIHZvaWQgaWYgLT4tPiBkb2Vzbid0IG92ZXJyaWRlIHRhcmdldFwiKX1pZih0aGlzLnN0YXRlLlRyeUV4aXRGdW5jdGlvbkV2YWx1YXRpb25Gcm9tR2FtZSgpKWJyZWFrO2lmKHRoaXMuc3RhdGUuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LnR5cGU9PXQmJnRoaXMuc3RhdGUuY2FsbFN0YWNrLmNhblBvcCl0aGlzLnN0YXRlLlBvcENhbGxTdGFjaygpLG4mJih0aGlzLnN0YXRlLmRpdmVydGVkUG9pbnRlcj10aGlzLlBvaW50ZXJBdFBhdGgobi50YXJnZXRQYXRoKSk7ZWxzZXtsZXQgZT1uZXcgTWFwO2Uuc2V0KHIuRnVuY3Rpb24sXCJmdW5jdGlvbiByZXR1cm4gc3RhdGVtZW50ICh+IHJldHVybilcIiksZS5zZXQoci5UdW5uZWwsXCJ0dW5uZWwgb253YXJkcyBzdGF0ZW1lbnQgKC0+LT4pXCIpO2xldCBuPWUuZ2V0KHRoaXMuc3RhdGUuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LnR5cGUpO3RoaXMuc3RhdGUuY2FsbFN0YWNrLmNhblBvcHx8KG49XCJlbmQgb2YgZmxvdyAoLT4gRU5EIG9yIGNob2ljZSlcIik7bGV0IGk9XCJGb3VuZCBcIitlLmdldCh0KStcIiwgd2hlbiBleHBlY3RlZCBcIituO3RoaXMuRXJyb3IoaSl9YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLkJlZ2luU3RyaW5nOnRoaXMuc3RhdGUuUHVzaFRvT3V0cHV0U3RyZWFtKGUpLHRoaXMuQXNzZXJ0KCEwPT09dGhpcy5zdGF0ZS5pbkV4cHJlc3Npb25FdmFsdWF0aW9uLFwiRXhwZWN0ZWQgdG8gYmUgaW4gYW4gZXhwcmVzc2lvbiB3aGVuIGV2YWx1YXRpbmcgYSBzdHJpbmdcIiksdGhpcy5zdGF0ZS5pbkV4cHJlc3Npb25FdmFsdWF0aW9uPSExO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5FbmRTdHJpbmc6bGV0IGk9W10sbD0wO2ZvcihsZXQgdD10aGlzLnN0YXRlLm91dHB1dFN0cmVhbS5sZW5ndGgtMTt0Pj0wOy0tdCl7bGV0IGU9dGhpcy5zdGF0ZS5vdXRwdXRTdHJlYW1bdF07bCsrO2xldCBuPWEoZSxBKTtpZihuJiZuLmNvbW1hbmRUeXBlPT1BLkNvbW1hbmRUeXBlLkJlZ2luU3RyaW5nKWJyZWFrO2UgaW5zdGFuY2VvZiBUJiZpLnB1c2goZSl9dGhpcy5zdGF0ZS5Qb3BGcm9tT3V0cHV0U3RyZWFtKGwpLGk9aS5yZXZlcnNlKCk7bGV0IG89bmV3IG07Zm9yKGxldCB0IG9mIGkpby5BcHBlbmQodC50b1N0cmluZygpKTt0aGlzLnN0YXRlLmluRXhwcmVzc2lvbkV2YWx1YXRpb249ITAsdGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKG5ldyBUKG8udG9TdHJpbmcoKSkpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5DaG9pY2VDb3VudDpsZXQgdT10aGlzLnN0YXRlLmdlbmVyYXRlZENob2ljZXMubGVuZ3RoO3RoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhuZXcgYih1KSk7YnJlYWs7Y2FzZSBBLkNvbW1hbmRUeXBlLlR1cm5zOnRoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhuZXcgYih0aGlzLnN0YXRlLmN1cnJlbnRUdXJuSW5kZXgrMSkpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5UdXJuc1NpbmNlOmNhc2UgQS5Db21tYW5kVHlwZS5SZWFkQ291bnQ6bGV0IGg9dGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKTtpZighKGggaW5zdGFuY2VvZiBQKSl7bGV0IHQ9XCJcIjtoIGluc3RhbmNlb2YgYiYmKHQ9XCIuIERpZCB5b3UgYWNjaWRlbnRhbGx5IHBhc3MgYSByZWFkIGNvdW50ICgna25vdF9uYW1lJykgaW5zdGVhZCBvZiBhIHRhcmdldCAoJy0+IGtub3RfbmFtZScpP1wiKSx0aGlzLkVycm9yKFwiVFVSTlNfU0lOQ0UgLyBSRUFEX0NPVU5UIGV4cGVjdGVkIGEgZGl2ZXJ0IHRhcmdldCAoa25vdCwgc3RpdGNoLCBsYWJlbCBuYW1lKSwgYnV0IHNhdyBcIitoK3QpO2JyZWFrfWxldCBjLHA9cyhoLFApLHk9YSh0aGlzLkNvbnRlbnRBdFBhdGgocC50YXJnZXRQYXRoKS5jb3JyZWN0T2JqLE4pO251bGwhPXk/Yz1lLmNvbW1hbmRUeXBlPT1BLkNvbW1hbmRUeXBlLlR1cm5zU2luY2U/dGhpcy5zdGF0ZS5UdXJuc1NpbmNlRm9yQ29udGFpbmVyKHkpOnRoaXMuc3RhdGUuVmlzaXRDb3VudEZvckNvbnRhaW5lcih5KTooYz1lLmNvbW1hbmRUeXBlPT1BLkNvbW1hbmRUeXBlLlR1cm5zU2luY2U/LTE6MCx0aGlzLldhcm5pbmcoXCJGYWlsZWQgdG8gZmluZCBjb250YWluZXIgZm9yIFwiK2UudG9TdHJpbmcoKStcIiBsb29rdXAgYXQgXCIrcC50YXJnZXRQYXRoLnRvU3RyaW5nKCkpKSx0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2sobmV3IGIoYykpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5SYW5kb206e2xldCB0PWEodGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSxiKSxlPWEodGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSxiKTtpZihudWxsPT1lfHxlIGluc3RhbmNlb2YgYj09ITEpcmV0dXJuIHRoaXMuRXJyb3IoXCJJbnZhbGlkIHZhbHVlIGZvciBtaW5pbXVtIHBhcmFtZXRlciBvZiBSQU5ET00obWluLCBtYXgpXCIpO2lmKG51bGw9PXR8fGUgaW5zdGFuY2VvZiBiPT0hMSlyZXR1cm4gdGhpcy5FcnJvcihcIkludmFsaWQgdmFsdWUgZm9yIG1heGltdW0gcGFyYW1ldGVyIG9mIFJBTkRPTShtaW4sIG1heClcIik7aWYobnVsbD09PXQudmFsdWUpcmV0dXJuIGQoXCJtYXhJbnQudmFsdWVcIik7aWYobnVsbD09PWUudmFsdWUpcmV0dXJuIGQoXCJtaW5JbnQudmFsdWVcIik7bGV0IG49dC52YWx1ZS1lLnZhbHVlKzE7bjw9MCYmdGhpcy5FcnJvcihcIlJBTkRPTSB3YXMgY2FsbGVkIHdpdGggbWluaW11bSBhcyBcIitlLnZhbHVlK1wiIGFuZCBtYXhpbXVtIGFzIFwiK3QudmFsdWUrXCIuIFRoZSBtYXhpbXVtIG11c3QgYmUgbGFyZ2VyXCIpO2xldCBpPXRoaXMuc3RhdGUuc3RvcnlTZWVkK3RoaXMuc3RhdGUucHJldmlvdXNSYW5kb20scj1uZXcgSyhpKS5uZXh0KCkscz1yJW4rZS52YWx1ZTt0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2sobmV3IGIocykpLHRoaXMuc3RhdGUucHJldmlvdXNSYW5kb209cjticmVha31jYXNlIEEuQ29tbWFuZFR5cGUuU2VlZFJhbmRvbTpsZXQgQz1hKHRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCksYik7aWYobnVsbD09Q3x8QyBpbnN0YW5jZW9mIGI9PSExKXJldHVybiB0aGlzLkVycm9yKFwiSW52YWxpZCB2YWx1ZSBwYXNzZWQgdG8gU0VFRF9SQU5ET01cIik7aWYobnVsbD09PUMudmFsdWUpcmV0dXJuIGQoXCJtaW5JbnQudmFsdWVcIik7dGhpcy5zdGF0ZS5zdG9yeVNlZWQ9Qy52YWx1ZSx0aGlzLnN0YXRlLnByZXZpb3VzUmFuZG9tPTAsdGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKG5ldyBMKTticmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuVmlzaXRJbmRleDpsZXQgXz10aGlzLnN0YXRlLlZpc2l0Q291bnRGb3JDb250YWluZXIodGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlci5jb250YWluZXIpLTE7dGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKG5ldyBiKF8pKTticmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuU2VxdWVuY2VTaHVmZmxlSW5kZXg6bGV0IHc9dGhpcy5OZXh0U2VxdWVuY2VTaHVmZmxlSW5kZXgoKTt0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2sobmV3IGIodykpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5TdGFydFRocmVhZDpicmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuRG9uZTp0aGlzLnN0YXRlLmNhbGxTdGFjay5jYW5Qb3BUaHJlYWQ/dGhpcy5zdGF0ZS5jYWxsU3RhY2suUG9wVGhyZWFkKCk6KHRoaXMuc3RhdGUuZGlkU2FmZUV4aXQ9ITAsdGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlcj1JLk51bGwpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5FbmQ6dGhpcy5zdGF0ZS5Gb3JjZUVuZCgpO2JyZWFrO2Nhc2UgQS5Db21tYW5kVHlwZS5MaXN0RnJvbUludDpsZXQgRT1hKHRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCksYikseD1zKHRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCksVCk7aWYobnVsbD09PUUpdGhyb3cgbmV3IFMoXCJQYXNzZWQgbm9uLWludGVnZXIgd2hlbiBjcmVhdGluZyBhIGxpc3QgZWxlbWVudCBmcm9tIGEgbnVtZXJpY2FsIHZhbHVlLlwiKTtsZXQgaz1udWxsO2lmKG51bGw9PT10aGlzLmxpc3REZWZpbml0aW9ucylyZXR1cm4gZChcInRoaXMubGlzdERlZmluaXRpb25zXCIpO2xldCBXPXRoaXMubGlzdERlZmluaXRpb25zLlRyeUxpc3RHZXREZWZpbml0aW9uKHgudmFsdWUsbnVsbCk7aWYoIVcuZXhpc3RzKXRocm93IG5ldyBTKFwiRmFpbGVkIHRvIGZpbmQgTElTVCBjYWxsZWQgXCIreC52YWx1ZSk7e2lmKG51bGw9PT1FLnZhbHVlKXJldHVybiBkKFwibWluSW50LnZhbHVlXCIpO2xldCB0PVcucmVzdWx0LlRyeUdldEl0ZW1XaXRoVmFsdWUoRS52YWx1ZSxmLk51bGwpO3QuZXhpc3RzJiYoaz1uZXcgTyh0LnJlc3VsdCxFLnZhbHVlKSl9bnVsbD09ayYmKGs9bmV3IE8pLHRoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhrKTticmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuTGlzdFJhbmdlOmxldCBGPWEodGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSx2KSxWPWEodGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSx2KSxSPWEodGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSxPKTtpZihudWxsPT09Unx8bnVsbD09PVZ8fG51bGw9PT1GKXRocm93IG5ldyBTKFwiRXhwZWN0ZWQgbGlzdCwgbWluaW11bSBhbmQgbWF4aW11bSBmb3IgTElTVF9SQU5HRVwiKTtpZihudWxsPT09Ui52YWx1ZSlyZXR1cm4gZChcInRhcmdldExpc3QudmFsdWVcIik7bGV0IGo9Ui52YWx1ZS5MaXN0V2l0aFN1YlJhbmdlKFYudmFsdWVPYmplY3QsRi52YWx1ZU9iamVjdCk7dGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKG5ldyBPKGopKTticmVhaztjYXNlIEEuQ29tbWFuZFR5cGUuTGlzdFJhbmRvbTp7bGV0IHQ9dGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKTtpZihudWxsPT09dCl0aHJvdyBuZXcgUyhcIkV4cGVjdGVkIGxpc3QgZm9yIExJU1RfUkFORE9NXCIpO2xldCBlPXQudmFsdWUsbj1udWxsO2lmKG51bGw9PT1lKXRocm93IGQoXCJsaXN0XCIpO2lmKDA9PWUuQ291bnQpbj1uZXcgZztlbHNle2xldCB0PXRoaXMuc3RhdGUuc3RvcnlTZWVkK3RoaXMuc3RhdGUucHJldmlvdXNSYW5kb20saT1uZXcgSyh0KS5uZXh0KCkscj1pJWUuQ291bnQsYT1lLmVudHJpZXMoKTtmb3IobGV0IHQ9MDt0PD1yLTE7dCsrKWEubmV4dCgpO2xldCBzPWEubmV4dCgpLnZhbHVlLGw9e0tleTpmLmZyb21TZXJpYWxpemVkS2V5KHNbMF0pLFZhbHVlOnNbMV19O2lmKG51bGw9PT1sLktleS5vcmlnaW5OYW1lKXJldHVybiBkKFwicmFuZG9tSXRlbS5LZXkub3JpZ2luTmFtZVwiKTtuPW5ldyBnKGwuS2V5Lm9yaWdpbk5hbWUsdGhpcyksbi5BZGQobC5LZXksbC5WYWx1ZSksdGhpcy5zdGF0ZS5wcmV2aW91c1JhbmRvbT1pfXRoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhuZXcgTyhuKSk7YnJlYWt9ZGVmYXVsdDp0aGlzLkVycm9yKFwidW5oYW5kbGVkIENvbnRyb2xDb21tYW5kOiBcIitlKX1yZXR1cm4hMH1pZih0IGluc3RhbmNlb2YgVil7bGV0IGU9dCxuPXRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKCk7cmV0dXJuIHRoaXMuc3RhdGUudmFyaWFibGVzU3RhdGUuQXNzaWduKGUsbiksITB9aWYodCBpbnN0YW5jZW9mIEYpe2xldCBlPXQsbj1udWxsO2lmKG51bGwhPWUucGF0aEZvckNvdW50KXtsZXQgdD1lLmNvbnRhaW5lckZvckNvdW50LGk9dGhpcy5zdGF0ZS5WaXNpdENvdW50Rm9yQ29udGFpbmVyKHQpO249bmV3IGIoaSl9ZWxzZSBuPXRoaXMuc3RhdGUudmFyaWFibGVzU3RhdGUuR2V0VmFyaWFibGVXaXRoTmFtZShlLm5hbWUpLG51bGw9PW4mJih0aGlzLldhcm5pbmcoXCJWYXJpYWJsZSBub3QgZm91bmQ6ICdcIitlLm5hbWUrXCInLiBVc2luZyBkZWZhdWx0IHZhbHVlIG9mIDAgKGZhbHNlKS4gVGhpcyBjYW4gaGFwcGVuIHdpdGggdGVtcG9yYXJ5IHZhcmlhYmxlcyBpZiB0aGUgZGVjbGFyYXRpb24gaGFzbid0IHlldCBiZWVuIGhpdC4gR2xvYmFscyBhcmUgYWx3YXlzIGdpdmVuIGEgZGVmYXVsdCB2YWx1ZSBvbiBsb2FkIGlmIGEgdmFsdWUgZG9lc24ndCBleGlzdCBpbiB0aGUgc2F2ZSBzdGF0ZS5cIiksbj1uZXcgYigwKSk7cmV0dXJuIHRoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhuKSwhMH1pZih0IGluc3RhbmNlb2YgUil7bGV0IGU9dCxuPXRoaXMuc3RhdGUuUG9wRXZhbHVhdGlvblN0YWNrKGUubnVtYmVyT2ZQYXJhbWV0ZXJzKSxpPWUuQ2FsbChuKTtyZXR1cm4gdGhpcy5zdGF0ZS5QdXNoRXZhbHVhdGlvblN0YWNrKGkpLCEwfXJldHVybiExfUNob29zZVBhdGhTdHJpbmcodCxuPSEwLGk9W10pe2lmKHRoaXMuSWZBc3luY1dlQ2FudChcImNhbGwgQ2hvb3NlUGF0aFN0cmluZyByaWdodCBub3dcIiksbil0aGlzLlJlc2V0Q2FsbHN0YWNrKCk7ZWxzZSBpZih0aGlzLnN0YXRlLmNhbGxTdGFjay5jdXJyZW50RWxlbWVudC50eXBlPT1yLkZ1bmN0aW9uKXtsZXQgZT1cIlwiLG49dGhpcy5zdGF0ZS5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQuY3VycmVudFBvaW50ZXIuY29udGFpbmVyO3Rocm93IG51bGwhPW4mJihlPVwiKFwiK24ucGF0aC50b1N0cmluZygpK1wiKSBcIiksbmV3IEVycm9yKFwiU3Rvcnkgd2FzIHJ1bm5pbmcgYSBmdW5jdGlvbiBcIitlK1wid2hlbiB5b3UgY2FsbGVkIENob29zZVBhdGhTdHJpbmcoXCIrdCtcIikgLSB0aGlzIGlzIGFsbW9zdCBjZXJ0YWlubHkgbm90IG5vdCB3aGF0IHlvdSB3YW50ISBGdWxsIHN0YWNrIHRyYWNlOiBcXG5cIit0aGlzLnN0YXRlLmNhbGxTdGFjay5jYWxsU3RhY2tUcmFjZSl9dGhpcy5zdGF0ZS5QYXNzQXJndW1lbnRzVG9FdmFsdWF0aW9uU3RhY2soaSksdGhpcy5DaG9vc2VQYXRoKG5ldyBlKHQpKX1JZkFzeW5jV2VDYW50KHQpe2lmKHRoaXMuX2FzeW5jQ29udGludWVBY3RpdmUpdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgXCIrdCtcIi4gU3RvcnkgaXMgaW4gdGhlIG1pZGRsZSBvZiBhIENvbnRpbnVlQXN5bmMoKS4gTWFrZSBtb3JlIENvbnRpbnVlQXN5bmMoKSBjYWxscyBvciBhIHNpbmdsZSBDb250aW51ZSgpIGNhbGwgYmVmb3JlaGFuZC5cIil9Q2hvb3NlUGF0aCh0LGU9ITApe3RoaXMuc3RhdGUuU2V0Q2hvc2VuUGF0aCh0LGUpLHRoaXMuVmlzaXRDaGFuZ2VkQ29udGFpbmVyc0R1ZVRvRGl2ZXJ0KCl9Q2hvb3NlQ2hvaWNlSW5kZXgodCl7dD10O2xldCBlPXRoaXMuY3VycmVudENob2ljZXM7dGhpcy5Bc3NlcnQodD49MCYmdDxlLmxlbmd0aCxcImNob2ljZSBvdXQgb2YgcmFuZ2VcIik7bGV0IG49ZVt0XTtyZXR1cm4gbnVsbD09PW4udGhyZWFkQXRHZW5lcmF0aW9uP2QoXCJjaG9pY2VUb0Nob29zZS50aHJlYWRBdEdlbmVyYXRpb25cIik6bnVsbD09PW4udGFyZ2V0UGF0aD9kKFwiY2hvaWNlVG9DaG9vc2UudGFyZ2V0UGF0aFwiKToodGhpcy5zdGF0ZS5jYWxsU3RhY2suY3VycmVudFRocmVhZD1uLnRocmVhZEF0R2VuZXJhdGlvbix2b2lkIHRoaXMuQ2hvb3NlUGF0aChuLnRhcmdldFBhdGgpKX1IYXNGdW5jdGlvbih0KXt0cnl7cmV0dXJuIG51bGwhPXRoaXMuS25vdENvbnRhaW5lcldpdGhOYW1lKHQpfWNhdGNoKHQpe3JldHVybiExfX1FdmFsdWF0ZUZ1bmN0aW9uKHQsZT1bXSxuPSExKXtpZih0aGlzLklmQXN5bmNXZUNhbnQoXCJldmFsdWF0ZSBhIGZ1bmN0aW9uXCIpLG51bGw9PXQpdGhyb3cgbmV3IEVycm9yKFwiRnVuY3Rpb24gaXMgbnVsbFwiKTtpZihcIlwiPT10fHxcIlwiPT10LnRyaW0oKSl0aHJvdyBuZXcgRXJyb3IoXCJGdW5jdGlvbiBpcyBlbXB0eSBvciB3aGl0ZSBzcGFjZS5cIik7bGV0IGk9dGhpcy5Lbm90Q29udGFpbmVyV2l0aE5hbWUodCk7aWYobnVsbD09aSl0aHJvdyBuZXcgRXJyb3IoXCJGdW5jdGlvbiBkb2Vzbid0IGV4aXN0OiAnXCIrdCtcIidcIik7bGV0IHI9W107ci5wdXNoLmFwcGx5KHIsdGhpcy5zdGF0ZS5vdXRwdXRTdHJlYW0pLHRoaXMuX3N0YXRlLlJlc2V0T3V0cHV0KCksdGhpcy5zdGF0ZS5TdGFydEZ1bmN0aW9uRXZhbHVhdGlvbkZyb21HYW1lKGksZSk7bGV0IGE9bmV3IG07Zm9yKDt0aGlzLmNhbkNvbnRpbnVlOylhLkFwcGVuZCh0aGlzLkNvbnRpbnVlKCkpO2xldCBzPWEudG9TdHJpbmcoKTt0aGlzLl9zdGF0ZS5SZXNldE91dHB1dChyKTtsZXQgbD10aGlzLnN0YXRlLkNvbXBsZXRlRnVuY3Rpb25FdmFsdWF0aW9uRnJvbUdhbWUoKTtyZXR1cm4gbj97cmV0dXJuZWQ6bCxvdXRwdXQ6c306bH1FdmFsdWF0ZUV4cHJlc3Npb24odCl7bGV0IGU9dGhpcy5zdGF0ZS5jYWxsU3RhY2suZWxlbWVudHMubGVuZ3RoO3RoaXMuc3RhdGUuY2FsbFN0YWNrLlB1c2goci5UdW5uZWwpLHRoaXMuX3RlbXBvcmFyeUV2YWx1YXRpb25Db250YWluZXI9dCx0aGlzLnN0YXRlLkdvVG9TdGFydCgpO2xldCBuPXRoaXMuc3RhdGUuZXZhbHVhdGlvblN0YWNrLmxlbmd0aDtyZXR1cm4gdGhpcy5Db250aW51ZSgpLHRoaXMuX3RlbXBvcmFyeUV2YWx1YXRpb25Db250YWluZXI9bnVsbCx0aGlzLnN0YXRlLmNhbGxTdGFjay5lbGVtZW50cy5sZW5ndGg+ZSYmdGhpcy5zdGF0ZS5Qb3BDYWxsU3RhY2soKSx0aGlzLnN0YXRlLmV2YWx1YXRpb25TdGFjay5sZW5ndGg+bj90aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpOm51bGx9Q2FsbEV4dGVybmFsRnVuY3Rpb24odCxlKXtpZihudWxsPT09dClyZXR1cm4gZChcImZ1bmNOYW1lXCIpO2xldCBuPXRoaXMuX2V4dGVybmFscy5nZXQodCksaT1udWxsO2lmKCEodm9pZCAwIT09bikpe2lmKHRoaXMuYWxsb3dFeHRlcm5hbEZ1bmN0aW9uRmFsbGJhY2tzKXJldHVybiBpPXRoaXMuS25vdENvbnRhaW5lcldpdGhOYW1lKHQpLHRoaXMuQXNzZXJ0KG51bGwhPT1pLFwiVHJ5aW5nIHRvIGNhbGwgRVhURVJOQUwgZnVuY3Rpb24gJ1wiK3QrXCInIHdoaWNoIGhhcyBub3QgYmVlbiBib3VuZCwgYW5kIGZhbGxiYWNrIGluayBmdW5jdGlvbiBjb3VsZCBub3QgYmUgZm91bmQuXCIpLHRoaXMuc3RhdGUuY2FsbFN0YWNrLlB1c2goci5GdW5jdGlvbix2b2lkIDAsdGhpcy5zdGF0ZS5vdXRwdXRTdHJlYW0ubGVuZ3RoKSx2b2lkKHRoaXMuc3RhdGUuZGl2ZXJ0ZWRQb2ludGVyPUkuU3RhcnRPZihpKSk7dGhpcy5Bc3NlcnQoITEsXCJUcnlpbmcgdG8gY2FsbCBFWFRFUk5BTCBmdW5jdGlvbiAnXCIrdCtcIicgd2hpY2ggaGFzIG5vdCBiZWVuIGJvdW5kIChhbmQgaW5rIGZhbGxiYWNrcyBkaXNhYmxlZCkuXCIpfWxldCBhPVtdO2ZvcihsZXQgdD0wO3Q8ZTsrK3Qpe2xldCB0PXModGhpcy5zdGF0ZS5Qb3BFdmFsdWF0aW9uU3RhY2soKSx2KS52YWx1ZU9iamVjdDthLnB1c2godCl9YS5yZXZlcnNlKCk7bGV0IGw9bihhKSxvPW51bGw7bnVsbCE9bD8obz12LkNyZWF0ZShsKSx0aGlzLkFzc2VydChudWxsIT09byxcIkNvdWxkIG5vdCBjcmVhdGUgaW5rIHZhbHVlIGZyb20gcmV0dXJuZWQgb2JqZWN0IG9mIHR5cGUgXCIrdHlwZW9mIGwpKTpvPW5ldyBMLHRoaXMuc3RhdGUuUHVzaEV2YWx1YXRpb25TdGFjayhvKX1CaW5kRXh0ZXJuYWxGdW5jdGlvbkdlbmVyYWwodCxlKXt0aGlzLklmQXN5bmNXZUNhbnQoXCJiaW5kIGFuIGV4dGVybmFsIGZ1bmN0aW9uXCIpLHRoaXMuQXNzZXJ0KCF0aGlzLl9leHRlcm5hbHMuaGFzKHQpLFwiRnVuY3Rpb24gJ1wiK3QrXCInIGhhcyBhbHJlYWR5IGJlZW4gYm91bmQuXCIpLHRoaXMuX2V4dGVybmFscy5zZXQodCxlKX1UcnlDb2VyY2UodCl7cmV0dXJuIHR9QmluZEV4dGVybmFsRnVuY3Rpb24odCxlKXt0aGlzLkFzc2VydChudWxsIT1lLFwiQ2FuJ3QgYmluZCBhIG51bGwgZnVuY3Rpb25cIiksdGhpcy5CaW5kRXh0ZXJuYWxGdW5jdGlvbkdlbmVyYWwodCx0PT57dGhpcy5Bc3NlcnQodC5sZW5ndGg+PWUubGVuZ3RoLFwiRXh0ZXJuYWwgZnVuY3Rpb24gZXhwZWN0ZWQgXCIrZS5sZW5ndGgrXCIgYXJndW1lbnRzXCIpO2xldCBuPVtdO2ZvcihsZXQgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyluW2VdPXRoaXMuVHJ5Q29lcmNlKHRbZV0pO3JldHVybiBlLmFwcGx5KG51bGwsbil9KX1VbmJpbmRFeHRlcm5hbEZ1bmN0aW9uKHQpe3RoaXMuSWZBc3luY1dlQ2FudChcInVuYmluZCBhbiBleHRlcm5hbCBhIGZ1bmN0aW9uXCIpLHRoaXMuQXNzZXJ0KHRoaXMuX2V4dGVybmFscy5oYXModCksXCJGdW5jdGlvbiAnXCIrdCtcIicgaGFzIG5vdCBiZWVuIGJvdW5kLlwiKSx0aGlzLl9leHRlcm5hbHMuZGVsZXRlKHQpfVZhbGlkYXRlRXh0ZXJuYWxCaW5kaW5ncygpe2xldCB0PW51bGwsZT1udWxsLG49YXJndW1lbnRzWzFdfHxuZXcgU2V0O2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YgTiYmKHQ9YXJndW1lbnRzWzBdKSxhcmd1bWVudHNbMF1pbnN0YW5jZW9mIHAmJihlPWFyZ3VtZW50c1swXSksbnVsbD09PXQmJm51bGw9PT1lKWlmKHRoaXMuVmFsaWRhdGVFeHRlcm5hbEJpbmRpbmdzKHRoaXMuX21haW5Db250ZW50Q29udGFpbmVyLG4pLHRoaXMuX2hhc1ZhbGlkYXRlZEV4dGVybmFscz0hMCwwPT1uLnNpemUpdGhpcy5faGFzVmFsaWRhdGVkRXh0ZXJuYWxzPSEwO2Vsc2V7bGV0IHQ9XCJFcnJvcjogTWlzc2luZyBmdW5jdGlvbiBiaW5kaW5nIGZvciBleHRlcm5hbFwiO3QrPW4uc2l6ZT4xP1wic1wiOlwiXCIsdCs9XCI6ICdcIix0Kz1BcnJheS5mcm9tKG4pLmpvaW4oXCInLCAnXCIpLHQrPVwiJyBcIix0Kz10aGlzLmFsbG93RXh0ZXJuYWxGdW5jdGlvbkZhbGxiYWNrcz9cIiwgYW5kIG5vIGZhbGxiYWNrIGluayBmdW5jdGlvbiBmb3VuZC5cIjpcIiAoaW5rIGZhbGxiYWNrcyBkaXNhYmxlZClcIix0aGlzLkVycm9yKHQpfWVsc2UgaWYobnVsbCE9dCl7Zm9yKGxldCBlIG9mIHQuY29udGVudCl7bGV0IHQ9ZTtudWxsIT10JiZ0Lmhhc1ZhbGlkTmFtZXx8dGhpcy5WYWxpZGF0ZUV4dGVybmFsQmluZGluZ3MoZSxuKX1mb3IobGV0WyxlXW9mIHQubmFtZWRDb250ZW50KXRoaXMuVmFsaWRhdGVFeHRlcm5hbEJpbmRpbmdzKGEoZSxwKSxuKX1lbHNlIGlmKG51bGwhPWUpe2xldCB0PWEoZSxrKTtpZih0JiZ0LmlzRXh0ZXJuYWwpe2xldCBlPXQudGFyZ2V0UGF0aFN0cmluZztpZihudWxsPT09ZSlyZXR1cm4gZChcIm5hbWVcIik7aWYoIXRoaXMuX2V4dGVybmFscy5oYXMoZSkpaWYodGhpcy5hbGxvd0V4dGVybmFsRnVuY3Rpb25GYWxsYmFja3Mpe3RoaXMubWFpbkNvbnRlbnRDb250YWluZXIubmFtZWRDb250ZW50LmhhcyhlKXx8bi5hZGQoZSl9ZWxzZSBuLmFkZChlKX19fU9ic2VydmVWYXJpYWJsZSh0LGUpe2lmKHRoaXMuSWZBc3luY1dlQ2FudChcIm9ic2VydmUgYSBuZXcgdmFyaWFibGVcIiksbnVsbD09PXRoaXMuX3ZhcmlhYmxlT2JzZXJ2ZXJzJiYodGhpcy5fdmFyaWFibGVPYnNlcnZlcnM9bmV3IE1hcCksIXRoaXMuc3RhdGUudmFyaWFibGVzU3RhdGUuR2xvYmFsVmFyaWFibGVFeGlzdHNXaXRoTmFtZSh0KSl0aHJvdyBuZXcgUyhcIkNhbm5vdCBvYnNlcnZlIHZhcmlhYmxlICdcIit0K1wiJyBiZWNhdXNlIGl0IHdhc24ndCBkZWNsYXJlZCBpbiB0aGUgaW5rIHN0b3J5LlwiKTt0aGlzLl92YXJpYWJsZU9ic2VydmVycy5oYXModCk/dGhpcy5fdmFyaWFibGVPYnNlcnZlcnMuZ2V0KHQpLnB1c2goZSk6dGhpcy5fdmFyaWFibGVPYnNlcnZlcnMuc2V0KHQsW2VdKX1PYnNlcnZlVmFyaWFibGVzKHQsZSl7Zm9yKGxldCBuPTAsaT10Lmxlbmd0aDtuPGk7bisrKXRoaXMuT2JzZXJ2ZVZhcmlhYmxlKHRbbl0sZVtuXSl9UmVtb3ZlVmFyaWFibGVPYnNlcnZlcih0LGUpe2lmKHRoaXMuSWZBc3luY1dlQ2FudChcInJlbW92ZSBhIHZhcmlhYmxlIG9ic2VydmVyXCIpLG51bGwhPT10aGlzLl92YXJpYWJsZU9ic2VydmVycylpZih2b2lkIDAhPT1lKXtpZih0aGlzLl92YXJpYWJsZU9ic2VydmVycy5oYXMoZSkpe2xldCBuPXRoaXMuX3ZhcmlhYmxlT2JzZXJ2ZXJzLmdldChlKTtudWxsIT09dD9uLnNwbGljZShuLmluZGV4T2YodCksMSk6dGhpcy5fdmFyaWFibGVPYnNlcnZlcnMuZGVsZXRlKGUpfX1lbHNlIGlmKG51bGwhPT10KXtsZXQgZT10aGlzLl92YXJpYWJsZU9ic2VydmVycy5rZXlzKCk7Zm9yKGxldCBuIG9mIGUpe2xldCBlPXRoaXMuX3ZhcmlhYmxlT2JzZXJ2ZXJzLmdldChuKTtlLnNwbGljZShlLmluZGV4T2YodCksMSl9fX1WYXJpYWJsZVN0YXRlRGlkQ2hhbmdlRXZlbnQodCxlKXtpZihudWxsPT09dGhpcy5fdmFyaWFibGVPYnNlcnZlcnMpcmV0dXJuO2xldCBuPXRoaXMuX3ZhcmlhYmxlT2JzZXJ2ZXJzLmdldCh0KTtpZih2b2lkIDAhPT1uKXtpZighKGUgaW5zdGFuY2VvZiB2KSl0aHJvdyBuZXcgRXJyb3IoXCJUcmllZCB0byBnZXQgdGhlIHZhbHVlIG9mIGEgdmFyaWFibGUgdGhhdCBpc24ndCBhIHN0YW5kYXJkIHR5cGVcIik7bGV0IGk9cyhlLHYpO2ZvcihsZXQgZSBvZiBuKWUodCxpLnZhbHVlT2JqZWN0KX19Z2V0IGdsb2JhbFRhZ3MoKXtyZXR1cm4gdGhpcy5UYWdzQXRTdGFydE9mRmxvd0NvbnRhaW5lcldpdGhQYXRoU3RyaW5nKFwiXCIpfVRhZ3NGb3JDb250ZW50QXRQYXRoKHQpe3JldHVybiB0aGlzLlRhZ3NBdFN0YXJ0T2ZGbG93Q29udGFpbmVyV2l0aFBhdGhTdHJpbmcodCl9VGFnc0F0U3RhcnRPZkZsb3dDb250YWluZXJXaXRoUGF0aFN0cmluZyh0KXtsZXQgbj1uZXcgZSh0KSxpPXRoaXMuQ29udGVudEF0UGF0aChuKS5jb250YWluZXI7aWYobnVsbD09PWkpcmV0dXJuIGQoXCJmbG93Q29udGFpbmVyXCIpO2Zvcig7Oyl7bGV0IHQ9aS5jb250ZW50WzBdO2lmKCEodCBpbnN0YW5jZW9mIE4pKWJyZWFrO2k9dH1sZXQgcj1udWxsO2ZvcihsZXQgdCBvZiBpLmNvbnRlbnQpe2xldCBlPWEodCxqKTtpZighZSlicmVhaztudWxsPT1yJiYocj1bXSksci5wdXNoKGUudGV4dCl9cmV0dXJuIHJ9QnVpbGRTdHJpbmdPZkhpZXJhcmNoeSgpe2xldCB0PW5ldyBtO3JldHVybiB0aGlzLm1haW5Db250ZW50Q29udGFpbmVyLkJ1aWxkU3RyaW5nT2ZIaWVyYXJjaHkodCwwLHRoaXMuc3RhdGUuY3VycmVudFBvaW50ZXIuUmVzb2x2ZSgpKSx0LnRvU3RyaW5nKCl9QnVpbGRTdHJpbmdPZkNvbnRhaW5lcih0KXtsZXQgZT1uZXcgbTtyZXR1cm4gdC5CdWlsZFN0cmluZ09mSGllcmFyY2h5KGUsMCx0aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLlJlc29sdmUoKSksZS50b1N0cmluZygpfU5leHRDb250ZW50KCl7aWYodGhpcy5zdGF0ZS5wcmV2aW91c1BvaW50ZXI9dGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlci5jb3B5KCksIXRoaXMuc3RhdGUuZGl2ZXJ0ZWRQb2ludGVyLmlzTnVsbCYmKHRoaXMuc3RhdGUuY3VycmVudFBvaW50ZXI9dGhpcy5zdGF0ZS5kaXZlcnRlZFBvaW50ZXIuY29weSgpLHRoaXMuc3RhdGUuZGl2ZXJ0ZWRQb2ludGVyPUkuTnVsbCx0aGlzLlZpc2l0Q2hhbmdlZENvbnRhaW5lcnNEdWVUb0RpdmVydCgpLCF0aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyLmlzTnVsbCkpcmV0dXJuO2lmKCF0aGlzLkluY3JlbWVudENvbnRlbnRQb2ludGVyKCkpe2xldCB0PSExO3RoaXMuc3RhdGUuY2FsbFN0YWNrLkNhblBvcChyLkZ1bmN0aW9uKT8odGhpcy5zdGF0ZS5Qb3BDYWxsU3RhY2soci5GdW5jdGlvbiksdGhpcy5zdGF0ZS5pbkV4cHJlc3Npb25FdmFsdWF0aW9uJiZ0aGlzLnN0YXRlLlB1c2hFdmFsdWF0aW9uU3RhY2sobmV3IEwpLHQ9ITApOnRoaXMuc3RhdGUuY2FsbFN0YWNrLmNhblBvcFRocmVhZD8odGhpcy5zdGF0ZS5jYWxsU3RhY2suUG9wVGhyZWFkKCksdD0hMCk6dGhpcy5zdGF0ZS5UcnlFeGl0RnVuY3Rpb25FdmFsdWF0aW9uRnJvbUdhbWUoKSx0JiYhdGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlci5pc051bGwmJnRoaXMuTmV4dENvbnRlbnQoKX19SW5jcmVtZW50Q29udGVudFBvaW50ZXIoKXtsZXQgdD0hMCxlPXRoaXMuc3RhdGUuY2FsbFN0YWNrLmN1cnJlbnRFbGVtZW50LmN1cnJlbnRQb2ludGVyLmNvcHkoKTtpZihlLmluZGV4KyssbnVsbD09PWUuY29udGFpbmVyKXJldHVybiBkKFwicG9pbnRlci5jb250YWluZXJcIik7Zm9yKDtlLmluZGV4Pj1lLmNvbnRhaW5lci5jb250ZW50Lmxlbmd0aDspe3Q9ITE7bGV0IG49YShlLmNvbnRhaW5lci5wYXJlbnQsTik7aWYobiBpbnN0YW5jZW9mIE49PSExKWJyZWFrO2xldCBpPW4uY29udGVudC5pbmRleE9mKGUuY29udGFpbmVyKTtpZigtMT09aSlicmVhaztpZihlPW5ldyBJKG4saSksZS5pbmRleCsrLHQ9ITAsbnVsbD09PWUuY29udGFpbmVyKXJldHVybiBkKFwicG9pbnRlci5jb250YWluZXJcIil9cmV0dXJuIHR8fChlPUkuTnVsbCksdGhpcy5zdGF0ZS5jYWxsU3RhY2suY3VycmVudEVsZW1lbnQuY3VycmVudFBvaW50ZXI9ZS5jb3B5KCksdH1UcnlGb2xsb3dEZWZhdWx0SW52aXNpYmxlQ2hvaWNlKCl7bGV0IHQ9dGhpcy5fc3RhdGUuY3VycmVudENob2ljZXMsZT10LmZpbHRlcih0PT50LmlzSW52aXNpYmxlRGVmYXVsdCk7aWYoMD09ZS5sZW5ndGh8fHQubGVuZ3RoPmUubGVuZ3RoKXJldHVybiExO2xldCBuPWVbMF07cmV0dXJuIG51bGw9PT1uLnRhcmdldFBhdGg/ZChcImNob2ljZS50YXJnZXRQYXRoXCIpOm51bGw9PT1uLnRocmVhZEF0R2VuZXJhdGlvbj9kKFwiY2hvaWNlLnRocmVhZEF0R2VuZXJhdGlvblwiKToodGhpcy5zdGF0ZS5jYWxsU3RhY2suY3VycmVudFRocmVhZD1uLnRocmVhZEF0R2VuZXJhdGlvbix0aGlzLkNob29zZVBhdGgobi50YXJnZXRQYXRoLCExKSwhMCl9TmV4dFNlcXVlbmNlU2h1ZmZsZUluZGV4KCl7bGV0IHQ9YSh0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpLGIpO2lmKCEodCBpbnN0YW5jZW9mIGIpKXJldHVybiB0aGlzLkVycm9yKFwiZXhwZWN0ZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGluIHNlcXVlbmNlIGZvciBzaHVmZmxlIGluZGV4XCIpLDA7bGV0IGU9dGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlci5jb250YWluZXI7aWYobnVsbD09PWUpcmV0dXJuIGQoXCJzZXFDb250YWluZXJcIik7aWYobnVsbD09PXQudmFsdWUpcmV0dXJuIGQoXCJudW1FbGVtZW50c0ludFZhbC52YWx1ZVwiKTtsZXQgbj10LnZhbHVlLGk9cyh0aGlzLnN0YXRlLlBvcEV2YWx1YXRpb25TdGFjaygpLGIpLnZhbHVlO2lmKG51bGw9PT1pKXJldHVybiBkKFwic2VxQ291bnRcIik7bGV0IHI9aS9uLGw9aSVuLG89ZS5wYXRoLnRvU3RyaW5nKCksdT0wO2ZvcihsZXQgdD0wLGU9by5sZW5ndGg7dDxlO3QrKyl1Kz1vLmNoYXJDb2RlQXQodCl8fDA7bGV0IGg9dStyK3RoaXMuc3RhdGUuc3RvcnlTZWVkLGM9bmV3IEsoTWF0aC5mbG9vcihoKSkscD1bXTtmb3IobGV0IHQ9MDt0PG47Kyt0KXAucHVzaCh0KTtmb3IobGV0IHQ9MDt0PD1sOysrdCl7bGV0IGU9Yy5uZXh0KCklcC5sZW5ndGgsbj1wW2VdO2lmKHAuc3BsaWNlKGUsMSksdD09bClyZXR1cm4gbn10aHJvdyBuZXcgRXJyb3IoXCJTaG91bGQgbmV2ZXIgcmVhY2ggaGVyZVwiKX1FcnJvcih0LGU9ITEpe2xldCBuPW5ldyBTKHQpO3Rocm93IG4udXNlRW5kTGluZU51bWJlcj1lLG59V2FybmluZyh0KXt0aGlzLkFkZEVycm9yKHQsITApfUFkZEVycm9yKHQsZT0hMSxuPSExKXtsZXQgaT10aGlzLmN1cnJlbnREZWJ1Z01ldGFkYXRhLHI9ZT9cIldBUk5JTkdcIjpcIkVSUk9SXCI7aWYobnVsbCE9aSl7bGV0IGU9bj9pLmVuZExpbmVOdW1iZXI6aS5zdGFydExpbmVOdW1iZXI7dD1cIlJVTlRJTUUgXCIrcitcIjogJ1wiK2kuZmlsZU5hbWUrXCInIGxpbmUgXCIrZStcIjogXCIrdH1lbHNlIHQ9dGhpcy5zdGF0ZS5jdXJyZW50UG9pbnRlci5pc051bGw/XCJSVU5USU1FIFwiK3IrXCI6IFwiK3Q6XCJSVU5USU1FIFwiK3IrXCI6IChcIit0aGlzLnN0YXRlLmN1cnJlbnRQb2ludGVyK1wiKTogXCIrdDt0aGlzLnN0YXRlLkFkZEVycm9yKHQsZSksZXx8dGhpcy5zdGF0ZS5Gb3JjZUVuZCgpfUFzc2VydCh0LGU9bnVsbCl7aWYoMD09dCl0aHJvdyBudWxsPT1lJiYoZT1cIlN0b3J5IGFzc2VydFwiKSxuZXcgRXJyb3IoZStcIiBcIit0aGlzLmN1cnJlbnREZWJ1Z01ldGFkYXRhKX1nZXQgY3VycmVudERlYnVnTWV0YWRhdGEoKXtsZXQgdCxlPXRoaXMuc3RhdGUuY3VycmVudFBvaW50ZXI7aWYoIWUuaXNOdWxsJiZudWxsIT09ZS5SZXNvbHZlKCkmJih0PWUuUmVzb2x2ZSgpLmRlYnVnTWV0YWRhdGEsbnVsbCE9PXQpKXJldHVybiB0O2ZvcihsZXQgbj10aGlzLnN0YXRlLmNhbGxTdGFjay5lbGVtZW50cy5sZW5ndGgtMTtuPj0wOy0tbilpZihlPXRoaXMuc3RhdGUuY2FsbFN0YWNrLmVsZW1lbnRzW25dLmN1cnJlbnRQb2ludGVyLCFlLmlzTnVsbCYmbnVsbCE9PWUuUmVzb2x2ZSgpJiYodD1lLlJlc29sdmUoKS5kZWJ1Z01ldGFkYXRhLG51bGwhPT10KSlyZXR1cm4gdDtmb3IobGV0IGU9dGhpcy5zdGF0ZS5vdXRwdXRTdHJlYW0ubGVuZ3RoLTE7ZT49MDstLWUpe2lmKHQ9dGhpcy5zdGF0ZS5vdXRwdXRTdHJlYW1bZV0uZGVidWdNZXRhZGF0YSxudWxsIT09dClyZXR1cm4gdH1yZXR1cm4gbnVsbH1nZXQgbWFpbkNvbnRlbnRDb250YWluZXIoKXtyZXR1cm4gdGhpcy5fdGVtcG9yYXJ5RXZhbHVhdGlvbkNvbnRhaW5lcj90aGlzLl90ZW1wb3JhcnlFdmFsdWF0aW9uQ29udGFpbmVyOnRoaXMuX21haW5Db250ZW50Q29udGFpbmVyfX1YLmlua1ZlcnNpb25DdXJyZW50PTE5LGZ1bmN0aW9uKHQpe2xldCBlOyFmdW5jdGlvbih0KXt0W3QuTm9DaGFuZ2U9MF09XCJOb0NoYW5nZVwiLHRbdC5FeHRlbmRlZEJleW9uZE5ld2xpbmU9MV09XCJFeHRlbmRlZEJleW9uZE5ld2xpbmVcIix0W3QuTmV3bGluZVJlbW92ZWQ9Ml09XCJOZXdsaW5lUmVtb3ZlZFwifShlPXQuT3V0cHV0U3RhdGVDaGFuZ2V8fCh0Lk91dHB1dFN0YXRlQ2hhbmdlPXt9KSl9KFh8fChYPXt9KSksdC5JbmtMaXN0PWcsdC5TdG9yeT1YLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pfSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5rLWVzMjAxNS5qcy5tYXBcbiIsImltcG9ydCBIZWFkIGZyb20gJ25leHQvaGVhZCdcbmltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0J1xuXG5pbXBvcnQgKiBhcyBpbmtqcyBmcm9tICdpbmtqcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEhvbWUoKSB7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhpbmtqcyk7XG4gICAgICAgIC8qIGZldGNoKFwic3RvcnkuanNvblwiKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHN0b3J5Q29udGVudCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0b3J5Q29udGVudCk7XG4gICAgICAgICAgICAgICAgc3RvcnkgPSBuZXcgaW5ranMuU3Rvcnkoc3RvcnlDb250ZW50KTtcbiAgICAgICAgICAgICAgICBjb250aW51ZVN0b3J5KCk7XG4gICAgICAgICAgICB9KTsgKi9cbiAgICB9KVxuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIDxIZWFkPlxuICAgICAgICAgICAgICAgIDx0aXRsZT5EYXRpbmcgU2ltPC90aXRsZT5cbiAgICAgICAgICAgIDwvSGVhZD5cblxuICAgICAgICAgICAgPG1haW4+XG4gICAgICAgICAgICAgICAgPGgxPkRhdGluZyBTaW08L2gxPlxuXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICA8L21haW4+XG4gICAgICAgIDwvZGl2PlxuICAgIClcbn0iXSwic291cmNlUm9vdCI6IiJ9